var qo=Object.defineProperty;var ao=e=>{throw TypeError(e)};var Qo=(e,i,s)=>i in e?qo(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s;var mn=(e,i,s)=>Qo(e,typeof i!="symbol"?i+"":i,s),Fs=(e,i,s)=>i.has(e)||ao("Cannot "+s);var ht=(e,i,s)=>(Fs(e,i,"read from private field"),s?s.call(e):i.get(e)),Sr=(e,i,s)=>i.has(e)?ao("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,s),yr=(e,i,s,a)=>(Fs(e,i,"write to private field"),a?a.call(e,s):i.set(e,s),s),mr=(e,i,s)=>(Fs(e,i,"access private method"),s);var On=(e,i,s,a)=>({set _(o){yr(e,i,o,s)},get _(){return ht(e,i,a)}});function _mergeNamespaces(e,i){for(var s=0;s<i.length;s++){const a=i[s];if(typeof a!="string"&&!Array.isArray(a)){for(const o in a)if(o!=="default"&&!(o in e)){const c=Object.getOwnPropertyDescriptor(a,o);c&&Object.defineProperty(e,o,c.get?c:{enumerable:!0,get:()=>a[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=s(o);fetch(o.href,c)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var s=function a(){return this instanceof a?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};s.prototype=i.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var o=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(s,a,o.get?o:{enumerable:!0,get:function(){return e[a]}})}),s}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$2={};function E$2(e,i,s){this.props=e,this.context=i,this.refs=D$2,this.updater=s||B$1}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$2.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$2.prototype;function G$1(e,i,s){this.props=e,this.context=i,this.refs=D$2,this.updater=s||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$2.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,s){var a,o={},c=null,d=null;if(i!=null)for(a in i.ref!==void 0&&(d=i.ref),i.key!==void 0&&(c=""+i.key),i)J.call(i,a)&&!L$2.hasOwnProperty(a)&&(o[a]=i[a]);var h=arguments.length-2;if(h===1)o.children=s;else if(1<h){for(var g=Array(h),_=0;_<h;_++)g[_]=arguments[_+2];o.children=g}if(e&&e.defaultProps)for(a in h=e.defaultProps,h)o[a]===void 0&&(o[a]=h[a]);return{$$typeof:l$1,type:e,key:c,ref:d,props:o,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape$1(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return i[s]})}var P$2=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):i.toString(36)}function R$1(e,i,s,a,o){var c=typeof e;(c==="undefined"||c==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=e,o=o(d),e=a===""?"."+Q$1(d,0):a,I$1(o)?(s="",e!=null&&(s=e.replace(P$2,"$&/")+"/"),R$1(o,i,s,"",function(_){return _})):o!=null&&(O$1(o)&&(o=N$1(o,s+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(P$2,"$&/")+"/")+e)),i.push(o)),1;if(d=0,a=a===""?".":a+":",I$1(e))for(var h=0;h<e.length;h++){c=e[h];var g=a+Q$1(c,h);d+=R$1(c,i,s,g,o)}else if(g=A$1(e),typeof g=="function")for(e=g.call(e),h=0;!(c=e.next()).done;)c=c.value,g=a+Q$1(c,h++),d+=R$1(c,i,s,g,o);else if(c==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(e,i,s){if(e==null)return e;var a=[],o=0;return R$1(e,a,"","",function(c){return i.call(s,c,o++)}),a}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$2={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,s){S$1(e,function(){i.apply(this,arguments)},s)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$2;react_production_min.Fragment=p$2;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$2;react_production_min.cloneElement=function(e,i,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=C$1({},e.props),o=e.key,c=e.ref,d=e._owner;if(i!=null){if(i.ref!==void 0&&(c=i.ref,d=K$1.current),i.key!==void 0&&(o=""+i.key),e.type&&e.type.defaultProps)var h=e.type.defaultProps;for(g in i)J.call(i,g)&&!L$2.hasOwnProperty(g)&&(a[g]=i[g]===void 0&&h!==void 0?h[g]:i[g])}var g=arguments.length-2;if(g===1)a.children=s;else if(1<g){h=Array(g);for(var _=0;_<g;_++)h[_]=arguments[_+2];a.children=h}return{$$typeof:l$1,type:e.type,key:o,ref:c,props:a,_owner:d}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$2,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(e,i){return U$2.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$2.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$2.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$2.current.useEffect(e,i)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(e,i,s){return U$2.current.useImperativeHandle(e,i,s)};react_production_min.useInsertionEffect=function(e,i){return U$2.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$2.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$2.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,s){return U$2.current.useReducer(e,i,s)};react_production_min.useRef=function(e){return U$2.current.useRef(e)};react_production_min.useState=function(e){return U$2.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,s){return U$2.current.useSyncExternalStore(e,i,s)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,s){var a,o={},c=null,d=null;s!==void 0&&(c=""+s),i.key!==void 0&&(c=""+i.key),i.ref!==void 0&&(d=i.ref);for(a in i)m$1.call(i,a)&&!p$1.hasOwnProperty(a)&&(o[a]=i[a]);if(e&&e.defaultProps)for(a in i=e.defaultProps,i)o[a]===void 0&&(o[a]=i[a]);return{$$typeof:k,type:e,key:c,ref:d,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Yt,kt){var ir=Yt.length;Yt.push(kt);e:for(;0<ir;){var fr=ir-1>>>1,Et=Yt[fr];if(0<o(Et,kt))Yt[fr]=kt,Yt[ir]=Et,ir=fr;else break e}}function s(Yt){return Yt.length===0?null:Yt[0]}function a(Yt){if(Yt.length===0)return null;var kt=Yt[0],ir=Yt.pop();if(ir!==kt){Yt[0]=ir;e:for(var fr=0,Et=Yt.length,xt=Et>>>1;fr<xt;){var mt=2*(fr+1)-1,St=Yt[mt],Pt=mt+1,Nt=Yt[Pt];if(0>o(St,ir))Pt<Et&&0>o(Nt,St)?(Yt[fr]=Nt,Yt[Pt]=ir,fr=Pt):(Yt[fr]=St,Yt[mt]=ir,fr=mt);else if(Pt<Et&&0>o(Nt,ir))Yt[fr]=Nt,Yt[Pt]=ir,fr=Pt;else break e}}return kt}function o(Yt,kt){var ir=Yt.sortIndex-kt.sortIndex;return ir!==0?ir:Yt.id-kt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();e.unstable_now=function(){return d.now()-h}}var g=[],_=[],b=1,tt=null,_e=3,rt=!1,it=!1,et=!1,nt=typeof setTimeout=="function"?setTimeout:null,at=typeof clearTimeout=="function"?clearTimeout:null,st=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ot(Yt){for(var kt=s(_);kt!==null;){if(kt.callback===null)a(_);else if(kt.startTime<=Yt)a(_),kt.sortIndex=kt.expirationTime,i(g,kt);else break;kt=s(_)}}function pt(Yt){if(et=!1,ot(Yt),!it)if(s(g)!==null)it=!0,ar(dt);else{var kt=s(_);kt!==null&&Jt(pt,kt.startTime-Yt)}}function dt(Yt,kt){it=!1,et&&(et=!1,at(gt),gt=-1),rt=!0;var ir=_e;try{for(ot(kt),tt=s(g);tt!==null&&(!(tt.expirationTime>kt)||Yt&&!yt());){var fr=tt.callback;if(typeof fr=="function"){tt.callback=null,_e=tt.priorityLevel;var Et=fr(tt.expirationTime<=kt);kt=e.unstable_now(),typeof Et=="function"?tt.callback=Et:tt===s(g)&&a(g),ot(kt)}else a(g);tt=s(g)}if(tt!==null)var xt=!0;else{var mt=s(_);mt!==null&&Jt(pt,mt.startTime-kt),xt=!1}return xt}finally{tt=null,_e=ir,rt=!1}}var wt=!1,lt=null,gt=-1,vt=5,At=-1;function yt(){return!(e.unstable_now()-At<vt)}function bt(){if(lt!==null){var Yt=e.unstable_now();At=Yt;var kt=!0;try{kt=lt(!0,Yt)}finally{kt?Tt():(wt=!1,lt=null)}}else wt=!1}var Tt;if(typeof st=="function")Tt=function(){st(bt)};else if(typeof MessageChannel<"u"){var er=new MessageChannel,zt=er.port2;er.port1.onmessage=bt,Tt=function(){zt.postMessage(null)}}else Tt=function(){nt(bt,0)};function ar(Yt){lt=Yt,wt||(wt=!0,Tt())}function Jt(Yt,kt){gt=nt(function(){Yt(e.unstable_now())},kt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Yt){Yt.callback=null},e.unstable_continueExecution=function(){it||rt||(it=!0,ar(dt))},e.unstable_forceFrameRate=function(Yt){0>Yt||125<Yt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):vt=0<Yt?Math.floor(1e3/Yt):5},e.unstable_getCurrentPriorityLevel=function(){return _e},e.unstable_getFirstCallbackNode=function(){return s(g)},e.unstable_next=function(Yt){switch(_e){case 1:case 2:case 3:var kt=3;break;default:kt=_e}var ir=_e;_e=kt;try{return Yt()}finally{_e=ir}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Yt,kt){switch(Yt){case 1:case 2:case 3:case 4:case 5:break;default:Yt=3}var ir=_e;_e=Yt;try{return kt()}finally{_e=ir}},e.unstable_scheduleCallback=function(Yt,kt,ir){var fr=e.unstable_now();switch(typeof ir=="object"&&ir!==null?(ir=ir.delay,ir=typeof ir=="number"&&0<ir?fr+ir:fr):ir=fr,Yt){case 1:var Et=-1;break;case 2:Et=250;break;case 5:Et=1073741823;break;case 4:Et=1e4;break;default:Et=5e3}return Et=ir+Et,Yt={id:b++,callback:kt,priorityLevel:Yt,startTime:ir,expirationTime:Et,sortIndex:-1},ir>fr?(Yt.sortIndex=ir,i(_,Yt),s(g)===null&&Yt===s(_)&&(et?(at(gt),gt=-1):et=!0,Jt(pt,ir-fr))):(Yt.sortIndex=Et,i(g,Yt),it||rt||(it=!0,ar(dt))),Yt},e.unstable_shouldYield=yt,e.unstable_wrapCallback=function(Yt){var kt=_e;return function(){var ir=_e;_e=kt;try{return Yt.apply(this,arguments)}finally{_e=ir}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,s,a){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,s,a){if(i===null||typeof i>"u"||pa(e,i,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v$1(e,i,s,a,o,c,d){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=a,this.attributeNamespace=o,this.mustUseProperty=s,this.propertyName=e,this.type=i,this.sanitizeURL=c,this.removeEmptyString=d}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v$1(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v$1(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v$1(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v$1(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v$1(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v$1(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v$1(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v$1(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v$1(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v$1(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v$1(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,s,a){var o=z.hasOwnProperty(i)?z[i]:null;(o!==null?o.type!==0:a||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,s,o,a)&&(s=null),a||o===null?oa(i)&&(s===null?e.removeAttribute(i):e.setAttribute(i,""+s)):o.mustUseProperty?e[o.propertyName]=s===null?o.type===3?!1:"":s:(i=o.attributeName,a=o.attributeNamespace,s===null?e.removeAttribute(i):(o=o.type,s=o===3||o===4&&s===!0?"":""+s,a?e.setAttributeNS(a,i,s):e.setAttribute(i,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(_){var a=_}Reflect.construct(e,[],i)}else{try{i.call()}catch(_){a=_}e.call(i.prototype)}else{try{throw Error()}catch(_){a=_}e()}}catch(_){if(_&&a&&typeof _.stack=="string"){for(var o=_.stack.split(`
`),c=a.stack.split(`
`),d=o.length-1,h=c.length-1;1<=d&&0<=h&&o[d]!==c[h];)h--;for(;1<=d&&0<=h;d--,h--)if(o[d]!==c[h]){if(d!==1||h!==1)do if(d--,h--,0>h||o[d]!==c[h]){var g=`
`+o[d].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=d&&0<=h);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),a=""+e[i];if(!e.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var o=s.get,c=s.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return o.call(this)},set:function(d){a=""+d,c.call(this,d)}}),Object.defineProperty(e,i,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(d){a=""+d},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var s=i.getValue(),a="";return e&&(a=Ta(e)?e.checked?"true":"false":e.value),e=a,e!==s?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var s=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,i){var s=i.defaultValue==null?"":i.defaultValue,a=i.checked!=null?i.checked:i.defaultChecked;s=Sa(i.value!=null?i.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var s=Sa(i.value),a=i.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,s):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var a=i.type;if(!(a!=="submit"&&a!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,s||i===e.value||(e.value=i),e.defaultValue=i}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,i,s){(i!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,i,s,a){if(e=e.options,i){i={};for(var o=0;o<s.length;o++)i["$"+s[o]]=!0;for(s=0;s<e.length;s++)o=i.hasOwnProperty("$"+e[s].value),e[s].selected!==o&&(e[s].selected=o),o&&a&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),i=null,o=0;o<e.length;o++){if(e[o].value===s){e[o].selected=!0,a&&(e[o].defaultSelected=!0);return}i!==null||e[o].disabled||(i=e[o])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}i=s}i==null&&(i=""),s=i}e._wrapperState={initialValue:Sa(s)}}function ib(e,i){var s=Sa(i.value),a=Sa(i.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),i.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,a,o){MSApp.execUnsafeLocalFunction(function(){return e(i,s,a,o)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var s in i)if(i.hasOwnProperty(s)){var a=s.indexOf("--")===0,o=rb(s,i[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,o):e[s]=o}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,s){if(Ib)return e(i,s);Ib=!0;try{return Gb(e,i,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var s=e.stateNode;if(s===null)return null;var a=Db(s);if(a===null)return null;s=a[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,i,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,s,a,o,c,d,h,g){var _=Array.prototype.slice.call(arguments,3);try{i.apply(s,_)}catch(b){this.onError(b)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,s,a,o,c,d,h,g){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,s,a,o,c,d,h,g){if(Tb.apply(this,arguments),Ob){if(Ob){var _=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_)}}function Vb(e){var i=e,s=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(s=i.return),e=i.return;while(e)}return i.tag===3?s:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p(188));return i!==e?null:e}for(var s=e,a=i;;){var o=s.return;if(o===null)break;var c=o.alternate;if(c===null){if(a=o.return,a!==null){s=a;continue}break}if(o.child===c.child){for(c=o.child;c;){if(c===s)return Xb(o),e;if(c===a)return Xb(o),i;c=c.sibling}throw Error(p(188))}if(s.return!==a.return)s=o,a=c;else{for(var d=!1,h=o.child;h;){if(h===s){d=!0,s=o,a=c;break}if(h===a){d=!0,a=o,s=c;break}h=h.sibling}if(!d){for(h=c.child;h;){if(h===s){d=!0,s=c,a=o;break}if(h===a){d=!0,a=c,s=o;break}h=h.sibling}if(!d)throw Error(p(189))}}if(s.alternate!==a)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var s=e.pendingLanes;if(s===0)return 0;var a=0,o=e.suspendedLanes,c=e.pingedLanes,d=s&268435455;if(d!==0){var h=d&~o;h!==0?a=tc(h):(c&=d,c!==0&&(a=tc(c)))}else d=s&~o,d!==0?a=tc(d):c!==0&&(a=tc(c));if(a===0)return 0;if(i!==0&&i!==a&&!(i&o)&&(o=a&-a,c=i&-i,o>=c||o===16&&(c&4194240)!==0))return i;if(a&4&&(a|=s&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=a;0<i;)s=31-oc(i),o=1<<s,a|=e[s],i&=~o;return a}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var s=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,c=e.pendingLanes;0<c;){var d=31-oc(c),h=1<<d,g=o[d];g===-1?(!(h&s)||h&a)&&(o[d]=vc(h,i)):g<=i&&(e.expiredLanes|=h),c&=~h}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],s=0;31>s;s++)i.push(e);return i}function Ac(e,i,s){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=s}function Bc(e,i){var s=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var o=31-oc(s),c=1<<o;i[o]=0,a[o]=-1,e[o]=-1,s&=~c}}function Cc(e,i){var s=e.entangledLanes|=i;for(e=e.entanglements;s;){var a=31-oc(s),o=1<<a;o&i|e[a]&i&&(e[a]|=i),s&=~o}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,s,a,o,c){return e===null||e.nativeEvent!==c?(e={blockedOn:i,domEventName:s,eventSystemFlags:a,nativeEvent:c,targetContainers:[o]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=a,i=e.targetContainers,o!==null&&i.indexOf(o)===-1&&i.push(o),e)}function Uc(e,i,s,a,o){switch(i){case"focusin":return Lc=Tc(Lc,e,i,s,a,o),!0;case"dragenter":return Mc=Tc(Mc,e,i,s,a,o),!0;case"mouseover":return Nc=Tc(Nc,e,i,s,a,o),!0;case"pointerover":var c=o.pointerId;return Oc.set(c,Tc(Oc.get(c)||null,e,i,s,a,o)),!0;case"gotpointercapture":return c=o.pointerId,Pc.set(c,Tc(Pc.get(c)||null,e,i,s,a,o)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var s=Vb(i);if(s!==null){if(i=s.tag,i===13){if(i=Wb(s),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var s=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);wb=a,s.target.dispatchEvent(a),wb=null}else return i=Cb(s),i!==null&&Fc(i),e.blockedOn=s,!1;i.shift()}return!0}function Zc(e,i,s){Xc(e)&&s.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(o){return ad(o,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var a=Kc[s];a.blockedOn===e&&(a.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),s=0;s<Qc.length;s++)a=Qc[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,s,a){var o=C,c=cd.transition;cd.transition=null;try{C=1,fd(e,i,s,a)}finally{C=o,cd.transition=c}}function gd(e,i,s,a){var o=C,c=cd.transition;cd.transition=null;try{C=4,fd(e,i,s,a)}finally{C=o,cd.transition=c}}function fd(e,i,s,a){if(dd){var o=Yc(e,i,s,a);if(o===null)hd(e,i,a,id,s),Sc(e,a);else if(Uc(o,e,i,s,a))a.stopPropagation();else if(Sc(e,a),i&4&&-1<Rc.indexOf(e)){for(;o!==null;){var c=Cb(o);if(c!==null&&Ec(c),c=Yc(e,i,s,a),c===null&&hd(e,i,a,id,s),c===o)break;o=c}o!==null&&a.stopPropagation()}else hd(e,i,a,null,s)}}var id=null;function Yc(e,i,s,a){if(id=null,e=xb(a),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(s=i.tag,s===13){if(e=Wb(i),e!==null)return e;e=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,s=i.length,a,o="value"in kd?kd.value:kd.textContent,c=o.length;for(e=0;e<s&&i[e]===o[e];e++);var d=s-e;for(a=1;a<=d&&i[s-a]===o[c-a];a++);return md=o.slice(e,1<a?1-a:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(s,a,o,c,d){this._reactName=s,this._targetInst=o,this.type=a,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var h in e)e.hasOwnProperty(h)&&(s=e[h],this[h]=s?s(c):c[h]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae$1||be&&8<be&&11>=be),ee$1=" ",fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee$1);case"textInput":return e=i.data,e===ee$1&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae$1&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne$1(e,i,s,a){Eb(a),i=oe$1(i,"onChange"),0<i.length&&(s=new td("onChange","change",null,s,a),e.push({event:s,listeners:i}))}var pe=null,qe=null;function re(e){se$1(e,0)}function te$1(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te$1(qe)){var i=[];ne$1(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,s){e==="focusin"?(Ae(),pe=i,qe=s,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te$1(qe)}function Ee(e,i){if(e==="click")return te$1(i)}function Fe(e,i){if(e==="input"||e==="change")return te$1(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var s=Object.keys(e),a=Object.keys(i);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var o=s[a];if(!ja.call(i,o)||!He(e[o],i[o]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var s=Je(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=i&&a>=i)return{node:s,offset:i-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),s=e.focusedElem,a=e.selectionRange;if(i!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(a!==null&&Ne(s)){if(i=a.start,e=a.end,e===void 0&&(e=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(e,s.value.length);else if(e=(i=s.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var o=s.textContent.length,c=Math.min(a.start,o);a=a.end===void 0?c:Math.min(a.end,o),!e.extend&&c>a&&(o=a,a=c,c=o),o=Ke(s,c);var d=Ke(s,a);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(i=i.createRange(),i.setStart(o.node,o.offset),e.removeAllRanges(),c>a?(e.addRange(i),e.extend(d.node,d.offset)):(i.setEnd(d.node,d.offset),e.addRange(i)))}}for(i=[],e=s;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)e=i[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te$1=!1;function Ue(e,i,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te$1||Qe==null||Qe!==Xa(a)||(a=Qe,"selectionStart"in a&&Ne(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Se&&Ie(Se,a)||(Se=a,a=oe$1(Re,"onSelect"),0<a.length&&(i=new td("onSelect","select",null,i,s),e.push({event:i,listeners:a}),i.target=Qe)))}function Ve(e,i){var s={};return s[e.toLowerCase()]=i.toLowerCase(),s["Webkit"+e]="webkit"+i,s["Moz"+e]="moz"+i,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],s;for(s in i)if(i.hasOwnProperty(s)&&s in Ye)return Xe[e]=i[s];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,s){var a=e.type||"unknown-event";e.currentTarget=s,Ub(a,i,void 0,e),e.currentTarget=null}function se$1(e,i){i=(i&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],o=a.event;a=a.listeners;e:{var c=void 0;if(i)for(var d=a.length-1;0<=d;d--){var h=a[d],g=h.instance,_=h.currentTarget;if(h=h.listener,g!==c&&o.isPropagationStopped())break e;nf(o,h,_),c=g}else for(d=0;d<a.length;d++){if(h=a[d],g=h.instance,_=h.currentTarget,h=h.listener,g!==c&&o.isPropagationStopped())break e;nf(o,h,_),c=g}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D$1(e,i){var s=i[of];s===void 0&&(s=i[of]=new Set);var a=e+"__bubble";s.has(a)||(pf(i,e,2,!1),s.add(a))}function qf(e,i,s){var a=0;i&&(a|=4),pf(s,e,a,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,s,a){switch(jd(i)){case 1:var o=ed;break;case 4:o=gd;break;default:o=fd}s=o.bind(null,i,s,e),o=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(o=!0),a?o!==void 0?e.addEventListener(i,s,{capture:!0,passive:o}):e.addEventListener(i,s,!0):o!==void 0?e.addEventListener(i,s,{passive:o}):e.addEventListener(i,s,!1)}function hd(e,i,s,a,o){var c=a;if(!(i&1)&&!(i&2)&&a!==null)e:for(;;){if(a===null)return;var d=a.tag;if(d===3||d===4){var h=a.stateNode.containerInfo;if(h===o||h.nodeType===8&&h.parentNode===o)break;if(d===4)for(d=a.return;d!==null;){var g=d.tag;if((g===3||g===4)&&(g=d.stateNode.containerInfo,g===o||g.nodeType===8&&g.parentNode===o))return;d=d.return}for(;h!==null;){if(d=Wc(h),d===null)return;if(g=d.tag,g===5||g===6){a=c=d;continue e}h=h.parentNode}}a=a.return}Jb(function(){var _=c,b=xb(s),tt=[];e:{var _e=df.get(e);if(_e!==void 0){var rt=td,it=e;switch(e){case"keypress":if(od(s)===0)break e;case"keydown":case"keyup":rt=Rd;break;case"focusin":it="focus",rt=Fd;break;case"focusout":it="blur",rt=Fd;break;case"beforeblur":case"afterblur":rt=Fd;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=Vd;break;case $e:case af:case bf:rt=Hd;break;case cf:rt=Xd;break;case"scroll":rt=vd;break;case"wheel":rt=Zd;break;case"copy":case"cut":case"paste":rt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=Td}var et=(i&4)!==0,nt=!et&&e==="scroll",at=et?_e!==null?_e+"Capture":null:_e;et=[];for(var st=_,ot;st!==null;){ot=st;var pt=ot.stateNode;if(ot.tag===5&&pt!==null&&(ot=pt,at!==null&&(pt=Kb(st,at),pt!=null&&et.push(tf(st,pt,ot)))),nt)break;st=st.return}0<et.length&&(_e=new rt(_e,it,null,s,b),tt.push({event:_e,listeners:et}))}}if(!(i&7)){e:{if(_e=e==="mouseover"||e==="pointerover",rt=e==="mouseout"||e==="pointerout",_e&&s!==wb&&(it=s.relatedTarget||s.fromElement)&&(Wc(it)||it[uf]))break e;if((rt||_e)&&(_e=b.window===b?b:(_e=b.ownerDocument)?_e.defaultView||_e.parentWindow:window,rt?(it=s.relatedTarget||s.toElement,rt=_,it=it?Wc(it):null,it!==null&&(nt=Vb(it),it!==nt||it.tag!==5&&it.tag!==6)&&(it=null)):(rt=null,it=_),rt!==it)){if(et=Bd,pt="onMouseLeave",at="onMouseEnter",st="mouse",(e==="pointerout"||e==="pointerover")&&(et=Td,pt="onPointerLeave",at="onPointerEnter",st="pointer"),nt=rt==null?_e:ue(rt),ot=it==null?_e:ue(it),_e=new et(pt,st+"leave",rt,s,b),_e.target=nt,_e.relatedTarget=ot,pt=null,Wc(b)===_&&(et=new et(at,st+"enter",it,s,b),et.target=ot,et.relatedTarget=nt,pt=et),nt=pt,rt&&it)t:{for(et=rt,at=it,st=0,ot=et;ot;ot=vf(ot))st++;for(ot=0,pt=at;pt;pt=vf(pt))ot++;for(;0<st-ot;)et=vf(et),st--;for(;0<ot-st;)at=vf(at),ot--;for(;st--;){if(et===at||at!==null&&et===at.alternate)break t;et=vf(et),at=vf(at)}et=null}else et=null;rt!==null&&wf(tt,_e,rt,et,!1),it!==null&&nt!==null&&wf(tt,nt,it,et,!0)}}e:{if(_e=_?ue(_):window,rt=_e.nodeName&&_e.nodeName.toLowerCase(),rt==="select"||rt==="input"&&_e.type==="file")var dt=ve;else if(me(_e))if(we)dt=Fe;else{dt=De;var wt=Ce}else(rt=_e.nodeName)&&rt.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(dt=Ee);if(dt&&(dt=dt(e,_))){ne$1(tt,dt,s,b);break e}wt&&wt(e,_e,_),e==="focusout"&&(wt=_e._wrapperState)&&wt.controlled&&_e.type==="number"&&cb(_e,"number",_e.value)}switch(wt=_?ue(_):window,e){case"focusin":(me(wt)||wt.contentEditable==="true")&&(Qe=wt,Re=_,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue(tt,s,b);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(tt,s,b)}var lt;if(ae$1)e:{switch(e){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else ie?ge(e,s)&&(gt="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(gt="onCompositionStart");gt&&(de&&s.locale!=="ko"&&(ie||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&ie&&(lt=nd()):(kd=b,ld="value"in kd?kd.value:kd.textContent,ie=!0)),wt=oe$1(_,gt),0<wt.length&&(gt=new Ld(gt,e,null,s,b),tt.push({event:gt,listeners:wt}),lt?gt.data=lt:(lt=he(s),lt!==null&&(gt.data=lt)))),(lt=ce?je(e,s):ke(e,s))&&(_=oe$1(_,"onBeforeInput"),0<_.length&&(b=new Ld("onBeforeInput","beforeinput",null,s,b),tt.push({event:b,listeners:_}),b.data=lt))}se$1(tt,i)})}function tf(e,i,s){return{instance:e,listener:i,currentTarget:s}}function oe$1(e,i){for(var s=i+"Capture",a=[];e!==null;){var o=e,c=o.stateNode;o.tag===5&&c!==null&&(o=c,c=Kb(e,s),c!=null&&a.unshift(tf(e,c,o)),c=Kb(e,i),c!=null&&a.push(tf(e,c,o))),e=e.return}return a}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,s,a,o){for(var c=i._reactName,d=[];s!==null&&s!==a;){var h=s,g=h.alternate,_=h.stateNode;if(g!==null&&g===a)break;h.tag===5&&_!==null&&(h=_,o?(g=Kb(s,c),g!=null&&d.unshift(tf(s,g,h))):o||(g=Kb(s,c),g!=null&&d.push(tf(s,g,h)))),s=s.return}d.length!==0&&e.push({event:i,listeners:d})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,s){if(i=zf(i),zf(e)!==i&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var s=i,a=0;do{var o=s.nextSibling;if(e.removeChild(s),o&&o.nodeType===8)if(s=o.data,s==="/$"){if(a===0){e.removeChild(o),bd(i);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=o}while(s);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return e;i--}else s==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var s=e.parentNode;s;){if(i=s[uf]||s[Of]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return i}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E$1(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var s=e.type.contextTypes;if(!s)return Vf;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===i)return a.__reactInternalMemoizedMaskedChildContext;var o={},c;for(c in s)o[c]=i[c];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E$1(Wf),E$1(H)}function ag(e,i,s){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,s)}function bg(e,i,s){var a=e.stateNode;if(i=i.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var o in a)if(!(o in i))throw Error(p(108,Ra(e)||"Unknown",o));return A({},s,a)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,s){var a=e.stateNode;if(!a)throw Error(p(169));s?(e=bg(e,i,Xf),a.__reactInternalMemoizedMergedChildContext=e,E$1(Wf),E$1(H),G(H,e)):E$1(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var s=eg;for(C=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}eg=null,fg=!1}catch(o){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),o}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var a=rg;e=sg;var o=32-oc(a)-1;a&=~(1<<o),s+=1;var c=32-oc(i)+o;if(30<c){var d=o-o%5;c=(a&(1<<d)-1).toString(32),a>>=d,o-=d,rg=1<<32-oc(i)+o|s<<o|a,sg=c+e}else rg=1<<c|s<<o|a,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=e,i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)}function Cg(e,i){switch(e.tag){case 5:var s=e.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=i,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var s=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf(s.nextSibling);var a=xg;i&&Cg(e,i)?Ag(a,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(i===0){yg=Lf(e.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var a=s.stateNode}if(!a)throw Error(p(147,e));var o=a,c=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===c?i.ref:(i=function(d){var h=o.refs;d===null?delete h[c]:h[c]=d},i._stringRef=c,i)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(at,st){if(e){var ot=at.deletions;ot===null?(at.deletions=[st],at.flags|=16):ot.push(st)}}function s(at,st){if(!e)return null;for(;st!==null;)i(at,st),st=st.sibling;return null}function a(at,st){for(at=new Map;st!==null;)st.key!==null?at.set(st.key,st):at.set(st.index,st),st=st.sibling;return at}function o(at,st){return at=Pg(at,st),at.index=0,at.sibling=null,at}function c(at,st,ot){return at.index=ot,e?(ot=at.alternate,ot!==null?(ot=ot.index,ot<st?(at.flags|=2,st):ot):(at.flags|=2,st)):(at.flags|=1048576,st)}function d(at){return e&&at.alternate===null&&(at.flags|=2),at}function h(at,st,ot,pt){return st===null||st.tag!==6?(st=Qg(ot,at.mode,pt),st.return=at,st):(st=o(st,ot),st.return=at,st)}function g(at,st,ot,pt){var dt=ot.type;return dt===ya?b(at,st,ot.props.children,pt,ot.key):st!==null&&(st.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===st.type)?(pt=o(st,ot.props),pt.ref=Lg(at,st,ot),pt.return=at,pt):(pt=Rg(ot.type,ot.key,ot.props,null,at.mode,pt),pt.ref=Lg(at,st,ot),pt.return=at,pt)}function _(at,st,ot,pt){return st===null||st.tag!==4||st.stateNode.containerInfo!==ot.containerInfo||st.stateNode.implementation!==ot.implementation?(st=Sg(ot,at.mode,pt),st.return=at,st):(st=o(st,ot.children||[]),st.return=at,st)}function b(at,st,ot,pt,dt){return st===null||st.tag!==7?(st=Tg(ot,at.mode,pt,dt),st.return=at,st):(st=o(st,ot),st.return=at,st)}function tt(at,st,ot){if(typeof st=="string"&&st!==""||typeof st=="number")return st=Qg(""+st,at.mode,ot),st.return=at,st;if(typeof st=="object"&&st!==null){switch(st.$$typeof){case va:return ot=Rg(st.type,st.key,st.props,null,at.mode,ot),ot.ref=Lg(at,null,st),ot.return=at,ot;case wa:return st=Sg(st,at.mode,ot),st.return=at,st;case Ha:var pt=st._init;return tt(at,pt(st._payload),ot)}if(eb(st)||Ka(st))return st=Tg(st,at.mode,ot,null),st.return=at,st;Mg(at,st)}return null}function _e(at,st,ot,pt){var dt=st!==null?st.key:null;if(typeof ot=="string"&&ot!==""||typeof ot=="number")return dt!==null?null:h(at,st,""+ot,pt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case va:return ot.key===dt?g(at,st,ot,pt):null;case wa:return ot.key===dt?_(at,st,ot,pt):null;case Ha:return dt=ot._init,_e(at,st,dt(ot._payload),pt)}if(eb(ot)||Ka(ot))return dt!==null?null:b(at,st,ot,pt,null);Mg(at,ot)}return null}function rt(at,st,ot,pt,dt){if(typeof pt=="string"&&pt!==""||typeof pt=="number")return at=at.get(ot)||null,h(st,at,""+pt,dt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case va:return at=at.get(pt.key===null?ot:pt.key)||null,g(st,at,pt,dt);case wa:return at=at.get(pt.key===null?ot:pt.key)||null,_(st,at,pt,dt);case Ha:var wt=pt._init;return rt(at,st,ot,wt(pt._payload),dt)}if(eb(pt)||Ka(pt))return at=at.get(ot)||null,b(st,at,pt,dt,null);Mg(st,pt)}return null}function it(at,st,ot,pt){for(var dt=null,wt=null,lt=st,gt=st=0,vt=null;lt!==null&&gt<ot.length;gt++){lt.index>gt?(vt=lt,lt=null):vt=lt.sibling;var At=_e(at,lt,ot[gt],pt);if(At===null){lt===null&&(lt=vt);break}e&&lt&&At.alternate===null&&i(at,lt),st=c(At,st,gt),wt===null?dt=At:wt.sibling=At,wt=At,lt=vt}if(gt===ot.length)return s(at,lt),I&&tg(at,gt),dt;if(lt===null){for(;gt<ot.length;gt++)lt=tt(at,ot[gt],pt),lt!==null&&(st=c(lt,st,gt),wt===null?dt=lt:wt.sibling=lt,wt=lt);return I&&tg(at,gt),dt}for(lt=a(at,lt);gt<ot.length;gt++)vt=rt(lt,at,gt,ot[gt],pt),vt!==null&&(e&&vt.alternate!==null&&lt.delete(vt.key===null?gt:vt.key),st=c(vt,st,gt),wt===null?dt=vt:wt.sibling=vt,wt=vt);return e&&lt.forEach(function(yt){return i(at,yt)}),I&&tg(at,gt),dt}function et(at,st,ot,pt){var dt=Ka(ot);if(typeof dt!="function")throw Error(p(150));if(ot=dt.call(ot),ot==null)throw Error(p(151));for(var wt=dt=null,lt=st,gt=st=0,vt=null,At=ot.next();lt!==null&&!At.done;gt++,At=ot.next()){lt.index>gt?(vt=lt,lt=null):vt=lt.sibling;var yt=_e(at,lt,At.value,pt);if(yt===null){lt===null&&(lt=vt);break}e&&lt&&yt.alternate===null&&i(at,lt),st=c(yt,st,gt),wt===null?dt=yt:wt.sibling=yt,wt=yt,lt=vt}if(At.done)return s(at,lt),I&&tg(at,gt),dt;if(lt===null){for(;!At.done;gt++,At=ot.next())At=tt(at,At.value,pt),At!==null&&(st=c(At,st,gt),wt===null?dt=At:wt.sibling=At,wt=At);return I&&tg(at,gt),dt}for(lt=a(at,lt);!At.done;gt++,At=ot.next())At=rt(lt,at,gt,At.value,pt),At!==null&&(e&&At.alternate!==null&&lt.delete(At.key===null?gt:At.key),st=c(At,st,gt),wt===null?dt=At:wt.sibling=At,wt=At);return e&&lt.forEach(function(bt){return i(at,bt)}),I&&tg(at,gt),dt}function nt(at,st,ot,pt){if(typeof ot=="object"&&ot!==null&&ot.type===ya&&ot.key===null&&(ot=ot.props.children),typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case va:e:{for(var dt=ot.key,wt=st;wt!==null;){if(wt.key===dt){if(dt=ot.type,dt===ya){if(wt.tag===7){s(at,wt.sibling),st=o(wt,ot.props.children),st.return=at,at=st;break e}}else if(wt.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===Ha&&Ng(dt)===wt.type){s(at,wt.sibling),st=o(wt,ot.props),st.ref=Lg(at,wt,ot),st.return=at,at=st;break e}s(at,wt);break}else i(at,wt);wt=wt.sibling}ot.type===ya?(st=Tg(ot.props.children,at.mode,pt,ot.key),st.return=at,at=st):(pt=Rg(ot.type,ot.key,ot.props,null,at.mode,pt),pt.ref=Lg(at,st,ot),pt.return=at,at=pt)}return d(at);case wa:e:{for(wt=ot.key;st!==null;){if(st.key===wt)if(st.tag===4&&st.stateNode.containerInfo===ot.containerInfo&&st.stateNode.implementation===ot.implementation){s(at,st.sibling),st=o(st,ot.children||[]),st.return=at,at=st;break e}else{s(at,st);break}else i(at,st);st=st.sibling}st=Sg(ot,at.mode,pt),st.return=at,at=st}return d(at);case Ha:return wt=ot._init,nt(at,st,wt(ot._payload),pt)}if(eb(ot))return it(at,st,ot,pt);if(Ka(ot))return et(at,st,ot,pt);Mg(at,ot)}return typeof ot=="string"&&ot!==""||typeof ot=="number"?(ot=""+ot,st!==null&&st.tag===6?(s(at,st.sibling),st=o(st,ot),st.return=at,at=st):(s(at,st),st=Qg(ot,at.mode,pt),st.return=at,at=st),d(at)):s(at,st)}return nt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E$1(Wg),e._currentValue=i}function bh(e,i,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,a!==null&&(a.childLanes|=i)):a!==null&&(a.childLanes&i)!==i&&(a.childLanes|=i),e===s)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,s,a){var o=i.interleaved;return o===null?(s.next=s,gh(i)):(s.next=o.next,o.next=s),i.interleaved=s,ih(e,a)}function ih(e,i){e.lanes|=i;var s=e.alternate;for(s!==null&&(s.lanes|=i),s=e,e=e.return;e!==null;)e.childLanes|=i,s=e.alternate,s!==null&&(s.childLanes|=i),s=e,e=e.return;return s.tag===3?s.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,K&2){var o=a.pending;return o===null?i.next=i:(i.next=o.next,o.next=i),a.pending=i,ih(e,s)}return o=a.interleaved,o===null?(i.next=i,gh(a)):(i.next=o.next,o.next=i),a.interleaved=i,ih(e,s)}function oh(e,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var a=i.lanes;a&=e.pendingLanes,s|=a,i.lanes=s,Cc(e,s)}}function ph(e,i){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var o=null,c=null;if(s=s.firstBaseUpdate,s!==null){do{var d={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};c===null?o=c=d:c=c.next=d,s=s.next}while(s!==null);c===null?o=c=i:c=c.next=i}else o=c=i;s={baseState:a.baseState,firstBaseUpdate:o,lastBaseUpdate:c,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=i:e.next=i,s.lastBaseUpdate=i}function qh(e,i,s,a){var o=e.updateQueue;jh=!1;var c=o.firstBaseUpdate,d=o.lastBaseUpdate,h=o.shared.pending;if(h!==null){o.shared.pending=null;var g=h,_=g.next;g.next=null,d===null?c=_:d.next=_,d=g;var b=e.alternate;b!==null&&(b=b.updateQueue,h=b.lastBaseUpdate,h!==d&&(h===null?b.firstBaseUpdate=_:h.next=_,b.lastBaseUpdate=g))}if(c!==null){var tt=o.baseState;d=0,b=_=g=null,h=c;do{var _e=h.lane,rt=h.eventTime;if((a&_e)===_e){b!==null&&(b=b.next={eventTime:rt,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var it=e,et=h;switch(_e=i,rt=s,et.tag){case 1:if(it=et.payload,typeof it=="function"){tt=it.call(rt,tt,_e);break e}tt=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=et.payload,_e=typeof it=="function"?it.call(rt,tt,_e):it,_e==null)break e;tt=A({},tt,_e);break e;case 2:jh=!0}}h.callback!==null&&h.lane!==0&&(e.flags|=64,_e=o.effects,_e===null?o.effects=[h]:_e.push(h))}else rt={eventTime:rt,lane:_e,tag:h.tag,payload:h.payload,callback:h.callback,next:null},b===null?(_=b=rt,g=tt):b=b.next=rt,d|=_e;if(h=h.next,h===null){if(h=o.shared.pending,h===null)break;_e=h,h=_e.next,_e.next=null,o.lastBaseUpdate=_e,o.shared.pending=null}}while(!0);if(b===null&&(g=tt),o.baseState=g,o.firstBaseUpdate=_,o.lastBaseUpdate=b,i=o.shared.interleaved,i!==null){o=i;do d|=o.lane,o=o.next;while(o!==i)}else c===null&&(o.shared.lanes=0);rh|=d,e.lanes=d,e.memoizedState=tt}}function sh(e,i,s){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var a=e[i],o=a.callback;if(o!==null){if(a.callback=null,a=s,typeof o!="function")throw Error(p(191,o));o.call(a)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,i){switch(G(wh,i),G(vh,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E$1(uh),G(uh,i)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),s=lb(i,e.type);i!==s&&(G(vh,e),G(uh,s))}function Bh(e){vh.current===e&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p(321))}function Mh(e,i){if(i===null)return!1;for(var s=0;s<i.length&&s<e.length;s++)if(!He(e[s],i[s]))return!1;return!0}function Nh(e,i,s,a,o,c){if(Hh=c,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=s(a,o),Jh){c=0;do{if(Jh=!1,Kh=0,25<=c)throw Error(p(301));c+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=s(a,o)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=N,o=a.baseQueue,c=s.pending;if(c!==null){if(o!==null){var d=o.next;o.next=c.next,c.next=d}a.baseQueue=o=c,s.pending=null}if(o!==null){c=o.next,a=a.baseState;var h=d=null,g=null,_=c;do{var b=_.lane;if((Hh&b)===b)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),a=_.hasEagerState?_.eagerState:e(a,_.action);else{var tt={lane:b,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(h=g=tt,d=a):g=g.next=tt,M.lanes|=b,rh|=b}_=_.next}while(_!==null&&_!==c);g===null?d=a:g.next=h,He(a,i.memoizedState)||(dh=!0),i.memoizedState=a,i.baseState=d,i.baseQueue=g,s.lastRenderedState=a}if(e=s.interleaved,e!==null){o=e;do c=o.lane,M.lanes|=c,rh|=c,o=o.next;while(o!==e)}else o===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function Xh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=s.dispatch,o=s.pending,c=i.memoizedState;if(o!==null){s.pending=null;var d=o=o.next;do c=e(c,d.action),d=d.next;while(d!==o);He(c,i.memoizedState)||(dh=!0),i.memoizedState=c,i.baseQueue===null&&(i.baseState=c),s.lastRenderedState=c}return[c,a]}function Yh(){}function Zh(e,i){var s=M,a=Uh(),o=i(),c=!He(a.memoizedState,o);if(c&&(a.memoizedState=o,dh=!0),a=a.queue,$h(ai.bind(null,s,a,e),[e]),a.getSnapshot!==i||c||O!==null&&O.memoizedState.tag&1){if(s.flags|=2048,bi(9,ci.bind(null,s,a,o,i),void 0,null),Q===null)throw Error(p(349));Hh&30||di(s,i,o)}return o}function di(e,i,s){e.flags|=16384,e={getSnapshot:i,value:s},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[e]):(s=i.stores,s===null?i.stores=[e]:s.push(e))}function ci(e,i,s,a){i.value=s,i.getSnapshot=a,ei(i)&&fi(e)}function ai(e,i,s){return s(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var s=i();return!He(e,s)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M,e),[i.memoizedState,e]}function bi(e,i,s,a){return e={tag:e,create:i,destroy:s,deps:a,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=e.next=e):(s=i.lastEffect,s===null?i.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,s,a){var o=Th();M.flags|=e,o.memoizedState=bi(1|i,s,void 0,a===void 0?null:a)}function li(e,i,s,a){var o=Uh();a=a===void 0?null:a;var c=void 0;if(N!==null){var d=N.memoizedState;if(c=d.destroy,a!==null&&Mh(a,d.deps)){o.memoizedState=bi(i,s,c,a);return}}M.flags|=e,o.memoizedState=bi(1|i,s,c,a)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li(2048,8,e,i)}function ni(e,i){return li(4,2,e,i)}function oi(e,i){return li(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,s){return s=s!=null?s.concat([e]):null,li(4,4,pi.bind(null,i,e),s)}function ri(){}function si(e,i){var s=Uh();i=i===void 0?null:i;var a=s.memoizedState;return a!==null&&i!==null&&Mh(i,a[1])?a[0]:(s.memoizedState=[e,i],e)}function ti(e,i){var s=Uh();i=i===void 0?null:i;var a=s.memoizedState;return a!==null&&i!==null&&Mh(i,a[1])?a[0]:(e=e(),s.memoizedState=[e,i],e)}function ui(e,i,s){return Hh&21?(He(s,i)||(s=yc(),M.lanes|=s,rh|=s,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=s)}function vi(e,i){var s=C;C=s!==0&&4>s?s:4,e(!0);var a=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=s,Gh.transition=a}}function wi(){return Uh().memoizedState}function xi(e,i,s){var a=yi(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,s);else if(s=hh(e,i,s,a),s!==null){var o=R();gi(s,e,a,o),Bi(s,i,a)}}function ii(e,i,s){var a=yi(e),o={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,o);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=i.lastRenderedReducer,c!==null))try{var d=i.lastRenderedState,h=c(d,s);if(o.hasEagerState=!0,o.eagerState=h,He(h,d)){var g=i.interleaved;g===null?(o.next=o,gh(i)):(o.next=g.next,g.next=o),i.interleaved=o;return}}catch{}finally{}s=hh(e,i,o,a),s!==null&&(o=R(),gi(s,e,a,o),Bi(s,i,a))}}function zi(e){var i=e.alternate;return e===M||i!==null&&i===M}function Ai(e,i){Jh=Ih=!0;var s=e.pending;s===null?i.next=i:(i.next=s.next,s.next=i),e.pending=i}function Bi(e,i,s){if(s&4194240){var a=i.lanes;a&=e.pendingLanes,s|=a,i.lanes=s,Cc(e,s)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,s){return s=s!=null?s.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),s)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var s=Th();return i=i===void 0?null:i,e=e(),s.memoizedState=[e,i],e},useReducer:function(e,i,s){var a=Th();return i=s!==void 0?s(i):i,a.memoizedState=a.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},a.queue=e,e=e.dispatch=xi.bind(null,M,e),[a.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,s){var a=M,o=Th();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=i(),Q===null)throw Error(p(349));Hh&30||di(a,i,s)}o.memoizedState=s;var c={value:s,getSnapshot:i};return o.queue=c,mi(ai.bind(null,a,c,e),[e]),a.flags|=2048,bi(9,ci.bind(null,a,c,s,i),void 0,null),s},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var s=sg,a=rg;s=(a&~(1<<32-oc(a)-1)).toString(32)+s,i=":"+i+"R"+s,s=Kh++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=Lh++,i=":"+i+"r"+s.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var s in e)i[s]===void 0&&(i[s]=e[s]);return i}return i}function Di(e,i,s,a){i=e.memoizedState,s=s(a,i),s=s==null?i:A({},i,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,s){e=e._reactInternals;var a=R(),o=yi(e),c=mh(a,o);c.payload=i,s!=null&&(c.callback=s),i=nh(e,c,o),i!==null&&(gi(i,e,o,a),oh(i,e,o))},enqueueReplaceState:function(e,i,s){e=e._reactInternals;var a=R(),o=yi(e),c=mh(a,o);c.tag=1,c.payload=i,s!=null&&(c.callback=s),i=nh(e,c,o),i!==null&&(gi(i,e,o,a),oh(i,e,o))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var s=R(),a=yi(e),o=mh(s,a);o.tag=2,i!=null&&(o.callback=i),i=nh(e,o,a),i!==null&&(gi(i,e,a,s),oh(i,e,a))}};function Fi(e,i,s,a,o,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,c,d):i.prototype&&i.prototype.isPureReactComponent?!Ie(s,a)||!Ie(o,c):!0}function Gi(e,i,s){var a=!1,o=Vf,c=i.contextType;return typeof c=="object"&&c!==null?c=eh(c):(o=Zf(i)?Xf:H.current,a=i.contextTypes,c=(a=a!=null)?Yf(e,o):Vf),i=new i(s,c),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=c),i}function Hi(e,i,s,a){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,a),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,a),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,s,a){var o=e.stateNode;o.props=s,o.state=e.memoizedState,o.refs={},kh(e);var c=i.contextType;typeof c=="object"&&c!==null?o.context=eh(c):(c=Zf(i)?Xf:H.current,o.context=Yf(e,c)),o.state=e.memoizedState,c=i.getDerivedStateFromProps,typeof c=="function"&&(Di(e,i,c,s),o.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(i=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),i!==o.state&&Ei.enqueueReplaceState(o,o.state,null),qh(e,s,o,a),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var s="",a=i;do s+=Pa(a),a=a.return;while(a);var o=s}catch(c){o=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:i,stack:o,digest:null}}function Ki(e,i,s){return{value:e,source:null,stack:s??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,s){s=mh(-1,s),s.tag=3,s.payload={element:null};var a=i.value;return s.callback=function(){Oi||(Oi=!0,Pi=a),Li(e,i)},s}function Qi(e,i,s){s=mh(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var o=i.value;s.payload=function(){return a(o)},s.callback=function(){Li(e,i)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(s.callback=function(){Li(e,i),typeof a!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var d=i.stack;this.componentDidCatch(i.value,{componentStack:d!==null?d:""})}),s}function Si(e,i,s){var a=e.pingCache;if(a===null){a=e.pingCache=new Mi;var o=new Set;a.set(i,o)}else o=a.get(i),o===void 0&&(o=new Set,a.set(i,o));o.has(s)||(o.add(s),e=Ti.bind(null,e,i,s),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,s,a,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===i?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=mh(-1,1),i.tag=2,nh(s,i,1))),s.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,s,a){i.child=e===null?Vg(i,null,s,a):Ug(i,e.child,s,a)}function Yi(e,i,s,a,o){s=s.render;var c=i.ref;return ch(i,o),a=Nh(e,i,s,a,c,o),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,a,o),i.child)}function $i(e,i,s,a,o){if(e===null){var c=s.type;return typeof c=="function"&&!aj(c)&&c.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=c,bj(e,i,c,a,o)):(e=Rg(s.type,null,a,i,i.mode,o),e.ref=i.ref,e.return=i,i.child=e)}if(c=e.child,!(e.lanes&o)){var d=c.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(d,a)&&e.ref===i.ref)return Zi(e,i,o)}return i.flags|=1,e=Pg(c,a),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,s,a,o){if(e!==null){var c=e.memoizedProps;if(Ie(c,a)&&e.ref===i.ref)if(dh=!1,i.pendingProps=a=c,(e.lanes&o)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,o)}return cj(e,i,s,a,o)}function dj(e,i,s){var a=i.pendingProps,o=a.children,c=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=s;else{if(!(s&1073741824))return e=c!==null?c.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=c!==null?c.baseLanes:s,G(ej,fj),fj|=a}else c!==null?(a=c.baseLanes|s,i.memoizedState=null):a=s,G(ej,fj),fj|=a;return Xi(e,i,o,s),i.child}function gj(e,i){var s=i.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,s,a,o){var c=Zf(s)?Xf:H.current;return c=Yf(i,c),ch(i,o),s=Nh(e,i,s,a,c,o),a=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~o,Zi(e,i,o)):(I&&a&&vg(i),i.flags|=1,Xi(e,i,s,o),i.child)}function hj(e,i,s,a,o){if(Zf(s)){var c=!0;cg(i)}else c=!1;if(ch(i,o),i.stateNode===null)ij(e,i),Gi(i,s,a),Ii(i,s,a,o),a=!0;else if(e===null){var d=i.stateNode,h=i.memoizedProps;d.props=h;var g=d.context,_=s.contextType;typeof _=="object"&&_!==null?_=eh(_):(_=Zf(s)?Xf:H.current,_=Yf(i,_));var b=s.getDerivedStateFromProps,tt=typeof b=="function"||typeof d.getSnapshotBeforeUpdate=="function";tt||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==a||g!==_)&&Hi(i,d,a,_),jh=!1;var _e=i.memoizedState;d.state=_e,qh(i,a,d,o),g=i.memoizedState,h!==a||_e!==g||Wf.current||jh?(typeof b=="function"&&(Di(i,s,b,a),g=i.memoizedState),(h=jh||Fi(i,s,h,a,_e,g,_))?(tt||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(i.flags|=4194308)):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=a,i.memoizedState=g),d.props=a,d.state=g,d.context=_,a=h):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),a=!1)}else{d=i.stateNode,lh(e,i),h=i.memoizedProps,_=i.type===i.elementType?h:Ci(i.type,h),d.props=_,tt=i.pendingProps,_e=d.context,g=s.contextType,typeof g=="object"&&g!==null?g=eh(g):(g=Zf(s)?Xf:H.current,g=Yf(i,g));var rt=s.getDerivedStateFromProps;(b=typeof rt=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(h!==tt||_e!==g)&&Hi(i,d,a,g),jh=!1,_e=i.memoizedState,d.state=_e,qh(i,a,d,o);var it=i.memoizedState;h!==tt||_e!==it||Wf.current||jh?(typeof rt=="function"&&(Di(i,s,rt,a),it=i.memoizedState),(_=jh||Fi(i,s,_,a,_e,it,g)||!1)?(b||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(a,it,g),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(a,it,g)),typeof d.componentDidUpdate=="function"&&(i.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof d.componentDidUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(i.flags|=1024),i.memoizedProps=a,i.memoizedState=it),d.props=a,d.state=it,d.context=g,a=_):(typeof d.componentDidUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&_e===e.memoizedState||(i.flags|=1024),a=!1)}return jj(e,i,s,a,c,o)}function jj(e,i,s,a,o,c){gj(e,i);var d=(i.flags&128)!==0;if(!a&&!d)return o&&dg(i,s,!1),Zi(e,i,c);a=i.stateNode,Wi.current=i;var h=d&&typeof s.getDerivedStateFromError!="function"?null:a.render();return i.flags|=1,e!==null&&d?(i.child=Ug(i,e.child,null,c),i.child=Ug(i,null,h,c)):Xi(e,i,h,c),i.memoizedState=a.state,o&&dg(i,s,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,s,a,o){return Ig(),Jg(o),i.flags|=256,Xi(e,i,s,a),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,s){var a=i.pendingProps,o=L$1.current,c=!1,d=(i.flags&128)!==0,h;if((h=d)||(h=e!==null&&e.memoizedState===null?!1:(o&2)!==0),h?(c=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),G(L$1,o&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(d=a.children,e=a.fallback,c?(a=i.mode,c=i.child,d={mode:"hidden",children:d},!(a&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=pj(d,a,0,null),e=Tg(e,a,s,null),c.return=i,e.return=i,c.sibling=e,i.child=c,i.child.memoizedState=nj(s),i.memoizedState=mj,e):qj(i,d));if(o=e.memoizedState,o!==null&&(h=o.dehydrated,h!==null))return rj(e,i,d,a,h,o,s);if(c){c=a.fallback,d=i.mode,o=e.child,h=o.sibling;var g={mode:"hidden",children:a.children};return!(d&1)&&i.child!==o?(a=i.child,a.childLanes=0,a.pendingProps=g,i.deletions=null):(a=Pg(o,g),a.subtreeFlags=o.subtreeFlags&14680064),h!==null?c=Pg(h,c):(c=Tg(c,d,s,null),c.flags|=2),c.return=i,a.return=i,a.sibling=c,i.child=a,a=c,c=i.child,d=e.child.memoizedState,d=d===null?nj(s):{baseLanes:d.baseLanes|s,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=e.childLanes&~s,i.memoizedState=mj,a}return c=e.child,e=c.sibling,a=Pg(c,{mode:"visible",children:a.children}),!(i.mode&1)&&(a.lanes=s),a.return=i,a.sibling=null,e!==null&&(s=i.deletions,s===null?(i.deletions=[e],i.flags|=16):s.push(e)),i.child=a,i.memoizedState=null,a}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,s,a){return a!==null&&Jg(a),Ug(i,e.child,null,s),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,s,a,o,c,d){if(s)return i.flags&256?(i.flags&=-257,a=Ki(Error(p(422))),sj(e,i,d,a)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(c=a.fallback,o=i.mode,a=pj({mode:"visible",children:a.children},o,0,null),c=Tg(c,o,d,null),c.flags|=2,a.return=i,c.return=i,a.sibling=c,i.child=a,i.mode&1&&Ug(i,e.child,null,d),i.child.memoizedState=nj(d),i.memoizedState=mj,c);if(!(i.mode&1))return sj(e,i,d,null);if(o.data==="$!"){if(a=o.nextSibling&&o.nextSibling.dataset,a)var h=a.dgst;return a=h,c=Error(p(419)),a=Ki(c,a,void 0),sj(e,i,d,a)}if(h=(d&e.childLanes)!==0,dh||h){if(a=Q,a!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(a.suspendedLanes|d)?0:o,o!==0&&o!==c.retryLane&&(c.retryLane=o,ih(e,o),gi(a,e,o,-1))}return tj(),a=Ki(Error(p(421))),sj(e,i,d,a)}return o.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),o._reactRetry=i,null):(e=c.treeContext,yg=Lf(o.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,a.children),i.flags|=4096,i)}function vj(e,i,s){e.lanes|=i;var a=e.alternate;a!==null&&(a.lanes|=i),bh(e.return,i,s)}function wj(e,i,s,a,o){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:o}:(c.isBackwards=i,c.rendering=null,c.renderingStartTime=0,c.last=a,c.tail=s,c.tailMode=o)}function xj(e,i,s){var a=i.pendingProps,o=a.revealOrder,c=a.tail;if(Xi(e,i,a.children,s),a=L$1.current,a&2)a=a&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,s,i);else if(e.tag===19)vj(e,s,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(G(L$1,a),!(i.mode&1))i.memoizedState=null;else switch(o){case"forwards":for(s=i.child,o=null;s!==null;)e=s.alternate,e!==null&&Ch(e)===null&&(o=s),s=s.sibling;s=o,s===null?(o=i.child,i.child=null):(o=s.sibling,s.sibling=null),wj(i,!1,o,s,c);break;case"backwards":for(s=null,o=i.child,i.child=null;o!==null;){if(e=o.alternate,e!==null&&Ch(e)===null){i.child=o;break}e=o.sibling,o.sibling=s,s=o,o=e}wj(i,!0,s,null,c);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,s){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(s&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,s=Pg(e,e.pendingProps),i.child=s,s.return=i;e.sibling!==null;)e=e.sibling,s=s.sibling=Pg(e,e.pendingProps),s.return=i;s.sibling=null}return i.child}function yj(e,i,s){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var a=i.type._context,o=i.memoizedProps.value;G(Wg,a._currentValue),a._currentValue=o;break;case 13:if(a=i.memoizedState,a!==null)return a.dehydrated!==null?(G(L$1,L$1.current&1),i.flags|=128,null):s&i.child.childLanes?oj(e,i,s):(G(L$1,L$1.current&1),e=Zi(e,i,s),e!==null?e.sibling:null);G(L$1,L$1.current&1);break;case 19:if(a=(s&i.childLanes)!==0,e.flags&128){if(a)return xj(e,i,s);i.flags|=128}if(o=i.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),G(L$1,L$1.current),a)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,s)}return Zi(e,i,s)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Aj=function(){};Bj=function(e,i,s,a){var o=e.memoizedProps;if(o!==a){e=i.stateNode,xh(uh.current);var c=null;switch(s){case"input":o=Ya(e,o),a=Ya(e,a),c=[];break;case"select":o=A({},o,{value:void 0}),a=A({},a,{value:void 0}),c=[];break;case"textarea":o=gb(e,o),a=gb(e,a),c=[];break;default:typeof o.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Bf)}ub(s,a);var d;s=null;for(_ in o)if(!a.hasOwnProperty(_)&&o.hasOwnProperty(_)&&o[_]!=null)if(_==="style"){var h=o[_];for(d in h)h.hasOwnProperty(d)&&(s||(s={}),s[d]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ea.hasOwnProperty(_)?c||(c=[]):(c=c||[]).push(_,null));for(_ in a){var g=a[_];if(h=o!=null?o[_]:void 0,a.hasOwnProperty(_)&&g!==h&&(g!=null||h!=null))if(_==="style")if(h){for(d in h)!h.hasOwnProperty(d)||g&&g.hasOwnProperty(d)||(s||(s={}),s[d]="");for(d in g)g.hasOwnProperty(d)&&h[d]!==g[d]&&(s||(s={}),s[d]=g[d])}else s||(c||(c=[]),c.push(_,s)),s=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,h=h?h.__html:void 0,g!=null&&h!==g&&(c=c||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(c=c||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&D$1("scroll",e),c||h===g||(c=[])):(c=c||[]).push(_,g))}s&&(c=c||[]).push("style",s);var _=c;(i.updateQueue=_)&&(i.flags|=4)}};Cj=function(e,i,s,a){s!==a&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(i)for(var o=e.child;o!==null;)s|=o.lanes|o.childLanes,a|=o.subtreeFlags&14680064,a|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)s|=o.lanes|o.childLanes,a|=o.subtreeFlags,a|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=a,e.childLanes=s,i}function Ej(e,i,s){var a=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return a=i.stateNode,zh(),E$1(Wf),E$1(H),Eh(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var o=xh(wh.current);if(s=i.type,e!==null&&i.stateNode!=null)Bj(e,i,s,a,o),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!a){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=xh(uh.current),Gg(i)){a=i.stateNode,s=i.type;var c=i.memoizedProps;switch(a[Of]=i,a[Pf]=c,e=(i.mode&1)!==0,s){case"dialog":D$1("cancel",a),D$1("close",a);break;case"iframe":case"object":case"embed":D$1("load",a);break;case"video":case"audio":for(o=0;o<lf.length;o++)D$1(lf[o],a);break;case"source":D$1("error",a);break;case"img":case"image":case"link":D$1("error",a),D$1("load",a);break;case"details":D$1("toggle",a);break;case"input":Za(a,c),D$1("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!c.multiple},D$1("invalid",a);break;case"textarea":hb(a,c),D$1("invalid",a)}ub(s,c),o=null;for(var d in c)if(c.hasOwnProperty(d)){var h=c[d];d==="children"?typeof h=="string"?a.textContent!==h&&(c.suppressHydrationWarning!==!0&&Af(a.textContent,h,e),o=["children",h]):typeof h=="number"&&a.textContent!==""+h&&(c.suppressHydrationWarning!==!0&&Af(a.textContent,h,e),o=["children",""+h]):ea.hasOwnProperty(d)&&h!=null&&d==="onScroll"&&D$1("scroll",a)}switch(s){case"input":Va(a),db(a,c,!0);break;case"textarea":Va(a),jb(a);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(a.onclick=Bf)}a=o,i.updateQueue=a,a!==null&&(i.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=d.createElement(s,{is:a.is}):(e=d.createElement(s),s==="select"&&(d=e,a.multiple?d.multiple=!0:a.size&&(d.size=a.size))):e=d.createElementNS(e,s),e[Of]=i,e[Pf]=a,zj(e,i,!1,!1),i.stateNode=e;e:{switch(d=vb(s,a),s){case"dialog":D$1("cancel",e),D$1("close",e),o=a;break;case"iframe":case"object":case"embed":D$1("load",e),o=a;break;case"video":case"audio":for(o=0;o<lf.length;o++)D$1(lf[o],e);o=a;break;case"source":D$1("error",e),o=a;break;case"img":case"image":case"link":D$1("error",e),D$1("load",e),o=a;break;case"details":D$1("toggle",e),o=a;break;case"input":Za(e,a),o=Ya(e,a),D$1("invalid",e);break;case"option":o=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},o=A({},a,{value:void 0}),D$1("invalid",e);break;case"textarea":hb(e,a),o=gb(e,a),D$1("invalid",e);break;default:o=a}ub(s,o),h=o;for(c in h)if(h.hasOwnProperty(c)){var g=h[c];c==="style"?sb(e,g):c==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&nb(e,g)):c==="children"?typeof g=="string"?(s!=="textarea"||g!=="")&&ob(e,g):typeof g=="number"&&ob(e,""+g):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?g!=null&&c==="onScroll"&&D$1("scroll",e):g!=null&&ta(e,c,g,d))}switch(s){case"input":Va(e),db(e,a,!1);break;case"textarea":Va(e),jb(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Sa(a.value));break;case"select":e.multiple=!!a.multiple,c=a.value,c!=null?fb(e,!!a.multiple,c,!1):a.defaultValue!=null&&fb(e,!!a.multiple,a.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,a);else{if(typeof a!="string"&&i.stateNode===null)throw Error(p(166));if(s=xh(wh.current),xh(uh.current),Gg(i)){if(a=i.stateNode,s=i.memoizedProps,a[Of]=i,(c=a.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(a.nodeValue,s,(e.mode&1)!==0)}c&&(i.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[Of]=i,i.stateNode=a}return S(i),null;case 13:if(E$1(L$1),a=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,c=!1;else if(c=Gg(i),a!==null&&a.dehydrated!==null){if(e===null){if(!c)throw Error(p(318));if(c=i.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(p(317));c[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),c=!1}else zg!==null&&(Fj(zg),zg=null),c=!0;if(!c)return i.flags&65536?i:null}return i.flags&128?(i.lanes=s,i):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(i.child.flags|=8192,i.mode&1&&(e===null||L$1.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E$1(L$1),c=i.memoizedState,c===null)return S(i),null;if(a=(i.flags&128)!==0,d=c.rendering,d===null)if(a)Dj(c,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(d=Ch(e),d!==null){for(i.flags|=128,Dj(c,!1),a=d.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),i.subtreeFlags=0,a=s,s=i.child;s!==null;)c=s,e=a,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,e=d.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(L$1,L$1.current&1|2),i.child}e=e.sibling}c.tail!==null&&B()>Gj&&(i.flags|=128,a=!0,Dj(c,!1),i.lanes=4194304)}else{if(!a)if(e=Ch(d),e!==null){if(i.flags|=128,a=!0,s=e.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),Dj(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!I)return S(i),null}else 2*B()-c.renderingStartTime>Gj&&s!==1073741824&&(i.flags|=128,a=!0,Dj(c,!1),i.lanes=4194304);c.isBackwards?(d.sibling=i.child,i.child=d):(s=c.last,s!==null?s.sibling=d:i.child=d,c.last=d)}return c.tail!==null?(i=c.tail,c.rendering=i,c.tail=i.sibling,c.renderingStartTime=B(),i.sibling=null,s=L$1.current,G(L$1,a?s&1|2:s&1),i):(S(i),null);case 22:case 23:return Hj(),a=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(i.flags|=8192),a&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E$1(Wf),E$1(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E$1(L$1),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){W(e,i,a)}else s.current=null}function Mj(e,i,s){try{s()}catch(a){W(e,i,a)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var o=a.anchorOffset,c=a.focusNode;a=a.focusOffset;try{s.nodeType,c.nodeType}catch{s=null;break e}var d=0,h=-1,g=-1,_=0,b=0,tt=e,_e=null;t:for(;;){for(var rt;tt!==s||o!==0&&tt.nodeType!==3||(h=d+o),tt!==c||a!==0&&tt.nodeType!==3||(g=d+a),tt.nodeType===3&&(d+=tt.nodeValue.length),(rt=tt.firstChild)!==null;)_e=tt,tt=rt;for(;;){if(tt===e)break t;if(_e===s&&++_===o&&(h=d),_e===c&&++b===a&&(g=d),(rt=tt.nextSibling)!==null)break;tt=_e,_e=tt.parentNode}tt=rt}s=h===-1||g===-1?null:{start:h,end:g}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var it=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(it!==null){var et=it.memoizedProps,nt=it.memoizedState,at=i.stateNode,st=at.getSnapshotBeforeUpdate(i.elementType===i.type?et:Ci(i.type,et),nt);at.__reactInternalSnapshotBeforeUpdate=st}break;case 3:var ot=i.stateNode.containerInfo;ot.nodeType===1?ot.textContent="":ot.nodeType===9&&ot.documentElement&&ot.removeChild(ot.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(pt){W(i,i.return,pt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return it=Nj,Nj=!1,it}function Pj(e,i,s){var a=i.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var o=a=a.next;do{if((o.tag&e)===e){var c=o.destroy;o.destroy=void 0,c!==void 0&&Mj(i,s,c)}o=o.next}while(o!==a)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==i)}}function Rj(e){var i=e.ref;if(i!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(e,i):s.insertBefore(e,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(e,s)):(i=s,i.appendChild(e)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=Bf));else if(a!==4&&(e=e.child,e!==null))for(Vj(e,i,s),e=e.sibling;e!==null;)Vj(e,i,s),e=e.sibling}function Wj(e,i,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,i?s.insertBefore(e,i):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Wj(e,i,s),e=e.sibling;e!==null;)Wj(e,i,s),e=e.sibling}var X$1=null,Xj=!1;function Yj(e,i,s){for(s=s.child;s!==null;)Zj(e,i,s),s=s.sibling}function Zj(e,i,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U$1||Lj(s,i);case 6:var a=X$1,o=Xj;X$1=null,Yj(e,i,s),X$1=a,Xj=o,X$1!==null&&(Xj?(e=X$1,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X$1.removeChild(s.stateNode));break;case 18:X$1!==null&&(Xj?(e=X$1,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X$1,s.stateNode));break;case 4:a=X$1,o=Xj,X$1=s.stateNode.containerInfo,Xj=!0,Yj(e,i,s),X$1=a,Xj=o;break;case 0:case 11:case 14:case 15:if(!U$1&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){o=a=a.next;do{var c=o,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&Mj(s,i,d),o=o.next}while(o!==a)}Yj(e,i,s);break;case 1:if(!U$1&&(Lj(s,i),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(h){W(s,i,h)}Yj(e,i,s);break;case 21:Yj(e,i,s);break;case 22:s.mode&1?(U$1=(a=U$1)||s.memoizedState!==null,Yj(e,i,s),U$1=a):Yj(e,i,s);break;default:Yj(e,i,s)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Kj),i.forEach(function(a){var o=bk.bind(null,e,a);s.has(a)||(s.add(a),a.then(o,o))})}}function ck(e,i){var s=i.deletions;if(s!==null)for(var a=0;a<s.length;a++){var o=s[a];try{var c=e,d=i,h=d;e:for(;h!==null;){switch(h.tag){case 5:X$1=h.stateNode,Xj=!1;break e;case 3:X$1=h.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=h.stateNode.containerInfo,Xj=!0;break e}h=h.return}if(X$1===null)throw Error(p(160));Zj(c,d,o),X$1=null,Xj=!1;var g=o.alternate;g!==null&&(g.return=null),o.return=null}catch(_){W(o,i,_)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),a&4){try{Pj(3,e,e.return),Qj(3,e)}catch(et){W(e,e.return,et)}try{Pj(5,e,e.return)}catch(et){W(e,e.return,et)}}break;case 1:ck(i,e),ek(e),a&512&&s!==null&&Lj(s,s.return);break;case 5:if(ck(i,e),ek(e),a&512&&s!==null&&Lj(s,s.return),e.flags&32){var o=e.stateNode;try{ob(o,"")}catch(et){W(e,e.return,et)}}if(a&4&&(o=e.stateNode,o!=null)){var c=e.memoizedProps,d=s!==null?s.memoizedProps:c,h=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{h==="input"&&c.type==="radio"&&c.name!=null&&ab(o,c),vb(h,d);var _=vb(h,c);for(d=0;d<g.length;d+=2){var b=g[d],tt=g[d+1];b==="style"?sb(o,tt):b==="dangerouslySetInnerHTML"?nb(o,tt):b==="children"?ob(o,tt):ta(o,b,tt,_)}switch(h){case"input":bb(o,c);break;case"textarea":ib(o,c);break;case"select":var _e=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!c.multiple;var rt=c.value;rt!=null?fb(o,!!c.multiple,rt,!1):_e!==!!c.multiple&&(c.defaultValue!=null?fb(o,!!c.multiple,c.defaultValue,!0):fb(o,!!c.multiple,c.multiple?[]:"",!1))}o[Pf]=c}catch(et){W(e,e.return,et)}}break;case 6:if(ck(i,e),ek(e),a&4){if(e.stateNode===null)throw Error(p(162));o=e.stateNode,c=e.memoizedProps;try{o.nodeValue=c}catch(et){W(e,e.return,et)}}break;case 3:if(ck(i,e),ek(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(et){W(e,e.return,et)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),o=e.child,o.flags&8192&&(c=o.memoizedState!==null,o.stateNode.isHidden=c,!c||o.alternate!==null&&o.alternate.memoizedState!==null||(fk=B())),a&4&&ak(e);break;case 22:if(b=s!==null&&s.memoizedState!==null,e.mode&1?(U$1=(_=U$1)||b,ck(i,e),U$1=_):ck(i,e),ek(e),a&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!b&&e.mode&1)for(V=e,b=e.child;b!==null;){for(tt=V=b;V!==null;){switch(_e=V,rt=_e.child,_e.tag){case 0:case 11:case 14:case 15:Pj(4,_e,_e.return);break;case 1:Lj(_e,_e.return);var it=_e.stateNode;if(typeof it.componentWillUnmount=="function"){a=_e,s=_e.return;try{i=a,it.props=i.memoizedProps,it.state=i.memoizedState,it.componentWillUnmount()}catch(et){W(a,s,et)}}break;case 5:Lj(_e,_e.return);break;case 22:if(_e.memoizedState!==null){gk(tt);continue}}rt!==null?(rt.return=_e,V=rt):gk(tt)}b=b.sibling}e:for(b=null,tt=e;;){if(tt.tag===5){if(b===null){b=tt;try{o=tt.stateNode,_?(c=o.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(h=tt.stateNode,g=tt.memoizedProps.style,d=g!=null&&g.hasOwnProperty("display")?g.display:null,h.style.display=rb("display",d))}catch(et){W(e,e.return,et)}}}else if(tt.tag===6){if(b===null)try{tt.stateNode.nodeValue=_?"":tt.memoizedProps}catch(et){W(e,e.return,et)}}else if((tt.tag!==22&&tt.tag!==23||tt.memoizedState===null||tt===e)&&tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===e)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===e)break e;b===tt&&(b=null),tt=tt.return}b===tt&&(b=null),tt.sibling.return=tt.return,tt=tt.sibling}}break;case 19:ck(i,e),ek(e),a&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{e:{for(var s=e.return;s!==null;){if(Tj(s)){var a=s;break e}s=s.return}throw Error(p(160))}switch(a.tag){case 5:var o=a.stateNode;a.flags&32&&(ob(o,""),a.flags&=-33);var c=Uj(e);Wj(e,c,o);break;case 3:case 4:var d=a.stateNode.containerInfo,h=Uj(e);Vj(e,h,d);break;default:throw Error(p(161))}}catch(g){W(e,e.return,g)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,s){V=e,ik(e)}function ik(e,i,s){for(var a=(e.mode&1)!==0;V!==null;){var o=V,c=o.child;if(o.tag===22&&a){var d=o.memoizedState!==null||Jj;if(!d){var h=o.alternate,g=h!==null&&h.memoizedState!==null||U$1;h=Jj;var _=U$1;if(Jj=d,(U$1=g)&&!_)for(V=o;V!==null;)d=V,g=d.child,d.tag===22&&d.memoizedState!==null?jk(o):g!==null?(g.return=d,V=g):jk(o);for(;c!==null;)V=c,ik(c),c=c.sibling;V=o,Jj=h,U$1=_}kk(e)}else o.subtreeFlags&8772&&c!==null?(c.return=o,V=c):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var s=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U$1||Qj(5,i);break;case 1:var a=i.stateNode;if(i.flags&4&&!U$1)if(s===null)a.componentDidMount();else{var o=i.elementType===i.type?s.memoizedProps:Ci(i.type,s.memoizedProps);a.componentDidUpdate(o,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var c=i.updateQueue;c!==null&&sh(i,c,a);break;case 3:var d=i.updateQueue;if(d!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}sh(i,d,s)}break;case 5:var h=i.stateNode;if(s===null&&i.flags&4){s=h;var g=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&s.focus();break;case"img":g.src&&(s.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var _=i.alternate;if(_!==null){var b=_.memoizedState;if(b!==null){var tt=b.dehydrated;tt!==null&&bd(tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U$1||i.flags&512&&Rj(i)}catch(_e){W(i,i.return,_e)}}if(i===e){V=null;break}if(s=i.sibling,s!==null){s.return=i.return,V=s;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var s=i.sibling;if(s!==null){s.return=i.return,V=s;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Qj(4,i)}catch(g){W(i,s,g)}break;case 1:var a=i.stateNode;if(typeof a.componentDidMount=="function"){var o=i.return;try{a.componentDidMount()}catch(g){W(i,o,g)}}var c=i.return;try{Rj(i)}catch(g){W(i,c,g)}break;case 5:var d=i.return;try{Rj(i)}catch(g){W(i,d,g)}}}catch(g){W(i,i.return,g)}if(i===e){V=null;break}var h=i.sibling;if(h!==null){h.return=i.return,V=h;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,s,a){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,s,a),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=s),T===4&&Ck(e,Z)),Dk(e,a),s===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var s=e.callbackNode;wc(e,i);var a=uc(e,e===Q?Z:0);if(a===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(i=a&-a,e.callbackPriority!==i){if(s!=null&&bc(s),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(a)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Fk(s,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=s}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Hk()&&e.callbackNode!==s)return null;var a=uc(e,e===Q?Z:0);if(a===0)return null;if(a&30||a&e.expiredLanes||i)i=Ik(e,a);else{i=a;var o=K;K|=2;var c=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(h){Mk(e,h)}while(!0);$g(),mk.current=c,K=o,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(o=xc(e),o!==0&&(a=o,i=Nk(e,o))),i===1)throw s=pk,Kk(e,0),Ck(e,a),Dk(e,B()),s;if(i===6)Ck(e,a);else{if(o=e.current.alternate,!(a&30)&&!Ok(o)&&(i=Ik(e,a),i===2&&(c=xc(e),c!==0&&(a=c,i=Nk(e,c))),i===1))throw s=pk,Kk(e,0),Ck(e,a),Dk(e,B()),s;switch(e.finishedWork=o,e.finishedLanes=a,i){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,a),(a&130023424)===a&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(o=e.suspendedLanes,(o&a)!==a){R(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,a),(a&4194240)===a)break;for(i=e.eventTimes,o=-1;0<a;){var d=31-oc(a);c=1<<d,d=i[d],d>o&&(o=d),a&=~c}if(a=o,a=B()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*lk(a/1960))-a,10<a){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),a);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===s?Gk.bind(null,e):null}function Nk(e,i){var s=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=s,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var o=s[a],c=o.getSnapshot;o=o.value;try{if(!He(c(),o))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var s=31-oc(i),a=1<<s;e[s]=-1,i&=~a}}function Ek(e){if(K&6)throw Error(p(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var s=Ik(e,i);if(e.tag!==0&&s===2){var a=xc(e);a!==0&&(i=a,s=Nk(e,a))}if(s===1)throw s=pk,Kk(e,0),Ck(e,i),Dk(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var s=K;K|=1;try{return e(i)}finally{K=s,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var s=ok.transition,a=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=a,ok.transition=s,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var a=s;switch(wg(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H),Eh();break;case 5:Bh(a);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(a.type._context);break;case 22:case 23:Hj()}s=s.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(s=fh[i],a=s.interleaved,a!==null){s.interleaved=null;var o=a.next,c=s.pending;if(c!==null){var d=c.next;c.next=o,a.next=d}s.pending=a}fh=null}return e}function Mk(e,i){do{var s=Y;try{if($g(),Fh.current=Rh,Ih){for(var a=M.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,s===null||s.return===null){T=1,pk=i,Y=null;break}e:{var c=e,d=s.return,h=s,g=i;if(i=Z,h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,b=h,tt=b.tag;if(!(b.mode&1)&&(tt===0||tt===11||tt===15)){var _e=b.alternate;_e?(b.updateQueue=_e.updateQueue,b.memoizedState=_e.memoizedState,b.lanes=_e.lanes):(b.updateQueue=null,b.memoizedState=null)}var rt=Ui(d);if(rt!==null){rt.flags&=-257,Vi(rt,d,h,c,i),rt.mode&1&&Si(c,_,i),i=rt,g=_;var it=i.updateQueue;if(it===null){var et=new Set;et.add(g),i.updateQueue=et}else it.add(g);break e}else{if(!(i&1)){Si(c,_,i),tj();break e}g=Error(p(426))}}else if(I&&h.mode&1){var nt=Ui(d);if(nt!==null){!(nt.flags&65536)&&(nt.flags|=256),Vi(nt,d,h,c,i),Jg(Ji(g,h));break e}}c=g=Ji(g,h),T!==4&&(T=2),sk===null?sk=[c]:sk.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,i&=-i,c.lanes|=i;var at=Ni(c,g,i);ph(c,at);break e;case 1:h=g;var st=c.type,ot=c.stateNode;if(!(c.flags&128)&&(typeof st.getDerivedStateFromError=="function"||ot!==null&&typeof ot.componentDidCatch=="function"&&(Ri===null||!Ri.has(ot)))){c.flags|=65536,i&=-i,c.lanes|=i;var pt=Qi(c,h,i);ph(c,pt);break e}}c=c.return}while(c!==null)}Sk(s)}catch(dt){i=dt,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var s=K;K|=2;var a=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(o){Mk(e,o)}while(!0);if($g(),K=s,mk.current=a,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y=i,nk.current=null}function Sk(e){var i=e;do{var s=i.alternate;if(e=i.return,i.flags&32768){if(s=Ij(s,i),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Ej(s,i,fj),s!==null){Y=s;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,s){var a=C,o=ok.transition;try{ok.transition=null,C=1,Wk(e,i,s,a)}finally{ok.transition=o,C=a}return null}function Wk(e,i,s,a){do Hk();while(wk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var o=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var c=s.lanes|s.childLanes;if(Bc(e,c),e===Q&&(Y=Q=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),c=(s.flags&15990)!==0,s.subtreeFlags&15990||c){c=ok.transition,ok.transition=null;var d=C;C=1;var h=K;K|=4,nk.current=null,Oj(e,s),dk(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,hk(s),dc(),K=h,C=d,ok.transition=c}else e.current=s;if(vk&&(vk=!1,wk=e,xk=o),c=e.pendingLanes,c===0&&(Ri=null),mc(s.stateNode),Dk(e,B()),i!==null)for(a=e.onRecoverableError,s=0;s<i.length;s++)o=i[s],a(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),c=e.pendingLanes,c&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,s=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var a=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var o=K;for(K|=4,V=e.current;V!==null;){var c=V,d=c.child;if(V.flags&16){var h=c.deletions;if(h!==null){for(var g=0;g<h.length;g++){var _=h[g];for(V=_;V!==null;){var b=V;switch(b.tag){case 0:case 11:case 15:Pj(8,b,c)}var tt=b.child;if(tt!==null)tt.return=b,V=tt;else for(;V!==null;){b=V;var _e=b.sibling,rt=b.return;if(Sj(b),b===_){V=null;break}if(_e!==null){_e.return=rt,V=_e;break}V=rt}}}var it=c.alternate;if(it!==null){var et=it.child;if(et!==null){it.child=null;do{var nt=et.sibling;et.sibling=null,et=nt}while(et!==null)}}V=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,V=d;else e:for(;V!==null;){if(c=V,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Pj(9,c,c.return)}var at=c.sibling;if(at!==null){at.return=c.return,V=at;break e}V=c.return}}var st=e.current;for(V=st;V!==null;){d=V;var ot=d.child;if(d.subtreeFlags&2064&&ot!==null)ot.return=d,V=ot;else e:for(d=st;V!==null;){if(h=V,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(dt){W(h,h.return,dt)}if(h===d){V=null;break e}var pt=h.sibling;if(pt!==null){pt.return=h.return,V=pt;break e}V=h.return}}if(K=o,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}a=!0}return a}finally{C=s,ok.transition=i}}return!1}function Xk(e,i,s){i=Ji(s,i),i=Ni(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,s){if(e.tag===3)Xk(e,e,s);else for(;i!==null;){if(i.tag===3){Xk(i,e,s);break}else if(i.tag===1){var a=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Ri===null||!Ri.has(a))){e=Ji(s,e),e=Qi(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,s){var a=e.pingCache;a!==null&&a.delete(i),i=R(),e.pingedLanes|=e.suspendedLanes&s,Q===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=s),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var s=R();e=ih(e,i),e!==null&&(Ac(e,i,s),Dk(e,s))}function uj(e){var i=e.memoizedState,s=0;i!==null&&(s=i.retryLane),Yk(e,s)}function bk(e,i){var s=0;switch(e.tag){case 13:var a=e.stateNode,o=e.memoizedState;o!==null&&(s=o.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(p(314))}a!==null&&a.delete(i),Yk(e,s)}var Vk;Vk=function(e,i,s){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&s)&&!(i.flags&128))return dh=!1,yj(e,i,s);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var a=i.type;ij(e,i),e=i.pendingProps;var o=Yf(i,H.current);ch(i,s),o=Nh(null,i,a,e,o,s);var c=Sh();return i.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(a)?(c=!0,cg(i)):c=!1,i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,kh(i),o.updater=Ei,i.stateNode=o,o._reactInternals=i,Ii(i,a,e,s),i=jj(null,i,a,!0,c,s)):(i.tag=0,I&&c&&vg(i),Xi(null,i,o,s),i=i.child),i;case 16:a=i.elementType;e:{switch(ij(e,i),e=i.pendingProps,o=a._init,a=o(a._payload),i.type=a,o=i.tag=Zk(a),e=Ci(a,e),o){case 0:i=cj(null,i,a,e,s);break e;case 1:i=hj(null,i,a,e,s);break e;case 11:i=Yi(null,i,a,e,s);break e;case 14:i=$i(null,i,a,Ci(a.type,e),s);break e}throw Error(p(306,a,""))}return i;case 0:return a=i.type,o=i.pendingProps,o=i.elementType===a?o:Ci(a,o),cj(e,i,a,o,s);case 1:return a=i.type,o=i.pendingProps,o=i.elementType===a?o:Ci(a,o),hj(e,i,a,o,s);case 3:e:{if(kj(i),e===null)throw Error(p(387));a=i.pendingProps,c=i.memoizedState,o=c.element,lh(e,i),qh(i,a,null,s);var d=i.memoizedState;if(a=d.element,c.isDehydrated)if(c={element:a,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},i.updateQueue.baseState=c,i.memoizedState=c,i.flags&256){o=Ji(Error(p(423)),i),i=lj(e,i,a,s,o);break e}else if(a!==o){o=Ji(Error(p(424)),i),i=lj(e,i,a,s,o);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,s=Vg(i,null,a,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),a===o){i=Zi(e,i,s);break e}Xi(e,i,a,s)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),a=i.type,o=i.pendingProps,c=e!==null?e.memoizedProps:null,d=o.children,Ef(a,o)?d=null:c!==null&&Ef(a,c)&&(i.flags|=32),gj(e,i),Xi(e,i,d,s),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,s);case 4:return yh(i,i.stateNode.containerInfo),a=i.pendingProps,e===null?i.child=Ug(i,null,a,s):Xi(e,i,a,s),i.child;case 11:return a=i.type,o=i.pendingProps,o=i.elementType===a?o:Ci(a,o),Yi(e,i,a,o,s);case 7:return Xi(e,i,i.pendingProps,s),i.child;case 8:return Xi(e,i,i.pendingProps.children,s),i.child;case 12:return Xi(e,i,i.pendingProps.children,s),i.child;case 10:e:{if(a=i.type._context,o=i.pendingProps,c=i.memoizedProps,d=o.value,G(Wg,a._currentValue),a._currentValue=d,c!==null)if(He(c.value,d)){if(c.children===o.children&&!Wf.current){i=Zi(e,i,s);break e}}else for(c=i.child,c!==null&&(c.return=i);c!==null;){var h=c.dependencies;if(h!==null){d=c.child;for(var g=h.firstContext;g!==null;){if(g.context===a){if(c.tag===1){g=mh(-1,s&-s),g.tag=2;var _=c.updateQueue;if(_!==null){_=_.shared;var b=_.pending;b===null?g.next=g:(g.next=b.next,b.next=g),_.pending=g}}c.lanes|=s,g=c.alternate,g!==null&&(g.lanes|=s),bh(c.return,s,i),h.lanes|=s;break}g=g.next}}else if(c.tag===10)d=c.type===i.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(p(341));d.lanes|=s,h=d.alternate,h!==null&&(h.lanes|=s),bh(d,s,i),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===i){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Xi(e,i,o.children,s),i=i.child}return i;case 9:return o=i.type,a=i.pendingProps.children,ch(i,s),o=eh(o),a=a(o),i.flags|=1,Xi(e,i,a,s),i.child;case 14:return a=i.type,o=Ci(a,i.pendingProps),o=Ci(a.type,o),$i(e,i,a,o,s);case 15:return bj(e,i,i.type,i.pendingProps,s);case 17:return a=i.type,o=i.pendingProps,o=i.elementType===a?o:Ci(a,o),ij(e,i),i.tag=1,Zf(a)?(e=!0,cg(i)):e=!1,ch(i,s),Gi(i,a,o),Ii(i,a,o,s),jj(null,i,a,!0,e,s);case 19:return xj(e,i,s);case 22:return dj(e,i,s)}throw Error(p(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,s,a){return new $k(e,i,s,a)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var s=e.alternate;return s===null?(s=Bg(e.tag,i,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=i,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,i=e.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rg(e,i,s,a,o,c){var d=2;if(a=e,typeof e=="function")aj(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case ya:return Tg(s.children,o,c,i);case za:d=8,o|=8;break;case Aa:return e=Bg(12,s,i,o|2),e.elementType=Aa,e.lanes=c,e;case Ea:return e=Bg(13,s,i,o),e.elementType=Ea,e.lanes=c,e;case Fa:return e=Bg(19,s,i,o),e.elementType=Fa,e.lanes=c,e;case Ia:return pj(s,o,c,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:d=10;break e;case Ca:d=9;break e;case Da:d=11;break e;case Ga:d=14;break e;case Ha:d=16,a=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(d,s,i,o),i.elementType=e,i.type=a,i.lanes=c,i}function Tg(e,i,s,a){return e=Bg(7,e,a,i),e.lanes=s,e}function pj(e,i,s,a){return e=Bg(22,e,a,i),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function Qg(e,i,s){return e=Bg(6,e,null,i),e.lanes=s,e}function Sg(e,i,s){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=s,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,s,a,o){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=a,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function bl(e,i,s,a,o,c,d,h,g){return e=new al(e,i,s,h,g),i===1?(i=1,c===!0&&(i|=8)):i=0,c=Bg(3,null,null,i),e.current=c,c.stateNode=e,c.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(c),e}function cl(e,i,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:a==null?null:""+a,children:e,containerInfo:i,implementation:s}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,i)}return i}function el(e,i,s,a,o,c,d,h,g){return e=bl(s,a,!0,e,o,c,d,h,g),e.context=dl(null),s=e.current,a=R(),o=yi(s),c=mh(a,o),c.callback=i??null,nh(s,c,o),e.current.lanes=o,Ac(e,o,a),Dk(e,a),e}function fl(e,i,s,a){var o=i.current,c=R(),d=yi(o);return s=dl(s),i.context===null?i.context=s:i.pendingContext=s,i=mh(c,d),i.payload={element:e},a=a===void 0?null:a,a!==null&&(i.callback=a),e=nh(o,i,d),e!==null&&(gi(e,o,d,c),oh(e,o,d)),d}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<i?s:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var s=0;s<Qc.length&&i!==0&&i<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,s,a,o){if(o){if(typeof a=="function"){var c=a;a=function(){var _=gl(d);c.call(_)}}var d=el(i,a,e,0,null,!1,!1,"",pl);return e._reactRootContainer=d,e[uf]=d.current,sf(e.nodeType===8?e.parentNode:e),Rk(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof a=="function"){var h=a;a=function(){var _=gl(g);h.call(_)}}var g=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=g,e[uf]=g.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,g,s,a)}),g}function rl(e,i,s,a,o){var c=s._reactRootContainer;if(c){var d=c;if(typeof o=="function"){var h=o;o=function(){var g=gl(d);h.call(g)}}fl(i,d,e,o)}else d=ql(s,i,e,o,a);return gl(d)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var s=tc(i.pendingLanes);s!==0&&(Cc(i,s|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var a=ih(e,1);if(a!==null){var o=R();gi(a,e,1,o)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var s=R();gi(i,e,134217728,s)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),s=ih(e,i);if(s!==null){var a=R();gi(s,e,i,a)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var s=C;try{return C=e,i()}finally{C=s}};yb=function(e,i,s){switch(i){case"input":if(bb(e,s),i=s.name,s.type==="radio"&&i!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var a=s[i];if(a!==e&&a.form===e.form){var o=Db(a);if(!o)throw Error(p(90));Wa(a),bb(a,o)}}}break;case"textarea":ib(e,s);break;case"select":i=s.value,i!=null&&fb(e,!!s.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p(200));return cl(e,i,null,s)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p(299));var s=!1,a="",o=kl;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(a=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),i=bl(e,1,!1,null,null,s,!1,a,o),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!0,s)};reactDom_production_min.hydrateRoot=function(e,i,s){if(!nl(e))throw Error(p(405));var a=s!=null&&s.hydratedSources||null,o=!1,c="",d=kl;if(s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onRecoverableError!==void 0&&(d=s.onRecoverableError)),i=el(i,null,e,1,s??null,o,!1,c,d),e[uf]=i.current,sf(e),a)for(e=0;e<a.length;e++)s=a[e],o=s._getVersion,o=o(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,o]:i.mutableSourceEagerHydrationData.push(s,o);return new ml(i)};reactDom_production_min.render=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,s,a){if(!ol(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,i,s,!1,a)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const Gt=getDefaultExportFromCjs(reactDomExports);var createRoot,m=reactDomExports;createRoot=m.createRoot,m.hydrateRoot;const TOAST_LIMIT=1,TOAST_REMOVE_DELAY=1e6;let count$2=0;function genId(){return count$2=(count$2+1)%Number.MAX_SAFE_INTEGER,count$2.toString()}const toastTimeouts=new Map,addToRemoveQueue=e=>{if(toastTimeouts.has(e))return;const i=setTimeout(()=>{toastTimeouts.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},TOAST_REMOVE_DELAY);toastTimeouts.set(e,i)},reducer$1=(e,i)=>{switch(i.type){case"ADD_TOAST":return{...e,toasts:[i.toast,...e.toasts].slice(0,TOAST_LIMIT)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(s=>s.id===i.toast.id?{...s,...i.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=i;return s?addToRemoveQueue(s):e.toasts.forEach(a=>{addToRemoveQueue(a.id)}),{...e,toasts:e.toasts.map(a=>a.id===s||s===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return i.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==i.toastId)}}},listeners=[];let memoryState={toasts:[]};function dispatch(e){memoryState=reducer$1(memoryState,e),listeners.forEach(i=>{i(memoryState)})}function toast({...e}){const i=genId(),s=o=>dispatch({type:"UPDATE_TOAST",toast:{...o,id:i}}),a=()=>dispatch({type:"DISMISS_TOAST",toastId:i});return dispatch({type:"ADD_TOAST",toast:{...e,id:i,open:!0,onOpenChange:o=>{o||a()}}}),{id:i,dismiss:a,update:s}}function useToast(){const[e,i]=reactExports.useState(memoryState);return reactExports.useEffect(()=>(listeners.push(i),()=>{const s=listeners.indexOf(i);s>-1&&listeners.splice(s,1)}),[e]),{...e,toast,dismiss:s=>dispatch({type:"DISMISS_TOAST",toastId:s})}}function composeEventHandlers$1(e,i,{checkForDefaultPrevented:s=!0}={}){return function(o){if(e==null||e(o),s===!1||!o.defaultPrevented)return i==null?void 0:i(o)}}function setRef(e,i){typeof e=="function"?e(i):e!=null&&(e.current=i)}function composeRefs(...e){return i=>e.forEach(s=>setRef(s,i))}function useComposedRefs(...e){return reactExports.useCallback(composeRefs(...e),e)}function createContextScope$3(e,i=[]){let s=[];function a(c,d){const h=reactExports.createContext(d),g=s.length;s=[...s,d];function _(tt){const{scope:_e,children:rt,...it}=tt,et=(_e==null?void 0:_e[e][g])||h,nt=reactExports.useMemo(()=>it,Object.values(it));return jsxRuntimeExports.jsx(et.Provider,{value:nt,children:rt})}function b(tt,_e){const rt=(_e==null?void 0:_e[e][g])||h,it=reactExports.useContext(rt);if(it)return it;if(d!==void 0)return d;throw new Error(`\`${tt}\` must be used within \`${c}\``)}return _.displayName=c+"Provider",[_,b]}const o=()=>{const c=s.map(d=>reactExports.createContext(d));return function(h){const g=(h==null?void 0:h[e])||c;return reactExports.useMemo(()=>({[`__scope${e}`]:{...h,[e]:g}}),[h,g])}};return o.scopeName=e,[a,composeContextScopes$3(o,...i)]}function composeContextScopes$3(...e){const i=e[0];if(e.length===1)return i;const s=()=>{const a=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(c){const d=a.reduce((h,{useScope:g,scopeName:_})=>{const tt=g(c)[`__scope${_}`];return{...h,...tt}},{});return reactExports.useMemo(()=>({[`__scope${i.scopeName}`]:d}),[d])}};return s.scopeName=i.scopeName,s}var Slot=reactExports.forwardRef((e,i)=>{const{children:s,...a}=e,o=reactExports.Children.toArray(s),c=o.find(isSlottable);if(c){const d=c.props.children,h=o.map(g=>g===c?reactExports.Children.count(d)>1?reactExports.Children.only(null):reactExports.isValidElement(d)?d.props.children:null:g);return jsxRuntimeExports.jsx(SlotClone,{...a,ref:i,children:reactExports.isValidElement(d)?reactExports.cloneElement(d,void 0,h):null})}return jsxRuntimeExports.jsx(SlotClone,{...a,ref:i,children:s})});Slot.displayName="Slot";var SlotClone=reactExports.forwardRef((e,i)=>{const{children:s,...a}=e;if(reactExports.isValidElement(s)){const o=getElementRef$1(s);return reactExports.cloneElement(s,{...mergeProps(a,s.props),ref:i?composeRefs(i,o):o})}return reactExports.Children.count(s)>1?reactExports.Children.only(null):null});SlotClone.displayName="SlotClone";var Slottable=({children:e})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e});function isSlottable(e){return reactExports.isValidElement(e)&&e.type===Slottable}function mergeProps(e,i){const s={...i};for(const a in i){const o=e[a],c=i[a];/^on[A-Z]/.test(a)?o&&c?s[a]=(...h)=>{c(...h),o(...h)}:o&&(s[a]=o):a==="style"?s[a]={...o,...c}:a==="className"&&(s[a]=[o,c].filter(Boolean).join(" "))}return{...e,...s}}function getElementRef$1(e){var a,o;let i=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,s=i&&"isReactWarning"in i&&i.isReactWarning;return s?e.ref:(i=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,s=i&&"isReactWarning"in i&&i.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}function createCollection(e){const i=e+"CollectionProvider",[s,a]=createContextScope$3(i),[o,c]=s(i,{collectionRef:{current:null},itemMap:new Map}),d=rt=>{const{scope:it,children:et}=rt,nt=React.useRef(null),at=React.useRef(new Map).current;return jsxRuntimeExports.jsx(o,{scope:it,itemMap:at,collectionRef:nt,children:et})};d.displayName=i;const h=e+"CollectionSlot",g=React.forwardRef((rt,it)=>{const{scope:et,children:nt}=rt,at=c(h,et),st=useComposedRefs(it,at.collectionRef);return jsxRuntimeExports.jsx(Slot,{ref:st,children:nt})});g.displayName=h;const _=e+"CollectionItemSlot",b="data-radix-collection-item",tt=React.forwardRef((rt,it)=>{const{scope:et,children:nt,...at}=rt,st=React.useRef(null),ot=useComposedRefs(it,st),pt=c(_,et);return React.useEffect(()=>(pt.itemMap.set(st,{ref:st,...at}),()=>void pt.itemMap.delete(st))),jsxRuntimeExports.jsx(Slot,{[b]:"",ref:ot,children:nt})});tt.displayName=_;function _e(rt){const it=c(e+"CollectionConsumer",rt);return React.useCallback(()=>{const nt=it.collectionRef.current;if(!nt)return[];const at=Array.from(nt.querySelectorAll(`[${b}]`));return Array.from(it.itemMap.values()).sort((pt,dt)=>at.indexOf(pt.ref.current)-at.indexOf(dt.ref.current))},[it.collectionRef,it.itemMap])}return[{Provider:d,Slot:g,ItemSlot:tt},_e,a]}function createContextScope$2(e,i=[]){let s=[];function a(c,d){const h=reactExports.createContext(d),g=s.length;s=[...s,d];const _=tt=>{var at;const{scope:_e,children:rt,...it}=tt,et=((at=_e==null?void 0:_e[e])==null?void 0:at[g])||h,nt=reactExports.useMemo(()=>it,Object.values(it));return jsxRuntimeExports.jsx(et.Provider,{value:nt,children:rt})};_.displayName=c+"Provider";function b(tt,_e){var et;const rt=((et=_e==null?void 0:_e[e])==null?void 0:et[g])||h,it=reactExports.useContext(rt);if(it)return it;if(d!==void 0)return d;throw new Error(`\`${tt}\` must be used within \`${c}\``)}return[_,b]}const o=()=>{const c=s.map(d=>reactExports.createContext(d));return function(h){const g=(h==null?void 0:h[e])||c;return reactExports.useMemo(()=>({[`__scope${e}`]:{...h,[e]:g}}),[h,g])}};return o.scopeName=e,[a,composeContextScopes$2(o,...i)]}function composeContextScopes$2(...e){const i=e[0];if(e.length===1)return i;const s=()=>{const a=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(c){const d=a.reduce((h,{useScope:g,scopeName:_})=>{const tt=g(c)[`__scope${_}`];return{...h,...tt}},{});return reactExports.useMemo(()=>({[`__scope${i.scopeName}`]:d}),[d])}};return s.scopeName=i.scopeName,s}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Primitive=NODES.reduce((e,i)=>{const s=reactExports.forwardRef((a,o)=>{const{asChild:c,...d}=a,h=c?Slot:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(h,{...d,ref:o})});return s.displayName=`Primitive.${i}`,{...e,[i]:s}},{});function dispatchDiscreteCustomEvent(e,i){e&&reactDomExports.flushSync(()=>e.dispatchEvent(i))}function useCallbackRef$1(e){const i=reactExports.useRef(e);return reactExports.useEffect(()=>{i.current=e}),reactExports.useMemo(()=>(...s)=>{var a;return(a=i.current)==null?void 0:a.call(i,...s)},[])}function useEscapeKeydown(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef$1(e);reactExports.useEffect(()=>{const a=o=>{o.key==="Escape"&&s(o)};return i.addEventListener("keydown",a,{capture:!0}),()=>i.removeEventListener("keydown",a,{capture:!0})},[s,i])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((e,i)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:c,onInteractOutside:d,onDismiss:h,...g}=e,_=reactExports.useContext(DismissableLayerContext),[b,tt]=reactExports.useState(null),_e=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,rt]=reactExports.useState({}),it=useComposedRefs(i,lt=>tt(lt)),et=Array.from(_.layers),[nt]=[..._.layersWithOutsidePointerEventsDisabled].slice(-1),at=et.indexOf(nt),st=b?et.indexOf(b):-1,ot=_.layersWithOutsidePointerEventsDisabled.size>0,pt=st>=at,dt=usePointerDownOutside(lt=>{const gt=lt.target,vt=[..._.branches].some(At=>At.contains(gt));!pt||vt||(o==null||o(lt),d==null||d(lt),lt.defaultPrevented||h==null||h())},_e),wt=useFocusOutside(lt=>{const gt=lt.target;[..._.branches].some(At=>At.contains(gt))||(c==null||c(lt),d==null||d(lt),lt.defaultPrevented||h==null||h())},_e);return useEscapeKeydown(lt=>{st===_.layers.size-1&&(a==null||a(lt),!lt.defaultPrevented&&h&&(lt.preventDefault(),h()))},_e),reactExports.useEffect(()=>{if(b)return s&&(_.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=_e.body.style.pointerEvents,_e.body.style.pointerEvents="none"),_.layersWithOutsidePointerEventsDisabled.add(b)),_.layers.add(b),dispatchUpdate(),()=>{s&&_.layersWithOutsidePointerEventsDisabled.size===1&&(_e.body.style.pointerEvents=originalBodyPointerEvents)}},[b,_e,s,_]),reactExports.useEffect(()=>()=>{b&&(_.layers.delete(b),_.layersWithOutsidePointerEventsDisabled.delete(b),dispatchUpdate())},[b,_]),reactExports.useEffect(()=>{const lt=()=>rt({});return document.addEventListener(CONTEXT_UPDATE,lt),()=>document.removeEventListener(CONTEXT_UPDATE,lt)},[]),jsxRuntimeExports.jsx(Primitive.div,{...g,ref:it,style:{pointerEvents:ot?pt?"auto":"none":void 0,...e.style},onFocusCapture:composeEventHandlers$1(e.onFocusCapture,wt.onFocusCapture),onBlurCapture:composeEventHandlers$1(e.onBlurCapture,wt.onBlurCapture),onPointerDownCapture:composeEventHandlers$1(e.onPointerDownCapture,dt.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((e,i)=>{const s=reactExports.useContext(DismissableLayerContext),a=reactExports.useRef(null),o=useComposedRefs(i,a);return reactExports.useEffect(()=>{const c=a.current;if(c)return s.branches.add(c),()=>{s.branches.delete(c)}},[s.branches]),jsxRuntimeExports.jsx(Primitive.div,{...e,ref:o})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef$1(e),a=reactExports.useRef(!1),o=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const c=h=>{if(h.target&&!a.current){let g=function(){handleAndDispatchCustomEvent$1(POINTER_DOWN_OUTSIDE,s,_,{discrete:!0})};const _={originalEvent:h};h.pointerType==="touch"?(i.removeEventListener("click",o.current),o.current=g,i.addEventListener("click",o.current,{once:!0})):g()}else i.removeEventListener("click",o.current);a.current=!1},d=window.setTimeout(()=>{i.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(d),i.removeEventListener("pointerdown",c),i.removeEventListener("click",o.current)}},[i,s]),{onPointerDownCapture:()=>a.current=!0}}function useFocusOutside(e,i=globalThis==null?void 0:globalThis.document){const s=useCallbackRef$1(e),a=reactExports.useRef(!1);return reactExports.useEffect(()=>{const o=c=>{c.target&&!a.current&&handleAndDispatchCustomEvent$1(FOCUS_OUTSIDE,s,{originalEvent:c},{discrete:!1})};return i.addEventListener("focusin",o),()=>i.removeEventListener("focusin",o)},[i,s]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function dispatchUpdate(){const e=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(e)}function handleAndDispatchCustomEvent$1(e,i,s,{discrete:a}){const o=s.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});i&&o.addEventListener(e,i,{once:!0}),a?dispatchDiscreteCustomEvent(o,c):o.dispatchEvent(c)}var Root$4=DismissableLayer,Branch=DismissableLayerBranch,useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},PORTAL_NAME$3="Portal",Portal$2=reactExports.forwardRef((e,i)=>{var h;const{container:s,...a}=e,[o,c]=reactExports.useState(!1);useLayoutEffect2(()=>c(!0),[]);const d=s||o&&((h=globalThis==null?void 0:globalThis.document)==null?void 0:h.body);return d?Gt.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i}),d):null});Portal$2.displayName=PORTAL_NAME$3;function useStateMachine(e,i){return reactExports.useReducer((s,a)=>i[s][a]??s,e)}var Presence=e=>{const{present:i,children:s}=e,a=usePresence(i),o=typeof s=="function"?s({present:a.isPresent}):reactExports.Children.only(s),c=useComposedRefs(a.ref,getElementRef(o));return typeof s=="function"||a.isPresent?reactExports.cloneElement(o,{ref:c}):null};Presence.displayName="Presence";function usePresence(e){const[i,s]=reactExports.useState(),a=reactExports.useRef({}),o=reactExports.useRef(e),c=reactExports.useRef("none"),d=e?"mounted":"unmounted",[h,g]=useStateMachine(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const _=getAnimationName(a.current);c.current=h==="mounted"?_:"none"},[h]),useLayoutEffect2(()=>{const _=a.current,b=o.current;if(b!==e){const _e=c.current,rt=getAnimationName(_);e?g("MOUNT"):rt==="none"||(_==null?void 0:_.display)==="none"?g("UNMOUNT"):g(b&&_e!==rt?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,g]),useLayoutEffect2(()=>{if(i){let _;const b=i.ownerDocument.defaultView??window,tt=rt=>{const et=getAnimationName(a.current).includes(rt.animationName);if(rt.target===i&&et&&(g("ANIMATION_END"),!o.current)){const nt=i.style.animationFillMode;i.style.animationFillMode="forwards",_=b.setTimeout(()=>{i.style.animationFillMode==="forwards"&&(i.style.animationFillMode=nt)})}},_e=rt=>{rt.target===i&&(c.current=getAnimationName(a.current))};return i.addEventListener("animationstart",_e),i.addEventListener("animationcancel",tt),i.addEventListener("animationend",tt),()=>{b.clearTimeout(_),i.removeEventListener("animationstart",_e),i.removeEventListener("animationcancel",tt),i.removeEventListener("animationend",tt)}}else g("ANIMATION_END")},[i,g]),{isPresent:["mounted","unmountSuspended"].includes(h),ref:reactExports.useCallback(_=>{_&&(a.current=getComputedStyle(_)),s(_)},[])}}function getAnimationName(e){return(e==null?void 0:e.animationName)||"none"}function getElementRef(e){var a,o;let i=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,s=i&&"isReactWarning"in i&&i.isReactWarning;return s?e.ref:(i=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,s=i&&"isReactWarning"in i&&i.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}function useControllableState({prop:e,defaultProp:i,onChange:s=()=>{}}){const[a,o]=useUncontrolledState({defaultProp:i,onChange:s}),c=e!==void 0,d=c?e:a,h=useCallbackRef$1(s),g=reactExports.useCallback(_=>{if(c){const tt=typeof _=="function"?_(e):_;tt!==e&&h(tt)}else o(_)},[c,e,o,h]);return[d,g]}function useUncontrolledState({defaultProp:e,onChange:i}){const s=reactExports.useState(e),[a]=s,o=reactExports.useRef(a),c=useCallbackRef$1(i);return reactExports.useEffect(()=>{o.current!==a&&(c(a),o.current=a)},[a,o,c]),s}var NAME$1="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((e,i)=>jsxRuntimeExports.jsx(Primitive.span,{...e,ref:i,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));VisuallyHidden.displayName=NAME$1;var Root$3=VisuallyHidden,PROVIDER_NAME$1="ToastProvider",[Collection$1,useCollection$1,createCollectionScope$1]=createCollection("Toast"),[createToastContext,createToastScope]=createContextScope$2("Toast",[createCollectionScope$1]),[ToastProviderProvider,useToastProviderContext]=createToastContext(PROVIDER_NAME$1),ToastProvider$1=e=>{const{__scopeToast:i,label:s="Notification",duration:a=5e3,swipeDirection:o="right",swipeThreshold:c=50,children:d}=e,[h,g]=reactExports.useState(null),[_,b]=reactExports.useState(0),tt=reactExports.useRef(!1),_e=reactExports.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${PROVIDER_NAME$1}\`. Expected non-empty \`string\`.`),jsxRuntimeExports.jsx(Collection$1.Provider,{scope:i,children:jsxRuntimeExports.jsx(ToastProviderProvider,{scope:i,label:s,duration:a,swipeDirection:o,swipeThreshold:c,toastCount:_,viewport:h,onViewportChange:g,onToastAdd:reactExports.useCallback(()=>b(rt=>rt+1),[]),onToastRemove:reactExports.useCallback(()=>b(rt=>rt-1),[]),isFocusedToastEscapeKeyDownRef:tt,isClosePausedRef:_e,children:d})})};ToastProvider$1.displayName=PROVIDER_NAME$1;var VIEWPORT_NAME$1="ToastViewport",VIEWPORT_DEFAULT_HOTKEY=["F8"],VIEWPORT_PAUSE="toast.viewportPause",VIEWPORT_RESUME="toast.viewportResume",ToastViewport$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,hotkey:a=VIEWPORT_DEFAULT_HOTKEY,label:o="Notifications ({hotkey})",...c}=e,d=useToastProviderContext(VIEWPORT_NAME$1,s),h=useCollection$1(s),g=reactExports.useRef(null),_=reactExports.useRef(null),b=reactExports.useRef(null),tt=reactExports.useRef(null),_e=useComposedRefs(i,tt,d.onViewportChange),rt=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),it=d.toastCount>0;reactExports.useEffect(()=>{const nt=at=>{var ot;a.length!==0&&a.every(pt=>at[pt]||at.code===pt)&&((ot=tt.current)==null||ot.focus())};return document.addEventListener("keydown",nt),()=>document.removeEventListener("keydown",nt)},[a]),reactExports.useEffect(()=>{const nt=g.current,at=tt.current;if(it&&nt&&at){const st=()=>{if(!d.isClosePausedRef.current){const wt=new CustomEvent(VIEWPORT_PAUSE);at.dispatchEvent(wt),d.isClosePausedRef.current=!0}},ot=()=>{if(d.isClosePausedRef.current){const wt=new CustomEvent(VIEWPORT_RESUME);at.dispatchEvent(wt),d.isClosePausedRef.current=!1}},pt=wt=>{!nt.contains(wt.relatedTarget)&&ot()},dt=()=>{nt.contains(document.activeElement)||ot()};return nt.addEventListener("focusin",st),nt.addEventListener("focusout",pt),nt.addEventListener("pointermove",st),nt.addEventListener("pointerleave",dt),window.addEventListener("blur",st),window.addEventListener("focus",ot),()=>{nt.removeEventListener("focusin",st),nt.removeEventListener("focusout",pt),nt.removeEventListener("pointermove",st),nt.removeEventListener("pointerleave",dt),window.removeEventListener("blur",st),window.removeEventListener("focus",ot)}}},[it,d.isClosePausedRef]);const et=reactExports.useCallback(({tabbingDirection:nt})=>{const st=h().map(ot=>{const pt=ot.ref.current,dt=[pt,...getTabbableCandidates$1(pt)];return nt==="forwards"?dt:dt.reverse()});return(nt==="forwards"?st.reverse():st).flat()},[h]);return reactExports.useEffect(()=>{const nt=tt.current;if(nt){const at=st=>{var dt,wt,lt;const ot=st.altKey||st.ctrlKey||st.metaKey;if(st.key==="Tab"&&!ot){const gt=document.activeElement,vt=st.shiftKey;if(st.target===nt&&vt){(dt=_.current)==null||dt.focus();return}const bt=et({tabbingDirection:vt?"backwards":"forwards"}),Tt=bt.findIndex(er=>er===gt);focusFirst$1(bt.slice(Tt+1))?st.preventDefault():vt?(wt=_.current)==null||wt.focus():(lt=b.current)==null||lt.focus()}};return nt.addEventListener("keydown",at),()=>nt.removeEventListener("keydown",at)}},[h,et]),jsxRuntimeExports.jsxs(Branch,{ref:g,role:"region","aria-label":o.replace("{hotkey}",rt),tabIndex:-1,style:{pointerEvents:it?void 0:"none"},children:[it&&jsxRuntimeExports.jsx(FocusProxy,{ref:_,onFocusFromOutsideViewport:()=>{const nt=et({tabbingDirection:"forwards"});focusFirst$1(nt)}}),jsxRuntimeExports.jsx(Collection$1.Slot,{scope:s,children:jsxRuntimeExports.jsx(Primitive.ol,{tabIndex:-1,...c,ref:_e})}),it&&jsxRuntimeExports.jsx(FocusProxy,{ref:b,onFocusFromOutsideViewport:()=>{const nt=et({tabbingDirection:"backwards"});focusFirst$1(nt)}})]})});ToastViewport$1.displayName=VIEWPORT_NAME$1;var FOCUS_PROXY_NAME="ToastFocusProxy",FocusProxy=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,onFocusFromOutsideViewport:a,...o}=e,c=useToastProviderContext(FOCUS_PROXY_NAME,s);return jsxRuntimeExports.jsx(VisuallyHidden,{"aria-hidden":!0,tabIndex:0,...o,ref:i,style:{position:"fixed"},onFocus:d=>{var _;const h=d.relatedTarget;!((_=c.viewport)!=null&&_.contains(h))&&a()}})});FocusProxy.displayName=FOCUS_PROXY_NAME;var TOAST_NAME="Toast",TOAST_SWIPE_START="toast.swipeStart",TOAST_SWIPE_MOVE="toast.swipeMove",TOAST_SWIPE_CANCEL="toast.swipeCancel",TOAST_SWIPE_END="toast.swipeEnd",Toast$1=reactExports.forwardRef((e,i)=>{const{forceMount:s,open:a,defaultOpen:o,onOpenChange:c,...d}=e,[h=!0,g]=useControllableState({prop:a,defaultProp:o,onChange:c});return jsxRuntimeExports.jsx(Presence,{present:s||h,children:jsxRuntimeExports.jsx(ToastImpl,{open:h,...d,ref:i,onClose:()=>g(!1),onPause:useCallbackRef$1(e.onPause),onResume:useCallbackRef$1(e.onResume),onSwipeStart:composeEventHandlers$1(e.onSwipeStart,_=>{_.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:composeEventHandlers$1(e.onSwipeMove,_=>{const{x:b,y:tt}=_.detail.delta;_.currentTarget.setAttribute("data-swipe","move"),_.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${b}px`),_.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${tt}px`)}),onSwipeCancel:composeEventHandlers$1(e.onSwipeCancel,_=>{_.currentTarget.setAttribute("data-swipe","cancel"),_.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),_.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),_.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),_.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:composeEventHandlers$1(e.onSwipeEnd,_=>{const{x:b,y:tt}=_.detail.delta;_.currentTarget.setAttribute("data-swipe","end"),_.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),_.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),_.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${b}px`),_.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${tt}px`),g(!1)})})})});Toast$1.displayName=TOAST_NAME;var[ToastInteractiveProvider,useToastInteractiveContext]=createToastContext(TOAST_NAME,{onClose(){}}),ToastImpl=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,type:a="foreground",duration:o,open:c,onClose:d,onEscapeKeyDown:h,onPause:g,onResume:_,onSwipeStart:b,onSwipeMove:tt,onSwipeCancel:_e,onSwipeEnd:rt,...it}=e,et=useToastProviderContext(TOAST_NAME,s),[nt,at]=reactExports.useState(null),st=useComposedRefs(i,er=>at(er)),ot=reactExports.useRef(null),pt=reactExports.useRef(null),dt=o||et.duration,wt=reactExports.useRef(0),lt=reactExports.useRef(dt),gt=reactExports.useRef(0),{onToastAdd:vt,onToastRemove:At}=et,yt=useCallbackRef$1(()=>{var zt;(nt==null?void 0:nt.contains(document.activeElement))&&((zt=et.viewport)==null||zt.focus()),d()}),bt=reactExports.useCallback(er=>{!er||er===1/0||(window.clearTimeout(gt.current),wt.current=new Date().getTime(),gt.current=window.setTimeout(yt,er))},[yt]);reactExports.useEffect(()=>{const er=et.viewport;if(er){const zt=()=>{bt(lt.current),_==null||_()},ar=()=>{const Jt=new Date().getTime()-wt.current;lt.current=lt.current-Jt,window.clearTimeout(gt.current),g==null||g()};return er.addEventListener(VIEWPORT_PAUSE,ar),er.addEventListener(VIEWPORT_RESUME,zt),()=>{er.removeEventListener(VIEWPORT_PAUSE,ar),er.removeEventListener(VIEWPORT_RESUME,zt)}}},[et.viewport,dt,g,_,bt]),reactExports.useEffect(()=>{c&&!et.isClosePausedRef.current&&bt(dt)},[c,dt,et.isClosePausedRef,bt]),reactExports.useEffect(()=>(vt(),()=>At()),[vt,At]);const Tt=reactExports.useMemo(()=>nt?getAnnounceTextContent(nt):null,[nt]);return et.viewport?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Tt&&jsxRuntimeExports.jsx(ToastAnnounce,{__scopeToast:s,role:"status","aria-live":a==="foreground"?"assertive":"polite","aria-atomic":!0,children:Tt}),jsxRuntimeExports.jsx(ToastInteractiveProvider,{scope:s,onClose:yt,children:reactDomExports.createPortal(jsxRuntimeExports.jsx(Collection$1.ItemSlot,{scope:s,children:jsxRuntimeExports.jsx(Root$4,{asChild:!0,onEscapeKeyDown:composeEventHandlers$1(h,()=>{et.isFocusedToastEscapeKeyDownRef.current||yt(),et.isFocusedToastEscapeKeyDownRef.current=!1}),children:jsxRuntimeExports.jsx(Primitive.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":c?"open":"closed","data-swipe-direction":et.swipeDirection,...it,ref:st,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:composeEventHandlers$1(e.onKeyDown,er=>{er.key==="Escape"&&(h==null||h(er.nativeEvent),er.nativeEvent.defaultPrevented||(et.isFocusedToastEscapeKeyDownRef.current=!0,yt()))}),onPointerDown:composeEventHandlers$1(e.onPointerDown,er=>{er.button===0&&(ot.current={x:er.clientX,y:er.clientY})}),onPointerMove:composeEventHandlers$1(e.onPointerMove,er=>{if(!ot.current)return;const zt=er.clientX-ot.current.x,ar=er.clientY-ot.current.y,Jt=!!pt.current,Yt=["left","right"].includes(et.swipeDirection),kt=["left","up"].includes(et.swipeDirection)?Math.min:Math.max,ir=Yt?kt(0,zt):0,fr=Yt?0:kt(0,ar),Et=er.pointerType==="touch"?10:2,xt={x:ir,y:fr},mt={originalEvent:er,delta:xt};Jt?(pt.current=xt,handleAndDispatchCustomEvent(TOAST_SWIPE_MOVE,tt,mt,{discrete:!1})):isDeltaInDirection(xt,et.swipeDirection,Et)?(pt.current=xt,handleAndDispatchCustomEvent(TOAST_SWIPE_START,b,mt,{discrete:!1}),er.target.setPointerCapture(er.pointerId)):(Math.abs(zt)>Et||Math.abs(ar)>Et)&&(ot.current=null)}),onPointerUp:composeEventHandlers$1(e.onPointerUp,er=>{const zt=pt.current,ar=er.target;if(ar.hasPointerCapture(er.pointerId)&&ar.releasePointerCapture(er.pointerId),pt.current=null,ot.current=null,zt){const Jt=er.currentTarget,Yt={originalEvent:er,delta:zt};isDeltaInDirection(zt,et.swipeDirection,et.swipeThreshold)?handleAndDispatchCustomEvent(TOAST_SWIPE_END,rt,Yt,{discrete:!0}):handleAndDispatchCustomEvent(TOAST_SWIPE_CANCEL,_e,Yt,{discrete:!0}),Jt.addEventListener("click",kt=>kt.preventDefault(),{once:!0})}})})})}),et.viewport)})]}):null}),ToastAnnounce=e=>{const{__scopeToast:i,children:s,...a}=e,o=useToastProviderContext(TOAST_NAME,i),[c,d]=reactExports.useState(!1),[h,g]=reactExports.useState(!1);return useNextFrame(()=>d(!0)),reactExports.useEffect(()=>{const _=window.setTimeout(()=>g(!0),1e3);return()=>window.clearTimeout(_)},[]),h?null:jsxRuntimeExports.jsx(Portal$2,{asChild:!0,children:jsxRuntimeExports.jsx(VisuallyHidden,{...a,children:c&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[o.label," ",s]})})})},TITLE_NAME="ToastTitle",ToastTitle$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e;return jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i})});ToastTitle$1.displayName=TITLE_NAME;var DESCRIPTION_NAME="ToastDescription",ToastDescription$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e;return jsxRuntimeExports.jsx(Primitive.div,{...a,ref:i})});ToastDescription$1.displayName=DESCRIPTION_NAME;var ACTION_NAME="ToastAction",ToastAction$1=reactExports.forwardRef((e,i)=>{const{altText:s,...a}=e;return s.trim()?jsxRuntimeExports.jsx(ToastAnnounceExclude,{altText:s,asChild:!0,children:jsxRuntimeExports.jsx(ToastClose$1,{...a,ref:i})}):(console.error(`Invalid prop \`altText\` supplied to \`${ACTION_NAME}\`. Expected non-empty \`string\`.`),null)});ToastAction$1.displayName=ACTION_NAME;var CLOSE_NAME$1="ToastClose",ToastClose$1=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,...a}=e,o=useToastInteractiveContext(CLOSE_NAME$1,s);return jsxRuntimeExports.jsx(ToastAnnounceExclude,{asChild:!0,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",...a,ref:i,onClick:composeEventHandlers$1(e.onClick,o.onClose)})})});ToastClose$1.displayName=CLOSE_NAME$1;var ToastAnnounceExclude=reactExports.forwardRef((e,i)=>{const{__scopeToast:s,altText:a,...o}=e;return jsxRuntimeExports.jsx(Primitive.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...o,ref:i})});function getAnnounceTextContent(e){const i=[];return Array.from(e.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&i.push(a.textContent),isHTMLElement$1(a)){const o=a.ariaHidden||a.hidden||a.style.display==="none",c=a.dataset.radixToastAnnounceExclude==="";if(!o)if(c){const d=a.dataset.radixToastAnnounceAlt;d&&i.push(d)}else i.push(...getAnnounceTextContent(a))}}),i}function handleAndDispatchCustomEvent(e,i,s,{discrete:a}){const o=s.originalEvent.currentTarget,c=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:s});i&&o.addEventListener(e,i,{once:!0}),a?dispatchDiscreteCustomEvent(o,c):o.dispatchEvent(c)}var isDeltaInDirection=(e,i,s=0)=>{const a=Math.abs(e.x),o=Math.abs(e.y),c=a>o;return i==="left"||i==="right"?c&&a>s:!c&&o>s};function useNextFrame(e=()=>{}){const i=useCallbackRef$1(e);useLayoutEffect2(()=>{let s=0,a=0;return s=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(i)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(a)}},[i])}function isHTMLElement$1(e){return e.nodeType===e.ELEMENT_NODE}function getTabbableCandidates$1(e){const i=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const o=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||o?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)i.push(s.currentNode);return i}function focusFirst$1(e){const i=document.activeElement;return e.some(s=>s===i?!0:(s.focus(),document.activeElement!==i))}var Provider$1=ToastProvider$1,Viewport$1=ToastViewport$1,Root2$3=Toast$1,Title=ToastTitle$1,Description=ToastDescription$1,Action$1=ToastAction$1,Close=ToastClose$1;function r(e){var i,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(i=0;i<o;i++)e[i]&&(s=r(e[i]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function clsx(){for(var e,i,s=0,a="",o=arguments.length;s<o;s++)(e=arguments[s])&&(i=r(e))&&(a&&(a+=" "),a+=i);return a}const falsyToString=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,cx=clsx,cva=(e,i)=>s=>{var a;if((i==null?void 0:i.variants)==null)return cx(e,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:o,defaultVariants:c}=i,d=Object.keys(o).map(_=>{const b=s==null?void 0:s[_],tt=c==null?void 0:c[_];if(b===null)return null;const _e=falsyToString(b)||falsyToString(tt);return o[_][_e]}),h=s&&Object.entries(s).reduce((_,b)=>{let[tt,_e]=b;return _e===void 0||(_[tt]=_e),_},{}),g=i==null||(a=i.compoundVariants)===null||a===void 0?void 0:a.reduce((_,b)=>{let{class:tt,className:_e,...rt}=b;return Object.entries(rt).every(it=>{let[et,nt]=it;return Array.isArray(nt)?nt.includes({...c,...h}[et]):{...c,...h}[et]===nt})?[..._,tt,_e]:_},[]);return cx(e,d,g,s==null?void 0:s.class,s==null?void 0:s.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((i,s,a)=>!!i&&i.trim()!==""&&a.indexOf(i)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon$1=reactExports.forwardRef(({color:e="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:c,iconNode:d,...h},g)=>reactExports.createElement("svg",{ref:g,...defaultAttributes,width:i,height:i,stroke:e,strokeWidth:a?Number(s)*24/Number(i):s,className:mergeClasses("lucide",o),...h},[...d.map(([_,b])=>reactExports.createElement(_,b)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(e,i)=>{const s=reactExports.forwardRef(({className:a,...o},c)=>reactExports.createElement(Icon$1,{ref:c,iconNode:i,className:mergeClasses(`lucide-${toKebabCase(e)}`,a),...o}));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronDown=createLucideIcon("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronUp=createLucideIcon("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CircleAlert=createLucideIcon("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CircleCheckBig=createLucideIcon("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clock=createLucideIcon("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileSpreadsheet=createLucideIcon("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FileText=createLucideIcon("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Filter=createLucideIcon("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RefreshCw=createLucideIcon("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Search=createLucideIcon("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TriangleAlert=createLucideIcon("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Users=createLucideIcon("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=createLucideIcon("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),CLASS_PART_SEPARATOR="-",createClassGroupUtils=e=>{const i=createClassMap(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:d=>{const h=d.split(CLASS_PART_SEPARATOR);return h[0]===""&&h.length!==1&&h.shift(),getGroupRecursive(h,i)||getGroupIdForArbitraryProperty(d)},getConflictingClassGroupIds:(d,h)=>{const g=s[d]||[];return h&&a[d]?[...g,...a[d]]:g}}},getGroupRecursive=(e,i)=>{var d;if(e.length===0)return i.classGroupId;const s=e[0],a=i.nextPart.get(s),o=a?getGroupRecursive(e.slice(1),a):void 0;if(o)return o;if(i.validators.length===0)return;const c=e.join(CLASS_PART_SEPARATOR);return(d=i.validators.find(({validator:h})=>h(c)))==null?void 0:d.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=e=>{if(arbitraryPropertyRegex.test(e)){const i=arbitraryPropertyRegex.exec(e)[1],s=i==null?void 0:i.substring(0,i.indexOf(":"));if(s)return"arbitrary.."+s}},createClassMap=e=>{const{theme:i,prefix:s}=e,a={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(e.classGroups),s).forEach(([c,d])=>{processClassesRecursively(d,a,c,i)}),a},processClassesRecursively=(e,i,s,a)=>{e.forEach(o=>{if(typeof o=="string"){const c=o===""?i:getPart(i,o);c.classGroupId=s;return}if(typeof o=="function"){if(isThemeGetter(o)){processClassesRecursively(o(a),i,s,a);return}i.validators.push({validator:o,classGroupId:s});return}Object.entries(o).forEach(([c,d])=>{processClassesRecursively(d,getPart(i,c),s,a)})})},getPart=(e,i)=>{let s=e;return i.split(CLASS_PART_SEPARATOR).forEach(a=>{s.nextPart.has(a)||s.nextPart.set(a,{nextPart:new Map,validators:[]}),s=s.nextPart.get(a)}),s},isThemeGetter=e=>e.isThemeGetter,getPrefixedClassGroupEntries=(e,i)=>i?e.map(([s,a])=>{const o=a.map(c=>typeof c=="string"?i+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([d,h])=>[i+d,h])):c);return[s,o]}):e,createLruCache=e=>{if(e<1)return{get:()=>{},set:()=>{}};let i=0,s=new Map,a=new Map;const o=(c,d)=>{s.set(c,d),i++,i>e&&(i=0,a=s,s=new Map)};return{get(c){let d=s.get(c);if(d!==void 0)return d;if((d=a.get(c))!==void 0)return o(c,d),d},set(c,d){s.has(c)?s.set(c,d):o(c,d)}}},IMPORTANT_MODIFIER="!",createParseClassName=e=>{const{separator:i,experimentalParseClassName:s}=e,a=i.length===1,o=i[0],c=i.length,d=h=>{const g=[];let _=0,b=0,tt;for(let nt=0;nt<h.length;nt++){let at=h[nt];if(_===0){if(at===o&&(a||h.slice(nt,nt+c)===i)){g.push(h.slice(b,nt)),b=nt+c;continue}if(at==="/"){tt=nt;continue}}at==="["?_++:at==="]"&&_--}const _e=g.length===0?h:h.substring(b),rt=_e.startsWith(IMPORTANT_MODIFIER),it=rt?_e.substring(1):_e,et=tt&&tt>b?tt-b:void 0;return{modifiers:g,hasImportantModifier:rt,baseClassName:it,maybePostfixModifierPosition:et}};return s?h=>s({className:h,parseClassName:d}):d},sortModifiers=e=>{if(e.length<=1)return e;const i=[];let s=[];return e.forEach(a=>{a[0]==="["?(i.push(...s.sort(),a),s=[]):s.push(a)}),i.push(...s.sort()),i},createConfigUtils=e=>({cache:createLruCache(e.cacheSize),parseClassName:createParseClassName(e),...createClassGroupUtils(e)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(e,i)=>{const{parseClassName:s,getClassGroupId:a,getConflictingClassGroupIds:o}=i,c=[],d=e.trim().split(SPLIT_CLASSES_REGEX);let h="";for(let g=d.length-1;g>=0;g-=1){const _=d[g],{modifiers:b,hasImportantModifier:tt,baseClassName:_e,maybePostfixModifierPosition:rt}=s(_);let it=!!rt,et=a(it?_e.substring(0,rt):_e);if(!et){if(!it){h=_+(h.length>0?" "+h:h);continue}if(et=a(_e),!et){h=_+(h.length>0?" "+h:h);continue}it=!1}const nt=sortModifiers(b).join(":"),at=tt?nt+IMPORTANT_MODIFIER:nt,st=at+et;if(c.includes(st))continue;c.push(st);const ot=o(et,it);for(let pt=0;pt<ot.length;++pt){const dt=ot[pt];c.push(at+dt)}h=_+(h.length>0?" "+h:h)}return h};function twJoin(){let e=0,i,s,a="";for(;e<arguments.length;)(i=arguments[e++])&&(s=toValue(i))&&(a&&(a+=" "),a+=s);return a}const toValue=e=>{if(typeof e=="string")return e;let i,s="";for(let a=0;a<e.length;a++)e[a]&&(i=toValue(e[a]))&&(s&&(s+=" "),s+=i);return s};function createTailwindMerge(e,...i){let s,a,o,c=d;function d(g){const _=i.reduce((b,tt)=>tt(b),e());return s=createConfigUtils(_),a=s.cache.get,o=s.cache.set,c=h,h(g)}function h(g){const _=a(g);if(_)return _;const b=mergeClassList(g,s);return o(g,b),b}return function(){return c(twJoin.apply(null,arguments))}}const fromTheme=e=>{const i=s=>s[e]||[];return i.isThemeGetter=!0,i},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=e=>isNumber$1(e)||stringLengths.has(e)||fractionRegex.test(e),isArbitraryLength=e=>getIsArbitraryValue(e,"length",isLengthOnly),isNumber$1=e=>!!e&&!Number.isNaN(Number(e)),isArbitraryNumber=e=>getIsArbitraryValue(e,"number",isNumber$1),isInteger=e=>!!e&&Number.isInteger(Number(e)),isPercent=e=>e.endsWith("%")&&isNumber$1(e.slice(0,-1)),isArbitraryValue=e=>arbitraryValueRegex.test(e),isTshirtSize=e=>tshirtUnitRegex.test(e),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=e=>getIsArbitraryValue(e,sizeLabels,isNever),isArbitraryPosition=e=>getIsArbitraryValue(e,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=e=>getIsArbitraryValue(e,imageLabels,isImage),isArbitraryShadow=e=>getIsArbitraryValue(e,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(e,i,s)=>{const a=arbitraryValueRegex.exec(e);return a?a[1]?typeof i=="string"?a[1]===i:i.has(a[1]):s(a[2]):!1},isLengthOnly=e=>lengthUnitRegex.test(e)&&!colorFunctionRegex.test(e),isNever=()=>!1,isShadow=e=>shadowRegex.test(e),isImage=e=>imageRegex.test(e),getDefaultConfig=()=>{const e=fromTheme("colors"),i=fromTheme("spacing"),s=fromTheme("blur"),a=fromTheme("brightness"),o=fromTheme("borderColor"),c=fromTheme("borderRadius"),d=fromTheme("borderSpacing"),h=fromTheme("borderWidth"),g=fromTheme("contrast"),_=fromTheme("grayscale"),b=fromTheme("hueRotate"),tt=fromTheme("invert"),_e=fromTheme("gap"),rt=fromTheme("gradientColorStops"),it=fromTheme("gradientColorStopPositions"),et=fromTheme("inset"),nt=fromTheme("margin"),at=fromTheme("opacity"),st=fromTheme("padding"),ot=fromTheme("saturate"),pt=fromTheme("scale"),dt=fromTheme("sepia"),wt=fromTheme("skew"),lt=fromTheme("space"),gt=fromTheme("translate"),vt=()=>["auto","contain","none"],At=()=>["auto","hidden","clip","visible","scroll"],yt=()=>["auto",isArbitraryValue,i],bt=()=>[isArbitraryValue,i],Tt=()=>["",isLength,isArbitraryLength],er=()=>["auto",isNumber$1,isArbitraryValue],zt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ar=()=>["solid","dashed","dotted","double","none"],Jt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Yt=()=>["start","end","center","between","around","evenly","stretch"],kt=()=>["","0",isArbitraryValue],ir=()=>["auto","avoid","all","avoid-page","page","left","right","column"],fr=()=>[isNumber$1,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:fr(),borderColor:[e],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:bt(),borderWidth:Tt(),contrast:fr(),grayscale:kt(),hueRotate:fr(),invert:kt(),gap:bt(),gradientColorStops:[e],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:yt(),margin:yt(),opacity:fr(),padding:bt(),saturate:fr(),scale:fr(),sepia:kt(),skew:fr(),space:bt(),translate:bt()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":ir()}],"break-before":[{"break-before":ir()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...zt(),isArbitraryValue]}],overflow:[{overflow:At()}],"overflow-x":[{"overflow-x":At()}],"overflow-y":[{"overflow-y":At()}],overscroll:[{overscroll:vt()}],"overscroll-x":[{"overscroll-x":vt()}],"overscroll-y":[{"overscroll-y":vt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[et]}],"inset-x":[{"inset-x":[et]}],"inset-y":[{"inset-y":[et]}],start:[{start:[et]}],end:[{end:[et]}],top:[{top:[et]}],right:[{right:[et]}],bottom:[{bottom:[et]}],left:[{left:[et]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:yt()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:kt()}],shrink:[{shrink:kt()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":er()}],"col-end":[{"col-end":er()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":er()}],"row-end":[{"row-end":er()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[_e]}],"gap-x":[{"gap-x":[_e]}],"gap-y":[{"gap-y":[_e]}],"justify-content":[{justify:["normal",...Yt()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Yt(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Yt(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[st]}],px:[{px:[st]}],py:[{py:[st]}],ps:[{ps:[st]}],pe:[{pe:[st]}],pt:[{pt:[st]}],pr:[{pr:[st]}],pb:[{pb:[st]}],pl:[{pl:[st]}],m:[{m:[nt]}],mx:[{mx:[nt]}],my:[{my:[nt]}],ms:[{ms:[nt]}],me:[{me:[nt]}],mt:[{mt:[nt]}],mr:[{mr:[nt]}],mb:[{mb:[nt]}],ml:[{ml:[nt]}],"space-x":[{"space-x":[lt]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[lt]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,i]}],"min-w":[{"min-w":[isArbitraryValue,i,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,i,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,i,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,i,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,i,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,i,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber$1,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[at]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[at]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ar(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:bt()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[at]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...zt(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[it]}],"gradient-via-pos":[{via:[it]}],"gradient-to-pos":[{to:[it]}],"gradient-from":[{from:[rt]}],"gradient-via":[{via:[rt]}],"gradient-to":[{to:[rt]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[h]}],"border-w-x":[{"border-x":[h]}],"border-w-y":[{"border-y":[h]}],"border-w-s":[{"border-s":[h]}],"border-w-e":[{"border-e":[h]}],"border-w-t":[{"border-t":[h]}],"border-w-r":[{"border-r":[h]}],"border-w-b":[{"border-b":[h]}],"border-w-l":[{"border-l":[h]}],"border-opacity":[{"border-opacity":[at]}],"border-style":[{border:[...ar(),"hidden"]}],"divide-x":[{"divide-x":[h]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[h]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[at]}],"divide-style":[{divide:ar()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...ar()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Tt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[at]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[at]}],"mix-blend":[{"mix-blend":[...Jt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Jt()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[a]}],contrast:[{contrast:[g]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[_]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[tt]}],saturate:[{saturate:[ot]}],sepia:[{sepia:[dt]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[g]}],"backdrop-grayscale":[{"backdrop-grayscale":[_]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[tt]}],"backdrop-opacity":[{"backdrop-opacity":[at]}],"backdrop-saturate":[{"backdrop-saturate":[ot]}],"backdrop-sepia":[{"backdrop-sepia":[dt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:fr()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:fr()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[pt]}],"scale-x":[{"scale-x":[pt]}],"scale-y":[{"scale-y":[pt]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[gt]}],"translate-y":[{"translate-y":[gt]}],"skew-x":[{"skew-x":[wt]}],"skew-y":[{"skew-y":[wt]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":bt()}],"scroll-mx":[{"scroll-mx":bt()}],"scroll-my":[{"scroll-my":bt()}],"scroll-ms":[{"scroll-ms":bt()}],"scroll-me":[{"scroll-me":bt()}],"scroll-mt":[{"scroll-mt":bt()}],"scroll-mr":[{"scroll-mr":bt()}],"scroll-mb":[{"scroll-mb":bt()}],"scroll-ml":[{"scroll-ml":bt()}],"scroll-p":[{"scroll-p":bt()}],"scroll-px":[{"scroll-px":bt()}],"scroll-py":[{"scroll-py":bt()}],"scroll-ps":[{"scroll-ps":bt()}],"scroll-pe":[{"scroll-pe":bt()}],"scroll-pt":[{"scroll-pt":bt()}],"scroll-pr":[{"scroll-pr":bt()}],"scroll-pb":[{"scroll-pb":bt()}],"scroll-pl":[{"scroll-pl":bt()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...e){return twMerge(clsx(e))}const ToastProvider=Provider$1,ToastViewport=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Viewport$1,{ref:s,className:cn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...i}));ToastViewport.displayName=Viewport$1.displayName;const toastVariants=cva("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Toast=reactExports.forwardRef(({className:e,variant:i,...s},a)=>jsxRuntimeExports.jsx(Root2$3,{ref:a,className:cn(toastVariants({variant:i}),e),...s}));Toast.displayName=Root2$3.displayName;const ToastAction=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Action$1,{ref:s,className:cn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...i}));ToastAction.displayName=Action$1.displayName;const ToastClose=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Close,{ref:s,className:cn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...i,children:jsxRuntimeExports.jsx(X,{className:"h-4 w-4"})}));ToastClose.displayName=Close.displayName;const ToastTitle=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Title,{ref:s,className:cn("text-sm font-semibold",e),...i}));ToastTitle.displayName=Title.displayName;const ToastDescription=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Description,{ref:s,className:cn("text-sm opacity-90",e),...i}));ToastDescription.displayName=Description.displayName;function Toaster$1(){const{toasts:e}=useToast();return jsxRuntimeExports.jsxs(ToastProvider,{children:[e.map(function({id:i,title:s,description:a,action:o,...c}){return jsxRuntimeExports.jsxs(Toast,{...c,children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-1",children:[s&&jsxRuntimeExports.jsx(ToastTitle,{children:s}),a&&jsxRuntimeExports.jsx(ToastDescription,{children:a})]}),o,jsxRuntimeExports.jsx(ToastClose,{})]},i)}),jsxRuntimeExports.jsx(ToastViewport,{})]})}var P=["light","dark"],E="(prefers-color-scheme: dark)",L=reactExports.createContext(void 0),D={setTheme:e=>{},themes:[]},j=()=>{var e;return(e=reactExports.useContext(L))!=null?e:D};reactExports.memo(({forcedTheme:e,storageKey:i,attribute:s,enableSystem:a,enableColorScheme:o,defaultTheme:c,value:d,attrs:h,nonce:g})=>{let _=c==="system",b=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${h.map(it=>`'${it}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,tt=o?P.includes(c)&&c?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${c}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",_e=(it,et=!1,nt=!0)=>{let at=d?d[it]:it,st=et?it+"|| ''":`'${at}'`,ot="";return o&&nt&&!et&&P.includes(it)&&(ot+=`d.style.colorScheme = '${it}';`),s==="class"?et||at?ot+=`c.add(${st})`:ot+="null":at&&(ot+=`d[s](n,${st})`),ot},rt=e?`!function(){${b}${_e(e)}}()`:a?`!function(){try{${b}var e=localStorage.getItem('${i}');if('system'===e||(!e&&${_})){var t='${E}',m=window.matchMedia(t);if(m.media!==t||m.matches){${_e("dark")}}else{${_e("light")}}}else if(e){${d?`var x=${JSON.stringify(d)};`:""}${_e(d?"x[e]":"e",!0)}}${_?"":"else{"+_e(c,!1,!1)+"}"}${tt}}catch(e){}}()`:`!function(){try{${b}var e=localStorage.getItem('${i}');if(e){${d?`var x=${JSON.stringify(d)};`:""}${_e(d?"x[e]":"e",!0)}}else{${_e(c,!1,!1)};}${tt}}catch(t){}}();`;return reactExports.createElement("script",{nonce:g,dangerouslySetInnerHTML:{__html:rt}})});var Ct=e=>{switch(e){case"success":return $t;case"info":return _t;case"warning":return Wt;case"error":return Ut;default:return null}},Ft=Array(12).fill(0),It=({visible:e})=>React.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},React.createElement("div",{className:"sonner-spinner"},Ft.map((i,s)=>React.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),$t=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Wt=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),_t=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ut=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Dt=()=>{let[e,i]=React.useState(document.hidden);return React.useEffect(()=>{let s=()=>{i(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),e},ct=1,ut=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let i=this.subscribers.indexOf(e);this.subscribers.splice(i,1)}),this.publish=e=>{this.subscribers.forEach(i=>i(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var i;let{message:s,...a}=e,o=typeof(e==null?void 0:e.id)=="number"||((i=e.id)==null?void 0:i.length)>0?e.id:ct++,c=this.toasts.find(h=>h.id===o),d=e.dismissible===void 0?!0:e.dismissible;return c?this.toasts=this.toasts.map(h=>h.id===o?(this.publish({...h,...e,id:o,title:s}),{...h,...e,id:o,dismissible:d,title:s}):h):this.addToast({title:s,...a,dismissible:d,id:o}),o},this.dismiss=e=>(e||this.toasts.forEach(i=>{this.subscribers.forEach(s=>s({id:i.id,dismiss:!0}))}),this.subscribers.forEach(i=>i({id:e,dismiss:!0})),e),this.message=(e,i)=>this.create({...i,message:e}),this.error=(e,i)=>this.create({...i,message:e,type:"error"}),this.success=(e,i)=>this.create({...i,type:"success",message:e}),this.info=(e,i)=>this.create({...i,type:"info",message:e}),this.warning=(e,i)=>this.create({...i,type:"warning",message:e}),this.loading=(e,i)=>this.create({...i,type:"loading",message:e}),this.promise=(e,i)=>{if(!i)return;let s;i.loading!==void 0&&(s=this.create({...i,promise:e,type:"loading",message:i.loading,description:typeof i.description!="function"?i.description:void 0}));let a=e instanceof Promise?e:e(),o=s!==void 0;return a.then(async c=>{if(Ot(c)&&!c.ok){o=!1;let d=typeof i.error=="function"?await i.error(`HTTP error! status: ${c.status}`):i.error,h=typeof i.description=="function"?await i.description(`HTTP error! status: ${c.status}`):i.description;this.create({id:s,type:"error",message:d,description:h})}else if(i.success!==void 0){o=!1;let d=typeof i.success=="function"?await i.success(c):i.success,h=typeof i.description=="function"?await i.description(c):i.description;this.create({id:s,type:"success",message:d,description:h})}}).catch(async c=>{if(i.error!==void 0){o=!1;let d=typeof i.error=="function"?await i.error(c):i.error,h=typeof i.description=="function"?await i.description(c):i.description;this.create({id:s,type:"error",message:d,description:h})}}).finally(()=>{var c;o&&(this.dismiss(s),s=void 0),(c=i.finally)==null||c.call(i)}),s},this.custom=(e,i)=>{let s=(i==null?void 0:i.id)||ct++;return this.create({jsx:e(s),id:s,...i}),s},this.subscribers=[],this.toasts=[]}},v=new ut,Vt=(e,i)=>{let s=(i==null?void 0:i.id)||ct++;return v.addToast({title:e,...i,id:s}),s},Ot=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Kt=Vt,Xt=()=>v.toasts;Object.assign(Kt,{success:v.success,info:v.info,warning:v.warning,error:v.error,custom:v.custom,message:v.message,promise:v.promise,dismiss:v.dismiss,loading:v.loading},{getHistory:Xt});function ft(e,{insertAt:i}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}ft(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function U(e){return e.label!==void 0}var qt=3,Qt="32px",Zt=4e3,te=356,ee=14,oe=20,ae=200;function ne(...e){return e.filter(Boolean).join(" ")}var se=e=>{var i,s,a,o,c,d,h,g,_,b;let{invert:tt,toast:_e,unstyled:rt,interacting:it,setHeights:et,visibleToasts:nt,heights:at,index:st,toasts:ot,expanded:pt,removeToast:dt,defaultRichColors:wt,closeButton:lt,style:gt,cancelButtonStyle:vt,actionButtonStyle:At,className:yt="",descriptionClassName:bt="",duration:Tt,position:er,gap:zt,loadingIcon:ar,expandByDefault:Jt,classNames:Yt,icons:kt,closeButtonAriaLabel:ir="Close toast",pauseWhenPageIsHidden:fr,cn:Et}=e,[xt,mt]=React.useState(!1),[St,Pt]=React.useState(!1),[Nt,Lt]=React.useState(!1),[lr,ur]=React.useState(!1),[wr,vr]=React.useState(0),[Fr,Rr]=React.useState(0),jr=React.useRef(null),xr=React.useRef(null),hr=st===0,jt=st+1<=nt,sr=_e.type,_r=_e.dismissible!==!1,Ar=_e.className||"",Mr=_e.descriptionClassName||"",Ur=React.useMemo(()=>at.findIndex(Hr=>Hr.toastId===_e.id)||0,[at,_e.id]),Er=React.useMemo(()=>{var Hr;return(Hr=_e.closeButton)!=null?Hr:lt},[_e.closeButton,lt]),pr=React.useMemo(()=>_e.duration||Tt||Zt,[_e.duration,Tt]),Wr=React.useRef(0),zr=React.useRef(0),en=React.useRef(0),sn=React.useRef(null),[dn,Kr]=er.split("-"),tn=React.useMemo(()=>at.reduce((Hr,an,rn)=>rn>=Ur?Hr:Hr+an.height,0),[at,Ur]),fn=Dt(),hn=_e.invert||tt,Br=sr==="loading";zr.current=React.useMemo(()=>Ur*zt+tn,[Ur,tn]),React.useEffect(()=>{mt(!0)},[]),React.useLayoutEffect(()=>{if(!xt)return;let Hr=xr.current,an=Hr.style.height;Hr.style.height="auto";let rn=Hr.getBoundingClientRect().height;Hr.style.height=an,Rr(rn),et(dr=>dr.find(Nr=>Nr.toastId===_e.id)?dr.map(Nr=>Nr.toastId===_e.id?{...Nr,height:rn}:Nr):[{toastId:_e.id,height:rn,position:_e.position},...dr])},[xt,_e.title,_e.description,et,_e.id]);let br=React.useCallback(()=>{Pt(!0),vr(zr.current),et(Hr=>Hr.filter(an=>an.toastId!==_e.id)),setTimeout(()=>{dt(_e)},ae)},[_e,dt,et,zr]);React.useEffect(()=>{if(_e.promise&&sr==="loading"||_e.duration===1/0||_e.type==="loading")return;let Hr,an=pr;return pt||it||fr&&fn?(()=>{if(en.current<Wr.current){let rn=new Date().getTime()-Wr.current;an=an-rn}en.current=new Date().getTime()})():an!==1/0&&(Wr.current=new Date().getTime(),Hr=setTimeout(()=>{var rn;(rn=_e.onAutoClose)==null||rn.call(_e,_e),br()},an)),()=>clearTimeout(Hr)},[pt,it,Jt,_e,pr,br,_e.promise,sr,fr,fn]),React.useEffect(()=>{let Hr=xr.current;if(Hr){let an=Hr.getBoundingClientRect().height;return Rr(an),et(rn=>[{toastId:_e.id,height:an,position:_e.position},...rn]),()=>et(rn=>rn.filter(dr=>dr.toastId!==_e.id))}},[et,_e.id]),React.useEffect(()=>{_e.delete&&br()},[br,_e.delete]);function Cr(){return kt!=null&&kt.loading?React.createElement("div",{className:"sonner-loader","data-visible":sr==="loading"},kt.loading):ar?React.createElement("div",{className:"sonner-loader","data-visible":sr==="loading"},ar):React.createElement(It,{visible:sr==="loading"})}return React.createElement("li",{"aria-live":_e.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:xr,className:Et(yt,Ar,Yt==null?void 0:Yt.toast,(i=_e==null?void 0:_e.classNames)==null?void 0:i.toast,Yt==null?void 0:Yt.default,Yt==null?void 0:Yt[sr],(s=_e==null?void 0:_e.classNames)==null?void 0:s[sr]),"data-sonner-toast":"","data-rich-colors":(a=_e.richColors)!=null?a:wt,"data-styled":!(_e.jsx||_e.unstyled||rt),"data-mounted":xt,"data-promise":!!_e.promise,"data-removed":St,"data-visible":jt,"data-y-position":dn,"data-x-position":Kr,"data-index":st,"data-front":hr,"data-swiping":Nt,"data-dismissible":_r,"data-type":sr,"data-invert":hn,"data-swipe-out":lr,"data-expanded":!!(pt||Jt&&xt),style:{"--index":st,"--toasts-before":st,"--z-index":ot.length-st,"--offset":`${St?wr:zr.current}px`,"--initial-height":Jt?"auto":`${Fr}px`,...gt,..._e.style},onPointerDown:Hr=>{Br||!_r||(jr.current=new Date,vr(zr.current),Hr.target.setPointerCapture(Hr.pointerId),Hr.target.tagName!=="BUTTON"&&(Lt(!0),sn.current={x:Hr.clientX,y:Hr.clientY}))},onPointerUp:()=>{var Hr,an,rn,dr;if(lr||!_r)return;sn.current=null;let Nr=Number(((Hr=xr.current)==null?void 0:Hr.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Xr=new Date().getTime()-((an=jr.current)==null?void 0:an.getTime()),Jr=Math.abs(Nr)/Xr;if(Math.abs(Nr)>=oe||Jr>.11){vr(zr.current),(rn=_e.onDismiss)==null||rn.call(_e,_e),br(),ur(!0);return}(dr=xr.current)==null||dr.style.setProperty("--swipe-amount","0px"),Lt(!1)},onPointerMove:Hr=>{var an;if(!sn.current||!_r)return;let rn=Hr.clientY-sn.current.y,dr=Hr.clientX-sn.current.x,Nr=(dn==="top"?Math.min:Math.max)(0,rn),Xr=Hr.pointerType==="touch"?10:2;Math.abs(Nr)>Xr?(an=xr.current)==null||an.style.setProperty("--swipe-amount",`${rn}px`):Math.abs(dr)>Xr&&(sn.current=null)}},Er&&!_e.jsx?React.createElement("button",{"aria-label":ir,"data-disabled":Br,"data-close-button":!0,onClick:Br||!_r?()=>{}:()=>{var Hr;br(),(Hr=_e.onDismiss)==null||Hr.call(_e,_e)},className:Et(Yt==null?void 0:Yt.closeButton,(o=_e==null?void 0:_e.classNames)==null?void 0:o.closeButton)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),React.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,_e.jsx||React.isValidElement(_e.title)?_e.jsx||_e.title:React.createElement(React.Fragment,null,sr||_e.icon||_e.promise?React.createElement("div",{"data-icon":"",className:Et(Yt==null?void 0:Yt.icon,(c=_e==null?void 0:_e.classNames)==null?void 0:c.icon)},_e.promise||_e.type==="loading"&&!_e.icon?_e.icon||Cr():null,_e.type!=="loading"?_e.icon||(kt==null?void 0:kt[sr])||Ct(sr):null):null,React.createElement("div",{"data-content":"",className:Et(Yt==null?void 0:Yt.content,(d=_e==null?void 0:_e.classNames)==null?void 0:d.content)},React.createElement("div",{"data-title":"",className:Et(Yt==null?void 0:Yt.title,(h=_e==null?void 0:_e.classNames)==null?void 0:h.title)},_e.title),_e.description?React.createElement("div",{"data-description":"",className:Et(bt,Mr,Yt==null?void 0:Yt.description,(g=_e==null?void 0:_e.classNames)==null?void 0:g.description)},_e.description):null),React.isValidElement(_e.cancel)?_e.cancel:_e.cancel&&U(_e.cancel)?React.createElement("button",{"data-button":!0,"data-cancel":!0,style:_e.cancelButtonStyle||vt,onClick:Hr=>{var an,rn;U(_e.cancel)&&_r&&((rn=(an=_e.cancel).onClick)==null||rn.call(an,Hr),br())},className:Et(Yt==null?void 0:Yt.cancelButton,(_=_e==null?void 0:_e.classNames)==null?void 0:_.cancelButton)},_e.cancel.label):null,React.isValidElement(_e.action)?_e.action:_e.action&&U(_e.action)?React.createElement("button",{"data-button":!0,"data-action":!0,style:_e.actionButtonStyle||At,onClick:Hr=>{var an,rn;U(_e.action)&&(Hr.defaultPrevented||((rn=(an=_e.action).onClick)==null||rn.call(an,Hr),br()))},className:Et(Yt==null?void 0:Yt.actionButton,(b=_e==null?void 0:_e.classNames)==null?void 0:b.actionButton)},_e.action.label):null))};function Ht(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var Te=e=>{let{invert:i,position:s="bottom-right",hotkey:a=["altKey","KeyT"],expand:o,closeButton:c,className:d,offset:h,theme:g="light",richColors:_,duration:b,style:tt,visibleToasts:_e=qt,toastOptions:rt,dir:it=Ht(),gap:et=ee,loadingIcon:nt,icons:at,containerAriaLabel:st="Notifications",pauseWhenPageIsHidden:ot,cn:pt=ne}=e,[dt,wt]=React.useState([]),lt=React.useMemo(()=>Array.from(new Set([s].concat(dt.filter(fr=>fr.position).map(fr=>fr.position)))),[dt,s]),[gt,vt]=React.useState([]),[At,yt]=React.useState(!1),[bt,Tt]=React.useState(!1),[er,zt]=React.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ar=React.useRef(null),Jt=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),Yt=React.useRef(null),kt=React.useRef(!1),ir=React.useCallback(fr=>{var Et;(Et=dt.find(xt=>xt.id===fr.id))!=null&&Et.delete||v.dismiss(fr.id),wt(xt=>xt.filter(({id:mt})=>mt!==fr.id))},[dt]);return React.useEffect(()=>v.subscribe(fr=>{if(fr.dismiss){wt(Et=>Et.map(xt=>xt.id===fr.id?{...xt,delete:!0}:xt));return}setTimeout(()=>{Gt.flushSync(()=>{wt(Et=>{let xt=Et.findIndex(mt=>mt.id===fr.id);return xt!==-1?[...Et.slice(0,xt),{...Et[xt],...fr},...Et.slice(xt+1)]:[fr,...Et]})})})}),[]),React.useEffect(()=>{if(g!=="system"){zt(g);return}g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?zt("dark"):zt("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:fr})=>{zt(fr?"dark":"light")})},[g]),React.useEffect(()=>{dt.length<=1&&yt(!1)},[dt]),React.useEffect(()=>{let fr=Et=>{var xt,mt;a.every(St=>Et[St]||Et.code===St)&&(yt(!0),(xt=ar.current)==null||xt.focus()),Et.code==="Escape"&&(document.activeElement===ar.current||(mt=ar.current)!=null&&mt.contains(document.activeElement))&&yt(!1)};return document.addEventListener("keydown",fr),()=>document.removeEventListener("keydown",fr)},[a]),React.useEffect(()=>{if(ar.current)return()=>{Yt.current&&(Yt.current.focus({preventScroll:!0}),Yt.current=null,kt.current=!1)}},[ar.current]),dt.length?React.createElement("section",{"aria-label":`${st} ${Jt}`,tabIndex:-1},lt.map((fr,Et)=>{var xt;let[mt,St]=fr.split("-");return React.createElement("ol",{key:fr,dir:it==="auto"?Ht():it,tabIndex:-1,ref:ar,className:d,"data-sonner-toaster":!0,"data-theme":er,"data-y-position":mt,"data-x-position":St,style:{"--front-toast-height":`${((xt=gt[0])==null?void 0:xt.height)||0}px`,"--offset":typeof h=="number"?`${h}px`:h||Qt,"--width":`${te}px`,"--gap":`${et}px`,...tt},onBlur:Pt=>{kt.current&&!Pt.currentTarget.contains(Pt.relatedTarget)&&(kt.current=!1,Yt.current&&(Yt.current.focus({preventScroll:!0}),Yt.current=null))},onFocus:Pt=>{Pt.target instanceof HTMLElement&&Pt.target.dataset.dismissible==="false"||kt.current||(kt.current=!0,Yt.current=Pt.relatedTarget)},onMouseEnter:()=>yt(!0),onMouseMove:()=>yt(!0),onMouseLeave:()=>{bt||yt(!1)},onPointerDown:Pt=>{Pt.target instanceof HTMLElement&&Pt.target.dataset.dismissible==="false"||Tt(!0)},onPointerUp:()=>Tt(!1)},dt.filter(Pt=>!Pt.position&&Et===0||Pt.position===fr).map((Pt,Nt)=>{var Lt,lr;return React.createElement(se,{key:Pt.id,icons:at,index:Nt,toast:Pt,defaultRichColors:_,duration:(Lt=rt==null?void 0:rt.duration)!=null?Lt:b,className:rt==null?void 0:rt.className,descriptionClassName:rt==null?void 0:rt.descriptionClassName,invert:i,visibleToasts:_e,closeButton:(lr=rt==null?void 0:rt.closeButton)!=null?lr:c,interacting:bt,position:fr,style:rt==null?void 0:rt.style,unstyled:rt==null?void 0:rt.unstyled,classNames:rt==null?void 0:rt.classNames,cancelButtonStyle:rt==null?void 0:rt.cancelButtonStyle,actionButtonStyle:rt==null?void 0:rt.actionButtonStyle,removeToast:ir,toasts:dt.filter(ur=>ur.position==Pt.position),heights:gt.filter(ur=>ur.position==Pt.position),setHeights:vt,expandByDefault:o,gap:et,loadingIcon:nt,expanded:At,pauseWhenPageIsHidden:ot,cn:pt})}))})):null};const Toaster=({...e})=>{const{theme:i="system"}=j();return jsxRuntimeExports.jsx(Te,{theme:i,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var useReactId=React$1.useId||(()=>{}),count$1=0;function useId(e){const[i,s]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{s(a=>a??String(count$1++))},[e]),i?`radix-${i}`:""}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=e=>({x:e,y:e}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$1(e,i,s){return max(e,min(i,s))}function evaluate(e,i){return typeof e=="function"?e(i):e}function getSide(e){return e.split("-")[0]}function getAlignment(e){return e.split("-")[1]}function getOppositeAxis(e){return e==="x"?"y":"x"}function getAxisLength(e){return e==="y"?"height":"width"}function getSideAxis(e){return["top","bottom"].includes(getSide(e))?"y":"x"}function getAlignmentAxis(e){return getOppositeAxis(getSideAxis(e))}function getAlignmentSides(e,i,s){s===void 0&&(s=!1);const a=getAlignment(e),o=getAlignmentAxis(e),c=getAxisLength(o);let d=o==="x"?a===(s?"end":"start")?"right":"left":a==="start"?"bottom":"top";return i.reference[c]>i.floating[c]&&(d=getOppositePlacement(d)),[d,getOppositePlacement(d)]}function getExpandedPlacements(e){const i=getOppositePlacement(e);return[getOppositeAlignmentPlacement(e),i,getOppositeAlignmentPlacement(i)]}function getOppositeAlignmentPlacement(e){return e.replace(/start|end/g,i=>oppositeAlignmentMap[i])}function getSideList(e,i,s){const a=["left","right"],o=["right","left"],c=["top","bottom"],d=["bottom","top"];switch(e){case"top":case"bottom":return s?i?o:a:i?a:o;case"left":case"right":return i?c:d;default:return[]}}function getOppositeAxisPlacements(e,i,s,a){const o=getAlignment(e);let c=getSideList(getSide(e),s==="start",a);return o&&(c=c.map(d=>d+"-"+o),i&&(c=c.concat(c.map(getOppositeAlignmentPlacement)))),c}function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,i=>oppositeSideMap[i])}function expandPaddingObject(e){return{top:0,right:0,bottom:0,left:0,...e}}function getPaddingObject(e){return typeof e!="number"?expandPaddingObject(e):{top:e,right:e,bottom:e,left:e}}function rectToClientRect(e){const{x:i,y:s,width:a,height:o}=e;return{width:a,height:o,top:s,left:i,right:i+a,bottom:s+o,x:i,y:s}}function computeCoordsFromPlacement(e,i,s){let{reference:a,floating:o}=e;const c=getSideAxis(i),d=getAlignmentAxis(i),h=getAxisLength(d),g=getSide(i),_=c==="y",b=a.x+a.width/2-o.width/2,tt=a.y+a.height/2-o.height/2,_e=a[h]/2-o[h]/2;let rt;switch(g){case"top":rt={x:b,y:a.y-o.height};break;case"bottom":rt={x:b,y:a.y+a.height};break;case"right":rt={x:a.x+a.width,y:tt};break;case"left":rt={x:a.x-o.width,y:tt};break;default:rt={x:a.x,y:a.y}}switch(getAlignment(i)){case"start":rt[d]-=_e*(s&&_?-1:1);break;case"end":rt[d]+=_e*(s&&_?-1:1);break}return rt}const computePosition$1=async(e,i,s)=>{const{placement:a="bottom",strategy:o="absolute",middleware:c=[],platform:d}=s,h=c.filter(Boolean),g=await(d.isRTL==null?void 0:d.isRTL(i));let _=await d.getElementRects({reference:e,floating:i,strategy:o}),{x:b,y:tt}=computeCoordsFromPlacement(_,a,g),_e=a,rt={},it=0;for(let et=0;et<h.length;et++){const{name:nt,fn:at}=h[et],{x:st,y:ot,data:pt,reset:dt}=await at({x:b,y:tt,initialPlacement:a,placement:_e,strategy:o,middlewareData:rt,rects:_,platform:d,elements:{reference:e,floating:i}});b=st??b,tt=ot??tt,rt={...rt,[nt]:{...rt[nt],...pt}},dt&&it<=50&&(it++,typeof dt=="object"&&(dt.placement&&(_e=dt.placement),dt.rects&&(_=dt.rects===!0?await d.getElementRects({reference:e,floating:i,strategy:o}):dt.rects),{x:b,y:tt}=computeCoordsFromPlacement(_,_e,g)),et=-1)}return{x:b,y:tt,placement:_e,strategy:o,middlewareData:rt}};async function detectOverflow(e,i){var s;i===void 0&&(i={});const{x:a,y:o,platform:c,rects:d,elements:h,strategy:g}=e,{boundary:_="clippingAncestors",rootBoundary:b="viewport",elementContext:tt="floating",altBoundary:_e=!1,padding:rt=0}=evaluate(i,e),it=getPaddingObject(rt),nt=h[_e?tt==="floating"?"reference":"floating":tt],at=rectToClientRect(await c.getClippingRect({element:(s=await(c.isElement==null?void 0:c.isElement(nt)))==null||s?nt:nt.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(h.floating)),boundary:_,rootBoundary:b,strategy:g})),st=tt==="floating"?{x:a,y:o,width:d.floating.width,height:d.floating.height}:d.reference,ot=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h.floating)),pt=await(c.isElement==null?void 0:c.isElement(ot))?await(c.getScale==null?void 0:c.getScale(ot))||{x:1,y:1}:{x:1,y:1},dt=rectToClientRect(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:h,rect:st,offsetParent:ot,strategy:g}):st);return{top:(at.top-dt.top+it.top)/pt.y,bottom:(dt.bottom-at.bottom+it.bottom)/pt.y,left:(at.left-dt.left+it.left)/pt.x,right:(dt.right-at.right+it.right)/pt.x}}const arrow$3=e=>({name:"arrow",options:e,async fn(i){const{x:s,y:a,placement:o,rects:c,platform:d,elements:h,middlewareData:g}=i,{element:_,padding:b=0}=evaluate(e,i)||{};if(_==null)return{};const tt=getPaddingObject(b),_e={x:s,y:a},rt=getAlignmentAxis(o),it=getAxisLength(rt),et=await d.getDimensions(_),nt=rt==="y",at=nt?"top":"left",st=nt?"bottom":"right",ot=nt?"clientHeight":"clientWidth",pt=c.reference[it]+c.reference[rt]-_e[rt]-c.floating[it],dt=_e[rt]-c.reference[rt],wt=await(d.getOffsetParent==null?void 0:d.getOffsetParent(_));let lt=wt?wt[ot]:0;(!lt||!await(d.isElement==null?void 0:d.isElement(wt)))&&(lt=h.floating[ot]||c.floating[it]);const gt=pt/2-dt/2,vt=lt/2-et[it]/2-1,At=min(tt[at],vt),yt=min(tt[st],vt),bt=At,Tt=lt-et[it]-yt,er=lt/2-et[it]/2+gt,zt=clamp$1(bt,er,Tt),ar=!g.arrow&&getAlignment(o)!=null&&er!==zt&&c.reference[it]/2-(er<bt?At:yt)-et[it]/2<0,Jt=ar?er<bt?er-bt:er-Tt:0;return{[rt]:_e[rt]+Jt,data:{[rt]:zt,centerOffset:er-zt-Jt,...ar&&{alignmentOffset:Jt}},reset:ar}}}),flip$2=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(i){var s,a;const{placement:o,middlewareData:c,rects:d,initialPlacement:h,platform:g,elements:_}=i,{mainAxis:b=!0,crossAxis:tt=!0,fallbackPlacements:_e,fallbackStrategy:rt="bestFit",fallbackAxisSideDirection:it="none",flipAlignment:et=!0,...nt}=evaluate(e,i);if((s=c.arrow)!=null&&s.alignmentOffset)return{};const at=getSide(o),st=getSideAxis(h),ot=getSide(h)===h,pt=await(g.isRTL==null?void 0:g.isRTL(_.floating)),dt=_e||(ot||!et?[getOppositePlacement(h)]:getExpandedPlacements(h)),wt=it!=="none";!_e&&wt&&dt.push(...getOppositeAxisPlacements(h,et,it,pt));const lt=[h,...dt],gt=await detectOverflow(i,nt),vt=[];let At=((a=c.flip)==null?void 0:a.overflows)||[];if(b&&vt.push(gt[at]),tt){const er=getAlignmentSides(o,d,pt);vt.push(gt[er[0]],gt[er[1]])}if(At=[...At,{placement:o,overflows:vt}],!vt.every(er=>er<=0)){var yt,bt;const er=(((yt=c.flip)==null?void 0:yt.index)||0)+1,zt=lt[er];if(zt)return{data:{index:er,overflows:At},reset:{placement:zt}};let ar=(bt=At.filter(Jt=>Jt.overflows[0]<=0).sort((Jt,Yt)=>Jt.overflows[1]-Yt.overflows[1])[0])==null?void 0:bt.placement;if(!ar)switch(rt){case"bestFit":{var Tt;const Jt=(Tt=At.filter(Yt=>{if(wt){const kt=getSideAxis(Yt.placement);return kt===st||kt==="y"}return!0}).map(Yt=>[Yt.placement,Yt.overflows.filter(kt=>kt>0).reduce((kt,ir)=>kt+ir,0)]).sort((Yt,kt)=>Yt[1]-kt[1])[0])==null?void 0:Tt[0];Jt&&(ar=Jt);break}case"initialPlacement":ar=h;break}if(o!==ar)return{reset:{placement:ar}}}return{}}}};function getSideOffsets(e,i){return{top:e.top-i.height,right:e.right-i.width,bottom:e.bottom-i.height,left:e.left-i.width}}function isAnySideFullyClipped(e){return sides.some(i=>e[i]>=0)}const hide$2=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(i){const{rects:s}=i,{strategy:a="referenceHidden",...o}=evaluate(e,i);switch(a){case"referenceHidden":{const c=await detectOverflow(i,{...o,elementContext:"reference"}),d=getSideOffsets(c,s.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:isAnySideFullyClipped(d)}}}case"escaped":{const c=await detectOverflow(i,{...o,altBoundary:!0}),d=getSideOffsets(c,s.floating);return{data:{escapedOffsets:d,escaped:isAnySideFullyClipped(d)}}}default:return{}}}}};async function convertValueToCoords(e,i){const{placement:s,platform:a,elements:o}=e,c=await(a.isRTL==null?void 0:a.isRTL(o.floating)),d=getSide(s),h=getAlignment(s),g=getSideAxis(s)==="y",_=["left","top"].includes(d)?-1:1,b=c&&g?-1:1,tt=evaluate(i,e);let{mainAxis:_e,crossAxis:rt,alignmentAxis:it}=typeof tt=="number"?{mainAxis:tt,crossAxis:0,alignmentAxis:null}:{mainAxis:tt.mainAxis||0,crossAxis:tt.crossAxis||0,alignmentAxis:tt.alignmentAxis};return h&&typeof it=="number"&&(rt=h==="end"?it*-1:it),g?{x:rt*b,y:_e*_}:{x:_e*_,y:rt*b}}const offset$2=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(i){var s,a;const{x:o,y:c,placement:d,middlewareData:h}=i,g=await convertValueToCoords(i,e);return d===((s=h.offset)==null?void 0:s.placement)&&(a=h.arrow)!=null&&a.alignmentOffset?{}:{x:o+g.x,y:c+g.y,data:{...g,placement:d}}}}},shift$2=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(i){const{x:s,y:a,placement:o}=i,{mainAxis:c=!0,crossAxis:d=!1,limiter:h={fn:nt=>{let{x:at,y:st}=nt;return{x:at,y:st}}},...g}=evaluate(e,i),_={x:s,y:a},b=await detectOverflow(i,g),tt=getSideAxis(getSide(o)),_e=getOppositeAxis(tt);let rt=_[_e],it=_[tt];if(c){const nt=_e==="y"?"top":"left",at=_e==="y"?"bottom":"right",st=rt+b[nt],ot=rt-b[at];rt=clamp$1(st,rt,ot)}if(d){const nt=tt==="y"?"top":"left",at=tt==="y"?"bottom":"right",st=it+b[nt],ot=it-b[at];it=clamp$1(st,it,ot)}const et=h.fn({...i,[_e]:rt,[tt]:it});return{...et,data:{x:et.x-s,y:et.y-a,enabled:{[_e]:c,[tt]:d}}}}}},limitShift$2=function(e){return e===void 0&&(e={}),{options:e,fn(i){const{x:s,y:a,placement:o,rects:c,middlewareData:d}=i,{offset:h=0,mainAxis:g=!0,crossAxis:_=!0}=evaluate(e,i),b={x:s,y:a},tt=getSideAxis(o),_e=getOppositeAxis(tt);let rt=b[_e],it=b[tt];const et=evaluate(h,i),nt=typeof et=="number"?{mainAxis:et,crossAxis:0}:{mainAxis:0,crossAxis:0,...et};if(g){const ot=_e==="y"?"height":"width",pt=c.reference[_e]-c.floating[ot]+nt.mainAxis,dt=c.reference[_e]+c.reference[ot]-nt.mainAxis;rt<pt?rt=pt:rt>dt&&(rt=dt)}if(_){var at,st;const ot=_e==="y"?"width":"height",pt=["top","left"].includes(getSide(o)),dt=c.reference[tt]-c.floating[ot]+(pt&&((at=d.offset)==null?void 0:at[tt])||0)+(pt?0:nt.crossAxis),wt=c.reference[tt]+c.reference[ot]+(pt?0:((st=d.offset)==null?void 0:st[tt])||0)-(pt?nt.crossAxis:0);it<dt?it=dt:it>wt&&(it=wt)}return{[_e]:rt,[tt]:it}}}},size$2=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(i){var s,a;const{placement:o,rects:c,platform:d,elements:h}=i,{apply:g=()=>{},..._}=evaluate(e,i),b=await detectOverflow(i,_),tt=getSide(o),_e=getAlignment(o),rt=getSideAxis(o)==="y",{width:it,height:et}=c.floating;let nt,at;tt==="top"||tt==="bottom"?(nt=tt,at=_e===(await(d.isRTL==null?void 0:d.isRTL(h.floating))?"start":"end")?"left":"right"):(at=tt,nt=_e==="end"?"top":"bottom");const st=et-b.top-b.bottom,ot=it-b.left-b.right,pt=min(et-b[nt],st),dt=min(it-b[at],ot),wt=!i.middlewareData.shift;let lt=pt,gt=dt;if((s=i.middlewareData.shift)!=null&&s.enabled.x&&(gt=ot),(a=i.middlewareData.shift)!=null&&a.enabled.y&&(lt=st),wt&&!_e){const At=max(b.left,0),yt=max(b.right,0),bt=max(b.top,0),Tt=max(b.bottom,0);rt?gt=it-2*(At!==0||yt!==0?At+yt:max(b.left,b.right)):lt=et-2*(bt!==0||Tt!==0?bt+Tt:max(b.top,b.bottom))}await g({...i,availableWidth:gt,availableHeight:lt});const vt=await d.getDimensions(h.floating);return it!==vt.width||et!==vt.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(e){return isNode(e)?(e.nodeName||"").toLowerCase():"#document"}function getWindow(e){var i;return(e==null||(i=e.ownerDocument)==null?void 0:i.defaultView)||window}function getDocumentElement(e){var i;return(i=(isNode(e)?e.ownerDocument:e.document)||window.document)==null?void 0:i.documentElement}function isNode(e){return hasWindow()?e instanceof Node||e instanceof getWindow(e).Node:!1}function isElement(e){return hasWindow()?e instanceof Element||e instanceof getWindow(e).Element:!1}function isHTMLElement(e){return hasWindow()?e instanceof HTMLElement||e instanceof getWindow(e).HTMLElement:!1}function isShadowRoot(e){return!hasWindow()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof getWindow(e).ShadowRoot}function isOverflowElement(e){const{overflow:i,overflowX:s,overflowY:a,display:o}=getComputedStyle$1(e);return/auto|scroll|overlay|hidden|clip/.test(i+a+s)&&!["inline","contents"].includes(o)}function isTableElement(e){return["table","td","th"].includes(getNodeName(e))}function isTopLayer(e){return[":popover-open",":modal"].some(i=>{try{return e.matches(i)}catch{return!1}})}function isContainingBlock(e){const i=isWebKit(),s=isElement(e)?getComputedStyle$1(e):e;return s.transform!=="none"||s.perspective!=="none"||(s.containerType?s.containerType!=="normal":!1)||!i&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!i&&(s.filter?s.filter!=="none":!1)||["transform","perspective","filter"].some(a=>(s.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(s.contain||"").includes(a))}function getContainingBlock(e){let i=getParentNode(e);for(;isHTMLElement(i)&&!isLastTraversableNode(i);){if(isContainingBlock(i))return i;if(isTopLayer(i))return null;i=getParentNode(i)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(e){return["html","body","#document"].includes(getNodeName(e))}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function getNodeScroll(e){return isElement(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function getParentNode(e){if(getNodeName(e)==="html")return e;const i=e.assignedSlot||e.parentNode||isShadowRoot(e)&&e.host||getDocumentElement(e);return isShadowRoot(i)?i.host:i}function getNearestOverflowAncestor(e){const i=getParentNode(e);return isLastTraversableNode(i)?e.ownerDocument?e.ownerDocument.body:e.body:isHTMLElement(i)&&isOverflowElement(i)?i:getNearestOverflowAncestor(i)}function getOverflowAncestors(e,i,s){var a;i===void 0&&(i=[]),s===void 0&&(s=!0);const o=getNearestOverflowAncestor(e),c=o===((a=e.ownerDocument)==null?void 0:a.body),d=getWindow(o);if(c){const h=getFrameElement(d);return i.concat(d,d.visualViewport||[],isOverflowElement(o)?o:[],h&&s?getOverflowAncestors(h):[])}return i.concat(o,getOverflowAncestors(o,[],s))}function getFrameElement(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function getCssDimensions(e){const i=getComputedStyle$1(e);let s=parseFloat(i.width)||0,a=parseFloat(i.height)||0;const o=isHTMLElement(e),c=o?e.offsetWidth:s,d=o?e.offsetHeight:a,h=round(s)!==c||round(a)!==d;return h&&(s=c,a=d),{width:s,height:a,$:h}}function unwrapElement(e){return isElement(e)?e:e.contextElement}function getScale(e){const i=unwrapElement(e);if(!isHTMLElement(i))return createCoords(1);const s=i.getBoundingClientRect(),{width:a,height:o,$:c}=getCssDimensions(i);let d=(c?round(s.width):s.width)/a,h=(c?round(s.height):s.height)/o;return(!d||!Number.isFinite(d))&&(d=1),(!h||!Number.isFinite(h))&&(h=1),{x:d,y:h}}const noOffsets=createCoords(0);function getVisualOffsets(e){const i=getWindow(e);return!isWebKit()||!i.visualViewport?noOffsets:{x:i.visualViewport.offsetLeft,y:i.visualViewport.offsetTop}}function shouldAddVisualOffsets(e,i,s){return i===void 0&&(i=!1),!s||i&&s!==getWindow(e)?!1:i}function getBoundingClientRect(e,i,s,a){i===void 0&&(i=!1),s===void 0&&(s=!1);const o=e.getBoundingClientRect(),c=unwrapElement(e);let d=createCoords(1);i&&(a?isElement(a)&&(d=getScale(a)):d=getScale(e));const h=shouldAddVisualOffsets(c,s,a)?getVisualOffsets(c):createCoords(0);let g=(o.left+h.x)/d.x,_=(o.top+h.y)/d.y,b=o.width/d.x,tt=o.height/d.y;if(c){const _e=getWindow(c),rt=a&&isElement(a)?getWindow(a):a;let it=_e,et=getFrameElement(it);for(;et&&a&&rt!==it;){const nt=getScale(et),at=et.getBoundingClientRect(),st=getComputedStyle$1(et),ot=at.left+(et.clientLeft+parseFloat(st.paddingLeft))*nt.x,pt=at.top+(et.clientTop+parseFloat(st.paddingTop))*nt.y;g*=nt.x,_*=nt.y,b*=nt.x,tt*=nt.y,g+=ot,_+=pt,it=getWindow(et),et=getFrameElement(it)}}return rectToClientRect({width:b,height:tt,x:g,y:_})}function convertOffsetParentRelativeRectToViewportRelativeRect(e){let{elements:i,rect:s,offsetParent:a,strategy:o}=e;const c=o==="fixed",d=getDocumentElement(a),h=i?isTopLayer(i.floating):!1;if(a===d||h&&c)return s;let g={scrollLeft:0,scrollTop:0},_=createCoords(1);const b=createCoords(0),tt=isHTMLElement(a);if((tt||!tt&&!c)&&((getNodeName(a)!=="body"||isOverflowElement(d))&&(g=getNodeScroll(a)),isHTMLElement(a))){const _e=getBoundingClientRect(a);_=getScale(a),b.x=_e.x+a.clientLeft,b.y=_e.y+a.clientTop}return{width:s.width*_.x,height:s.height*_.y,x:s.x*_.x-g.scrollLeft*_.x+b.x,y:s.y*_.y-g.scrollTop*_.y+b.y}}function getClientRects(e){return Array.from(e.getClientRects())}function getWindowScrollBarX(e,i){const s=getNodeScroll(e).scrollLeft;return i?i.left+s:getBoundingClientRect(getDocumentElement(e)).left+s}function getDocumentRect(e){const i=getDocumentElement(e),s=getNodeScroll(e),a=e.ownerDocument.body,o=max(i.scrollWidth,i.clientWidth,a.scrollWidth,a.clientWidth),c=max(i.scrollHeight,i.clientHeight,a.scrollHeight,a.clientHeight);let d=-s.scrollLeft+getWindowScrollBarX(e);const h=-s.scrollTop;return getComputedStyle$1(a).direction==="rtl"&&(d+=max(i.clientWidth,a.clientWidth)-o),{width:o,height:c,x:d,y:h}}function getViewportRect(e,i){const s=getWindow(e),a=getDocumentElement(e),o=s.visualViewport;let c=a.clientWidth,d=a.clientHeight,h=0,g=0;if(o){c=o.width,d=o.height;const _=isWebKit();(!_||_&&i==="fixed")&&(h=o.offsetLeft,g=o.offsetTop)}return{width:c,height:d,x:h,y:g}}function getInnerBoundingClientRect(e,i){const s=getBoundingClientRect(e,!0,i==="fixed"),a=s.top+e.clientTop,o=s.left+e.clientLeft,c=isHTMLElement(e)?getScale(e):createCoords(1),d=e.clientWidth*c.x,h=e.clientHeight*c.y,g=o*c.x,_=a*c.y;return{width:d,height:h,x:g,y:_}}function getClientRectFromClippingAncestor(e,i,s){let a;if(i==="viewport")a=getViewportRect(e,s);else if(i==="document")a=getDocumentRect(getDocumentElement(e));else if(isElement(i))a=getInnerBoundingClientRect(i,s);else{const o=getVisualOffsets(e);a={...i,x:i.x-o.x,y:i.y-o.y}}return rectToClientRect(a)}function hasFixedPositionAncestor(e,i){const s=getParentNode(e);return s===i||!isElement(s)||isLastTraversableNode(s)?!1:getComputedStyle$1(s).position==="fixed"||hasFixedPositionAncestor(s,i)}function getClippingElementAncestors(e,i){const s=i.get(e);if(s)return s;let a=getOverflowAncestors(e,[],!1).filter(h=>isElement(h)&&getNodeName(h)!=="body"),o=null;const c=getComputedStyle$1(e).position==="fixed";let d=c?getParentNode(e):e;for(;isElement(d)&&!isLastTraversableNode(d);){const h=getComputedStyle$1(d),g=isContainingBlock(d);!g&&h.position==="fixed"&&(o=null),(c?!g&&!o:!g&&h.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||isOverflowElement(d)&&!g&&hasFixedPositionAncestor(e,d))?a=a.filter(b=>b!==d):o=h,d=getParentNode(d)}return i.set(e,a),a}function getClippingRect(e){let{element:i,boundary:s,rootBoundary:a,strategy:o}=e;const d=[...s==="clippingAncestors"?isTopLayer(i)?[]:getClippingElementAncestors(i,this._c):[].concat(s),a],h=d[0],g=d.reduce((_,b)=>{const tt=getClientRectFromClippingAncestor(i,b,o);return _.top=max(tt.top,_.top),_.right=min(tt.right,_.right),_.bottom=min(tt.bottom,_.bottom),_.left=max(tt.left,_.left),_},getClientRectFromClippingAncestor(i,h,o));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function getDimensions(e){const{width:i,height:s}=getCssDimensions(e);return{width:i,height:s}}function getRectRelativeToOffsetParent(e,i,s){const a=isHTMLElement(i),o=getDocumentElement(i),c=s==="fixed",d=getBoundingClientRect(e,!0,c,i);let h={scrollLeft:0,scrollTop:0};const g=createCoords(0);if(a||!a&&!c)if((getNodeName(i)!=="body"||isOverflowElement(o))&&(h=getNodeScroll(i)),a){const rt=getBoundingClientRect(i,!0,c,i);g.x=rt.x+i.clientLeft,g.y=rt.y+i.clientTop}else o&&(g.x=getWindowScrollBarX(o));let _=0,b=0;if(o&&!a&&!c){const rt=o.getBoundingClientRect();b=rt.top+h.scrollTop,_=rt.left+h.scrollLeft-getWindowScrollBarX(o,rt)}const tt=d.left+h.scrollLeft-g.x-_,_e=d.top+h.scrollTop-g.y-b;return{x:tt,y:_e,width:d.width,height:d.height}}function isStaticPositioned(e){return getComputedStyle$1(e).position==="static"}function getTrueOffsetParent(e,i){if(!isHTMLElement(e)||getComputedStyle$1(e).position==="fixed")return null;if(i)return i(e);let s=e.offsetParent;return getDocumentElement(e)===s&&(s=s.ownerDocument.body),s}function getOffsetParent(e,i){const s=getWindow(e);if(isTopLayer(e))return s;if(!isHTMLElement(e)){let o=getParentNode(e);for(;o&&!isLastTraversableNode(o);){if(isElement(o)&&!isStaticPositioned(o))return o;o=getParentNode(o)}return s}let a=getTrueOffsetParent(e,i);for(;a&&isTableElement(a)&&isStaticPositioned(a);)a=getTrueOffsetParent(a,i);return a&&isLastTraversableNode(a)&&isStaticPositioned(a)&&!isContainingBlock(a)?s:a||getContainingBlock(e)||s}const getElementRects=async function(e){const i=this.getOffsetParent||getOffsetParent,s=this.getDimensions,a=await s(e.floating);return{reference:getRectRelativeToOffsetParent(e.reference,await i(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function isRTL(e){return getComputedStyle$1(e).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(e,i){let s=null,a;const o=getDocumentElement(e);function c(){var h;clearTimeout(a),(h=s)==null||h.disconnect(),s=null}function d(h,g){h===void 0&&(h=!1),g===void 0&&(g=1),c();const{left:_,top:b,width:tt,height:_e}=e.getBoundingClientRect();if(h||i(),!tt||!_e)return;const rt=floor(b),it=floor(o.clientWidth-(_+tt)),et=floor(o.clientHeight-(b+_e)),nt=floor(_),st={rootMargin:-rt+"px "+-it+"px "+-et+"px "+-nt+"px",threshold:max(0,min(1,g))||1};let ot=!0;function pt(dt){const wt=dt[0].intersectionRatio;if(wt!==g){if(!ot)return d();wt?d(!1,wt):a=setTimeout(()=>{d(!1,1e-7)},1e3)}ot=!1}try{s=new IntersectionObserver(pt,{...st,root:o.ownerDocument})}catch{s=new IntersectionObserver(pt,st)}s.observe(e)}return d(!0),c}function autoUpdate(e,i,s,a){a===void 0&&(a={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:h=typeof IntersectionObserver=="function",animationFrame:g=!1}=a,_=unwrapElement(e),b=o||c?[..._?getOverflowAncestors(_):[],...getOverflowAncestors(i)]:[];b.forEach(at=>{o&&at.addEventListener("scroll",s,{passive:!0}),c&&at.addEventListener("resize",s)});const tt=_&&h?observeMove(_,s):null;let _e=-1,rt=null;d&&(rt=new ResizeObserver(at=>{let[st]=at;st&&st.target===_&&rt&&(rt.unobserve(i),cancelAnimationFrame(_e),_e=requestAnimationFrame(()=>{var ot;(ot=rt)==null||ot.observe(i)})),s()}),_&&!g&&rt.observe(_),rt.observe(i));let it,et=g?getBoundingClientRect(e):null;g&&nt();function nt(){const at=getBoundingClientRect(e);et&&(at.x!==et.x||at.y!==et.y||at.width!==et.width||at.height!==et.height)&&s(),et=at,it=requestAnimationFrame(nt)}return s(),()=>{var at;b.forEach(st=>{o&&st.removeEventListener("scroll",s),c&&st.removeEventListener("resize",s)}),tt==null||tt(),(at=rt)==null||at.disconnect(),rt=null,g&&cancelAnimationFrame(it)}}const offset$1=offset$2,shift$1=shift$2,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(e,i,s)=>{const a=new Map,o={platform,...s},c={...o.platform,_c:a};return computePosition$1(e,i,{...o,platform:c})};var index=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(e,i){if(e===i)return!0;if(typeof e!=typeof i)return!1;if(typeof e=="function"&&e.toString()===i.toString())return!0;let s,a,o;if(e&&i&&typeof e=="object"){if(Array.isArray(e)){if(s=e.length,s!==i.length)return!1;for(a=s;a--!==0;)if(!deepEqual(e[a],i[a]))return!1;return!0}if(o=Object.keys(e),s=o.length,s!==Object.keys(i).length)return!1;for(a=s;a--!==0;)if(!{}.hasOwnProperty.call(i,o[a]))return!1;for(a=s;a--!==0;){const c=o[a];if(!(c==="_owner"&&e.$$typeof)&&!deepEqual(e[c],i[c]))return!1}return!0}return e!==e&&i!==i}function getDPR(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(e,i){const s=getDPR(e);return Math.round(i*s)/s}function useLatestRef(e){const i=reactExports.useRef(e);return index(()=>{i.current=e}),i}function useFloating(e){e===void 0&&(e={});const{placement:i="bottom",strategy:s="absolute",middleware:a=[],platform:o,elements:{reference:c,floating:d}={},transform:h=!0,whileElementsMounted:g,open:_}=e,[b,tt]=reactExports.useState({x:0,y:0,strategy:s,placement:i,middlewareData:{},isPositioned:!1}),[_e,rt]=reactExports.useState(a);deepEqual(_e,a)||rt(a);const[it,et]=reactExports.useState(null),[nt,at]=reactExports.useState(null),st=reactExports.useCallback(Yt=>{Yt!==wt.current&&(wt.current=Yt,et(Yt))},[]),ot=reactExports.useCallback(Yt=>{Yt!==lt.current&&(lt.current=Yt,at(Yt))},[]),pt=c||it,dt=d||nt,wt=reactExports.useRef(null),lt=reactExports.useRef(null),gt=reactExports.useRef(b),vt=g!=null,At=useLatestRef(g),yt=useLatestRef(o),bt=useLatestRef(_),Tt=reactExports.useCallback(()=>{if(!wt.current||!lt.current)return;const Yt={placement:i,strategy:s,middleware:_e};yt.current&&(Yt.platform=yt.current),computePosition(wt.current,lt.current,Yt).then(kt=>{const ir={...kt,isPositioned:bt.current!==!1};er.current&&!deepEqual(gt.current,ir)&&(gt.current=ir,reactDomExports.flushSync(()=>{tt(ir)}))})},[_e,i,s,yt,bt]);index(()=>{_===!1&&gt.current.isPositioned&&(gt.current.isPositioned=!1,tt(Yt=>({...Yt,isPositioned:!1})))},[_]);const er=reactExports.useRef(!1);index(()=>(er.current=!0,()=>{er.current=!1}),[]),index(()=>{if(pt&&(wt.current=pt),dt&&(lt.current=dt),pt&&dt){if(At.current)return At.current(pt,dt,Tt);Tt()}},[pt,dt,Tt,At,vt]);const zt=reactExports.useMemo(()=>({reference:wt,floating:lt,setReference:st,setFloating:ot}),[st,ot]),ar=reactExports.useMemo(()=>({reference:pt,floating:dt}),[pt,dt]),Jt=reactExports.useMemo(()=>{const Yt={position:s,left:0,top:0};if(!ar.floating)return Yt;const kt=roundByDPR(ar.floating,b.x),ir=roundByDPR(ar.floating,b.y);return h?{...Yt,transform:"translate("+kt+"px, "+ir+"px)",...getDPR(ar.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:kt,top:ir}},[s,h,ar.floating,b.x,b.y]);return reactExports.useMemo(()=>({...b,update:Tt,refs:zt,elements:ar,floatingStyles:Jt}),[b,Tt,zt,ar,Jt])}const arrow$1=e=>{function i(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:e,fn(s){const{element:a,padding:o}=typeof e=="function"?e(s):e;return a&&i(a)?a.current!=null?arrow$2({element:a.current,padding:o}).fn(s):{}:a?arrow$2({element:a,padding:o}).fn(s):{}}}},offset=(e,i)=>({...offset$1(e),options:[e,i]}),shift=(e,i)=>({...shift$1(e),options:[e,i]}),limitShift=(e,i)=>({...limitShift$1(e),options:[e,i]}),flip=(e,i)=>({...flip$1(e),options:[e,i]}),size=(e,i)=>({...size$1(e),options:[e,i]}),hide=(e,i)=>({...hide$1(e),options:[e,i]}),arrow=(e,i)=>({...arrow$1(e),options:[e,i]});var NAME="Arrow",Arrow$1=reactExports.forwardRef((e,i)=>{const{children:s,width:a=10,height:o=5,...c}=e;return jsxRuntimeExports.jsx(Primitive.svg,{...c,ref:i,width:a,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?s:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME;var Root$2=Arrow$1;function createContextScope$1(e,i=[]){let s=[];function a(c,d){const h=reactExports.createContext(d),g=s.length;s=[...s,d];function _(tt){const{scope:_e,children:rt,...it}=tt,et=(_e==null?void 0:_e[e][g])||h,nt=reactExports.useMemo(()=>it,Object.values(it));return jsxRuntimeExports.jsx(et.Provider,{value:nt,children:rt})}function b(tt,_e){const rt=(_e==null?void 0:_e[e][g])||h,it=reactExports.useContext(rt);if(it)return it;if(d!==void 0)return d;throw new Error(`\`${tt}\` must be used within \`${c}\``)}return _.displayName=c+"Provider",[_,b]}const o=()=>{const c=s.map(d=>reactExports.createContext(d));return function(h){const g=(h==null?void 0:h[e])||c;return reactExports.useMemo(()=>({[`__scope${e}`]:{...h,[e]:g}}),[h,g])}};return o.scopeName=e,[a,composeContextScopes$1(o,...i)]}function composeContextScopes$1(...e){const i=e[0];if(e.length===1)return i;const s=()=>{const a=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(c){const d=a.reduce((h,{useScope:g,scopeName:_})=>{const tt=g(c)[`__scope${_}`];return{...h,...tt}},{});return reactExports.useMemo(()=>({[`__scope${i.scopeName}`]:d}),[d])}};return s.scopeName=i.scopeName,s}function useSize(e){const[i,s]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const c=o[0];let d,h;if("borderBoxSize"in c){const g=c.borderBoxSize,_=Array.isArray(g)?g[0]:g;d=_.inlineSize,h=_.blockSize}else d=e.offsetWidth,h=e.offsetHeight;s({width:d,height:h})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else s(void 0)},[e]),i}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope$1(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=e=>{const{__scopePopper:i,children:s}=e,[a,o]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:i,anchor:a,onAnchorChange:o,children:s})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME$1="PopperAnchor",PopperAnchor=reactExports.forwardRef((e,i)=>{const{__scopePopper:s,virtualRef:a,...o}=e,c=usePopperContext(ANCHOR_NAME$1,s),d=reactExports.useRef(null),h=useComposedRefs(i,d);return reactExports.useEffect(()=>{c.onAnchorChange((a==null?void 0:a.current)||d.current)}),a?null:jsxRuntimeExports.jsx(Primitive.div,{...o,ref:h})});PopperAnchor.displayName=ANCHOR_NAME$1;var CONTENT_NAME$3="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$3),PopperContent=reactExports.forwardRef((e,i)=>{var Nt,Lt,lr,ur,wr,vr;const{__scopePopper:s,side:a="bottom",sideOffset:o=0,align:c="center",alignOffset:d=0,arrowPadding:h=0,avoidCollisions:g=!0,collisionBoundary:_=[],collisionPadding:b=0,sticky:tt="partial",hideWhenDetached:_e=!1,updatePositionStrategy:rt="optimized",onPlaced:it,...et}=e,nt=usePopperContext(CONTENT_NAME$3,s),[at,st]=reactExports.useState(null),ot=useComposedRefs(i,Fr=>st(Fr)),[pt,dt]=reactExports.useState(null),wt=useSize(pt),lt=(wt==null?void 0:wt.width)??0,gt=(wt==null?void 0:wt.height)??0,vt=a+(c!=="center"?"-"+c:""),At=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},yt=Array.isArray(_)?_:[_],bt=yt.length>0,Tt={padding:At,boundary:yt.filter(isNotNull),altBoundary:bt},{refs:er,floatingStyles:zt,placement:ar,isPositioned:Jt,middlewareData:Yt}=useFloating({strategy:"fixed",placement:vt,whileElementsMounted:(...Fr)=>autoUpdate(...Fr,{animationFrame:rt==="always"}),elements:{reference:nt.anchor},middleware:[offset({mainAxis:o+gt,alignmentAxis:d}),g&&shift({mainAxis:!0,crossAxis:!1,limiter:tt==="partial"?limitShift():void 0,...Tt}),g&&flip({...Tt}),size({...Tt,apply:({elements:Fr,rects:Rr,availableWidth:jr,availableHeight:xr})=>{const{width:hr,height:jt}=Rr.reference,sr=Fr.floating.style;sr.setProperty("--radix-popper-available-width",`${jr}px`),sr.setProperty("--radix-popper-available-height",`${xr}px`),sr.setProperty("--radix-popper-anchor-width",`${hr}px`),sr.setProperty("--radix-popper-anchor-height",`${jt}px`)}}),pt&&arrow({element:pt,padding:h}),transformOrigin({arrowWidth:lt,arrowHeight:gt}),_e&&hide({strategy:"referenceHidden",...Tt})]}),[kt,ir]=getSideAndAlignFromPlacement(ar),fr=useCallbackRef$1(it);useLayoutEffect2(()=>{Jt&&(fr==null||fr())},[Jt,fr]);const Et=(Nt=Yt.arrow)==null?void 0:Nt.x,xt=(Lt=Yt.arrow)==null?void 0:Lt.y,mt=((lr=Yt.arrow)==null?void 0:lr.centerOffset)!==0,[St,Pt]=reactExports.useState();return useLayoutEffect2(()=>{at&&Pt(window.getComputedStyle(at).zIndex)},[at]),jsxRuntimeExports.jsx("div",{ref:er.setFloating,"data-radix-popper-content-wrapper":"",style:{...zt,transform:Jt?zt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:St,"--radix-popper-transform-origin":[(ur=Yt.transformOrigin)==null?void 0:ur.x,(wr=Yt.transformOrigin)==null?void 0:wr.y].join(" "),...((vr=Yt.hide)==null?void 0:vr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:s,placedSide:kt,onArrowChange:dt,arrowX:Et,arrowY:xt,shouldHideArrow:mt,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":kt,"data-align":ir,...et,ref:ot,style:{...et.style,animation:Jt?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$3;var ARROW_NAME$3="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function(i,s){const{__scopePopper:a,...o}=i,c=useContentContext(ARROW_NAME$3,a),d=OPPOSITE_SIDE[c.placedSide];return jsxRuntimeExports.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$2,{...o,ref:s,style:{...o.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$3;function isNotNull(e){return e!==null}var transformOrigin=e=>({name:"transformOrigin",options:e,fn(i){var nt,at,st;const{placement:s,rects:a,middlewareData:o}=i,d=((nt=o.arrow)==null?void 0:nt.centerOffset)!==0,h=d?0:e.arrowWidth,g=d?0:e.arrowHeight,[_,b]=getSideAndAlignFromPlacement(s),tt={start:"0%",center:"50%",end:"100%"}[b],_e=(((at=o.arrow)==null?void 0:at.x)??0)+h/2,rt=(((st=o.arrow)==null?void 0:st.y)??0)+g/2;let it="",et="";return _==="bottom"?(it=d?tt:`${_e}px`,et=`${-g}px`):_==="top"?(it=d?tt:`${_e}px`,et=`${a.floating.height+g}px`):_==="right"?(it=`${-g}px`,et=d?tt:`${rt}px`):_==="left"&&(it=`${a.floating.width+g}px`,et=d?tt:`${rt}px`),{data:{x:it,y:et}}}});function getSideAndAlignFromPlacement(e){const[i,s="center"]=e.split("-");return[i,s]}var Root2$2=Popper,Anchor=PopperAnchor,Content=PopperContent,Arrow=PopperArrow,[createTooltipContext,createTooltipScope]=createContextScope$2("Tooltip",[createPopperScope]),usePopperScope$2=createPopperScope(),PROVIDER_NAME="TooltipProvider",DEFAULT_DELAY_DURATION=700,TOOLTIP_OPEN="tooltip.open",[TooltipProviderContextProvider,useTooltipProviderContext]=createTooltipContext(PROVIDER_NAME),TooltipProvider$1=e=>{const{__scopeTooltip:i,delayDuration:s=DEFAULT_DELAY_DURATION,skipDelayDuration:a=300,disableHoverableContent:o=!1,children:c}=e,[d,h]=reactExports.useState(!0),g=reactExports.useRef(!1),_=reactExports.useRef(0);return reactExports.useEffect(()=>{const b=_.current;return()=>window.clearTimeout(b)},[]),jsxRuntimeExports.jsx(TooltipProviderContextProvider,{scope:i,isOpenDelayed:d,delayDuration:s,onOpen:reactExports.useCallback(()=>{window.clearTimeout(_.current),h(!1)},[]),onClose:reactExports.useCallback(()=>{window.clearTimeout(_.current),_.current=window.setTimeout(()=>h(!0),a)},[a]),isPointerInTransitRef:g,onPointerInTransitChange:reactExports.useCallback(b=>{g.current=b},[]),disableHoverableContent:o,children:c})};TooltipProvider$1.displayName=PROVIDER_NAME;var TOOLTIP_NAME="Tooltip",[TooltipContextProvider,useTooltipContext]=createTooltipContext(TOOLTIP_NAME),TRIGGER_NAME$2="TooltipTrigger",TooltipTrigger=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,...a}=e,o=useTooltipContext(TRIGGER_NAME$2,s),c=useTooltipProviderContext(TRIGGER_NAME$2,s),d=usePopperScope$2(s),h=reactExports.useRef(null),g=useComposedRefs(i,h,o.onTriggerChange),_=reactExports.useRef(!1),b=reactExports.useRef(!1),tt=reactExports.useCallback(()=>_.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",tt),[tt]),jsxRuntimeExports.jsx(Anchor,{asChild:!0,...d,children:jsxRuntimeExports.jsx(Primitive.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...a,ref:g,onPointerMove:composeEventHandlers$1(e.onPointerMove,_e=>{_e.pointerType!=="touch"&&!b.current&&!c.isPointerInTransitRef.current&&(o.onTriggerEnter(),b.current=!0)}),onPointerLeave:composeEventHandlers$1(e.onPointerLeave,()=>{o.onTriggerLeave(),b.current=!1}),onPointerDown:composeEventHandlers$1(e.onPointerDown,()=>{_.current=!0,document.addEventListener("pointerup",tt,{once:!0})}),onFocus:composeEventHandlers$1(e.onFocus,()=>{_.current||o.onOpen()}),onBlur:composeEventHandlers$1(e.onBlur,o.onClose),onClick:composeEventHandlers$1(e.onClick,o.onClose)})})});TooltipTrigger.displayName=TRIGGER_NAME$2;var PORTAL_NAME$2="TooltipPortal",[PortalProvider$1,usePortalContext$1]=createTooltipContext(PORTAL_NAME$2,{forceMount:void 0}),CONTENT_NAME$2="TooltipContent",TooltipContent$1=reactExports.forwardRef((e,i)=>{const s=usePortalContext$1(CONTENT_NAME$2,e.__scopeTooltip),{forceMount:a=s.forceMount,side:o="top",...c}=e,d=useTooltipContext(CONTENT_NAME$2,e.__scopeTooltip);return jsxRuntimeExports.jsx(Presence,{present:a||d.open,children:d.disableHoverableContent?jsxRuntimeExports.jsx(TooltipContentImpl,{side:o,...c,ref:i}):jsxRuntimeExports.jsx(TooltipContentHoverable,{side:o,...c,ref:i})})}),TooltipContentHoverable=reactExports.forwardRef((e,i)=>{const s=useTooltipContext(CONTENT_NAME$2,e.__scopeTooltip),a=useTooltipProviderContext(CONTENT_NAME$2,e.__scopeTooltip),o=reactExports.useRef(null),c=useComposedRefs(i,o),[d,h]=reactExports.useState(null),{trigger:g,onClose:_}=s,b=o.current,{onPointerInTransitChange:tt}=a,_e=reactExports.useCallback(()=>{h(null),tt(!1)},[tt]),rt=reactExports.useCallback((it,et)=>{const nt=it.currentTarget,at={x:it.clientX,y:it.clientY},st=getExitSideFromRect(at,nt.getBoundingClientRect()),ot=getPaddedExitPoints(at,st),pt=getPointsFromRect(et.getBoundingClientRect()),dt=getHull([...ot,...pt]);h(dt),tt(!0)},[tt]);return reactExports.useEffect(()=>()=>_e(),[_e]),reactExports.useEffect(()=>{if(g&&b){const it=nt=>rt(nt,b),et=nt=>rt(nt,g);return g.addEventListener("pointerleave",it),b.addEventListener("pointerleave",et),()=>{g.removeEventListener("pointerleave",it),b.removeEventListener("pointerleave",et)}}},[g,b,rt,_e]),reactExports.useEffect(()=>{if(d){const it=et=>{const nt=et.target,at={x:et.clientX,y:et.clientY},st=(g==null?void 0:g.contains(nt))||(b==null?void 0:b.contains(nt)),ot=!isPointInPolygon(at,d);st?_e():ot&&(_e(),_())};return document.addEventListener("pointermove",it),()=>document.removeEventListener("pointermove",it)}},[g,b,d,_,_e]),jsxRuntimeExports.jsx(TooltipContentImpl,{...e,ref:c})}),[VisuallyHiddenContentContextProvider,useVisuallyHiddenContentContext]=createTooltipContext(TOOLTIP_NAME,{isInside:!1}),TooltipContentImpl=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,children:a,"aria-label":o,onEscapeKeyDown:c,onPointerDownOutside:d,...h}=e,g=useTooltipContext(CONTENT_NAME$2,s),_=usePopperScope$2(s),{onClose:b}=g;return reactExports.useEffect(()=>(document.addEventListener(TOOLTIP_OPEN,b),()=>document.removeEventListener(TOOLTIP_OPEN,b)),[b]),reactExports.useEffect(()=>{if(g.trigger){const tt=_e=>{const rt=_e.target;rt!=null&&rt.contains(g.trigger)&&b()};return window.addEventListener("scroll",tt,{capture:!0}),()=>window.removeEventListener("scroll",tt,{capture:!0})}},[g.trigger,b]),jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:tt=>tt.preventDefault(),onDismiss:b,children:jsxRuntimeExports.jsxs(Content,{"data-state":g.stateAttribute,..._,...h,ref:i,style:{...h.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[jsxRuntimeExports.jsx(Slottable,{children:a}),jsxRuntimeExports.jsx(VisuallyHiddenContentContextProvider,{scope:s,isInside:!0,children:jsxRuntimeExports.jsx(Root$3,{id:g.contentId,role:"tooltip",children:o||a})})]})})});TooltipContent$1.displayName=CONTENT_NAME$2;var ARROW_NAME$2="TooltipArrow",TooltipArrow=reactExports.forwardRef((e,i)=>{const{__scopeTooltip:s,...a}=e,o=usePopperScope$2(s);return useVisuallyHiddenContentContext(ARROW_NAME$2,s).isInside?null:jsxRuntimeExports.jsx(Arrow,{...o,...a,ref:i})});TooltipArrow.displayName=ARROW_NAME$2;function getExitSideFromRect(e,i){const s=Math.abs(i.top-e.y),a=Math.abs(i.bottom-e.y),o=Math.abs(i.right-e.x),c=Math.abs(i.left-e.x);switch(Math.min(s,a,o,c)){case c:return"left";case o:return"right";case s:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function getPaddedExitPoints(e,i,s=5){const a=[];switch(i){case"top":a.push({x:e.x-s,y:e.y+s},{x:e.x+s,y:e.y+s});break;case"bottom":a.push({x:e.x-s,y:e.y-s},{x:e.x+s,y:e.y-s});break;case"left":a.push({x:e.x+s,y:e.y-s},{x:e.x+s,y:e.y+s});break;case"right":a.push({x:e.x-s,y:e.y-s},{x:e.x-s,y:e.y+s});break}return a}function getPointsFromRect(e){const{top:i,right:s,bottom:a,left:o}=e;return[{x:o,y:i},{x:s,y:i},{x:s,y:a},{x:o,y:a}]}function isPointInPolygon(e,i){const{x:s,y:a}=e;let o=!1;for(let c=0,d=i.length-1;c<i.length;d=c++){const h=i[c].x,g=i[c].y,_=i[d].x,b=i[d].y;g>a!=b>a&&s<(_-h)*(a-g)/(b-g)+h&&(o=!o)}return o}function getHull(e){const i=e.slice();return i.sort((s,a)=>s.x<a.x?-1:s.x>a.x?1:s.y<a.y?-1:s.y>a.y?1:0),getHullPresorted(i)}function getHullPresorted(e){if(e.length<=1)return e.slice();const i=[];for(let a=0;a<e.length;a++){const o=e[a];for(;i.length>=2;){const c=i[i.length-1],d=i[i.length-2];if((c.x-d.x)*(o.y-d.y)>=(c.y-d.y)*(o.x-d.x))i.pop();else break}i.push(o)}i.pop();const s=[];for(let a=e.length-1;a>=0;a--){const o=e[a];for(;s.length>=2;){const c=s[s.length-1],d=s[s.length-2];if((c.x-d.x)*(o.y-d.y)>=(c.y-d.y)*(o.x-d.x))s.pop();else break}s.push(o)}return s.pop(),i.length===1&&s.length===1&&i[0].x===s[0].x&&i[0].y===s[0].y?i:i.concat(s)}var Provider=TooltipProvider$1,Content2$2=TooltipContent$1;const TooltipProvider=Provider,TooltipContent=reactExports.forwardRef(({className:e,sideOffset:i=4,...s},a)=>jsxRuntimeExports.jsx(Content2$2,{ref:a,sideOffset:i,className:cn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));TooltipContent.displayName=Content2$2.displayName;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},isServer=typeof window>"u"||"Deno"in globalThis;function noop$1(){}function functionalUpdate(e,i){return typeof e=="function"?e(i):e}function isValidTimeout(e){return typeof e=="number"&&e>=0&&e!==1/0}function timeUntilStale(e,i){return Math.max(e+(i||0)-Date.now(),0)}function resolveStaleTime(e,i){return typeof e=="function"?e(i):e}function resolveEnabled(e,i){return typeof e=="function"?e(i):e}function matchQuery(e,i){const{type:s="all",exact:a,fetchStatus:o,predicate:c,queryKey:d,stale:h}=e;if(d){if(a){if(i.queryHash!==hashQueryKeyByOptions(d,i.options))return!1}else if(!partialMatchKey(i.queryKey,d))return!1}if(s!=="all"){const g=i.isActive();if(s==="active"&&!g||s==="inactive"&&g)return!1}return!(typeof h=="boolean"&&i.isStale()!==h||o&&o!==i.state.fetchStatus||c&&!c(i))}function matchMutation(e,i){const{exact:s,status:a,predicate:o,mutationKey:c}=e;if(c){if(!i.options.mutationKey)return!1;if(s){if(hashKey(i.options.mutationKey)!==hashKey(c))return!1}else if(!partialMatchKey(i.options.mutationKey,c))return!1}return!(a&&i.state.status!==a||o&&!o(i))}function hashQueryKeyByOptions(e,i){return((i==null?void 0:i.queryKeyHashFn)||hashKey)(e)}function hashKey(e){return JSON.stringify(e,(i,s)=>isPlainObject(s)?Object.keys(s).sort().reduce((a,o)=>(a[o]=s[o],a),{}):s)}function partialMatchKey(e,i){return e===i?!0:typeof e!=typeof i?!1:e&&i&&typeof e=="object"&&typeof i=="object"?!Object.keys(i).some(s=>!partialMatchKey(e[s],i[s])):!1}function replaceEqualDeep(e,i){if(e===i)return e;const s=isPlainArray(e)&&isPlainArray(i);if(s||isPlainObject(e)&&isPlainObject(i)){const a=s?e:Object.keys(e),o=a.length,c=s?i:Object.keys(i),d=c.length,h=s?[]:{};let g=0;for(let _=0;_<d;_++){const b=s?_:c[_];(!s&&a.includes(b)||s)&&e[b]===void 0&&i[b]===void 0?(h[b]=void 0,g++):(h[b]=replaceEqualDeep(e[b],i[b]),h[b]===e[b]&&e[b]!==void 0&&g++)}return o===d&&g===o?e:h}return i}function isPlainArray(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function isPlainObject(e){if(!hasObjectPrototype(e))return!1;const i=e.constructor;if(i===void 0)return!0;const s=i.prototype;return!(!hasObjectPrototype(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function hasObjectPrototype(e){return Object.prototype.toString.call(e)==="[object Object]"}function sleep(e){return new Promise(i=>{setTimeout(i,e)})}function replaceData(e,i,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,i):s.structuralSharing!==!1?replaceEqualDeep(e,i):i}function addToEnd(e,i,s=0){const a=[...e,i];return s&&a.length>s?a.slice(1):a}function addToStart(e,i,s=0){const a=[i,...e];return s&&a.length>s?a.slice(0,-1):a}var skipToken=Symbol();function ensureQueryFn(e,i){return!e.queryFn&&(i!=null&&i.initialPromise)?()=>i.initialPromise:!e.queryFn||e.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var $n,In,qn,oo,FocusManager=(oo=class extends Subscribable{constructor(){super();Sr(this,$n);Sr(this,In);Sr(this,qn);yr(this,qn,i=>{if(!isServer&&window.addEventListener){const s=()=>i();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){ht(this,In)||this.setEventListener(ht(this,qn))}onUnsubscribe(){var i;this.hasListeners()||((i=ht(this,In))==null||i.call(this),yr(this,In,void 0))}setEventListener(i){var s;yr(this,qn,i),(s=ht(this,In))==null||s.call(this),yr(this,In,i(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(i){ht(this,$n)!==i&&(yr(this,$n,i),this.onFocus())}onFocus(){const i=this.isFocused();this.listeners.forEach(s=>{s(i)})}isFocused(){var i;return typeof ht(this,$n)=="boolean"?ht(this,$n):((i=globalThis.document)==null?void 0:i.visibilityState)!=="hidden"}},$n=new WeakMap,In=new WeakMap,qn=new WeakMap,oo),focusManager=new FocusManager,Qn,Mn,Jn,lo,OnlineManager=(lo=class extends Subscribable{constructor(){super();Sr(this,Qn,!0);Sr(this,Mn);Sr(this,Jn);yr(this,Jn,i=>{if(!isServer&&window.addEventListener){const s=()=>i(!0),a=()=>i(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}}})}onSubscribe(){ht(this,Mn)||this.setEventListener(ht(this,Jn))}onUnsubscribe(){var i;this.hasListeners()||((i=ht(this,Mn))==null||i.call(this),yr(this,Mn,void 0))}setEventListener(i){var s;yr(this,Jn,i),(s=ht(this,Mn))==null||s.call(this),yr(this,Mn,i(this.setOnline.bind(this)))}setOnline(i){ht(this,Qn)!==i&&(yr(this,Qn,i),this.listeners.forEach(a=>{a(i)}))}isOnline(){return ht(this,Qn)}},Qn=new WeakMap,Mn=new WeakMap,Jn=new WeakMap,lo),onlineManager=new OnlineManager;function pendingThenable(){let e,i;const s=new Promise((o,c)=>{e=o,i=c});s.status="pending",s.catch(()=>{});function a(o){Object.assign(s,o),delete s.resolve,delete s.reject}return s.resolve=o=>{a({status:"fulfilled",value:o}),e(o)},s.reject=o=>{a({status:"rejected",reason:o}),i(o)},s}function defaultRetryDelay(e){return Math.min(1e3*2**e,3e4)}function canFetch(e){return(e??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function isCancelledError(e){return e instanceof CancelledError}function createRetryer(e){let i=!1,s=0,a=!1,o;const c=pendingThenable(),d=et=>{var nt;a||(_e(new CancelledError(et)),(nt=e.abort)==null||nt.call(e))},h=()=>{i=!0},g=()=>{i=!1},_=()=>focusManager.isFocused()&&(e.networkMode==="always"||onlineManager.isOnline())&&e.canRun(),b=()=>canFetch(e.networkMode)&&e.canRun(),tt=et=>{var nt;a||(a=!0,(nt=e.onSuccess)==null||nt.call(e,et),o==null||o(),c.resolve(et))},_e=et=>{var nt;a||(a=!0,(nt=e.onError)==null||nt.call(e,et),o==null||o(),c.reject(et))},rt=()=>new Promise(et=>{var nt;o=at=>{(a||_())&&et(at)},(nt=e.onPause)==null||nt.call(e)}).then(()=>{var et;o=void 0,a||(et=e.onContinue)==null||et.call(e)}),it=()=>{if(a)return;let et;const nt=s===0?e.initialPromise:void 0;try{et=nt??e.fn()}catch(at){et=Promise.reject(at)}Promise.resolve(et).then(tt).catch(at=>{var wt;if(a)return;const st=e.retry??(isServer?0:3),ot=e.retryDelay??defaultRetryDelay,pt=typeof ot=="function"?ot(s,at):ot,dt=st===!0||typeof st=="number"&&s<st||typeof st=="function"&&st(s,at);if(i||!dt){_e(at);return}s++,(wt=e.onFail)==null||wt.call(e,s,at),sleep(pt).then(()=>_()?void 0:rt()).then(()=>{i?_e(at):it()})})};return{promise:c,cancel:d,continue:()=>(o==null||o(),c),cancelRetry:h,continueRetry:g,canStart:b,start:()=>(b()?it():rt().then(it),c)}}function createNotifyManager(){let e=[],i=0,s=h=>{h()},a=h=>{h()},o=h=>setTimeout(h,0);const c=h=>{i?e.push(h):o(()=>{s(h)})},d=()=>{const h=e;e=[],h.length&&o(()=>{a(()=>{h.forEach(g=>{s(g)})})})};return{batch:h=>{let g;i++;try{g=h()}finally{i--,i||d()}return g},batchCalls:h=>(...g)=>{c(()=>{h(...g)})},schedule:c,setNotifyFunction:h=>{s=h},setBatchNotifyFunction:h=>{a=h},setScheduler:h=>{o=h}}}var notifyManager=createNotifyManager(),zn,co,Removable=(co=class{constructor(){Sr(this,zn)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&yr(this,zn,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(isServer?1/0:5*60*1e3))}clearGcTimeout(){ht(this,zn)&&(clearTimeout(ht(this,zn)),yr(this,zn,void 0))}},zn=new WeakMap,co),Zn,_i,bn,yn,ps,Hn,An,kn,uo,Query=(uo=class extends Removable{constructor(i){super();Sr(this,An);Sr(this,Zn);Sr(this,_i);Sr(this,bn);Sr(this,yn);Sr(this,ps);Sr(this,Hn);yr(this,Hn,!1),yr(this,ps,i.defaultOptions),this.setOptions(i.options),this.observers=[],yr(this,bn,i.cache),this.queryKey=i.queryKey,this.queryHash=i.queryHash,yr(this,Zn,getDefaultState$1(this.options)),this.state=i.state??ht(this,Zn),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var i;return(i=ht(this,yn))==null?void 0:i.promise}setOptions(i){this.options={...ht(this,ps),...i},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ht(this,bn).remove(this)}setData(i,s){const a=replaceData(this.state.data,i,this.options);return mr(this,An,kn).call(this,{data:a,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),a}setState(i,s){mr(this,An,kn).call(this,{type:"setState",state:i,setStateOptions:s})}cancel(i){var a,o;const s=(a=ht(this,yn))==null?void 0:a.promise;return(o=ht(this,yn))==null||o.cancel(i),s?s.then(noop$1).catch(noop$1):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ht(this,Zn))}isActive(){return this.observers.some(i=>resolveEnabled(i.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(i=>i.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(i=0){return this.state.isInvalidated||this.state.data===void 0||!timeUntilStale(this.state.dataUpdatedAt,i)}onFocus(){var s;const i=this.observers.find(a=>a.shouldFetchOnWindowFocus());i==null||i.refetch({cancelRefetch:!1}),(s=ht(this,yn))==null||s.continue()}onOnline(){var s;const i=this.observers.find(a=>a.shouldFetchOnReconnect());i==null||i.refetch({cancelRefetch:!1}),(s=ht(this,yn))==null||s.continue()}addObserver(i){this.observers.includes(i)||(this.observers.push(i),this.clearGcTimeout(),ht(this,bn).notify({type:"observerAdded",query:this,observer:i}))}removeObserver(i){this.observers.includes(i)&&(this.observers=this.observers.filter(s=>s!==i),this.observers.length||(ht(this,yn)&&(ht(this,Hn)?ht(this,yn).cancel({revert:!0}):ht(this,yn).cancelRetry()),this.scheduleGc()),ht(this,bn).notify({type:"observerRemoved",query:this,observer:i}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||mr(this,An,kn).call(this,{type:"invalidate"})}fetch(i,s){var g,_,b;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(ht(this,yn))return ht(this,yn).continueRetry(),ht(this,yn).promise}if(i&&this.setOptions(i),!this.options.queryFn){const tt=this.observers.find(_e=>_e.options.queryFn);tt&&this.setOptions(tt.options)}const a=new AbortController,o=tt=>{Object.defineProperty(tt,"signal",{enumerable:!0,get:()=>(yr(this,Hn,!0),a.signal)})},c=()=>{const tt=ensureQueryFn(this.options,s),_e={queryKey:this.queryKey,meta:this.meta};return o(_e),yr(this,Hn,!1),this.options.persister?this.options.persister(tt,_e,this):tt(_e)},d={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:c};o(d),(g=this.options.behavior)==null||g.onFetch(d,this),yr(this,_i,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((_=d.fetchOptions)==null?void 0:_.meta))&&mr(this,An,kn).call(this,{type:"fetch",meta:(b=d.fetchOptions)==null?void 0:b.meta});const h=tt=>{var _e,rt,it,et;isCancelledError(tt)&&tt.silent||mr(this,An,kn).call(this,{type:"error",error:tt}),isCancelledError(tt)||((rt=(_e=ht(this,bn).config).onError)==null||rt.call(_e,tt,this),(et=(it=ht(this,bn).config).onSettled)==null||et.call(it,this.state.data,tt,this)),this.scheduleGc()};return yr(this,yn,createRetryer({initialPromise:s==null?void 0:s.initialPromise,fn:d.fetchFn,abort:a.abort.bind(a),onSuccess:tt=>{var _e,rt,it,et;if(tt===void 0){h(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(tt)}catch(nt){h(nt);return}(rt=(_e=ht(this,bn).config).onSuccess)==null||rt.call(_e,tt,this),(et=(it=ht(this,bn).config).onSettled)==null||et.call(it,tt,this.state.error,this),this.scheduleGc()},onError:h,onFail:(tt,_e)=>{mr(this,An,kn).call(this,{type:"failed",failureCount:tt,error:_e})},onPause:()=>{mr(this,An,kn).call(this,{type:"pause"})},onContinue:()=>{mr(this,An,kn).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0})),ht(this,yn).start()}},Zn=new WeakMap,_i=new WeakMap,bn=new WeakMap,yn=new WeakMap,ps=new WeakMap,Hn=new WeakMap,An=new WeakSet,kn=function(i){const s=a=>{switch(i.type){case"failed":return{...a,fetchFailureCount:i.failureCount,fetchFailureReason:i.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...fetchState(a.data,this.options),fetchMeta:i.meta??null};case"success":return{...a,data:i.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:i.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!i.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=i.error;return isCancelledError(o)&&o.revert&&ht(this,_i)?{...ht(this,_i),fetchStatus:"idle"}:{...a,error:o,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...i.state}}};this.state=s(this.state),notifyManager.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),ht(this,bn).notify({query:this,type:"updated",action:i})})},uo);function fetchState(e,i){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(i.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(e){const i=typeof e.initialData=="function"?e.initialData():e.initialData,s=i!==void 0,a=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:i,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Tn,fo,QueryCache=(fo=class extends Subscribable{constructor(i={}){super();Sr(this,Tn);this.config=i,yr(this,Tn,new Map)}build(i,s,a){const o=s.queryKey,c=s.queryHash??hashQueryKeyByOptions(o,s);let d=this.get(c);return d||(d=new Query({cache:this,queryKey:o,queryHash:c,options:i.defaultQueryOptions(s),state:a,defaultOptions:i.getQueryDefaults(o)}),this.add(d)),d}add(i){ht(this,Tn).has(i.queryHash)||(ht(this,Tn).set(i.queryHash,i),this.notify({type:"added",query:i}))}remove(i){const s=ht(this,Tn).get(i.queryHash);s&&(i.destroy(),s===i&&ht(this,Tn).delete(i.queryHash),this.notify({type:"removed",query:i}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(i=>{this.remove(i)})})}get(i){return ht(this,Tn).get(i)}getAll(){return[...ht(this,Tn).values()]}find(i){const s={exact:!0,...i};return this.getAll().find(a=>matchQuery(s,a))}findAll(i={}){const s=this.getAll();return Object.keys(i).length>0?s.filter(a=>matchQuery(i,a)):s}notify(i){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(i)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(i=>{i.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(i=>{i.onOnline()})})}},Tn=new WeakMap,fo),Cn,wn,Wn,Rn,Nn,ho,Mutation=(ho=class extends Removable{constructor(i){super();Sr(this,Rn);Sr(this,Cn);Sr(this,wn);Sr(this,Wn);this.mutationId=i.mutationId,yr(this,wn,i.mutationCache),yr(this,Cn,[]),this.state=i.state||getDefaultState(),this.setOptions(i.options),this.scheduleGc()}setOptions(i){this.options=i,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(i){ht(this,Cn).includes(i)||(ht(this,Cn).push(i),this.clearGcTimeout(),ht(this,wn).notify({type:"observerAdded",mutation:this,observer:i}))}removeObserver(i){yr(this,Cn,ht(this,Cn).filter(s=>s!==i)),this.scheduleGc(),ht(this,wn).notify({type:"observerRemoved",mutation:this,observer:i})}optionalRemove(){ht(this,Cn).length||(this.state.status==="pending"?this.scheduleGc():ht(this,wn).remove(this))}continue(){var i;return((i=ht(this,Wn))==null?void 0:i.continue())??this.execute(this.state.variables)}async execute(i){var o,c,d,h,g,_,b,tt,_e,rt,it,et,nt,at,st,ot,pt,dt,wt,lt;yr(this,Wn,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(i):Promise.reject(new Error("No mutationFn found")),onFail:(gt,vt)=>{mr(this,Rn,Nn).call(this,{type:"failed",failureCount:gt,error:vt})},onPause:()=>{mr(this,Rn,Nn).call(this,{type:"pause"})},onContinue:()=>{mr(this,Rn,Nn).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ht(this,wn).canRun(this)}));const s=this.state.status==="pending",a=!ht(this,Wn).canStart();try{if(!s){mr(this,Rn,Nn).call(this,{type:"pending",variables:i,isPaused:a}),await((c=(o=ht(this,wn).config).onMutate)==null?void 0:c.call(o,i,this));const vt=await((h=(d=this.options).onMutate)==null?void 0:h.call(d,i));vt!==this.state.context&&mr(this,Rn,Nn).call(this,{type:"pending",context:vt,variables:i,isPaused:a})}const gt=await ht(this,Wn).start();return await((_=(g=ht(this,wn).config).onSuccess)==null?void 0:_.call(g,gt,i,this.state.context,this)),await((tt=(b=this.options).onSuccess)==null?void 0:tt.call(b,gt,i,this.state.context)),await((rt=(_e=ht(this,wn).config).onSettled)==null?void 0:rt.call(_e,gt,null,this.state.variables,this.state.context,this)),await((et=(it=this.options).onSettled)==null?void 0:et.call(it,gt,null,i,this.state.context)),mr(this,Rn,Nn).call(this,{type:"success",data:gt}),gt}catch(gt){try{throw await((at=(nt=ht(this,wn).config).onError)==null?void 0:at.call(nt,gt,i,this.state.context,this)),await((ot=(st=this.options).onError)==null?void 0:ot.call(st,gt,i,this.state.context)),await((dt=(pt=ht(this,wn).config).onSettled)==null?void 0:dt.call(pt,void 0,gt,this.state.variables,this.state.context,this)),await((lt=(wt=this.options).onSettled)==null?void 0:lt.call(wt,void 0,gt,i,this.state.context)),gt}finally{mr(this,Rn,Nn).call(this,{type:"error",error:gt})}}finally{ht(this,wn).runNext(this)}}},Cn=new WeakMap,wn=new WeakMap,Wn=new WeakMap,Rn=new WeakSet,Nn=function(i){const s=a=>{switch(i.type){case"failed":return{...a,failureCount:i.failureCount,failureReason:i.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:i.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:i.isPaused,status:"pending",variables:i.variables,submittedAt:Date.now()};case"success":return{...a,data:i.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:i.error,failureCount:a.failureCount+1,failureReason:i.error,isPaused:!1,status:"error"}}};this.state=s(this.state),notifyManager.batch(()=>{ht(this,Cn).forEach(a=>{a.onMutationUpdate(i)}),ht(this,wn).notify({mutation:this,type:"updated",action:i})})},ho);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var En,ms,po,MutationCache=(po=class extends Subscribable{constructor(i={}){super();Sr(this,En);Sr(this,ms);this.config=i,yr(this,En,new Map),yr(this,ms,Date.now())}build(i,s,a){const o=new Mutation({mutationCache:this,mutationId:++On(this,ms)._,options:i.defaultMutationOptions(s),state:a});return this.add(o),o}add(i){const s=scopeFor(i),a=ht(this,En).get(s)??[];a.push(i),ht(this,En).set(s,a),this.notify({type:"added",mutation:i})}remove(i){var a;const s=scopeFor(i);if(ht(this,En).has(s)){const o=(a=ht(this,En).get(s))==null?void 0:a.filter(c=>c!==i);o&&(o.length===0?ht(this,En).delete(s):ht(this,En).set(s,o))}this.notify({type:"removed",mutation:i})}canRun(i){var a;const s=(a=ht(this,En).get(scopeFor(i)))==null?void 0:a.find(o=>o.state.status==="pending");return!s||s===i}runNext(i){var a;const s=(a=ht(this,En).get(scopeFor(i)))==null?void 0:a.find(o=>o!==i&&o.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}clear(){notifyManager.batch(()=>{this.getAll().forEach(i=>{this.remove(i)})})}getAll(){return[...ht(this,En).values()].flat()}find(i){const s={exact:!0,...i};return this.getAll().find(a=>matchMutation(s,a))}findAll(i={}){return this.getAll().filter(s=>matchMutation(i,s))}notify(i){notifyManager.batch(()=>{this.listeners.forEach(s=>{s(i)})})}resumePausedMutations(){const i=this.getAll().filter(s=>s.state.isPaused);return notifyManager.batch(()=>Promise.all(i.map(s=>s.continue().catch(noop$1))))}},En=new WeakMap,ms=new WeakMap,po);function scopeFor(e){var i;return((i=e.options.scope)==null?void 0:i.id)??String(e.mutationId)}function infiniteQueryBehavior(e){return{onFetch:(i,s)=>{var b,tt,_e,rt,it;const a=i.options,o=(_e=(tt=(b=i.fetchOptions)==null?void 0:b.meta)==null?void 0:tt.fetchMore)==null?void 0:_e.direction,c=((rt=i.state.data)==null?void 0:rt.pages)||[],d=((it=i.state.data)==null?void 0:it.pageParams)||[];let h={pages:[],pageParams:[]},g=0;const _=async()=>{let et=!1;const nt=ot=>{Object.defineProperty(ot,"signal",{enumerable:!0,get:()=>(i.signal.aborted?et=!0:i.signal.addEventListener("abort",()=>{et=!0}),i.signal)})},at=ensureQueryFn(i.options,i.fetchOptions),st=async(ot,pt,dt)=>{if(et)return Promise.reject();if(pt==null&&ot.pages.length)return Promise.resolve(ot);const wt={queryKey:i.queryKey,pageParam:pt,direction:dt?"backward":"forward",meta:i.options.meta};nt(wt);const lt=await at(wt),{maxPages:gt}=i.options,vt=dt?addToStart:addToEnd;return{pages:vt(ot.pages,lt,gt),pageParams:vt(ot.pageParams,pt,gt)}};if(o&&c.length){const ot=o==="backward",pt=ot?getPreviousPageParam:getNextPageParam,dt={pages:c,pageParams:d},wt=pt(a,dt);h=await st(dt,wt,ot)}else{const ot=e??c.length;do{const pt=g===0?d[0]??a.initialPageParam:getNextPageParam(a,h);if(g>0&&pt==null)break;h=await st(h,pt),g++}while(g<ot)}return h};i.options.persister?i.fetchFn=()=>{var et,nt;return(nt=(et=i.options).persister)==null?void 0:nt.call(et,_,{queryKey:i.queryKey,meta:i.options.meta,signal:i.signal},s)}:i.fetchFn=_}}}function getNextPageParam(e,{pages:i,pageParams:s}){const a=i.length-1;return i.length>0?e.getNextPageParam(i[a],i,s[a],s):void 0}function getPreviousPageParam(e,{pages:i,pageParams:s}){var a;return i.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,i[0],i,s[0],s):void 0}var vn,Dn,Ln,es,ts,jn,rs,ns,mo,QueryClient=(mo=class{constructor(e={}){Sr(this,vn);Sr(this,Dn);Sr(this,Ln);Sr(this,es);Sr(this,ts);Sr(this,jn);Sr(this,rs);Sr(this,ns);yr(this,vn,e.queryCache||new QueryCache),yr(this,Dn,e.mutationCache||new MutationCache),yr(this,Ln,e.defaultOptions||{}),yr(this,es,new Map),yr(this,ts,new Map),yr(this,jn,0)}mount(){On(this,jn)._++,ht(this,jn)===1&&(yr(this,rs,focusManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ht(this,vn).onFocus())})),yr(this,ns,onlineManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),ht(this,vn).onOnline())})))}unmount(){var e,i;On(this,jn)._--,ht(this,jn)===0&&((e=ht(this,rs))==null||e.call(this),yr(this,rs,void 0),(i=ht(this,ns))==null||i.call(this),yr(this,ns,void 0))}isFetching(e){return ht(this,vn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ht(this,Dn).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const i=this.defaultQueryOptions({queryKey:e});return(s=ht(this,vn).get(i.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const i=this.getQueryData(e.queryKey);if(i===void 0)return this.fetchQuery(e);{const s=this.defaultQueryOptions(e),a=ht(this,vn).build(this,s);return e.revalidateIfStale&&a.isStaleByTime(resolveStaleTime(s.staleTime,a))&&this.prefetchQuery(s),Promise.resolve(i)}}getQueriesData(e){return ht(this,vn).findAll(e).map(({queryKey:i,state:s})=>{const a=s.data;return[i,a]})}setQueryData(e,i,s){const a=this.defaultQueryOptions({queryKey:e}),o=ht(this,vn).get(a.queryHash),c=o==null?void 0:o.state.data,d=functionalUpdate(i,c);if(d!==void 0)return ht(this,vn).build(this,a).setData(d,{...s,manual:!0})}setQueriesData(e,i,s){return notifyManager.batch(()=>ht(this,vn).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,i,s)]))}getQueryState(e){var s;const i=this.defaultQueryOptions({queryKey:e});return(s=ht(this,vn).get(i.queryHash))==null?void 0:s.state}removeQueries(e){const i=ht(this,vn);notifyManager.batch(()=>{i.findAll(e).forEach(s=>{i.remove(s)})})}resetQueries(e,i){const s=ht(this,vn),a={type:"active",...e};return notifyManager.batch(()=>(s.findAll(e).forEach(o=>{o.reset()}),this.refetchQueries(a,i)))}cancelQueries(e={},i={}){const s={revert:!0,...i},a=notifyManager.batch(()=>ht(this,vn).findAll(e).map(o=>o.cancel(s)));return Promise.all(a).then(noop$1).catch(noop$1)}invalidateQueries(e={},i={}){return notifyManager.batch(()=>{if(ht(this,vn).findAll(e).forEach(a=>{a.invalidate()}),e.refetchType==="none")return Promise.resolve();const s={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(s,i)})}refetchQueries(e={},i){const s={...i,cancelRefetch:(i==null?void 0:i.cancelRefetch)??!0},a=notifyManager.batch(()=>ht(this,vn).findAll(e).filter(o=>!o.isDisabled()).map(o=>{let c=o.fetch(void 0,s);return s.throwOnError||(c=c.catch(noop$1)),o.state.fetchStatus==="paused"?Promise.resolve():c}));return Promise.all(a).then(noop$1)}fetchQuery(e){const i=this.defaultQueryOptions(e);i.retry===void 0&&(i.retry=!1);const s=ht(this,vn).build(this,i);return s.isStaleByTime(resolveStaleTime(i.staleTime,s))?s.fetch(i):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(noop$1).catch(noop$1)}fetchInfiniteQuery(e){return e.behavior=infiniteQueryBehavior(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(noop$1).catch(noop$1)}ensureInfiniteQueryData(e){return e.behavior=infiniteQueryBehavior(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return onlineManager.isOnline()?ht(this,Dn).resumePausedMutations():Promise.resolve()}getQueryCache(){return ht(this,vn)}getMutationCache(){return ht(this,Dn)}getDefaultOptions(){return ht(this,Ln)}setDefaultOptions(e){yr(this,Ln,e)}setQueryDefaults(e,i){ht(this,es).set(hashKey(e),{queryKey:e,defaultOptions:i})}getQueryDefaults(e){const i=[...ht(this,es).values()];let s={};return i.forEach(a=>{partialMatchKey(e,a.queryKey)&&(s={...s,...a.defaultOptions})}),s}setMutationDefaults(e,i){ht(this,ts).set(hashKey(e),{mutationKey:e,defaultOptions:i})}getMutationDefaults(e){const i=[...ht(this,ts).values()];let s={};return i.forEach(a=>{partialMatchKey(e,a.mutationKey)&&(s={...s,...a.defaultOptions})}),s}defaultQueryOptions(e){if(e._defaulted)return e;const i={...ht(this,Ln).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return i.queryHash||(i.queryHash=hashQueryKeyByOptions(i.queryKey,i)),i.refetchOnReconnect===void 0&&(i.refetchOnReconnect=i.networkMode!=="always"),i.throwOnError===void 0&&(i.throwOnError=!!i.suspense),!i.networkMode&&i.persister&&(i.networkMode="offlineFirst"),i.enabled!==!0&&i.queryFn===skipToken&&(i.enabled=!1),i}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ht(this,Ln).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ht(this,vn).clear(),ht(this,Dn).clear()}},vn=new WeakMap,Dn=new WeakMap,Ln=new WeakMap,es=new WeakMap,ts=new WeakMap,jn=new WeakMap,rs=new WeakMap,ns=new WeakMap,mo),QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:e,children:i})=>(reactExports.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:e,children:i}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$2.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function i(a,o){let{pathname:c,search:d,hash:h}=a.location;return createLocation("",{pathname:c,search:d,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function s(a,o){return typeof o=="string"?o:createPath(o)}return getUrlBasedHistory(i,s,null,e)}function invariant(e,i){if(e===!1||e===null||typeof e>"u")throw new Error(i)}function warning(e,i){if(!e){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,i){return{usr:e.state,key:e.key,idx:i}}function createLocation(e,i,s,a){return s===void 0&&(s=null),_extends$2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:s,key:i&&i.key||a||createKey()})}function createPath(e){let{pathname:i="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(i+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(i+=a.charAt(0)==="#"?a:"#"+a),i}function parsePath(e){let i={};if(e){let s=e.indexOf("#");s>=0&&(i.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(i.search=e.substr(a),e=e.substr(0,a)),e&&(i.pathname=e)}return i}function getUrlBasedHistory(e,i,s,a){a===void 0&&(a={});let{window:o=document.defaultView,v5Compat:c=!1}=a,d=o.history,h=Action.Pop,g=null,_=b();_==null&&(_=0,d.replaceState(_extends$2({},d.state,{idx:_}),""));function b(){return(d.state||{idx:null}).idx}function tt(){h=Action.Pop;let nt=b(),at=nt==null?null:nt-_;_=nt,g&&g({action:h,location:et.location,delta:at})}function _e(nt,at){h=Action.Push;let st=createLocation(et.location,nt,at);_=b()+1;let ot=getHistoryState(st,_),pt=et.createHref(st);try{d.pushState(ot,"",pt)}catch(dt){if(dt instanceof DOMException&&dt.name==="DataCloneError")throw dt;o.location.assign(pt)}c&&g&&g({action:h,location:et.location,delta:1})}function rt(nt,at){h=Action.Replace;let st=createLocation(et.location,nt,at);_=b();let ot=getHistoryState(st,_),pt=et.createHref(st);d.replaceState(ot,"",pt),c&&g&&g({action:h,location:et.location,delta:0})}function it(nt){let at=o.location.origin!=="null"?o.location.origin:o.location.href,st=typeof nt=="string"?nt:createPath(nt);return st=st.replace(/ $/,"%20"),invariant(at,"No window.location.(origin|href) available to create URL for href: "+st),new URL(st,at)}let et={get action(){return h},get location(){return e(o,d)},listen(nt){if(g)throw new Error("A history only accepts one active listener");return o.addEventListener(PopStateEventType,tt),g=nt,()=>{o.removeEventListener(PopStateEventType,tt),g=null}},createHref(nt){return i(o,nt)},createURL:it,encodeLocation(nt){let at=it(nt);return{pathname:at.pathname,search:at.search,hash:at.hash}},push:_e,replace:rt,go(nt){return d.go(nt)}};return et}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,i,s){return s===void 0&&(s="/"),matchRoutesImpl(e,i,s,!1)}function matchRoutesImpl(e,i,s,a){let o=typeof i=="string"?parsePath(i):i,c=stripBasename(o.pathname||"/",s);if(c==null)return null;let d=flattenRoutes(e);rankRouteBranches(d);let h=null;for(let g=0;h==null&&g<d.length;++g){let _=decodePath(c);h=matchRouteBranch(d[g],_,a)}return h}function flattenRoutes(e,i,s,a){i===void 0&&(i=[]),s===void 0&&(s=[]),a===void 0&&(a="");let o=(c,d,h)=>{let g={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};g.relativePath.startsWith("/")&&(invariant(g.relativePath.startsWith(a),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(a.length));let _=joinPaths([a,g.relativePath]),b=s.concat(g);c.children&&c.children.length>0&&(invariant(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),flattenRoutes(c.children,i,b,_)),!(c.path==null&&!c.index)&&i.push({path:_,score:computeScore(_,c.index),routesMeta:b})};return e.forEach((c,d)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))o(c,d);else for(let g of explodeOptionalSegments(c.path))o(c,d,g)}),i}function explodeOptionalSegments(e){let i=e.split("/");if(i.length===0)return[];let[s,...a]=i,o=s.endsWith("?"),c=s.replace(/\?$/,"");if(a.length===0)return o?[c,""]:[c];let d=explodeOptionalSegments(a.join("/")),h=[];return h.push(...d.map(g=>g===""?c:[c,g].join("/"))),o&&h.push(...d),h.map(g=>e.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(e){e.sort((i,s)=>i.score!==s.score?s.score-i.score:compareIndexes(i.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,i){let s=e.split("/"),a=s.length;return s.some(isSplat)&&(a+=splatPenalty),i&&(a+=indexRouteValue),s.filter(o=>!isSplat(o)).reduce((o,c)=>o+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(e,i){return e.length===i.length&&e.slice(0,-1).every((a,o)=>a===i[o])?e[e.length-1]-i[i.length-1]:0}function matchRouteBranch(e,i,s){let{routesMeta:a}=e,o={},c="/",d=[];for(let h=0;h<a.length;++h){let g=a[h],_=h===a.length-1,b=c==="/"?i:i.slice(c.length)||"/",tt=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},b),_e=g.route;if(!tt&&_&&s&&!a[a.length-1].route.index&&(tt=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!tt)return null;Object.assign(o,tt.params),d.push({params:o,pathname:joinPaths([c,tt.pathname]),pathnameBase:normalizePathname(joinPaths([c,tt.pathnameBase])),route:_e}),tt.pathnameBase!=="/"&&(c=joinPaths([c,tt.pathnameBase]))}return d}function matchPath(e,i){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=compilePath(e.path,e.caseSensitive,e.end),o=i.match(s);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:a.reduce((_,b,tt)=>{let{paramName:_e,isOptional:rt}=b;if(_e==="*"){let et=h[tt]||"";d=c.slice(0,c.length-et.length).replace(/(.)\/+$/,"$1")}const it=h[tt];return rt&&!it?_[_e]=void 0:_[_e]=(it||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:e}}function compilePath(e,i,s){i===void 0&&(i=!1),s===void 0&&(s=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,h,g)=>(a.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,i?void 0:"i"),a]}function decodePath(e){try{return e.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),e}}function stripBasename(e,i){if(i==="/")return e;if(!e.toLowerCase().startsWith(i.toLowerCase()))return null;let s=i.endsWith("/")?i.length-1:i.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}function resolvePath(e,i){i===void 0&&(i="/");let{pathname:s,search:a="",hash:o=""}=typeof e=="string"?parsePath(e):e;return{pathname:s?s.startsWith("/")?s:resolvePathname(s,i):i,search:normalizeSearch(a),hash:normalizeHash(o)}}function resolvePathname(e,i){let s=i.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?s.length>1&&s.pop():o!=="."&&s.push(o)}),s.length>1?s.join("/"):"/"}function getInvalidPathError(e,i,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((i,s)=>s===0||i.route.path&&i.route.path.length>0)}function getResolveToMatches(e,i){let s=getPathContributingMatches(e);return i?s.map((a,o)=>o===s.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function resolveTo(e,i,s,a){a===void 0&&(a=!1);let o;typeof e=="string"?o=parsePath(e):(o=_extends$2({},e),invariant(!o.pathname||!o.pathname.includes("?"),getInvalidPathError("?","pathname","search",o)),invariant(!o.pathname||!o.pathname.includes("#"),getInvalidPathError("#","pathname","hash",o)),invariant(!o.search||!o.search.includes("#"),getInvalidPathError("#","search","hash",o)));let c=e===""||o.pathname==="",d=c?"/":o.pathname,h;if(d==null)h=s;else{let tt=i.length-1;if(!a&&d.startsWith("..")){let _e=d.split("/");for(;_e[0]==="..";)_e.shift(),tt-=1;o.pathname=_e.join("/")}h=tt>=0?i[tt]:"/"}let g=resolvePath(o,h),_=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&s.endsWith("/");return!g.pathname.endsWith("/")&&(_||b)&&(g.pathname+="/"),g}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(e,i){let{relative:s}=i===void 0?{}:i;useInRouterContext()||invariant(!1);let{basename:a,navigator:o}=reactExports.useContext(NavigationContext),{hash:c,pathname:d,search:h}=useResolvedPath(e,{relative:s}),g=d;return a!=="/"&&(g=d==="/"?a:joinPaths([a,d])),o.createHref({pathname:g,search:h,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:i,future:s,navigator:a}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(o,s.v7_relativeSplatPath)),h=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{h.current=!0}),reactExports.useCallback(function(_,b){if(b===void 0&&(b={}),!h.current)return;if(typeof _=="number"){a.go(_);return}let tt=resolveTo(_,JSON.parse(d),c,b.relative==="path");e==null&&i!=="/"&&(tt.pathname=tt.pathname==="/"?i:joinPaths([i,tt.pathname])),(b.replace?a.replace:a.push)(tt,b.state,b)},[i,a,d,c,e])}function useResolvedPath(e,i){let{relative:s}=i===void 0?{}:i,{future:a}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(o,a.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(d),c,s==="path"),[e,d,c,s])}function useRoutes(e,i){return useRoutesImpl(e,i)}function useRoutesImpl(e,i,s,a){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),d=c[c.length-1],h=d?d.params:{};d&&d.pathname;let g=d?d.pathnameBase:"/";d&&d.route;let _=useLocation(),b;if(i){var tt;let nt=typeof i=="string"?parsePath(i):i;g==="/"||(tt=nt.pathname)!=null&&tt.startsWith(g)||invariant(!1),b=nt}else b=_;let _e=b.pathname||"/",rt=_e;if(g!=="/"){let nt=g.replace(/^\//,"").split("/");rt="/"+_e.replace(/^\//,"").split("/").slice(nt.length).join("/")}let it=matchRoutes(e,{pathname:rt}),et=_renderMatches(it&&it.map(nt=>Object.assign({},nt,{params:Object.assign({},h,nt.params),pathname:joinPaths([g,o.encodeLocation?o.encodeLocation(nt.pathname).pathname:nt.pathname]),pathnameBase:nt.pathnameBase==="/"?g:joinPaths([g,o.encodeLocation?o.encodeLocation(nt.pathnameBase).pathname:nt.pathnameBase])})),c,s,a);return i&&et?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Action.Pop}},et):et}function DefaultErrorComponent(){let e=useRouteError(),i=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),s?reactExports.createElement("pre",{style:o},s):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,s){return s.location!==i.location||s.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:s.error,location:s.location,revalidation:i.revalidation||s.revalidation}}componentDidCatch(i,s){console.error("React Router caught the following error during render",i,s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:i,match:s,children:a}=e,o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=s.route.id),reactExports.createElement(RouteContext.Provider,{value:i},a)}function _renderMatches(e,i,s,a){var o;if(i===void 0&&(i=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var c;if(!s)return null;if(s.errors)e=s.matches;else if((c=a)!=null&&c.v7_partialHydration&&i.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let d=e,h=(o=s)==null?void 0:o.errors;if(h!=null){let b=d.findIndex(tt=>tt.route.id&&(h==null?void 0:h[tt.route.id])!==void 0);b>=0||invariant(!1),d=d.slice(0,Math.min(d.length,b+1))}let g=!1,_=-1;if(s&&a&&a.v7_partialHydration)for(let b=0;b<d.length;b++){let tt=d[b];if((tt.route.HydrateFallback||tt.route.hydrateFallbackElement)&&(_=b),tt.route.id){let{loaderData:_e,errors:rt}=s,it=tt.route.loader&&_e[tt.route.id]===void 0&&(!rt||rt[tt.route.id]===void 0);if(tt.route.lazy||it){g=!0,_>=0?d=d.slice(0,_+1):d=[d[0]];break}}}return d.reduceRight((b,tt,_e)=>{let rt,it=!1,et=null,nt=null;s&&(rt=h&&tt.route.id?h[tt.route.id]:void 0,et=tt.route.errorElement||defaultErrorElement,g&&(_<0&&_e===0?(it=!0,nt=null):_===_e&&(it=!0,nt=tt.route.hydrateFallbackElement||null)));let at=i.concat(d.slice(0,_e+1)),st=()=>{let ot;return rt?ot=et:it?ot=nt:tt.route.Component?ot=reactExports.createElement(tt.route.Component,null):tt.route.element?ot=tt.route.element:ot=b,reactExports.createElement(RenderedRoute,{match:tt,routeContext:{outlet:b,matches:at,isDataRoute:s!=null},children:ot})};return s&&(tt.route.ErrorBoundary||tt.route.errorElement||_e===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,revalidation:s.revalidation,component:et,error:rt,children:st(),routeContext:{outlet:null,matches:at,isDataRoute:!0}}):st()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext(e){let i=reactExports.useContext(DataRouterContext);return i||invariant(!1),i}function useDataRouterState(e){let i=reactExports.useContext(DataRouterStateContext);return i||invariant(!1),i}function useRouteContext(e){let i=reactExports.useContext(RouteContext);return i||invariant(!1),i}function useCurrentRouteId(e){let i=useRouteContext(),s=i.matches[i.matches.length-1];return s.route.id||invariant(!1),s.route.id}function useRouteError(){var e;let i=reactExports.useContext(RouteErrorContext),s=useDataRouterState(DataRouterStateHook$1.UseRouteError),a=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return i!==void 0?i:(e=s.errors)==null?void 0:e[a]}function useNavigateStable(){let{router:e}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),i=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),s=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{s.current=!0}),reactExports.useCallback(function(o,c){c===void 0&&(c={}),s.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,_extends$1({fromRouteId:i},c)))},[e,i])}function Route(e){invariant(!1)}function Router(e){let{basename:i="/",children:s=null,location:a,navigationType:o=Action.Pop,navigator:c,static:d=!1,future:h}=e;useInRouterContext()&&invariant(!1);let g=i.replace(/^\/*/,"/"),_=reactExports.useMemo(()=>({basename:g,navigator:c,static:d,future:_extends$1({v7_relativeSplatPath:!1},h)}),[g,h,c,d]);typeof a=="string"&&(a=parsePath(a));let{pathname:b="/",search:tt="",hash:_e="",state:rt=null,key:it="default"}=a,et=reactExports.useMemo(()=>{let nt=stripBasename(b,g);return nt==null?null:{location:{pathname:nt,search:tt,hash:_e,state:rt,key:it},navigationType:o}},[g,b,tt,_e,rt,it,o]);return et==null?null:reactExports.createElement(NavigationContext.Provider,{value:_},reactExports.createElement(LocationContext.Provider,{children:s,value:et}))}function Routes(e){let{children:i,location:s}=e;return useRoutes(createRoutesFromChildren(i),s)}new Promise(()=>{});function createRoutesFromChildren(e,i){i===void 0&&(i=[]);let s=[];return reactExports.Children.forEach(e,(a,o)=>{if(!reactExports.isValidElement(a))return;let c=[...i,o];if(a.type===reactExports.Fragment){s.push.apply(s,createRoutesFromChildren(a.props.children,c));return}a.type!==Route&&invariant(!1),!a.props.index||!a.props.children||invariant(!1);let d={id:a.props.id||c.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=createRoutesFromChildren(a.props.children,c)),s.push(d)}),s}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(e,i){if(e==null)return{};var s={},a=Object.keys(e),o,c;for(c=0;c<a.length;c++)o=a[c],!(i.indexOf(o)>=0)&&(s[o]=e[o]);return s}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,i){return e.button===0&&(!i||i==="_self")&&!isModifiedEvent(e)}const _excluded$1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(e){let{basename:i,children:s,future:a,window:o}=e,c=reactExports.useRef();c.current==null&&(c.current=createBrowserHistory({window:o,v5Compat:!0}));let d=c.current,[h,g]=reactExports.useState({action:d.action,location:d.location}),{v7_startTransition:_}=a||{},b=reactExports.useCallback(tt=>{_&&startTransitionImpl?startTransitionImpl(()=>g(tt)):g(tt)},[g,_]);return reactExports.useLayoutEffect(()=>d.listen(b),[d,b]),reactExports.createElement(Router,{basename:i,children:s,location:h.location,navigationType:h.action,navigator:d,future:a})}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(i,s){let{onClick:a,relative:o,reloadDocument:c,replace:d,state:h,target:g,to:_,preventScrollReset:b,viewTransition:tt}=i,_e=_objectWithoutPropertiesLoose$1(i,_excluded$1),{basename:rt}=reactExports.useContext(NavigationContext),it,et=!1;if(typeof _=="string"&&ABSOLUTE_URL_REGEX.test(_)&&(it=_,isBrowser))try{let ot=new URL(window.location.href),pt=_.startsWith("//")?new URL(ot.protocol+_):new URL(_),dt=stripBasename(pt.pathname,rt);pt.origin===ot.origin&&dt!=null?_=dt+pt.search+pt.hash:et=!0}catch{}let nt=useHref(_,{relative:o}),at=useLinkClickHandler(_,{replace:d,state:h,target:g,preventScrollReset:b,relative:o,viewTransition:tt});function st(ot){a&&a(ot),ot.defaultPrevented||at(ot)}return reactExports.createElement("a",_extends({},_e,{href:it||nt,onClick:et||c?a:st,ref:s,target:g}))});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(e,i){let{target:s,replace:a,state:o,preventScrollReset:c,relative:d,viewTransition:h}=i===void 0?{}:i,g=useNavigate(),_=useLocation(),b=useResolvedPath(e,{relative:d});return reactExports.useCallback(tt=>{if(shouldProcessLinkClick(tt,s)){tt.preventDefault();let _e=a!==void 0?a:createPath(_)===createPath(b);g(e,{replace:_e,state:o,preventScrollReset:c,relative:d,viewTransition:h})}},[_,g,b,a,o,s,e,c,d,h])}class ErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={hasError:!1}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,s){console.error("ErrorBoundary capturou um erro:",i,s)}render(){return this.state.hasError?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-secondary flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"max-w-md mx-auto text-center p-8",children:jsxRuntimeExports.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-destructive mb-4",children:"Ops! Algo deu errado"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-4",children:"Ocorreu um erro inesperado. Tente recarregar a pgina."}),jsxRuntimeExports.jsx("button",{onClick:()=>window.location.reload(),className:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors",children:"Recarregar Pgina"})]})})}):this.props.children}}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function e(a,o,c,d,h,g){if(g!==ReactPropTypesSecret){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}e.isRequired=e;function i(){return e}var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:i,element:e,elementType:e,instanceOf:i,node:e,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return s.PropTypes=s,s};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var __assign=function(){return __assign=Object.assign||function(i){for(var s,a=1,o=arguments.length;a<o;a++){s=arguments[a];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(i[c]=s[c])}return i},__assign.apply(this,arguments)};function __rest(e,i){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&i.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)i.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(s[a[o]]=e[a[o]]);return s}function __awaiter(e,i,s,a){function o(c){return c instanceof s?c:new s(function(d){d(c)})}return new(s||(s=Promise))(function(c,d){function h(b){try{_(a.next(b))}catch(tt){d(tt)}}function g(b){try{_(a.throw(b))}catch(tt){d(tt)}}function _(b){b.done?c(b.value):o(b.value).then(h,g)}_((a=a.apply(e,i||[])).next())})}function __spreadArray(e,i,s){if(s||arguments.length===2)for(var a=0,o=i.length,c;a<o;a++)(c||!(a in i))&&(c||(c=Array.prototype.slice.call(i,0,a)),c[a]=i[a]);return e.concat(c||Array.prototype.slice.call(i))}typeof SuppressedError=="function"&&SuppressedError;const COMMON_MIME_TYPES=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function toFileWithPath(e,i,s){const a=withMimeType(e),{webkitRelativePath:o}=e,c=typeof i=="string"?i:typeof o=="string"&&o.length>0?o:`./${e.name}`;return typeof a.path!="string"&&setObjProp(a,"path",c),setObjProp(a,"relativePath",c),a}function withMimeType(e){const{name:i}=e;if(i&&i.lastIndexOf(".")!==-1&&!e.type){const a=i.split(".").pop().toLowerCase(),o=COMMON_MIME_TYPES.get(a);o&&Object.defineProperty(e,"type",{value:o,writable:!1,configurable:!1,enumerable:!0})}return e}function setObjProp(e,i,s){Object.defineProperty(e,i,{value:s,writable:!1,configurable:!1,enumerable:!0})}const FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(e){return __awaiter(this,void 0,void 0,function*(){return isObject(e)&&isDataTransfer(e.dataTransfer)?getDataTransferFiles(e.dataTransfer,e.type):isChangeEvt(e)?getInputFiles(e):Array.isArray(e)&&e.every(i=>"getFile"in i&&typeof i.getFile=="function")?getFsHandleFiles(e):[]})}function isDataTransfer(e){return isObject(e)}function isChangeEvt(e){return isObject(e)&&isObject(e.target)}function isObject(e){return typeof e=="object"&&e!==null}function getInputFiles(e){return fromList(e.target.files).map(i=>toFileWithPath(i))}function getFsHandleFiles(e){return __awaiter(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>s.getFile()))).map(s=>toFileWithPath(s))})}function getDataTransferFiles(e,i){return __awaiter(this,void 0,void 0,function*(){if(e.items){const s=fromList(e.items).filter(o=>o.kind==="file");if(i!=="drop")return s;const a=yield Promise.all(s.map(toFilePromises));return noIgnoredFiles(flatten(a))}return noIgnoredFiles(fromList(e.files).map(s=>toFileWithPath(s)))})}function noIgnoredFiles(e){return e.filter(i=>FILES_TO_IGNORE.indexOf(i.name)===-1)}function fromList(e){if(e===null)return[];const i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a)}return i}function toFilePromises(e){if(typeof e.webkitGetAsEntry!="function")return fromDataTransferItem(e);const i=e.webkitGetAsEntry();return i&&i.isDirectory?fromDirEntry(i):fromDataTransferItem(e,i)}function flatten(e){return e.reduce((i,s)=>[...i,...Array.isArray(s)?flatten(s):[s]],[])}function fromDataTransferItem(e,i){return __awaiter(this,void 0,void 0,function*(){var s;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const c=yield e.getAsFileSystemHandle();if(c===null)throw new Error(`${e} is not a File`);if(c!==void 0){const d=yield c.getFile();return d.handle=c,toFileWithPath(d)}}const a=e.getAsFile();if(!a)throw new Error(`${e} is not a File`);return toFileWithPath(a,(s=i==null?void 0:i.fullPath)!==null&&s!==void 0?s:void 0)})}function fromEntry(e){return __awaiter(this,void 0,void 0,function*(){return e.isDirectory?fromDirEntry(e):fromFileEntry(e)})}function fromDirEntry(e){const i=e.createReader();return new Promise((s,a)=>{const o=[];function c(){i.readEntries(d=>__awaiter(this,void 0,void 0,function*(){if(d.length){const h=Promise.all(d.map(fromEntry));o.push(h),c()}else try{const h=yield Promise.all(o);s(h)}catch(h){a(h)}}),d=>{a(d)})}c()})}function fromFileEntry(e){return __awaiter(this,void 0,void 0,function*(){return new Promise((i,s)=>{e.file(a=>{const o=toFileWithPath(a,e.fullPath);i(o)},a=>{s(a)})})})}var _default=function(e,i){if(e&&i){var s=Array.isArray(i)?i:i.split(",");if(s.length===0)return!0;var a=e.name||"",o=(e.type||"").toLowerCase(),c=o.replace(/\/.*$/,"");return s.some(function(d){var h=d.trim().toLowerCase();return h.charAt(0)==="."?a.toLowerCase().endsWith(h):h.endsWith("/*")?c===h.replace(/\/.*$/,""):o===h})}return!0};function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$1(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$1(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$1(e)}function ownKeys$1(e,i){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);i&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),s.push.apply(s,a)}return s}function _objectSpread$1(e){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$1(Object(s),!0).forEach(function(a){_defineProperty$1(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys$1(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function _defineProperty$1(e,i,s){return i in e?Object.defineProperty(e,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[i]=s,e}function _slicedToArray$1(e,i){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,i)||_unsupportedIterableToArray$1(e,i)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(e,i){if(e){if(typeof e=="string")return _arrayLikeToArray$1(e,i);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _arrayLikeToArray$1(e,i)}}function _arrayLikeToArray$1(e,i){(i==null||i>e.length)&&(i=e.length);for(var s=0,a=new Array(i);s<i;s++)a[s]=e[s];return a}function _iterableToArrayLimit$1(e,i){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var a=[],o=!0,c=!1,d,h;try{for(s=s.call(e);!(o=(d=s.next()).done)&&(a.push(d.value),!(i&&a.length===i));o=!0);}catch(g){c=!0,h=g}finally{try{!o&&s.return!=null&&s.return()}finally{if(c)throw h}}return a}}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}var accepts=typeof _default=="function"?_default:_default.default,FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=i.split(","),a=s.length>1?"one of ".concat(s.join(", ")):s[0];return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(a)}},getTooLargeRejectionErr=function(i){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(i," ").concat(i===1?"byte":"bytes")}},getTooSmallRejectionErr=function(i){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(i," ").concat(i===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(e,i){var s=e.type==="application/x-moz-file"||accepts(e,i);return[s,s?null:getInvalidTypeRejectionErr(i)]}function fileMatchSize(e,i,s){if(isDefined(e.size))if(isDefined(i)&&isDefined(s)){if(e.size>s)return[!1,getTooLargeRejectionErr(s)];if(e.size<i)return[!1,getTooSmallRejectionErr(i)]}else{if(isDefined(i)&&e.size<i)return[!1,getTooSmallRejectionErr(i)];if(isDefined(s)&&e.size>s)return[!1,getTooLargeRejectionErr(s)]}return[!0,null]}function isDefined(e){return e!=null}function allFilesAccepted(e){var i=e.files,s=e.accept,a=e.minSize,o=e.maxSize,c=e.multiple,d=e.maxFiles,h=e.validator;return!c&&i.length>1||c&&d>=1&&i.length>d?!1:i.every(function(g){var _=fileAccepted(g,s),b=_slicedToArray$1(_,1),tt=b[0],_e=fileMatchSize(g,a,o),rt=_slicedToArray$1(_e,1),it=rt[0],et=h?h(g):null;return tt&&it&&!et})}function isPropagationStopped(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function isEvtWithFiles(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(i){return i==="Files"||i==="application/x-moz-file"}):!!e.target&&!!e.target.files}function onDocumentDragOver(e){e.preventDefault()}function isIe(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function isEdge(e){return e.indexOf("Edge/")!==-1}function isIeOrEdge(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(e)||isEdge(e)}function composeEventHandlers(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return function(a){for(var o=arguments.length,c=new Array(o>1?o-1:0),d=1;d<o;d++)c[d-1]=arguments[d];return i.some(function(h){return!isPropagationStopped(a)&&h&&h.apply(void 0,[a].concat(c)),isPropagationStopped(a)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function pickerOptionsFromAccept(e){if(isDefined(e)){var i=Object.entries(e).filter(function(s){var a=_slicedToArray$1(s,2),o=a[0],c=a[1],d=!0;return isMIMEType(o)||(console.warn('Skipped "'.concat(o,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),d=!1),(!Array.isArray(c)||!c.every(isExt))&&(console.warn('Skipped "'.concat(o,'" because an invalid file extension was provided.')),d=!1),d}).reduce(function(s,a){var o=_slicedToArray$1(a,2),c=o[0],d=o[1];return _objectSpread$1(_objectSpread$1({},s),{},_defineProperty$1({},c,d))},{});return[{description:"Files",accept:i}]}return e}function acceptPropAsAcceptAttr(e){if(isDefined(e))return Object.entries(e).reduce(function(i,s){var a=_slicedToArray$1(s,2),o=a[0],c=a[1];return[].concat(_toConsumableArray$1(i),[o],_toConsumableArray$1(c))},[]).filter(function(i){return isMIMEType(i)||isExt(i)}).join(",")}function isAbort(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function isSecurityError(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function isMIMEType(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function isExt(e){return/^.*\.[\w]+$/.test(e)}var _excluded=["children"],_excluded2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,i){return _arrayWithHoles(e)||_iterableToArrayLimit(e,i)||_unsupportedIterableToArray(e,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(e,i){if(e){if(typeof e=="string")return _arrayLikeToArray(e,i);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _arrayLikeToArray(e,i)}}function _arrayLikeToArray(e,i){(i==null||i>e.length)&&(i=e.length);for(var s=0,a=new Array(i);s<i;s++)a[s]=e[s];return a}function _iterableToArrayLimit(e,i){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var a=[],o=!0,c=!1,d,h;try{for(s=s.call(e);!(o=(d=s.next()).done)&&(a.push(d.value),!(i&&a.length===i));o=!0);}catch(g){c=!0,h=g}finally{try{!o&&s.return!=null&&s.return()}finally{if(c)throw h}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(e,i){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);i&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),s.push.apply(s,a)}return s}function _objectSpread(e){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?ownKeys(Object(s),!0).forEach(function(a){_defineProperty(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function _defineProperty(e,i,s){return i in e?Object.defineProperty(e,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[i]=s,e}function _objectWithoutProperties(e,i){if(e==null)return{};var s=_objectWithoutPropertiesLoose(e,i),a,o;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)a=c[o],!(i.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function _objectWithoutPropertiesLoose(e,i){if(e==null)return{};var s={},a=Object.keys(e),o,c;for(c=0;c<a.length;c++)o=a[c],!(i.indexOf(o)>=0)&&(s[o]=e[o]);return s}var Dropzone=reactExports.forwardRef(function(e,i){var s=e.children,a=_objectWithoutProperties(e,_excluded),o=useDropzone(a),c=o.open,d=_objectWithoutProperties(o,_excluded2);return reactExports.useImperativeHandle(i,function(){return{open:c}},[c]),React.createElement(reactExports.Fragment,null,s(_objectSpread(_objectSpread({},d),{},{open:c})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.objectOf(PropTypes.arrayOf(PropTypes.string)),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,autoFocus:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,onError:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function useDropzone(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=_objectSpread(_objectSpread({},defaultProps),e),s=i.accept,a=i.disabled,o=i.getFilesFromEvent,c=i.maxSize,d=i.minSize,h=i.multiple,g=i.maxFiles,_=i.onDragEnter,b=i.onDragLeave,tt=i.onDragOver,_e=i.onDrop,rt=i.onDropAccepted,it=i.onDropRejected,et=i.onFileDialogCancel,nt=i.onFileDialogOpen,at=i.useFsAccessApi,st=i.autoFocus,ot=i.preventDropOnDocument,pt=i.noClick,dt=i.noKeyboard,wt=i.noDrag,lt=i.noDragEventsBubbling,gt=i.onError,vt=i.validator,At=reactExports.useMemo(function(){return acceptPropAsAcceptAttr(s)},[s]),yt=reactExports.useMemo(function(){return pickerOptionsFromAccept(s)},[s]),bt=reactExports.useMemo(function(){return typeof nt=="function"?nt:noop},[nt]),Tt=reactExports.useMemo(function(){return typeof et=="function"?et:noop},[et]),er=reactExports.useRef(null),zt=reactExports.useRef(null),ar=reactExports.useReducer(reducer,initialState),Jt=_slicedToArray(ar,2),Yt=Jt[0],kt=Jt[1],ir=Yt.isFocused,fr=Yt.isFileDialogActive,Et=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&at&&canUseFileSystemAccessAPI()),xt=function(){!Et.current&&fr&&setTimeout(function(){if(zt.current){var pr=zt.current.files;pr.length||(kt({type:"closeDialog"}),Tt())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",xt,!1),function(){window.removeEventListener("focus",xt,!1)}},[zt,fr,Tt,Et]);var mt=reactExports.useRef([]),St=function(pr){er.current&&er.current.contains(pr.target)||(pr.preventDefault(),mt.current=[])};reactExports.useEffect(function(){return ot&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",St,!1)),function(){ot&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",St))}},[er,ot]),reactExports.useEffect(function(){return!a&&st&&er.current&&er.current.focus(),function(){}},[er,st,a]);var Pt=reactExports.useCallback(function(Er){gt?gt(Er):console.error(Er)},[gt]),Nt=reactExports.useCallback(function(Er){Er.preventDefault(),Er.persist(),_r(Er),mt.current=[].concat(_toConsumableArray(mt.current),[Er.target]),isEvtWithFiles(Er)&&Promise.resolve(o(Er)).then(function(pr){if(!(isPropagationStopped(Er)&&!lt)){var Wr=pr.length,zr=Wr>0&&allFilesAccepted({files:pr,accept:At,minSize:d,maxSize:c,multiple:h,maxFiles:g,validator:vt}),en=Wr>0&&!zr;kt({isDragAccept:zr,isDragReject:en,isDragActive:!0,type:"setDraggedFiles"}),_&&_(Er)}}).catch(function(pr){return Pt(pr)})},[o,_,Pt,lt,At,d,c,h,g,vt]),Lt=reactExports.useCallback(function(Er){Er.preventDefault(),Er.persist(),_r(Er);var pr=isEvtWithFiles(Er);if(pr&&Er.dataTransfer)try{Er.dataTransfer.dropEffect="copy"}catch{}return pr&&tt&&tt(Er),!1},[tt,lt]),lr=reactExports.useCallback(function(Er){Er.preventDefault(),Er.persist(),_r(Er);var pr=mt.current.filter(function(zr){return er.current&&er.current.contains(zr)}),Wr=pr.indexOf(Er.target);Wr!==-1&&pr.splice(Wr,1),mt.current=pr,!(pr.length>0)&&(kt({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),isEvtWithFiles(Er)&&b&&b(Er))},[er,b,lt]),ur=reactExports.useCallback(function(Er,pr){var Wr=[],zr=[];Er.forEach(function(en){var sn=fileAccepted(en,At),dn=_slicedToArray(sn,2),Kr=dn[0],tn=dn[1],fn=fileMatchSize(en,d,c),hn=_slicedToArray(fn,2),Br=hn[0],br=hn[1],Cr=vt?vt(en):null;if(Kr&&Br&&!Cr)Wr.push(en);else{var Hr=[tn,br];Cr&&(Hr=Hr.concat(Cr)),zr.push({file:en,errors:Hr.filter(function(an){return an})})}}),(!h&&Wr.length>1||h&&g>=1&&Wr.length>g)&&(Wr.forEach(function(en){zr.push({file:en,errors:[TOO_MANY_FILES_REJECTION]})}),Wr.splice(0)),kt({acceptedFiles:Wr,fileRejections:zr,isDragReject:zr.length>0,type:"setFiles"}),_e&&_e(Wr,zr,pr),zr.length>0&&it&&it(zr,pr),Wr.length>0&&rt&&rt(Wr,pr)},[kt,h,At,d,c,g,_e,rt,it,vt]),wr=reactExports.useCallback(function(Er){Er.preventDefault(),Er.persist(),_r(Er),mt.current=[],isEvtWithFiles(Er)&&Promise.resolve(o(Er)).then(function(pr){isPropagationStopped(Er)&&!lt||ur(pr,Er)}).catch(function(pr){return Pt(pr)}),kt({type:"reset"})},[o,ur,Pt,lt]),vr=reactExports.useCallback(function(){if(Et.current){kt({type:"openDialog"}),bt();var Er={multiple:h,types:yt};window.showOpenFilePicker(Er).then(function(pr){return o(pr)}).then(function(pr){ur(pr,null),kt({type:"closeDialog"})}).catch(function(pr){isAbort(pr)?(Tt(pr),kt({type:"closeDialog"})):isSecurityError(pr)?(Et.current=!1,zt.current?(zt.current.value=null,zt.current.click()):Pt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Pt(pr)});return}zt.current&&(kt({type:"openDialog"}),bt(),zt.current.value=null,zt.current.click())},[kt,bt,Tt,at,ur,Pt,yt,h]),Fr=reactExports.useCallback(function(Er){!er.current||!er.current.isEqualNode(Er.target)||(Er.key===" "||Er.key==="Enter"||Er.keyCode===32||Er.keyCode===13)&&(Er.preventDefault(),vr())},[er,vr]),Rr=reactExports.useCallback(function(){kt({type:"focus"})},[]),jr=reactExports.useCallback(function(){kt({type:"blur"})},[]),xr=reactExports.useCallback(function(){pt||(isIeOrEdge()?setTimeout(vr,0):vr())},[pt,vr]),hr=function(pr){return a?null:pr},jt=function(pr){return dt?null:hr(pr)},sr=function(pr){return wt?null:hr(pr)},_r=function(pr){lt&&pr.stopPropagation()},Ar=reactExports.useMemo(function(){return function(){var Er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pr=Er.refKey,Wr=pr===void 0?"ref":pr,zr=Er.role,en=Er.onKeyDown,sn=Er.onFocus,dn=Er.onBlur,Kr=Er.onClick,tn=Er.onDragEnter,fn=Er.onDragOver,hn=Er.onDragLeave,Br=Er.onDrop,br=_objectWithoutProperties(Er,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:jt(composeEventHandlers(en,Fr)),onFocus:jt(composeEventHandlers(sn,Rr)),onBlur:jt(composeEventHandlers(dn,jr)),onClick:hr(composeEventHandlers(Kr,xr)),onDragEnter:sr(composeEventHandlers(tn,Nt)),onDragOver:sr(composeEventHandlers(fn,Lt)),onDragLeave:sr(composeEventHandlers(hn,lr)),onDrop:sr(composeEventHandlers(Br,wr)),role:typeof zr=="string"&&zr!==""?zr:"presentation"},Wr,er),!a&&!dt?{tabIndex:0}:{}),br)}},[er,Fr,Rr,jr,xr,Nt,Lt,lr,wr,dt,wt,a]),Mr=reactExports.useCallback(function(Er){Er.stopPropagation()},[]),Ur=reactExports.useMemo(function(){return function(){var Er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pr=Er.refKey,Wr=pr===void 0?"ref":pr,zr=Er.onChange,en=Er.onClick,sn=_objectWithoutProperties(Er,_excluded4),dn=_defineProperty({accept:At,multiple:h,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:hr(composeEventHandlers(zr,wr)),onClick:hr(composeEventHandlers(en,Mr)),tabIndex:-1},Wr,zt);return _objectSpread(_objectSpread({},dn),sn)}},[zt,s,h,wr,a]);return _objectSpread(_objectSpread({},Yt),{},{isFocused:ir&&!a,getRootProps:Ar,getInputProps:Ur,rootRef:er,inputRef:zt,open:hr(vr)})}function reducer(e,i){switch(i.type){case"focus":return _objectSpread(_objectSpread({},e),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},e),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return _objectSpread(_objectSpread({},e),{},{isDragActive:i.isDragActive,isDragAccept:i.isDragAccept,isDragReject:i.isDragReject});case"setFiles":return _objectSpread(_objectSpread({},e),{},{acceptedFiles:i.acceptedFiles,fileRejections:i.fileRejections,isDragReject:i.isDragReject});case"reset":return _objectSpread({},initialState);default:return e}}function noop(){}const buttonVariants=cva("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-primary hover:shadow-lg transform hover:scale-[1.02]",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"bg-gradient-primary text-primary-foreground hover:shadow-primary transform hover:scale-[1.02]",success:"bg-gradient-success text-success-foreground hover:shadow-lg transform hover:scale-[1.02]"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Button=reactExports.forwardRef(({className:e,variant:i,size:s,asChild:a=!1,...o},c)=>{const d=a?Slot:"button";return jsxRuntimeExports.jsx(d,{className:cn(buttonVariants({variant:i,size:s,className:e})),ref:c,...o})});Button.displayName="Button";const Card=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...i}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("flex flex-col space-y-1.5 p-6",e),...i}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("h3",{ref:s,className:cn("text-2xl font-semibold leading-none tracking-tight",e),...i}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("p",{ref:s,className:cn("text-sm text-muted-foreground",e),...i}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("p-6 pt-0",e),...i}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{ref:s,className:cn("flex items-center p-6 pt-0",e),...i}));CardFooter.displayName="CardFooter";function createContextScope(e,i=[]){let s=[];function a(c,d){const h=reactExports.createContext(d),g=s.length;s=[...s,d];function _(tt){const{scope:_e,children:rt,...it}=tt,et=(_e==null?void 0:_e[e][g])||h,nt=reactExports.useMemo(()=>it,Object.values(it));return jsxRuntimeExports.jsx(et.Provider,{value:nt,children:rt})}function b(tt,_e){const rt=(_e==null?void 0:_e[e][g])||h,it=reactExports.useContext(rt);if(it)return it;if(d!==void 0)return d;throw new Error(`\`${tt}\` must be used within \`${c}\``)}return _.displayName=c+"Provider",[_,b]}const o=()=>{const c=s.map(d=>reactExports.createContext(d));return function(h){const g=(h==null?void 0:h[e])||c;return reactExports.useMemo(()=>({[`__scope${e}`]:{...h,[e]:g}}),[h,g])}};return o.scopeName=e,[a,composeContextScopes(o,...i)]}function composeContextScopes(...e){const i=e[0];if(e.length===1)return i;const s=()=>{const a=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(c){const d=a.reduce((h,{useScope:g,scopeName:_})=>{const tt=g(c)[`__scope${_}`];return{...h,...tt}},{});return reactExports.useMemo(()=>({[`__scope${i.scopeName}`]:d}),[d])}};return s.scopeName=i.scopeName,s}var PROGRESS_NAME="Progress",DEFAULT_MAX=100,[createProgressContext,createProgressScope]=createContextScope(PROGRESS_NAME),[ProgressProvider,useProgressContext]=createProgressContext(PROGRESS_NAME),Progress$1=reactExports.forwardRef((e,i)=>{const{__scopeProgress:s,value:a=null,max:o,getValueLabel:c=defaultGetValueLabel,...d}=e;(o||o===0)&&!isValidMaxNumber(o)&&console.error(getInvalidMaxError(`${o}`,"Progress"));const h=isValidMaxNumber(o)?o:DEFAULT_MAX;a!==null&&!isValidValueNumber(a,h)&&console.error(getInvalidValueError(`${a}`,"Progress"));const g=isValidValueNumber(a,h)?a:null,_=isNumber(g)?c(g,h):void 0;return jsxRuntimeExports.jsx(ProgressProvider,{scope:s,value:g,max:h,children:jsxRuntimeExports.jsx(Primitive.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":isNumber(g)?g:void 0,"aria-valuetext":_,role:"progressbar","data-state":getProgressState(g,h),"data-value":g??void 0,"data-max":h,...d,ref:i})})});Progress$1.displayName=PROGRESS_NAME;var INDICATOR_NAME$1="ProgressIndicator",ProgressIndicator=reactExports.forwardRef((e,i)=>{const{__scopeProgress:s,...a}=e,o=useProgressContext(INDICATOR_NAME$1,s);return jsxRuntimeExports.jsx(Primitive.div,{"data-state":getProgressState(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...a,ref:i})});ProgressIndicator.displayName=INDICATOR_NAME$1;function defaultGetValueLabel(e,i){return`${Math.round(e/i*100)}%`}function getProgressState(e,i){return e==null?"indeterminate":e===i?"complete":"loading"}function isNumber(e){return typeof e=="number"}function isValidMaxNumber(e){return isNumber(e)&&!isNaN(e)&&e>0}function isValidValueNumber(e,i){return isNumber(e)&&!isNaN(e)&&e<=i&&e>=0}function getInvalidMaxError(e,i){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${i}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${DEFAULT_MAX}\`.`}function getInvalidValueError(e,i){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${i}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${DEFAULT_MAX} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Root$1=Progress$1,Indicator$1=ProgressIndicator;const Progress=reactExports.forwardRef(({className:e,value:i,...s},a)=>jsxRuntimeExports.jsx(Root$1,{ref:a,className:cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:jsxRuntimeExports.jsx(Indicator$1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(i||0)}%)`}})}));Progress.displayName=Root$1.displayName;function PDFUploader({onFilesSelected:e,isProcessing:i,processingProgress:s=0}){const[a,o]=reactExports.useState([]),c=reactExports.useCallback(_e=>{const rt=_e.filter(it=>it.type==="application/pdf");rt.length!==_e.length&&toast({title:"Arquivos invlidos",description:"Apenas arquivos PDF so aceitos.",variant:"destructive"}),rt.length>0&&o(it=>[...it,...rt])},[]),{getRootProps:d,getInputProps:h,isDragActive:g}=useDropzone({onDrop:c,accept:{"application/pdf":[".pdf"]},disabled:i}),_=_e=>{o(rt=>rt.filter((it,et)=>et!==_e))},b=()=>{a.length>0&&e(a)},tt=_e=>{if(_e===0)return"0 Bytes";const rt=1024,it=["Bytes","KB","MB","GB"],et=Math.floor(Math.log(_e)/Math.log(rt));return parseFloat((_e/Math.pow(rt,et)).toFixed(2))+" "+it[et]};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(Card,{className:"border-2 border-dashed transition-all duration-300 hover:border-primary/50 hover:shadow-card",children:jsxRuntimeExports.jsx(CardContent,{className:"p-8",children:jsxRuntimeExports.jsxs("div",{...d(),className:`text-center cursor-pointer transition-all duration-300 ${g?"scale-105":""} ${i?"opacity-50 cursor-not-allowed":""}`,children:[jsxRuntimeExports.jsx("input",{...h()}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[jsxRuntimeExports.jsx("div",{className:`w-16 h-16 rounded-full bg-gradient-primary flex items-center justify-center text-primary-foreground transition-transform duration-300 ${g?"animate-pulse-scale":""}`,children:jsxRuntimeExports.jsx(Upload,{className:"w-8 h-8"})}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-foreground",children:g?"Solte os arquivos aqui":"Upload de Folhas Analticas"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Arraste e solte arquivos PDF ou clique para selecionar"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Suporte para mltiplos arquivos PDF"})]})]})]})})}),a.length>0&&jsxRuntimeExports.jsx(Card,{className:"shadow-card",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsxs("h4",{className:"text-lg font-semibold text-foreground",children:["Arquivos Selecionados (",a.length,")"]}),!i&&jsxRuntimeExports.jsx(Button,{onClick:b,className:"bg-gradient-primary hover:shadow-primary",children:"Processar PDFs"})]}),i&&jsxRuntimeExports.jsxs("div",{className:"mb-4 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Processando arquivos..."}),jsxRuntimeExports.jsxs("span",{children:[Math.round(s),"%"]})]}),jsxRuntimeExports.jsx(Progress,{value:s,className:"h-2"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.map((_e,rt)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-secondary rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx(FileText,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-foreground",children:_e.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:tt(_e.size)})]})]}),!i&&jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>_(rt),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:jsxRuntimeExports.jsx(X,{className:"w-4 h-4"})})]},`${_e.name}-${rt}`))})]})}),a.length===0&&!i&&jsxRuntimeExports.jsx(Card,{className:"border-warning/20 bg-warning/5",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 text-warning",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Nenhum arquivo selecionado. Adicione arquivos PDF para comear a extrao."})]})})})]})}const Input=reactExports.forwardRef(({className:e,type:i,...s},a)=>jsxRuntimeExports.jsx("input",{type:i,className:cn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));Input.displayName="Input";const Table=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("div",{className:"relative w-full overflow-auto",children:jsxRuntimeExports.jsx("table",{ref:s,className:cn("w-full caption-bottom text-sm",e),...i})}));Table.displayName="Table";const TableHeader=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("thead",{ref:s,className:cn("[&_tr]:border-b",e),...i}));TableHeader.displayName="TableHeader";const TableBody=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("tbody",{ref:s,className:cn("[&_tr:last-child]:border-0",e),...i}));TableBody.displayName="TableBody";const TableFooter=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("tfoot",{ref:s,className:cn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...i}));TableFooter.displayName="TableFooter";const TableRow=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("tr",{ref:s,className:cn("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...i}));TableRow.displayName="TableRow";const TableHead=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("th",{ref:s,className:cn("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...i}));TableHead.displayName="TableHead";const TableCell=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("td",{ref:s,className:cn("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...i}));TableCell.displayName="TableCell";const TableCaption=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx("caption",{ref:s,className:cn("mt-4 text-sm text-muted-foreground",e),...i}));TableCaption.displayName="TableCaption";function clamp(e,[i,s]){return Math.min(s,Math.max(i,e))}var DirectionContext=reactExports.createContext(void 0);function useDirection(e){const i=reactExports.useContext(DirectionContext);return e||i||"ltr"}var count=0;function useFocusGuards(){reactExports.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??createFocusGuard()),document.body.insertAdjacentElement("beforeend",e[1]??createFocusGuard()),count++,()=>{count===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(i=>i.remove()),count--}},[])}function createFocusGuard(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS={bubbles:!1,cancelable:!0},FOCUS_SCOPE_NAME="FocusScope",FocusScope=reactExports.forwardRef((e,i)=>{const{loop:s=!1,trapped:a=!1,onMountAutoFocus:o,onUnmountAutoFocus:c,...d}=e,[h,g]=reactExports.useState(null),_=useCallbackRef$1(o),b=useCallbackRef$1(c),tt=reactExports.useRef(null),_e=useComposedRefs(i,et=>g(et)),rt=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(a){let et=function(ot){if(rt.paused||!h)return;const pt=ot.target;h.contains(pt)?tt.current=pt:focus(tt.current,{select:!0})},nt=function(ot){if(rt.paused||!h)return;const pt=ot.relatedTarget;pt!==null&&(h.contains(pt)||focus(tt.current,{select:!0}))},at=function(ot){if(document.activeElement===document.body)for(const dt of ot)dt.removedNodes.length>0&&focus(h)};document.addEventListener("focusin",et),document.addEventListener("focusout",nt);const st=new MutationObserver(at);return h&&st.observe(h,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",et),document.removeEventListener("focusout",nt),st.disconnect()}}},[a,h,rt.paused]),reactExports.useEffect(()=>{if(h){focusScopesStack.add(rt);const et=document.activeElement;if(!h.contains(et)){const at=new CustomEvent(AUTOFOCUS_ON_MOUNT,EVENT_OPTIONS);h.addEventListener(AUTOFOCUS_ON_MOUNT,_),h.dispatchEvent(at),at.defaultPrevented||(focusFirst(removeLinks(getTabbableCandidates(h)),{select:!0}),document.activeElement===et&&focus(h))}return()=>{h.removeEventListener(AUTOFOCUS_ON_MOUNT,_),setTimeout(()=>{const at=new CustomEvent(AUTOFOCUS_ON_UNMOUNT,EVENT_OPTIONS);h.addEventListener(AUTOFOCUS_ON_UNMOUNT,b),h.dispatchEvent(at),at.defaultPrevented||focus(et??document.body,{select:!0}),h.removeEventListener(AUTOFOCUS_ON_UNMOUNT,b),focusScopesStack.remove(rt)},0)}}},[h,_,b,rt]);const it=reactExports.useCallback(et=>{if(!s&&!a||rt.paused)return;const nt=et.key==="Tab"&&!et.altKey&&!et.ctrlKey&&!et.metaKey,at=document.activeElement;if(nt&&at){const st=et.currentTarget,[ot,pt]=getTabbableEdges(st);ot&&pt?!et.shiftKey&&at===pt?(et.preventDefault(),s&&focus(ot,{select:!0})):et.shiftKey&&at===ot&&(et.preventDefault(),s&&focus(pt,{select:!0})):at===st&&et.preventDefault()}},[s,a,rt.paused]);return jsxRuntimeExports.jsx(Primitive.div,{tabIndex:-1,...d,ref:_e,onKeyDown:it})});FocusScope.displayName=FOCUS_SCOPE_NAME;function focusFirst(e,{select:i=!1}={}){const s=document.activeElement;for(const a of e)if(focus(a,{select:i}),document.activeElement!==s)return}function getTabbableEdges(e){const i=getTabbableCandidates(e),s=findVisible(i,e),a=findVisible(i.reverse(),e);return[s,a]}function getTabbableCandidates(e){const i=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const o=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||o?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)i.push(s.currentNode);return i}function findVisible(e,i){for(const s of e)if(!isHidden(s,{upTo:i}))return s}function isHidden(e,{upTo:i}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(i!==void 0&&e===i)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function isSelectableInput(e){return e instanceof HTMLInputElement&&"select"in e}function focus(e,{select:i=!1}={}){if(e&&e.focus){const s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&isSelectableInput(e)&&i&&e.select()}}var focusScopesStack=createFocusScopesStack();function createFocusScopesStack(){let e=[];return{add(i){const s=e[0];i!==s&&(s==null||s.pause()),e=arrayRemove(e,i),e.unshift(i)},remove(i){var s;e=arrayRemove(e,i),(s=e[0])==null||s.resume()}}}function arrayRemove(e,i){const s=[...e],a=s.indexOf(i);return a!==-1&&s.splice(a,1),s}function removeLinks(e){return e.filter(i=>i.tagName!=="A")}function usePrevious(e){const i=reactExports.useRef({value:e,previous:e});return reactExports.useMemo(()=>(i.current.value!==e&&(i.current.previous=i.current.value,i.current.value=e),i.current.previous),[e])}var getDefaultParent=function(e){if(typeof document>"u")return null;var i=Array.isArray(e)?e[0]:e;return i.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(e){return e&&(e.host||unwrapHost(e.parentNode))},correctTargets=function(e,i){return i.map(function(s){if(e.contains(s))return s;var a=unwrapHost(s);return a&&e.contains(a)?a:(console.error("aria-hidden",s,"in not contained inside",e,". Doing nothing"),null)}).filter(function(s){return!!s})},applyAttributeToOthers=function(e,i,s,a){var o=correctTargets(i,Array.isArray(e)?e:[e]);markerMap[s]||(markerMap[s]=new WeakMap);var c=markerMap[s],d=[],h=new Set,g=new Set(o),_=function(tt){!tt||h.has(tt)||(h.add(tt),_(tt.parentNode))};o.forEach(_);var b=function(tt){!tt||g.has(tt)||Array.prototype.forEach.call(tt.children,function(_e){if(h.has(_e))b(_e);else try{var rt=_e.getAttribute(a),it=rt!==null&&rt!=="false",et=(counterMap.get(_e)||0)+1,nt=(c.get(_e)||0)+1;counterMap.set(_e,et),c.set(_e,nt),d.push(_e),et===1&&it&&uncontrolledNodes.set(_e,!0),nt===1&&_e.setAttribute(s,"true"),it||_e.setAttribute(a,"true")}catch(at){console.error("aria-hidden: cannot operate on ",_e,at)}})};return b(i),h.clear(),lockCount++,function(){d.forEach(function(tt){var _e=counterMap.get(tt)-1,rt=c.get(tt)-1;counterMap.set(tt,_e),c.set(tt,rt),_e||(uncontrolledNodes.has(tt)||tt.removeAttribute(a),uncontrolledNodes.delete(tt)),rt||tt.removeAttribute(s)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(e,i,s){s===void 0&&(s="data-aria-hidden");var a=Array.from(Array.isArray(e)?e:[e]),o=getDefaultParent(e);return o?(a.push.apply(a,Array.from(o.querySelectorAll("[aria-live]"))),applyAttributeToOthers(a,o,s,"aria-hidden")):function(){return null}},zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(e,i){return typeof e=="function"?e(i):e&&(e.current=i),e}function useCallbackRef(e,i){var s=reactExports.useState(function(){return{value:e,callback:i,facade:{get current(){return s.value},set current(a){var o=s.value;o!==a&&(s.value=a,s.callback(a,o))}}}})[0];return s.callback=i,s.facade}var useIsomorphicLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(e,i){var s=useCallbackRef(null,function(a){return e.forEach(function(o){return assignRef(o,a)})});return useIsomorphicLayoutEffect(function(){var a=currentValues.get(s);if(a){var o=new Set(a),c=new Set(e),d=s.current;o.forEach(function(h){c.has(h)||assignRef(h,null)}),c.forEach(function(h){o.has(h)||assignRef(h,d)})}currentValues.set(s,e)},[e]),s}function ItoI(e){return e}function innerCreateMedium(e,i){i===void 0&&(i=ItoI);var s=[],a=!1,o={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:e},useMedium:function(c){var d=i(c,a);return s.push(d),function(){s=s.filter(function(h){return h!==d})}},assignSyncMedium:function(c){for(a=!0;s.length;){var d=s;s=[],d.forEach(c)}s={push:function(h){return c(h)},filter:function(){return s}}},assignMedium:function(c){a=!0;var d=[];if(s.length){var h=s;s=[],h.forEach(c),d=s}var g=function(){var b=d;d=[],b.forEach(c)},_=function(){return Promise.resolve().then(g)};_(),s={push:function(b){d.push(b),_()},filter:function(b){return d=d.filter(b),s}}}};return o}function createSidecarMedium(e){e===void 0&&(e={});var i=innerCreateMedium(null);return i.options=__assign({async:!0,ssr:!1},e),i}var SideCar$1=function(e){var i=e.sideCar,s=__rest(e,["sideCar"]);if(!i)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=i.read();if(!a)throw new Error("Sidecar medium not found");return reactExports.createElement(a,__assign({},s))};SideCar$1.isSideCarExport=!0;function exportSidecar(e,i){return e.useMedium(i),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(e,i){var s=reactExports.useRef(null),a=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),o=a[0],c=a[1],d=e.forwardProps,h=e.children,g=e.className,_=e.removeScrollBar,b=e.enabled,tt=e.shards,_e=e.sideCar,rt=e.noIsolation,it=e.inert,et=e.allowPinchZoom,nt=e.as,at=nt===void 0?"div":nt,st=e.gapMode,ot=__rest(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),pt=_e,dt=useMergeRefs([s,i]),wt=__assign(__assign({},ot),o);return reactExports.createElement(reactExports.Fragment,null,b&&reactExports.createElement(pt,{sideCar:effectCar,removeScrollBar:_,shards:tt,noIsolation:rt,inert:it,setCallbacks:c,allowPinchZoom:!!et,lockRef:s,gapMode:st}),d?reactExports.cloneElement(reactExports.Children.only(h),__assign(__assign({},wt),{ref:dt})):reactExports.createElement(at,__assign({},wt,{className:g,ref:dt}),h))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var i=getNonce();return i&&e.setAttribute("nonce",i),e}function injectStyles(e,i){e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i))}function insertStyleTag(e){var i=document.head||document.getElementsByTagName("head")[0];i.appendChild(e)}var stylesheetSingleton=function(){var e=0,i=null;return{add:function(s){e==0&&(i=makeStyleTag())&&(injectStyles(i,s),insertStyleTag(i)),e++},remove:function(){e--,!e&&i&&(i.parentNode&&i.parentNode.removeChild(i),i=null)}}},styleHookSingleton=function(){var e=stylesheetSingleton();return function(i,s){reactExports.useEffect(function(){return e.add(i),function(){e.remove()}},[i&&s])}},styleSingleton=function(){var e=styleHookSingleton(),i=function(s){var a=s.styles,o=s.dynamic;return e(a,o),null};return i},zeroGap={left:0,top:0,right:0,gap:0},parse=function(e){return parseInt(e||"",10)||0},getOffset=function(e){var i=window.getComputedStyle(document.body),s=i[e==="padding"?"paddingLeft":"marginLeft"],a=i[e==="padding"?"paddingTop":"marginTop"],o=i[e==="padding"?"paddingRight":"marginRight"];return[parse(s),parse(a),parse(o)]},getGapWidth=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zeroGap;var i=getOffset(e),s=document.documentElement.clientWidth,a=window.innerWidth;return{left:i[0],top:i[1],right:i[2],gap:Math.max(0,a-s+i[2]-i[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles=function(e,i,s,a){var o=e.left,c=e.top,d=e.right,h=e.gap;return s===void 0&&(s="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(a,`;
   padding-right: `).concat(h,"px ").concat(a,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(a,`;
    overscroll-behavior: contain;
    `).concat([i&&"position: relative ".concat(a,";"),s==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(h,"px ").concat(a,`;
    `),s==="padding"&&"padding-right: ".concat(h,"px ").concat(a,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(h,"px ").concat(a,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(h,"px ").concat(a,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(a,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(a,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(h,`px;
  }
`)},getCurrentUseCounter=function(){var e=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(e)?e:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var e=getCurrentUseCounter()-1;e<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,e.toString())}},[])},RemoveScrollBar=function(e){var i=e.noRelative,s=e.noImportant,a=e.gapMode,o=a===void 0?"margin":a;useLockAttribute();var c=reactExports.useMemo(function(){return getGapWidth(o)},[o]);return reactExports.createElement(Style,{styles:getStyles(c,!i,o,s?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(e){return e.tagName==="TEXTAREA"},elementCanBeScrolled=function(e,i){if(!(e instanceof Element))return!1;var s=window.getComputedStyle(e);return s[i]!=="hidden"&&!(s.overflowY===s.overflowX&&!alwaysContainsScroll(e)&&s[i]==="visible")},elementCouldBeVScrolled=function(e){return elementCanBeScrolled(e,"overflowY")},elementCouldBeHScrolled=function(e){return elementCanBeScrolled(e,"overflowX")},locationCouldBeScrolled=function(e,i){var s=i.ownerDocument,a=i;do{typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&(a=a.host);var o=elementCouldBeScrolled(e,a);if(o){var c=getScrollVariables(e,a),d=c[1],h=c[2];if(d>h)return!0}a=a.parentNode}while(a&&a!==s.body);return!1},getVScrollVariables=function(e){var i=e.scrollTop,s=e.scrollHeight,a=e.clientHeight;return[i,s,a]},getHScrollVariables=function(e){var i=e.scrollLeft,s=e.scrollWidth,a=e.clientWidth;return[i,s,a]},elementCouldBeScrolled=function(e,i){return e==="v"?elementCouldBeVScrolled(i):elementCouldBeHScrolled(i)},getScrollVariables=function(e,i){return e==="v"?getVScrollVariables(i):getHScrollVariables(i)},getDirectionFactor=function(e,i){return e==="h"&&i==="rtl"?-1:1},handleScroll=function(e,i,s,a,o){var c=getDirectionFactor(e,window.getComputedStyle(i).direction),d=c*a,h=s.target,g=i.contains(h),_=!1,b=d>0,tt=0,_e=0;do{var rt=getScrollVariables(e,h),it=rt[0],et=rt[1],nt=rt[2],at=et-nt-c*it;(it||at)&&elementCouldBeScrolled(e,h)&&(tt+=at,_e+=it),h instanceof ShadowRoot?h=h.host:h=h.parentNode}while(!g&&h!==document.body||g&&(i.contains(h)||i===h));return(b&&(Math.abs(tt)<1||!o)||!b&&(Math.abs(_e)<1||!o))&&(_=!0),_},getTouchXY=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(e){return[e.deltaX,e.deltaY]},extractRef=function(e){return e&&"current"in e?e.current:e},deltaCompare=function(e,i){return e[0]===i[0]&&e[1]===i[1]},generateStyle=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(e){var i=reactExports.useRef([]),s=reactExports.useRef([0,0]),a=reactExports.useRef(),o=reactExports.useState(idCounter++)[0],c=reactExports.useState(styleSingleton)[0],d=reactExports.useRef(e);reactExports.useEffect(function(){d.current=e},[e]),reactExports.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(o));var et=__spreadArray([e.lockRef.current],(e.shards||[]).map(extractRef),!0).filter(Boolean);return et.forEach(function(nt){return nt.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),et.forEach(function(nt){return nt.classList.remove("allow-interactivity-".concat(o))})}}},[e.inert,e.lockRef.current,e.shards]);var h=reactExports.useCallback(function(et,nt){if("touches"in et&&et.touches.length===2||et.type==="wheel"&&et.ctrlKey)return!d.current.allowPinchZoom;var at=getTouchXY(et),st=s.current,ot="deltaX"in et?et.deltaX:st[0]-at[0],pt="deltaY"in et?et.deltaY:st[1]-at[1],dt,wt=et.target,lt=Math.abs(ot)>Math.abs(pt)?"h":"v";if("touches"in et&&lt==="h"&&wt.type==="range")return!1;var gt=locationCouldBeScrolled(lt,wt);if(!gt)return!0;if(gt?dt=lt:(dt=lt==="v"?"h":"v",gt=locationCouldBeScrolled(lt,wt)),!gt)return!1;if(!a.current&&"changedTouches"in et&&(ot||pt)&&(a.current=dt),!dt)return!0;var vt=a.current||dt;return handleScroll(vt,nt,et,vt==="h"?ot:pt,!0)},[]),g=reactExports.useCallback(function(et){var nt=et;if(!(!lockStack.length||lockStack[lockStack.length-1]!==c)){var at="deltaY"in nt?getDeltaXY(nt):getTouchXY(nt),st=i.current.filter(function(dt){return dt.name===nt.type&&(dt.target===nt.target||nt.target===dt.shadowParent)&&deltaCompare(dt.delta,at)})[0];if(st&&st.should){nt.cancelable&&nt.preventDefault();return}if(!st){var ot=(d.current.shards||[]).map(extractRef).filter(Boolean).filter(function(dt){return dt.contains(nt.target)}),pt=ot.length>0?h(nt,ot[0]):!d.current.noIsolation;pt&&nt.cancelable&&nt.preventDefault()}}},[]),_=reactExports.useCallback(function(et,nt,at,st){var ot={name:et,delta:nt,target:at,should:st,shadowParent:getOutermostShadowParent(at)};i.current.push(ot),setTimeout(function(){i.current=i.current.filter(function(pt){return pt!==ot})},1)},[]),b=reactExports.useCallback(function(et){s.current=getTouchXY(et),a.current=void 0},[]),tt=reactExports.useCallback(function(et){_(et.type,getDeltaXY(et),et.target,h(et,e.lockRef.current))},[]),_e=reactExports.useCallback(function(et){_(et.type,getTouchXY(et),et.target,h(et,e.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(c),e.setCallbacks({onScrollCapture:tt,onWheelCapture:tt,onTouchMoveCapture:_e}),document.addEventListener("wheel",g,nonPassive),document.addEventListener("touchmove",g,nonPassive),document.addEventListener("touchstart",b,nonPassive),function(){lockStack=lockStack.filter(function(et){return et!==c}),document.removeEventListener("wheel",g,nonPassive),document.removeEventListener("touchmove",g,nonPassive),document.removeEventListener("touchstart",b,nonPassive)}},[]);var rt=e.removeScrollBar,it=e.inert;return reactExports.createElement(reactExports.Fragment,null,it?reactExports.createElement(c,{styles:generateStyle(o)}):null,rt?reactExports.createElement(RemoveScrollBar,{gapMode:e.gapMode}):null)}function getOutermostShadowParent(e){for(var i=null;e!==null;)e instanceof ShadowRoot&&(i=e.host,e=e.host),e=e.parentNode;return i}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(e,i){return reactExports.createElement(RemoveScroll,__assign({},e,{ref:i,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],SELECTION_KEYS=[" ","Enter"],SELECT_NAME="Select",[Collection,useCollection,createCollectionScope]=createCollection(SELECT_NAME),[createSelectContext,createSelectScope]=createContextScope$2(SELECT_NAME,[createCollectionScope,createPopperScope]),usePopperScope$1=createPopperScope(),[SelectProvider,useSelectContext]=createSelectContext(SELECT_NAME),[SelectNativeOptionsProvider,useSelectNativeOptionsContext]=createSelectContext(SELECT_NAME),Select$1=e=>{const{__scopeSelect:i,children:s,open:a,defaultOpen:o,onOpenChange:c,value:d,defaultValue:h,onValueChange:g,dir:_,name:b,autoComplete:tt,disabled:_e,required:rt,form:it}=e,et=usePopperScope$1(i),[nt,at]=reactExports.useState(null),[st,ot]=reactExports.useState(null),[pt,dt]=reactExports.useState(!1),wt=useDirection(_),[lt=!1,gt]=useControllableState({prop:a,defaultProp:o,onChange:c}),[vt,At]=useControllableState({prop:d,defaultProp:h,onChange:g}),yt=reactExports.useRef(null),bt=nt?it||!!nt.closest("form"):!0,[Tt,er]=reactExports.useState(new Set),zt=Array.from(Tt).map(ar=>ar.props.value).join(";");return jsxRuntimeExports.jsx(Root2$2,{...et,children:jsxRuntimeExports.jsxs(SelectProvider,{required:rt,scope:i,trigger:nt,onTriggerChange:at,valueNode:st,onValueNodeChange:ot,valueNodeHasChildren:pt,onValueNodeHasChildrenChange:dt,contentId:useId(),value:vt,onValueChange:At,open:lt,onOpenChange:gt,dir:wt,triggerPointerDownPosRef:yt,disabled:_e,children:[jsxRuntimeExports.jsx(Collection.Provider,{scope:i,children:jsxRuntimeExports.jsx(SelectNativeOptionsProvider,{scope:e.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(ar=>{er(Jt=>new Set(Jt).add(ar))},[]),onNativeOptionRemove:reactExports.useCallback(ar=>{er(Jt=>{const Yt=new Set(Jt);return Yt.delete(ar),Yt})},[]),children:s})}),bt?jsxRuntimeExports.jsxs(BubbleSelect,{"aria-hidden":!0,required:rt,tabIndex:-1,name:b,autoComplete:tt,value:vt,onChange:ar=>At(ar.target.value),disabled:_e,form:it,children:[vt===void 0?jsxRuntimeExports.jsx("option",{value:""}):null,Array.from(Tt)]},zt):null]})})};Select$1.displayName=SELECT_NAME;var TRIGGER_NAME$1="SelectTrigger",SelectTrigger$1=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,disabled:a=!1,...o}=e,c=usePopperScope$1(s),d=useSelectContext(TRIGGER_NAME$1,s),h=d.disabled||a,g=useComposedRefs(i,d.onTriggerChange),_=useCollection(s),b=reactExports.useRef("touch"),[tt,_e,rt]=useTypeaheadSearch(et=>{const nt=_().filter(ot=>!ot.disabled),at=nt.find(ot=>ot.value===d.value),st=findNextItem(nt,et,at);st!==void 0&&d.onValueChange(st.value)}),it=et=>{h||(d.onOpenChange(!0),rt()),et&&(d.triggerPointerDownPosRef.current={x:Math.round(et.pageX),y:Math.round(et.pageY)})};return jsxRuntimeExports.jsx(Anchor,{asChild:!0,...c,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:h,"data-disabled":h?"":void 0,"data-placeholder":shouldShowPlaceholder(d.value)?"":void 0,...o,ref:g,onClick:composeEventHandlers$1(o.onClick,et=>{et.currentTarget.focus(),b.current!=="mouse"&&it(et)}),onPointerDown:composeEventHandlers$1(o.onPointerDown,et=>{b.current=et.pointerType;const nt=et.target;nt.hasPointerCapture(et.pointerId)&&nt.releasePointerCapture(et.pointerId),et.button===0&&et.ctrlKey===!1&&et.pointerType==="mouse"&&(it(et),et.preventDefault())}),onKeyDown:composeEventHandlers$1(o.onKeyDown,et=>{const nt=tt.current!=="";!(et.ctrlKey||et.altKey||et.metaKey)&&et.key.length===1&&_e(et.key),!(nt&&et.key===" ")&&OPEN_KEYS.includes(et.key)&&(it(),et.preventDefault())})})})});SelectTrigger$1.displayName=TRIGGER_NAME$1;var VALUE_NAME="SelectValue",SelectValue$1=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,className:a,style:o,children:c,placeholder:d="",...h}=e,g=useSelectContext(VALUE_NAME,s),{onValueNodeHasChildrenChange:_}=g,b=c!==void 0,tt=useComposedRefs(i,g.onValueNodeChange);return useLayoutEffect2(()=>{_(b)},[_,b]),jsxRuntimeExports.jsx(Primitive.span,{...h,ref:tt,style:{pointerEvents:"none"},children:shouldShowPlaceholder(g.value)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:d}):c})});SelectValue$1.displayName=VALUE_NAME;var ICON_NAME="SelectIcon",SelectIcon=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,children:a,...o}=e;return jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...o,ref:i,children:a||""})});SelectIcon.displayName=ICON_NAME;var PORTAL_NAME$1="SelectPortal",SelectPortal=e=>jsxRuntimeExports.jsx(Portal$2,{asChild:!0,...e});SelectPortal.displayName=PORTAL_NAME$1;var CONTENT_NAME$1="SelectContent",SelectContent$1=reactExports.forwardRef((e,i)=>{const s=useSelectContext(CONTENT_NAME$1,e.__scopeSelect),[a,o]=reactExports.useState();if(useLayoutEffect2(()=>{o(new DocumentFragment)},[]),!s.open){const c=a;return c?reactDomExports.createPortal(jsxRuntimeExports.jsx(SelectContentProvider,{scope:e.__scopeSelect,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:e.__scopeSelect,children:jsxRuntimeExports.jsx("div",{children:e.children})})}),c):null}return jsxRuntimeExports.jsx(SelectContentImpl,{...e,ref:i})});SelectContent$1.displayName=CONTENT_NAME$1;var CONTENT_MARGIN=10,[SelectContentProvider,useSelectContentContext]=createSelectContext(CONTENT_NAME$1),CONTENT_IMPL_NAME="SelectContentImpl",SelectContentImpl=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,position:a="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:c,onPointerDownOutside:d,side:h,sideOffset:g,align:_,alignOffset:b,arrowPadding:tt,collisionBoundary:_e,collisionPadding:rt,sticky:it,hideWhenDetached:et,avoidCollisions:nt,...at}=e,st=useSelectContext(CONTENT_NAME$1,s),[ot,pt]=reactExports.useState(null),[dt,wt]=reactExports.useState(null),lt=useComposedRefs(i,Nt=>pt(Nt)),[gt,vt]=reactExports.useState(null),[At,yt]=reactExports.useState(null),bt=useCollection(s),[Tt,er]=reactExports.useState(!1),zt=reactExports.useRef(!1);reactExports.useEffect(()=>{if(ot)return hideOthers(ot)},[ot]),useFocusGuards();const ar=reactExports.useCallback(Nt=>{const[Lt,...lr]=bt().map(vr=>vr.ref.current),[ur]=lr.slice(-1),wr=document.activeElement;for(const vr of Nt)if(vr===wr||(vr==null||vr.scrollIntoView({block:"nearest"}),vr===Lt&&dt&&(dt.scrollTop=0),vr===ur&&dt&&(dt.scrollTop=dt.scrollHeight),vr==null||vr.focus(),document.activeElement!==wr))return},[bt,dt]),Jt=reactExports.useCallback(()=>ar([gt,ot]),[ar,gt,ot]);reactExports.useEffect(()=>{Tt&&Jt()},[Tt,Jt]);const{onOpenChange:Yt,triggerPointerDownPosRef:kt}=st;reactExports.useEffect(()=>{if(ot){let Nt={x:0,y:0};const Lt=ur=>{var wr,vr;Nt={x:Math.abs(Math.round(ur.pageX)-(((wr=kt.current)==null?void 0:wr.x)??0)),y:Math.abs(Math.round(ur.pageY)-(((vr=kt.current)==null?void 0:vr.y)??0))}},lr=ur=>{Nt.x<=10&&Nt.y<=10?ur.preventDefault():ot.contains(ur.target)||Yt(!1),document.removeEventListener("pointermove",Lt),kt.current=null};return kt.current!==null&&(document.addEventListener("pointermove",Lt),document.addEventListener("pointerup",lr,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Lt),document.removeEventListener("pointerup",lr,{capture:!0})}}},[ot,Yt,kt]),reactExports.useEffect(()=>{const Nt=()=>Yt(!1);return window.addEventListener("blur",Nt),window.addEventListener("resize",Nt),()=>{window.removeEventListener("blur",Nt),window.removeEventListener("resize",Nt)}},[Yt]);const[ir,fr]=useTypeaheadSearch(Nt=>{const Lt=bt().filter(wr=>!wr.disabled),lr=Lt.find(wr=>wr.ref.current===document.activeElement),ur=findNextItem(Lt,Nt,lr);ur&&setTimeout(()=>ur.ref.current.focus())}),Et=reactExports.useCallback((Nt,Lt,lr)=>{const ur=!zt.current&&!lr;(st.value!==void 0&&st.value===Lt||ur)&&(vt(Nt),ur&&(zt.current=!0))},[st.value]),xt=reactExports.useCallback(()=>ot==null?void 0:ot.focus(),[ot]),mt=reactExports.useCallback((Nt,Lt,lr)=>{const ur=!zt.current&&!lr;(st.value!==void 0&&st.value===Lt||ur)&&yt(Nt)},[st.value]),St=a==="popper"?SelectPopperPosition:SelectItemAlignedPosition,Pt=St===SelectPopperPosition?{side:h,sideOffset:g,align:_,alignOffset:b,arrowPadding:tt,collisionBoundary:_e,collisionPadding:rt,sticky:it,hideWhenDetached:et,avoidCollisions:nt}:{};return jsxRuntimeExports.jsx(SelectContentProvider,{scope:s,content:ot,viewport:dt,onViewportChange:wt,itemRefCallback:Et,selectedItem:gt,onItemLeave:xt,itemTextRefCallback:mt,focusSelectedItem:Jt,selectedItemText:At,position:a,isPositioned:Tt,searchRef:ir,children:jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot,allowPinchZoom:!0,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:st.open,onMountAutoFocus:Nt=>{Nt.preventDefault()},onUnmountAutoFocus:composeEventHandlers$1(o,Nt=>{var Lt;(Lt=st.trigger)==null||Lt.focus({preventScroll:!0}),Nt.preventDefault()}),children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:Nt=>Nt.preventDefault(),onDismiss:()=>st.onOpenChange(!1),children:jsxRuntimeExports.jsx(St,{role:"listbox",id:st.contentId,"data-state":st.open?"open":"closed",dir:st.dir,onContextMenu:Nt=>Nt.preventDefault(),...at,...Pt,onPlaced:()=>er(!0),ref:lt,style:{display:"flex",flexDirection:"column",outline:"none",...at.style},onKeyDown:composeEventHandlers$1(at.onKeyDown,Nt=>{const Lt=Nt.ctrlKey||Nt.altKey||Nt.metaKey;if(Nt.key==="Tab"&&Nt.preventDefault(),!Lt&&Nt.key.length===1&&fr(Nt.key),["ArrowUp","ArrowDown","Home","End"].includes(Nt.key)){let ur=bt().filter(wr=>!wr.disabled).map(wr=>wr.ref.current);if(["ArrowUp","End"].includes(Nt.key)&&(ur=ur.slice().reverse()),["ArrowUp","ArrowDown"].includes(Nt.key)){const wr=Nt.target,vr=ur.indexOf(wr);ur=ur.slice(vr+1)}setTimeout(()=>ar(ur)),Nt.preventDefault()}})})})})})})});SelectContentImpl.displayName=CONTENT_IMPL_NAME;var ITEM_ALIGNED_POSITION_NAME="SelectItemAlignedPosition",SelectItemAlignedPosition=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,onPlaced:a,...o}=e,c=useSelectContext(CONTENT_NAME$1,s),d=useSelectContentContext(CONTENT_NAME$1,s),[h,g]=reactExports.useState(null),[_,b]=reactExports.useState(null),tt=useComposedRefs(i,lt=>b(lt)),_e=useCollection(s),rt=reactExports.useRef(!1),it=reactExports.useRef(!0),{viewport:et,selectedItem:nt,selectedItemText:at,focusSelectedItem:st}=d,ot=reactExports.useCallback(()=>{if(c.trigger&&c.valueNode&&h&&_&&et&&nt&&at){const lt=c.trigger.getBoundingClientRect(),gt=_.getBoundingClientRect(),vt=c.valueNode.getBoundingClientRect(),At=at.getBoundingClientRect();if(c.dir!=="rtl"){const wr=At.left-gt.left,vr=vt.left-wr,Fr=lt.left-vr,Rr=lt.width+Fr,jr=Math.max(Rr,gt.width),xr=window.innerWidth-CONTENT_MARGIN,hr=clamp(vr,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,xr-jr)]);h.style.minWidth=Rr+"px",h.style.left=hr+"px"}else{const wr=gt.right-At.right,vr=window.innerWidth-vt.right-wr,Fr=window.innerWidth-lt.right-vr,Rr=lt.width+Fr,jr=Math.max(Rr,gt.width),xr=window.innerWidth-CONTENT_MARGIN,hr=clamp(vr,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,xr-jr)]);h.style.minWidth=Rr+"px",h.style.right=hr+"px"}const yt=_e(),bt=window.innerHeight-CONTENT_MARGIN*2,Tt=et.scrollHeight,er=window.getComputedStyle(_),zt=parseInt(er.borderTopWidth,10),ar=parseInt(er.paddingTop,10),Jt=parseInt(er.borderBottomWidth,10),Yt=parseInt(er.paddingBottom,10),kt=zt+ar+Tt+Yt+Jt,ir=Math.min(nt.offsetHeight*5,kt),fr=window.getComputedStyle(et),Et=parseInt(fr.paddingTop,10),xt=parseInt(fr.paddingBottom,10),mt=lt.top+lt.height/2-CONTENT_MARGIN,St=bt-mt,Pt=nt.offsetHeight/2,Nt=nt.offsetTop+Pt,Lt=zt+ar+Nt,lr=kt-Lt;if(Lt<=mt){const wr=yt.length>0&&nt===yt[yt.length-1].ref.current;h.style.bottom="0px";const vr=_.clientHeight-et.offsetTop-et.offsetHeight,Fr=Math.max(St,Pt+(wr?xt:0)+vr+Jt),Rr=Lt+Fr;h.style.height=Rr+"px"}else{const wr=yt.length>0&&nt===yt[0].ref.current;h.style.top="0px";const Fr=Math.max(mt,zt+et.offsetTop+(wr?Et:0)+Pt)+lr;h.style.height=Fr+"px",et.scrollTop=Lt-mt+et.offsetTop}h.style.margin=`${CONTENT_MARGIN}px 0`,h.style.minHeight=ir+"px",h.style.maxHeight=bt+"px",a==null||a(),requestAnimationFrame(()=>rt.current=!0)}},[_e,c.trigger,c.valueNode,h,_,et,nt,at,c.dir,a]);useLayoutEffect2(()=>ot(),[ot]);const[pt,dt]=reactExports.useState();useLayoutEffect2(()=>{_&&dt(window.getComputedStyle(_).zIndex)},[_]);const wt=reactExports.useCallback(lt=>{lt&&it.current===!0&&(ot(),st==null||st(),it.current=!1)},[ot,st]);return jsxRuntimeExports.jsx(SelectViewportProvider,{scope:s,contentWrapper:h,shouldExpandOnScrollRef:rt,onScrollButtonChange:wt,children:jsxRuntimeExports.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:pt},children:jsxRuntimeExports.jsx(Primitive.div,{...o,ref:tt,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});SelectItemAlignedPosition.displayName=ITEM_ALIGNED_POSITION_NAME;var POPPER_POSITION_NAME="SelectPopperPosition",SelectPopperPosition=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,align:a="start",collisionPadding:o=CONTENT_MARGIN,...c}=e,d=usePopperScope$1(s);return jsxRuntimeExports.jsx(Content,{...d,...c,ref:i,align:a,collisionPadding:o,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SelectPopperPosition.displayName=POPPER_POSITION_NAME;var[SelectViewportProvider,useSelectViewportContext]=createSelectContext(CONTENT_NAME$1,{}),VIEWPORT_NAME="SelectViewport",SelectViewport=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,nonce:a,...o}=e,c=useSelectContentContext(VIEWPORT_NAME,s),d=useSelectViewportContext(VIEWPORT_NAME,s),h=useComposedRefs(i,c.onViewportChange),g=reactExports.useRef(0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),jsxRuntimeExports.jsx(Collection.Slot,{scope:s,children:jsxRuntimeExports.jsx(Primitive.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:h,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:composeEventHandlers$1(o.onScroll,_=>{const b=_.currentTarget,{contentWrapper:tt,shouldExpandOnScrollRef:_e}=d;if(_e!=null&&_e.current&&tt){const rt=Math.abs(g.current-b.scrollTop);if(rt>0){const it=window.innerHeight-CONTENT_MARGIN*2,et=parseFloat(tt.style.minHeight),nt=parseFloat(tt.style.height),at=Math.max(et,nt);if(at<it){const st=at+rt,ot=Math.min(it,st),pt=st-ot;tt.style.height=ot+"px",tt.style.bottom==="0px"&&(b.scrollTop=pt>0?pt:0,tt.style.justifyContent="flex-end")}}}g.current=b.scrollTop})})})]})});SelectViewport.displayName=VIEWPORT_NAME;var GROUP_NAME="SelectGroup",[SelectGroupContextProvider,useSelectGroupContext]=createSelectContext(GROUP_NAME),SelectGroup=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,...a}=e,o=useId();return jsxRuntimeExports.jsx(SelectGroupContextProvider,{scope:s,id:o,children:jsxRuntimeExports.jsx(Primitive.div,{role:"group","aria-labelledby":o,...a,ref:i})})});SelectGroup.displayName=GROUP_NAME;var LABEL_NAME="SelectLabel",SelectLabel$1=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,...a}=e,o=useSelectGroupContext(LABEL_NAME,s);return jsxRuntimeExports.jsx(Primitive.div,{id:o.id,...a,ref:i})});SelectLabel$1.displayName=LABEL_NAME;var ITEM_NAME="SelectItem",[SelectItemContextProvider,useSelectItemContext]=createSelectContext(ITEM_NAME),SelectItem$1=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,value:a,disabled:o=!1,textValue:c,...d}=e,h=useSelectContext(ITEM_NAME,s),g=useSelectContentContext(ITEM_NAME,s),_=h.value===a,[b,tt]=reactExports.useState(c??""),[_e,rt]=reactExports.useState(!1),it=useComposedRefs(i,st=>{var ot;return(ot=g.itemRefCallback)==null?void 0:ot.call(g,st,a,o)}),et=useId(),nt=reactExports.useRef("touch"),at=()=>{o||(h.onValueChange(a),h.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return jsxRuntimeExports.jsx(SelectItemContextProvider,{scope:s,value:a,disabled:o,textId:et,isSelected:_,onItemTextChange:reactExports.useCallback(st=>{tt(ot=>ot||((st==null?void 0:st.textContent)??"").trim())},[]),children:jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:s,value:a,disabled:o,textValue:b,children:jsxRuntimeExports.jsx(Primitive.div,{role:"option","aria-labelledby":et,"data-highlighted":_e?"":void 0,"aria-selected":_&&_e,"data-state":_?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...d,ref:it,onFocus:composeEventHandlers$1(d.onFocus,()=>rt(!0)),onBlur:composeEventHandlers$1(d.onBlur,()=>rt(!1)),onClick:composeEventHandlers$1(d.onClick,()=>{nt.current!=="mouse"&&at()}),onPointerUp:composeEventHandlers$1(d.onPointerUp,()=>{nt.current==="mouse"&&at()}),onPointerDown:composeEventHandlers$1(d.onPointerDown,st=>{nt.current=st.pointerType}),onPointerMove:composeEventHandlers$1(d.onPointerMove,st=>{var ot;nt.current=st.pointerType,o?(ot=g.onItemLeave)==null||ot.call(g):nt.current==="mouse"&&st.currentTarget.focus({preventScroll:!0})}),onPointerLeave:composeEventHandlers$1(d.onPointerLeave,st=>{var ot;st.currentTarget===document.activeElement&&((ot=g.onItemLeave)==null||ot.call(g))}),onKeyDown:composeEventHandlers$1(d.onKeyDown,st=>{var pt;((pt=g.searchRef)==null?void 0:pt.current)!==""&&st.key===" "||(SELECTION_KEYS.includes(st.key)&&at(),st.key===" "&&st.preventDefault())})})})})});SelectItem$1.displayName=ITEM_NAME;var ITEM_TEXT_NAME="SelectItemText",SelectItemText=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,className:a,style:o,...c}=e,d=useSelectContext(ITEM_TEXT_NAME,s),h=useSelectContentContext(ITEM_TEXT_NAME,s),g=useSelectItemContext(ITEM_TEXT_NAME,s),_=useSelectNativeOptionsContext(ITEM_TEXT_NAME,s),[b,tt]=reactExports.useState(null),_e=useComposedRefs(i,at=>tt(at),g.onItemTextChange,at=>{var st;return(st=h.itemTextRefCallback)==null?void 0:st.call(h,at,g.value,g.disabled)}),rt=b==null?void 0:b.textContent,it=reactExports.useMemo(()=>jsxRuntimeExports.jsx("option",{value:g.value,disabled:g.disabled,children:rt},g.value),[g.disabled,g.value,rt]),{onNativeOptionAdd:et,onNativeOptionRemove:nt}=_;return useLayoutEffect2(()=>(et(it),()=>nt(it)),[et,nt,it]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Primitive.span,{id:g.textId,...c,ref:_e}),g.isSelected&&d.valueNode&&!d.valueNodeHasChildren?reactDomExports.createPortal(c.children,d.valueNode):null]})});SelectItemText.displayName=ITEM_TEXT_NAME;var ITEM_INDICATOR_NAME="SelectItemIndicator",SelectItemIndicator=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,...a}=e;return useSelectItemContext(ITEM_INDICATOR_NAME,s).isSelected?jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...a,ref:i}):null});SelectItemIndicator.displayName=ITEM_INDICATOR_NAME;var SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",SelectScrollUpButton$1=reactExports.forwardRef((e,i)=>{const s=useSelectContentContext(SCROLL_UP_BUTTON_NAME,e.__scopeSelect),a=useSelectViewportContext(SCROLL_UP_BUTTON_NAME,e.__scopeSelect),[o,c]=reactExports.useState(!1),d=useComposedRefs(i,a.onScrollButtonChange);return useLayoutEffect2(()=>{if(s.viewport&&s.isPositioned){let h=function(){const _=g.scrollTop>0;c(_)};const g=s.viewport;return h(),g.addEventListener("scroll",h),()=>g.removeEventListener("scroll",h)}},[s.viewport,s.isPositioned]),o?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...e,ref:d,onAutoScroll:()=>{const{viewport:h,selectedItem:g}=s;h&&g&&(h.scrollTop=h.scrollTop-g.offsetHeight)}}):null});SelectScrollUpButton$1.displayName=SCROLL_UP_BUTTON_NAME;var SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",SelectScrollDownButton$1=reactExports.forwardRef((e,i)=>{const s=useSelectContentContext(SCROLL_DOWN_BUTTON_NAME,e.__scopeSelect),a=useSelectViewportContext(SCROLL_DOWN_BUTTON_NAME,e.__scopeSelect),[o,c]=reactExports.useState(!1),d=useComposedRefs(i,a.onScrollButtonChange);return useLayoutEffect2(()=>{if(s.viewport&&s.isPositioned){let h=function(){const _=g.scrollHeight-g.clientHeight,b=Math.ceil(g.scrollTop)<_;c(b)};const g=s.viewport;return h(),g.addEventListener("scroll",h),()=>g.removeEventListener("scroll",h)}},[s.viewport,s.isPositioned]),o?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...e,ref:d,onAutoScroll:()=>{const{viewport:h,selectedItem:g}=s;h&&g&&(h.scrollTop=h.scrollTop+g.offsetHeight)}}):null});SelectScrollDownButton$1.displayName=SCROLL_DOWN_BUTTON_NAME;var SelectScrollButtonImpl=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,onAutoScroll:a,...o}=e,c=useSelectContentContext("SelectScrollButton",s),d=reactExports.useRef(null),h=useCollection(s),g=reactExports.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return reactExports.useEffect(()=>()=>g(),[g]),useLayoutEffect2(()=>{var b;const _=h().find(tt=>tt.ref.current===document.activeElement);(b=_==null?void 0:_.ref.current)==null||b.scrollIntoView({block:"nearest"})},[h]),jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...o,ref:i,style:{flexShrink:0,...o.style},onPointerDown:composeEventHandlers$1(o.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(a,50))}),onPointerMove:composeEventHandlers$1(o.onPointerMove,()=>{var _;(_=c.onItemLeave)==null||_.call(c),d.current===null&&(d.current=window.setInterval(a,50))}),onPointerLeave:composeEventHandlers$1(o.onPointerLeave,()=>{g()})})}),SEPARATOR_NAME="SelectSeparator",SelectSeparator$1=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,...a}=e;return jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...a,ref:i})});SelectSeparator$1.displayName=SEPARATOR_NAME;var ARROW_NAME$1="SelectArrow",SelectArrow=reactExports.forwardRef((e,i)=>{const{__scopeSelect:s,...a}=e,o=usePopperScope$1(s),c=useSelectContext(ARROW_NAME$1,s),d=useSelectContentContext(ARROW_NAME$1,s);return c.open&&d.position==="popper"?jsxRuntimeExports.jsx(Arrow,{...o,...a,ref:i}):null});SelectArrow.displayName=ARROW_NAME$1;function shouldShowPlaceholder(e){return e===""||e===void 0}var BubbleSelect=reactExports.forwardRef((e,i)=>{const{value:s,...a}=e,o=reactExports.useRef(null),c=useComposedRefs(i,o),d=usePrevious(s);return reactExports.useEffect(()=>{const h=o.current,g=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(g,"value").set;if(d!==s&&b){const tt=new Event("change",{bubbles:!0});b.call(h,s),h.dispatchEvent(tt)}},[d,s]),jsxRuntimeExports.jsx(VisuallyHidden,{asChild:!0,children:jsxRuntimeExports.jsx("select",{...a,ref:c,defaultValue:s})})});BubbleSelect.displayName="BubbleSelect";function useTypeaheadSearch(e){const i=useCallbackRef$1(e),s=reactExports.useRef(""),a=reactExports.useRef(0),o=reactExports.useCallback(d=>{const h=s.current+d;i(h),function g(_){s.current=_,window.clearTimeout(a.current),_!==""&&(a.current=window.setTimeout(()=>g(""),1e3))}(h)},[i]),c=reactExports.useCallback(()=>{s.current="",window.clearTimeout(a.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(a.current),[]),[s,o,c]}function findNextItem(e,i,s){const o=i.length>1&&Array.from(i).every(_=>_===i[0])?i[0]:i,c=s?e.indexOf(s):-1;let d=wrapArray(e,Math.max(c,0));o.length===1&&(d=d.filter(_=>_!==s));const g=d.find(_=>_.textValue.toLowerCase().startsWith(o.toLowerCase()));return g!==s?g:void 0}function wrapArray(e,i){return e.map((s,a)=>e[(i+a)%e.length])}var Root2$1=Select$1,Trigger$1=SelectTrigger$1,Value=SelectValue$1,Icon=SelectIcon,Portal$1=SelectPortal,Content2$1=SelectContent$1,Viewport=SelectViewport,Label=SelectLabel$1,Item=SelectItem$1,ItemText=SelectItemText,ItemIndicator=SelectItemIndicator,ScrollUpButton=SelectScrollUpButton$1,ScrollDownButton=SelectScrollDownButton$1,Separator=SelectSeparator$1;const Select=Root2$1,SelectValue=Value,SelectTrigger=reactExports.forwardRef(({className:e,children:i,...s},a)=>jsxRuntimeExports.jsxs(Trigger$1,{ref:a,className:cn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[i,jsxRuntimeExports.jsx(Icon,{asChild:!0,children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 opacity-50"})})]}));SelectTrigger.displayName=Trigger$1.displayName;const SelectScrollUpButton=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(ScrollUpButton,{ref:s,className:cn("flex cursor-default items-center justify-center py-1",e),...i,children:jsxRuntimeExports.jsx(ChevronUp,{className:"h-4 w-4"})}));SelectScrollUpButton.displayName=ScrollUpButton.displayName;const SelectScrollDownButton=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(ScrollDownButton,{ref:s,className:cn("flex cursor-default items-center justify-center py-1",e),...i,children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4"})}));SelectScrollDownButton.displayName=ScrollDownButton.displayName;const SelectContent=reactExports.forwardRef(({className:e,children:i,position:s="popper",...a},o)=>jsxRuntimeExports.jsx(Portal$1,{children:jsxRuntimeExports.jsxs(Content2$1,{ref:o,className:cn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[jsxRuntimeExports.jsx(SelectScrollUpButton,{}),jsxRuntimeExports.jsx(Viewport,{className:cn("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),jsxRuntimeExports.jsx(SelectScrollDownButton,{})]})}));SelectContent.displayName=Content2$1.displayName;const SelectLabel=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Label,{ref:s,className:cn("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...i}));SelectLabel.displayName=Label.displayName;const SelectItem=reactExports.forwardRef(({className:e,children:i,...s},a)=>jsxRuntimeExports.jsxs(Item,{ref:a,className:cn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[jsxRuntimeExports.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:jsxRuntimeExports.jsx(ItemIndicator,{children:jsxRuntimeExports.jsx(Check,{className:"h-4 w-4"})})}),jsxRuntimeExports.jsx(ItemText,{children:i})]}));SelectItem.displayName=Item.displayName;const SelectSeparator=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Separator,{ref:s,className:cn("-mx-1 my-1 h-px bg-muted",e),...i}));SelectSeparator.displayName=Separator.displayName;const badgeVariants=cva("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge({className:e,variant:i,...s}){return jsxRuntimeExports.jsx("div",{className:cn(badgeVariants({variant:i}),e),...s})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}var _getchar=function(i){return String.fromCharCode(i)},_getansi=function(i){return String.fromCharCode(i)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var i="",s=0,a=0,o=0,c=0,d=0,h=0,g=0,_=0;_<e.length;)s=e.charCodeAt(_++),c=s>>2,a=e.charCodeAt(_++),d=(s&3)<<4|a>>4,o=e.charCodeAt(_++),h=(a&15)<<2|o>>6,g=o&63,isNaN(a)?h=g=64:isNaN(o)&&(g=64),i+=Base64_map.charAt(c)+Base64_map.charAt(d)+Base64_map.charAt(h)+Base64_map.charAt(g);return i}function Base64_decode(e){var i="",s=0,a=0,o=0,c=0,d=0,h=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var _=0;_<e.length;)c=Base64_map.indexOf(e.charAt(_++)),d=Base64_map.indexOf(e.charAt(_++)),s=c<<2|d>>4,i+=String.fromCharCode(s),h=Base64_map.indexOf(e.charAt(_++)),a=(d&15)<<4|h>>2,h!==64&&(i+=String.fromCharCode(a)),g=Base64_map.indexOf(e.charAt(_++)),o=(h&3)<<6|g,g!==64&&(i+=String.fromCharCode(o));return i}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(i,s){return s?new Buffer(i,s):new Buffer(i)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function(i){return has_buf?Buffer_from(i,"binary"):i.split("").map(function(s){return s.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var i=new ArrayBuffer(e.length),s=new Uint8Array(i),a=0;a!=e.length;++a)s[a]=e.charCodeAt(a)&255;return i}function a2s(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var i=[],s=0;s<e.length;++s)i[s]=String.fromCharCode(e[s]);return i.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)}))}:function(e){if(typeof Uint8Array<"u"){var i=0,s=0;for(i=0;i<e.length;++i)s+=e[i].length;var a=new Uint8Array(s),o=0;for(i=0,s=0;i<e.length;s+=o,++i)if(o=e[i].length,e[i]instanceof Uint8Array)a.set(e[i],s);else{if(typeof e[i]=="string")throw"wtf";a.set(new Uint8Array(e[i]),s)}return a}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function utf8decode(e){for(var i=[],s=0,a=e.length+250,o=new_raw_buf(e.length+255),c=0;c<e.length;++c){var d=e.charCodeAt(c);if(d<128)o[s++]=d;else if(d<2048)o[s++]=192|d>>6&31,o[s++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var h=e.charCodeAt(++c)&1023;o[s++]=240|d>>8&7,o[s++]=128|d>>2&63,o[s++]=128|h>>6&15|(d&3)<<4,o[s++]=128|h&63}else o[s++]=224|d>>12&15,o[s++]=128|d>>6&63,o[s++]=128|d&63;s>a&&(i.push(o.slice(0,s)),s=0,o=new_raw_buf(65535),a=65530)}return i.push(o.slice(0,s)),bconcat(i)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var i="",s=e.length-1;s>=0;)i+=e.charAt(s--);return i}function pad0(e,i){var s=""+e;return s.length>=i?s:fill("0",i-s.length)+s}function pad_(e,i){var s=""+e;return s.length>=i?s:fill(" ",i-s.length)+s}function rpad_(e,i){var s=""+e;return s.length>=i?s:s+fill(" ",i-s.length)}function pad0r1(e,i){var s=""+Math.round(e);return s.length>=i?s:fill("0",i-s.length)+s}function pad0r2(e,i){var s=""+e;return s.length>=i?s:fill("0",i-s.length)+s}var p2_32=Math.pow(2,32);function pad0r(e,i){if(e>p2_32||e<-p2_32)return pad0r1(e,i);var s=Math.round(e);return pad0r2(s,i)}function SSF_isgeneral(e,i){return i=i||0,e.length>=7+i&&(e.charCodeAt(i)|32)===103&&(e.charCodeAt(i+1)|32)===101&&(e.charCodeAt(i+2)|32)===110&&(e.charCodeAt(i+3)|32)===101&&(e.charCodeAt(i+4)|32)===114&&(e.charCodeAt(i+5)|32)===97&&(e.charCodeAt(i+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,i,s){for(var a=e<0?-1:1,o=e*a,c=0,d=1,h=0,g=1,_=0,b=0,tt=Math.floor(o);_<i&&(tt=Math.floor(o),h=tt*d+c,b=tt*_+g,!(o-tt<5e-8));)o=1/(o-tt),c=d,d=h,g=_,_=b;if(b>i&&(_>i?(b=g,h=c):(b=_,h=d)),!s)return[0,a*h,b];var _e=Math.floor(a*h/b);return[_e,a*h-_e*b,b]}function SSF_parse_date_code(e,i,s){if(e>2958465||e<0)return null;var a=e|0,o=Math.floor(86400*(e-a)),c=0,d=[],h={D:a,T:o,u:86400*(e-a)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),i&&i.date1904&&(a+=1462),h.u>.9999&&(h.u=0,++o==86400&&(h.T=o=0,++a,++h.D)),a===60)d=s?[1317,10,29]:[1900,2,29],c=3;else if(a===0)d=s?[1317,8,29]:[1900,1,0],c=6;else{a>60&&--a;var g=new Date(1900,0,1);g.setDate(g.getDate()+a-1),d=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),a<60&&(c=(c+6)%7),s&&(c=SSF_fix_hijri(g,d))}return h.y=d[0],h.m=d[1],h.d=d[2],h.S=o%60,o=Math.floor(o/60),h.M=o%60,o=Math.floor(o/60),h.H=o,h.q=c,h}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,i){var s=e.getTime();return i?s-=1461*24*60*60*1e3:e>=SSFbase1904&&(s+=24*60*60*1e3),(s-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var i=e<0?12:11,s=SSF_strip_decimal(e.toFixed(12));return s.length<=i||(s=e.toPrecision(10),s.length<=i)?s:e.toExponential(5)}function SSF_large_exp(e){var i=SSF_strip_decimal(e.toFixed(11));return i.length>(e<0?12:11)||i==="0"||i==="-0"?e.toPrecision(6):i}function SSF_general_num(e){var i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),s;return i>=-4&&i<=-1?s=e.toPrecision(10+i):Math.abs(i)<=9?s=SSF_small_exp(e):i===10?s=e.toFixed(10).substr(0,12):s=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(s.toUpperCase()))}function SSF_general(e,i){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,i){i[0]-=581;var s=e.getDay();return e<60&&(s=(s+6)%7),s}function SSF_write_date(e,i,s,a){var o="",c=0,d=0,h=s.y,g,_=0;switch(e){case 98:h=s.y+543;case 121:switch(i.length){case 1:case 2:g=h%100,_=2;break;default:g=h%1e4,_=4;break}break;case 109:switch(i.length){case 1:case 2:g=s.m,_=i.length;break;case 3:return months[s.m-1][1];case 5:return months[s.m-1][0];default:return months[s.m-1][2]}break;case 100:switch(i.length){case 1:case 2:g=s.d,_=i.length;break;case 3:return days[s.q][0];default:return days[s.q][1]}break;case 104:switch(i.length){case 1:case 2:g=1+(s.H+11)%12,_=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:g=s.H,_=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:g=s.M,_=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return s.u===0&&(i=="s"||i=="ss")?pad0(s.S,i.length):(a>=2?d=a===3?1e3:100:d=a===1?10:1,c=Math.round(d*(s.S+s.u)),c>=60*d&&(c=0),i==="s"?c===0?"0":""+c/d:(o=pad0(c,2+a),i==="ss"?o.substr(0,2):"."+o.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":g=s.D*24+s.H;break;case"[m]":case"[mm]":g=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":g=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+i}_=i.length===3?1:2;break;case 101:g=h,_=1;break}var b=_>0?pad0(g,_):"";return b}function commaify(e){var i=3;if(e.length<=i)return e;for(var s=e.length%i,a=e.substr(0,s);s!=e.length;s+=i)a+=(a.length>0?",":"")+e.substr(s,i);return a}var pct1=/%/g;function write_num_pct(e,i,s){var a=i.replace(pct1,""),o=i.length-a.length;return write_num(e,a,s*Math.pow(10,2*o))+fill("%",o)}function write_num_cm(e,i,s){for(var a=i.length-1;i.charCodeAt(a-1)===44;)--a;return write_num(e,i.substr(0,a),s/Math.pow(10,3*(i.length-a)))}function write_num_exp(e,i){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp(e,-i);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(i)*Math.LOG10E)%o;if(c<0&&(c+=o),s=(i/Math.pow(10,c)).toPrecision(a+1+(o+c)%o),s.indexOf("e")===-1){var d=Math.floor(Math.log(i)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(d-s.length+c):s+="E+"+(d-c);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,o)+"."+s.substr(2+o),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else s=i.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,i,s){var a=parseInt(e[4],10),o=Math.round(i*a),c=Math.floor(o/a),d=o-c*a,h=a;return s+(c===0?"":""+c)+" "+(d===0?fill(" ",e[1].length+1+e[4].length):pad_(d,e[1].length)+e[2]+"/"+e[3]+pad0(h,e[4].length))}function write_num_f2(e,i,s){return s+(i===0?"":""+i)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var i="",s,a=0;a!=e.length;++a)switch(s=e.charCodeAt(a)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(s)}return i}function rnd(e,i){var s=Math.pow(10,i);return""+Math.round(e*s)/s}function dec(e,i){var s=e-Math.floor(e),a=Math.pow(10,i);return i<(""+Math.round(s*a)).length?0:Math.round(s*a)}function carry(e,i){return i<(""+Math.round((e-Math.floor(e))*Math.pow(10,i))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,i,s){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var a=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?write_num_flt("n",a,s):"("+write_num_flt("n",a,-s)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm(e,i,s);if(i.indexOf("%")!==-1)return write_num_pct(e,i,s);if(i.indexOf("E")!==-1)return write_num_exp(i,s);if(i.charCodeAt(0)===36)return"$"+write_num_flt(e,i.substr(i.charAt(1)==" "?2:1),s);var o,c,d,h,g=Math.abs(s),_=s<0?"-":"";if(i.match(/^00+$/))return _+pad0r(g,i.length);if(i.match(/^[#?]+$/))return o=pad0r(s,0),o==="0"&&(o=""),o.length>i.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(frac1))return write_num_f1(c,g,_);if(i.match(/^#+0+$/))return _+pad0r(g,i.length-i.indexOf("0"));if(c=i.match(dec1))return o=rnd(s,c[1].length).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])).replace(/\.(\d*)$/,function(it,et){return"."+et+fill("0",hashq(c[1]).length-et.length)}),i.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),c=i.match(/^(0*)\.(#*)$/))return _+rnd(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=i.match(/^#{1,3},##0(\.?)$/))return _+commaify(pad0r(g,0));if(c=i.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+write_num_flt(e,i,-s):commaify(""+(Math.floor(s)+carry(s,c[1].length)))+"."+pad0(dec(s,c[1].length),c[1].length);if(c=i.match(/^#,#*,#0/))return write_num_flt(e,i.replace(/^#,#*,/,""),s);if(c=i.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_flt(e,i.replace(/[\\-]/g,""),s)),d=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(it){return d<o.length?o.charAt(d++):it==="0"?"0":""}));if(i.match(phone))return o=write_num_flt(e,"##########",s),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),h=SSF_frac(g,Math.pow(10,d)-1,!1),o=""+_,b=write_num("n",c[1],h[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(h[2],d),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),h=SSF_frac(g,Math.pow(10,d)-1,!0),_+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pad_(h[1],d)+c[2]+"/"+c[3]+rpad_(h[2],d):fill(" ",2*d+1+c[2].length+c[3].length));if(c=i.match(/^[#0?]+$/))return o=pad0r(s,0),i.length<=o.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(/^([#0?]+)\.([#0]+)$/)){o=""+s.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var tt=i.indexOf(".")-d,_e=i.length-o.length-tt;return hashq(i.substr(0,tt)+o+i.substr(i.length-_e))}if(c=i.match(/^00,000\.([#0]*0)$/))return d=dec(s,c[1].length),s<0?"-"+write_num_flt(e,i,-s):commaify(flr(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(it){return"00,"+(it.length<3?pad0(0,3-it.length):"")+it})+"."+pad0(d,c[1].length);switch(i){case"###,##0.00":return write_num_flt(e,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var rt=commaify(pad0r(g,0));return rt!=="0"?_+rt:"";case"###,###.00":return write_num_flt(e,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+i+"|")}function write_num_cm2(e,i,s){for(var a=i.length-1;i.charCodeAt(a-1)===44;)--a;return write_num(e,i.substr(0,a),s/Math.pow(10,3*(i.length-a)))}function write_num_pct2(e,i,s){var a=i.replace(pct1,""),o=i.length-a.length;return write_num(e,a,s*Math.pow(10,2*o))+fill("%",o)}function write_num_exp2(e,i){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+write_num_exp2(e,-i);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(i)*Math.LOG10E)%o;if(c<0&&(c+=o),s=(i/Math.pow(10,c)).toPrecision(a+1+(o+c)%o),!s.match(/[Ee]/)){var d=Math.floor(Math.log(i)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(d-s.length+c):s+="E+"+(d-c),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,_,b){return g+_+b.substr(0,(o+c)%o)+"."+b.substr(c)+"E"})}else s=i.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function write_num_int(e,i,s){if(e.charCodeAt(0)===40&&!i.match(closeparen)){var a=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?write_num_int("n",a,s):"("+write_num_int("n",a,-s)+")"}if(i.charCodeAt(i.length-1)===44)return write_num_cm2(e,i,s);if(i.indexOf("%")!==-1)return write_num_pct2(e,i,s);if(i.indexOf("E")!==-1)return write_num_exp2(i,s);if(i.charCodeAt(0)===36)return"$"+write_num_int(e,i.substr(i.charAt(1)==" "?2:1),s);var o,c,d,h,g=Math.abs(s),_=s<0?"-":"";if(i.match(/^00+$/))return _+pad0(g,i.length);if(i.match(/^[#?]+$/))return o=""+s,s===0&&(o=""),o.length>i.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(frac1))return write_num_f2(c,g,_);if(i.match(/^#+0+$/))return _+pad0(g,i.length-i.indexOf("0"));if(c=i.match(dec1))return o=(""+s).replace(/^([^\.]+)$/,"$1."+hashq(c[1])).replace(/\.$/,"."+hashq(c[1])),o=o.replace(/\.(\d*)$/,function(it,et){return"."+et+fill("0",hashq(c[1]).length-et.length)}),i.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),c=i.match(/^(0*)\.(#*)$/))return _+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=i.match(/^#{1,3},##0(\.?)$/))return _+commaify(""+g);if(c=i.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+write_num_int(e,i,-s):commaify(""+s)+"."+fill("0",c[1].length);if(c=i.match(/^#,#*,#0/))return write_num_int(e,i.replace(/^#,#*,/,""),s);if(c=i.match(/^([0#]+)(\\?-([0#]+))+$/))return o=_strrev(write_num_int(e,i.replace(/[\\-]/g,""),s)),d=0,_strrev(_strrev(i.replace(/\\/g,"")).replace(/[0#]/g,function(it){return d<o.length?o.charAt(d++):it==="0"?"0":""}));if(i.match(phone))return o=write_num_int(e,"##########",s),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var b="";if(c=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),h=SSF_frac(g,Math.pow(10,d)-1,!1),o=""+_,b=write_num("n",c[1],h[1]),b.charAt(b.length-1)==" "&&(b=b.substr(0,b.length-1)+"0"),o+=b+c[2]+"/"+c[3],b=rpad_(h[2],d),b.length<c[4].length&&(b=hashq(c[4].substr(c[4].length-b.length))+b),o+=b,o;if(c=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),h=SSF_frac(g,Math.pow(10,d)-1,!0),_+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pad_(h[1],d)+c[2]+"/"+c[3]+rpad_(h[2],d):fill(" ",2*d+1+c[2].length+c[3].length));if(c=i.match(/^[#0?]+$/))return o=""+s,i.length<=o.length?o:hashq(i.substr(0,i.length-o.length))+o;if(c=i.match(/^([#0]+)\.([#0]+)$/)){o=""+s.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var tt=i.indexOf(".")-d,_e=i.length-o.length-tt;return hashq(i.substr(0,tt)+o+i.substr(i.length-_e))}if(c=i.match(/^00,000\.([#0]*0)$/))return s<0?"-"+write_num_int(e,i,-s):commaify(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(it){return"00,"+(it.length<3?pad0(0,3-it.length):"")+it})+"."+pad0(0,c[1].length);switch(i){case"###,###":case"##,###":case"#,###":var rt=commaify(""+g);return rt!=="0"?_+rt:"";default:if(i.match(/\.[0#?]*$/))return write_num_int(e,i.slice(0,i.lastIndexOf(".")),s)+hashq(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}function write_num(e,i,s){return(s|0)===s?write_num_int(e,i,s):write_num_flt(e,i,s)}function SSF_split_fmt(e){for(var i=[],s=!1,a=0,o=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:i[i.length]=e.substr(o,a-o),o=a+1}if(i[i.length]=e.substr(o),s===!0)throw new Error("Format |"+e+"| unterminated string ");return i}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var i=0,s="",a="";i<e.length;)switch(s=e.charAt(i)){case"G":SSF_isgeneral(e,i)&&(i+=6),i++;break;case'"':for(;e.charCodeAt(++i)!==34&&i<e.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(i,3).toUpperCase()==="A/P"||e.substr(i,5).toUpperCase()==="AM/PM"||e.substr(i,5).toUpperCase()==="/")return!0;++i;break;case"[":for(a=s;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;i<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++i))>-1||s=="\\"&&e.charAt(i+1)=="-"&&"0#".indexOf(e.charAt(i+2))>-1););break;case"?":for(;e.charAt(++i)===s;);break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function eval_fmt(e,i,s,a){for(var o=[],c="",d=0,h="",g="t",_,b,tt,_e="H";d<e.length;)switch(h=e.charAt(d)){case"G":if(!SSF_isgeneral(e,d))throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"G",v:"General"},d+=7;break;case'"':for(c="";(tt=e.charCodeAt(++d))!==34&&d<e.length;)c+=String.fromCharCode(tt);o[o.length]={t:"t",v:c},++d;break;case"\\":var rt=e.charAt(++d),it=rt==="("||rt===")"?rt:"t";o[o.length]={t:it,v:rt},++d;break;case"_":o[o.length]={t:"t",v:" "},d+=2;break;case"@":o[o.length]={t:"T",v:i},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(_==null&&(_=SSF_parse_date_code(i,s,e.charAt(d+1)==="2"),_==null))return"";o[o.length]={t:"X",v:e.substr(d,2)},g=h,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||_==null&&(_=SSF_parse_date_code(i,s),_==null))return"";for(c=h;++d<e.length&&e.charAt(d).toLowerCase()===h;)c+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=_e),o[o.length]={t:h,v:c},g=h;break;case"A":case"a":case"":var et={t:h,v:h};if(_==null&&(_=SSF_parse_date_code(i,s)),e.substr(d,3).toUpperCase()==="A/P"?(_!=null&&(et.v=_.H>=12?"P":"A"),et.t="T",_e="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(_!=null&&(et.v=_.H>=12?"PM":"AM"),et.t="T",d+=5,_e="h"):e.substr(d,5).toUpperCase()==="/"?(_!=null&&(et.v=_.H>=12?"":""),et.t="T",d+=5,_e="h"):(et.t="t",++d),_==null&&et.t==="T")return"";o[o.length]=et,g=h;break;case"[":for(c=h;e.charAt(d++)!=="]"&&d<e.length;)c+=e.charAt(d);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(SSF_abstime)){if(_==null&&(_=SSF_parse_date_code(i,s),_==null))return"";o[o.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(o[o.length]={t:"t",v:c}));break;case".":if(_!=null){for(c=h;++d<e.length&&(h=e.charAt(d))==="0";)c+=h;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=h;++d<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(d))>-1;)c+=h;o[o.length]={t:"n",v:c};break;case"?":for(c=h;e.charAt(++d)===h;)c+=h;o[o.length]={t:h,v:c},g=h;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":o[o.length]={t:a===1?"t":h,v:h},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=h;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)c+=e.charAt(d);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:h,v:h},++d;break;case"$":o[o.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);o[o.length]={t:"t",v:h},++d;break}var nt=0,at=0,st;for(d=o.length-1,g="t";d>=0;--d)switch(o[d].t){case"h":case"H":o[d].t=_e,g="h",nt<1&&(nt=1);break;case"s":(st=o[d].v.match(/\.0+$/))&&(at=Math.max(at,st[0].length-1)),nt<3&&(nt=3);case"d":case"y":case"M":case"e":g=o[d].t;break;case"m":g==="s"&&(o[d].t="M",nt<2&&(nt=2));break;case"X":break;case"Z":nt<1&&o[d].v.match(/[Hh]/)&&(nt=1),nt<2&&o[d].v.match(/[Mm]/)&&(nt=2),nt<3&&o[d].v.match(/[Ss]/)&&(nt=3)}switch(nt){case 0:break;case 1:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M),_.M>=60&&(_.M=0,++_.H);break;case 2:_.u>=.5&&(_.u=0,++_.S),_.S>=60&&(_.S=0,++_.M);break}var ot="",pt;for(d=0;d<o.length;++d)switch(o[d].t){case"t":case"T":case" ":case"D":break;case"X":o[d].v="",o[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[d].v=SSF_write_date(o[d].t.charCodeAt(0),o[d].v,_,at),o[d].t="t";break;case"n":case"?":for(pt=d+1;o[pt]!=null&&((h=o[pt].t)==="?"||h==="D"||(h===" "||h==="t")&&o[pt+1]!=null&&(o[pt+1].t==="?"||o[pt+1].t==="t"&&o[pt+1].v==="/")||o[d].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(o[pt].v==="/"||o[pt].v===" "&&o[pt+1]!=null&&o[pt+1].t=="?"));)o[d].v+=o[pt].v,o[pt]={v:"",t:";"},++pt;ot+=o[d].v,d=pt-1;break;case"G":o[d].t="t",o[d].v=SSF_general(i,s);break}var dt="",wt,lt;if(ot.length>0){ot.charCodeAt(0)==40?(wt=i<0&&ot.charCodeAt(0)===45?-i:i,lt=write_num("n",ot,wt)):(wt=i<0&&a>1?-i:i,lt=write_num("n",ot,wt),wt<0&&o[0]&&o[0].t=="t"&&(lt=lt.substr(1),o[0].v="-"+o[0].v)),pt=lt.length-1;var gt=o.length;for(d=0;d<o.length;++d)if(o[d]!=null&&o[d].t!="t"&&o[d].v.indexOf(".")>-1){gt=d;break}var vt=o.length;if(gt===o.length&&lt.indexOf("E")===-1){for(d=o.length-1;d>=0;--d)o[d]==null||"n?".indexOf(o[d].t)===-1||(pt>=o[d].v.length-1?(pt-=o[d].v.length,o[d].v=lt.substr(pt+1,o[d].v.length)):pt<0?o[d].v="":(o[d].v=lt.substr(0,pt+1),pt=-1),o[d].t="t",vt=d);pt>=0&&vt<o.length&&(o[vt].v=lt.substr(0,pt+1)+o[vt].v)}else if(gt!==o.length&&lt.indexOf("E")===-1){for(pt=lt.indexOf(".")-1,d=gt;d>=0;--d)if(!(o[d]==null||"n?".indexOf(o[d].t)===-1)){for(b=o[d].v.indexOf(".")>-1&&d===gt?o[d].v.indexOf(".")-1:o[d].v.length-1,dt=o[d].v.substr(b+1);b>=0;--b)pt>=0&&(o[d].v.charAt(b)==="0"||o[d].v.charAt(b)==="#")&&(dt=lt.charAt(pt--)+dt);o[d].v=dt,o[d].t="t",vt=d}for(pt>=0&&vt<o.length&&(o[vt].v=lt.substr(0,pt+1)+o[vt].v),pt=lt.indexOf(".")+1,d=gt;d<o.length;++d)if(!(o[d]==null||"n?(".indexOf(o[d].t)===-1&&d!==gt)){for(b=o[d].v.indexOf(".")>-1&&d===gt?o[d].v.indexOf(".")+1:0,dt=o[d].v.substr(0,b);b<o[d].v.length;++b)pt<lt.length&&(dt+=lt.charAt(pt++));o[d].v=dt,o[d].t="t",vt=d}}}for(d=0;d<o.length;++d)o[d]!=null&&"n?".indexOf(o[d].t)>-1&&(wt=a>1&&i<0&&d>0&&o[d-1].v==="-"?-i:i,o[d].v=write_num(o[d].t,o[d].v,wt),o[d].t="t");var At="";for(d=0;d!==o.length;++d)o[d]!=null&&(At+=o[d].v);return At}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,i){if(i==null)return!1;var s=parseFloat(i[2]);switch(i[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0;break}return!1}function choose_fmt(e,i){var s=SSF_split_fmt(e),a=s.length,o=s[a-1].indexOf("@");if(a<4&&o>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof i!="number")return[4,s.length===4||o>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=o>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=o>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=o>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var c=i>0?s[0]:i<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[a,c];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var d=s[0].match(cfregex2),h=s[1].match(cfregex2);return chkcond(i,d)?[a,s[0]]:chkcond(i,h)?[a,s[1]]:[a,s[d!=null&&h!=null?2:1]]}return[a,c]}function SSF_format(e,i,s){s==null&&(s={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&s.dateNF?a=s.dateNF:a=e;break;case"number":e==14&&s.dateNF?a=s.dateNF:a=(s.table!=null?s.table:table_fmt)[e],a==null&&(a=s.table&&s.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),a==null&&(a=SSF_default_str[e]||"General");break}if(SSF_isgeneral(a,0))return SSF_general(i,s);i instanceof Date&&(i=datenum_local(i,s.date1904));var o=choose_fmt(a,i);if(SSF_isgeneral(o[1]))return SSF_general(i,s);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return eval_fmt(o[1],i,s,o[0])}function SSF_load(e,i){if(typeof i!="number"){i=+i||-1;for(var s=0;s<392;++s){if(table_fmt[s]==null){i<0&&(i=s);continue}if(table_fmt[s]==e){i=s;break}}i<0&&(i=391)}return table_fmt[i]=e,i}function SSF_load_table(e){for(var i=0;i!=392;++i)e[i]!==void 0&&SSF_load(e[i],i)}function make_ssf(){table_fmt=SSF_init_table()}var dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var i=typeof e=="number"?table_fmt[e]:e;return i=i.replace(dateNFregex,"(\\d+)"),new RegExp("^"+i+"$")}function dateNF_fix(e,i,s){var a=-1,o=-1,c=-1,d=-1,h=-1,g=-1;(i.match(dateNFregex)||[]).forEach(function(tt,_e){var rt=parseInt(s[_e+1],10);switch(tt.toLowerCase().charAt(0)){case"y":a=rt;break;case"d":c=rt;break;case"h":d=rt;break;case"s":g=rt;break;case"m":d>=0?h=rt:o=rt;break}}),g>=0&&h==-1&&o>=0&&(h=o,o=-1);var _=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);_.length==7&&(_="0"+_),_.length==8&&(_="20"+_);var b=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return d==-1&&h==-1&&g==-1?_:a==-1&&o==-1&&c==-1?b:_+"T"+b}var CRC32=function(){var e={};e.version="1.2.0";function i(){for(var lt=0,gt=new Array(256),vt=0;vt!=256;++vt)lt=vt,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,lt=lt&1?-306674912^lt>>>1:lt>>>1,gt[vt]=lt;return typeof Int32Array<"u"?new Int32Array(gt):gt}var s=i();function a(lt){var gt=0,vt=0,At=0,yt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(At=0;At!=256;++At)yt[At]=lt[At];for(At=0;At!=256;++At)for(vt=lt[At],gt=256+At;gt<4096;gt+=256)vt=yt[gt]=vt>>>8^lt[vt&255];var bt=[];for(At=1;At!=16;++At)bt[At-1]=typeof Int32Array<"u"?yt.subarray(At*256,At*256+256):yt.slice(At*256,At*256+256);return bt}var o=a(s),c=o[0],d=o[1],h=o[2],g=o[3],_=o[4],b=o[5],tt=o[6],_e=o[7],rt=o[8],it=o[9],et=o[10],nt=o[11],at=o[12],st=o[13],ot=o[14];function pt(lt,gt){for(var vt=gt^-1,At=0,yt=lt.length;At<yt;)vt=vt>>>8^s[(vt^lt.charCodeAt(At++))&255];return~vt}function dt(lt,gt){for(var vt=gt^-1,At=lt.length-15,yt=0;yt<At;)vt=ot[lt[yt++]^vt&255]^st[lt[yt++]^vt>>8&255]^at[lt[yt++]^vt>>16&255]^nt[lt[yt++]^vt>>>24]^et[lt[yt++]]^it[lt[yt++]]^rt[lt[yt++]]^_e[lt[yt++]]^tt[lt[yt++]]^b[lt[yt++]]^_[lt[yt++]]^g[lt[yt++]]^h[lt[yt++]]^d[lt[yt++]]^c[lt[yt++]]^s[lt[yt++]];for(At+=15;yt<At;)vt=vt>>>8^s[(vt^lt[yt++])&255];return~vt}function wt(lt,gt){for(var vt=gt^-1,At=0,yt=lt.length,bt=0,Tt=0;At<yt;)bt=lt.charCodeAt(At++),bt<128?vt=vt>>>8^s[(vt^bt)&255]:bt<2048?(vt=vt>>>8^s[(vt^(192|bt>>6&31))&255],vt=vt>>>8^s[(vt^(128|bt&63))&255]):bt>=55296&&bt<57344?(bt=(bt&1023)+64,Tt=lt.charCodeAt(At++)&1023,vt=vt>>>8^s[(vt^(240|bt>>8&7))&255],vt=vt>>>8^s[(vt^(128|bt>>2&63))&255],vt=vt>>>8^s[(vt^(128|Tt>>6&15|(bt&3)<<4))&255],vt=vt>>>8^s[(vt^(128|Tt&63))&255]):(vt=vt>>>8^s[(vt^(224|bt>>12&15))&255],vt=vt>>>8^s[(vt^(128|bt>>6&63))&255],vt=vt>>>8^s[(vt^(128|bt&63))&255]);return~vt}return e.table=s,e.bstr=pt,e.buf=dt,e.str=wt,e}(),CFB=function(){var i={};i.version="1.2.1";function s(Rt,nr){for(var Mt=Rt.split("/"),Bt=nr.split("/"),tr=0,or=0,Tr=Math.min(Mt.length,Bt.length);tr<Tr;++tr){if(or=Mt[tr].length-Bt[tr].length)return or;if(Mt[tr]!=Bt[tr])return Mt[tr]<Bt[tr]?-1:1}return Mt.length-Bt.length}function a(Rt){if(Rt.charAt(Rt.length-1)=="/")return Rt.slice(0,-1).indexOf("/")===-1?Rt:a(Rt.slice(0,-1));var nr=Rt.lastIndexOf("/");return nr===-1?Rt:Rt.slice(0,nr+1)}function o(Rt){if(Rt.charAt(Rt.length-1)=="/")return o(Rt.slice(0,-1));var nr=Rt.lastIndexOf("/");return nr===-1?Rt:Rt.slice(nr+1)}function c(Rt,nr){typeof nr=="string"&&(nr=new Date(nr));var Mt=nr.getHours();Mt=Mt<<6|nr.getMinutes(),Mt=Mt<<5|nr.getSeconds()>>>1,Rt.write_shift(2,Mt);var Bt=nr.getFullYear()-1980;Bt=Bt<<4|nr.getMonth()+1,Bt=Bt<<5|nr.getDate(),Rt.write_shift(2,Bt)}function d(Rt){var nr=Rt.read_shift(2)&65535,Mt=Rt.read_shift(2)&65535,Bt=new Date,tr=Mt&31;Mt>>>=5;var or=Mt&15;Mt>>>=4,Bt.setMilliseconds(0),Bt.setFullYear(Mt+1980),Bt.setMonth(or-1),Bt.setDate(tr);var Tr=nr&31;nr>>>=5;var Lr=nr&63;return nr>>>=6,Bt.setHours(nr),Bt.setMinutes(Lr),Bt.setSeconds(Tr<<1),Bt}function h(Rt){prep_blob(Rt,0);for(var nr={},Mt=0;Rt.l<=Rt.length-4;){var Bt=Rt.read_shift(2),tr=Rt.read_shift(2),or=Rt.l+tr,Tr={};switch(Bt){case 21589:Mt=Rt.read_shift(1),Mt&1&&(Tr.mtime=Rt.read_shift(4)),tr>5&&(Mt&2&&(Tr.atime=Rt.read_shift(4)),Mt&4&&(Tr.ctime=Rt.read_shift(4))),Tr.mtime&&(Tr.mt=new Date(Tr.mtime*1e3));break}Rt.l=or,nr[Bt]=Tr}return nr}var g;function _(){return g||(g={})}function b(Rt,nr){if(Rt[0]==80&&Rt[1]==75)return rn(Rt,nr);if((Rt[0]|32)==109&&(Rt[1]|32)==105)return gr(Rt,nr);if(Rt.length<512)throw new Error("CFB file size "+Rt.length+" < 512");var Mt=3,Bt=512,tr=0,or=0,Tr=0,Lr=0,kr=0,Pr=[],Dr=Rt.slice(0,512);prep_blob(Dr,0);var Gr=tt(Dr);switch(Mt=Gr[0],Mt){case 3:Bt=512;break;case 4:Bt=4096;break;case 0:if(Gr[1]==0)return rn(Rt,nr);default:throw new Error("Major Version: Expected 3 or 4 saw "+Mt)}Bt!==512&&(Dr=Rt.slice(0,Bt),prep_blob(Dr,28));var Yr=Rt.slice(0,Bt);_e(Dr,Mt);var un=Dr.read_shift(4,"i");if(Mt===3&&un!==0)throw new Error("# Directory Sectors: Expected 0 saw "+un);Dr.l+=4,Tr=Dr.read_shift(4,"i"),Dr.l+=4,Dr.chk("00100000","Mini Stream Cutoff Size: "),Lr=Dr.read_shift(4,"i"),tr=Dr.read_shift(4,"i"),kr=Dr.read_shift(4,"i"),or=Dr.read_shift(4,"i");for(var qr=-1,ln=0;ln<109&&(qr=Dr.read_shift(4,"i"),!(qr<0));++ln)Pr[ln]=qr;var pn=rt(Rt,Bt);nt(kr,or,pn,Bt,Pr);var gn=st(pn,Tr,Pr,Bt);gn[Tr].name="!Directory",tr>0&&Lr!==Tt&&(gn[Lr].name="!MiniFAT"),gn[Pr[0]].name="!FAT",gn.fat_addrs=Pr,gn.ssz=Bt;var xn={},_n=[],is=[],ss=[];ot(Tr,gn,pn,_n,tr,xn,is,Lr),it(is,ss,_n),_n.shift();var as={FileIndex:is,FullPaths:ss};return nr&&nr.raw&&(as.raw={header:Yr,sectors:pn}),as}function tt(Rt){if(Rt[Rt.l]==80&&Rt[Rt.l+1]==75)return[0,0];Rt.chk(er,"Header Signature: "),Rt.l+=16;var nr=Rt.read_shift(2,"u");return[Rt.read_shift(2,"u"),nr]}function _e(Rt,nr){var Mt=9;switch(Rt.l+=2,Mt=Rt.read_shift(2)){case 9:if(nr!=3)throw new Error("Sector Shift: Expected 9 saw "+Mt);break;case 12:if(nr!=4)throw new Error("Sector Shift: Expected 12 saw "+Mt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Mt)}Rt.chk("0600","Mini Sector Shift: "),Rt.chk("000000000000","Reserved: ")}function rt(Rt,nr){for(var Mt=Math.ceil(Rt.length/nr)-1,Bt=[],tr=1;tr<Mt;++tr)Bt[tr-1]=Rt.slice(tr*nr,(tr+1)*nr);return Bt[Mt-1]=Rt.slice(Mt*nr),Bt}function it(Rt,nr,Mt){for(var Bt=0,tr=0,or=0,Tr=0,Lr=0,kr=Mt.length,Pr=[],Dr=[];Bt<kr;++Bt)Pr[Bt]=Dr[Bt]=Bt,nr[Bt]=Mt[Bt];for(;Lr<Dr.length;++Lr)Bt=Dr[Lr],tr=Rt[Bt].L,or=Rt[Bt].R,Tr=Rt[Bt].C,Pr[Bt]===Bt&&(tr!==-1&&Pr[tr]!==tr&&(Pr[Bt]=Pr[tr]),or!==-1&&Pr[or]!==or&&(Pr[Bt]=Pr[or])),Tr!==-1&&(Pr[Tr]=Bt),tr!==-1&&Bt!=Pr[Bt]&&(Pr[tr]=Pr[Bt],Dr.lastIndexOf(tr)<Lr&&Dr.push(tr)),or!==-1&&Bt!=Pr[Bt]&&(Pr[or]=Pr[Bt],Dr.lastIndexOf(or)<Lr&&Dr.push(or));for(Bt=1;Bt<kr;++Bt)Pr[Bt]===Bt&&(or!==-1&&Pr[or]!==or?Pr[Bt]=Pr[or]:tr!==-1&&Pr[tr]!==tr&&(Pr[Bt]=Pr[tr]));for(Bt=1;Bt<kr;++Bt)if(Rt[Bt].type!==0){if(Lr=Bt,Lr!=Pr[Lr])do Lr=Pr[Lr],nr[Bt]=nr[Lr]+"/"+nr[Bt];while(Lr!==0&&Pr[Lr]!==-1&&Lr!=Pr[Lr]);Pr[Bt]=-1}for(nr[0]+="/",Bt=1;Bt<kr;++Bt)Rt[Bt].type!==2&&(nr[Bt]+="/")}function et(Rt,nr,Mt){for(var Bt=Rt.start,tr=Rt.size,or=[],Tr=Bt;Mt&&tr>0&&Tr>=0;)or.push(nr.slice(Tr*bt,Tr*bt+bt)),tr-=bt,Tr=__readInt32LE(Mt,Tr*4);return or.length===0?new_buf(0):bconcat(or).slice(0,Rt.size)}function nt(Rt,nr,Mt,Bt,tr){var or=Tt;if(Rt===Tt){if(nr!==0)throw new Error("DIFAT chain shorter than expected")}else if(Rt!==-1){var Tr=Mt[Rt],Lr=(Bt>>>2)-1;if(!Tr)return;for(var kr=0;kr<Lr&&(or=__readInt32LE(Tr,kr*4))!==Tt;++kr)tr.push(or);nt(__readInt32LE(Tr,Bt-4),nr-1,Mt,Bt,tr)}}function at(Rt,nr,Mt,Bt,tr){var or=[],Tr=[];tr||(tr=[]);var Lr=Bt-1,kr=0,Pr=0;for(kr=nr;kr>=0;){tr[kr]=!0,or[or.length]=kr,Tr.push(Rt[kr]);var Dr=Mt[Math.floor(kr*4/Bt)];if(Pr=kr*4&Lr,Bt<4+Pr)throw new Error("FAT boundary crossed: "+kr+" 4 "+Bt);if(!Rt[Dr])break;kr=__readInt32LE(Rt[Dr],Pr)}return{nodes:or,data:__toBuffer([Tr])}}function st(Rt,nr,Mt,Bt){var tr=Rt.length,or=[],Tr=[],Lr=[],kr=[],Pr=Bt-1,Dr=0,Gr=0,Yr=0,un=0;for(Dr=0;Dr<tr;++Dr)if(Lr=[],Yr=Dr+nr,Yr>=tr&&(Yr-=tr),!Tr[Yr]){kr=[];var qr=[];for(Gr=Yr;Gr>=0;){qr[Gr]=!0,Tr[Gr]=!0,Lr[Lr.length]=Gr,kr.push(Rt[Gr]);var ln=Mt[Math.floor(Gr*4/Bt)];if(un=Gr*4&Pr,Bt<4+un)throw new Error("FAT boundary crossed: "+Gr+" 4 "+Bt);if(!Rt[ln]||(Gr=__readInt32LE(Rt[ln],un),qr[Gr]))break}or[Yr]={nodes:Lr,data:__toBuffer([kr])}}return or}function ot(Rt,nr,Mt,Bt,tr,or,Tr,Lr){for(var kr=0,Pr=Bt.length?2:0,Dr=nr[Rt].data,Gr=0,Yr=0,un;Gr<Dr.length;Gr+=128){var qr=Dr.slice(Gr,Gr+128);prep_blob(qr,64),Yr=qr.read_shift(2),un=__utf16le(qr,0,Yr-Pr),Bt.push(un);var ln={name:un,type:qr.read_shift(1),color:qr.read_shift(1),L:qr.read_shift(4,"i"),R:qr.read_shift(4,"i"),C:qr.read_shift(4,"i"),clsid:qr.read_shift(16),state:qr.read_shift(4,"i"),start:0,size:0},pn=qr.read_shift(2)+qr.read_shift(2)+qr.read_shift(2)+qr.read_shift(2);pn!==0&&(ln.ct=pt(qr,qr.l-8));var gn=qr.read_shift(2)+qr.read_shift(2)+qr.read_shift(2)+qr.read_shift(2);gn!==0&&(ln.mt=pt(qr,qr.l-8)),ln.start=qr.read_shift(4,"i"),ln.size=qr.read_shift(4,"i"),ln.size<0&&ln.start<0&&(ln.size=ln.type=0,ln.start=Tt,ln.name=""),ln.type===5?(kr=ln.start,tr>0&&kr!==Tt&&(nr[kr].name="!StreamData")):ln.size>=4096?(ln.storage="fat",nr[ln.start]===void 0&&(nr[ln.start]=at(Mt,ln.start,nr.fat_addrs,nr.ssz)),nr[ln.start].name=ln.name,ln.content=nr[ln.start].data.slice(0,ln.size)):(ln.storage="minifat",ln.size<0?ln.size=0:kr!==Tt&&ln.start!==Tt&&nr[kr]&&(ln.content=et(ln,nr[kr].data,(nr[Lr]||{}).data))),ln.content&&prep_blob(ln.content,0),or[un]=ln,Tr.push(ln)}}function pt(Rt,nr){return new Date((__readUInt32LE(Rt,nr+4)/1e7*Math.pow(2,32)+__readUInt32LE(Rt,nr)/1e7-11644473600)*1e3)}function dt(Rt,nr){return _(),b(g.readFileSync(Rt),nr)}function wt(Rt,nr){var Mt=nr&&nr.type;switch(Mt||has_buf&&Buffer.isBuffer(Rt)&&(Mt="buffer"),Mt||"base64"){case"file":return dt(Rt,nr);case"base64":return b(s2a(Base64_decode(Rt)),nr);case"binary":return b(s2a(Rt),nr)}return b(Rt,nr)}function lt(Rt,nr){var Mt=nr||{},Bt=Mt.root||"Root Entry";if(Rt.FullPaths||(Rt.FullPaths=[]),Rt.FileIndex||(Rt.FileIndex=[]),Rt.FullPaths.length!==Rt.FileIndex.length)throw new Error("inconsistent CFB structure");Rt.FullPaths.length===0&&(Rt.FullPaths[0]=Bt+"/",Rt.FileIndex[0]={name:Bt,type:5}),Mt.CLSID&&(Rt.FileIndex[0].clsid=Mt.CLSID),gt(Rt)}function gt(Rt){var nr="Sh33tJ5";if(!CFB.find(Rt,"/"+nr)){var Mt=new_buf(4);Mt[0]=55,Mt[1]=Mt[3]=50,Mt[2]=54,Rt.FileIndex.push({name:nr,type:2,content:Mt,size:4,L:69,R:69,C:69}),Rt.FullPaths.push(Rt.FullPaths[0]+nr),vt(Rt)}}function vt(Rt,nr){lt(Rt);for(var Mt=!1,Bt=!1,tr=Rt.FullPaths.length-1;tr>=0;--tr){var or=Rt.FileIndex[tr];switch(or.type){case 0:Bt?Mt=!0:(Rt.FileIndex.pop(),Rt.FullPaths.pop());break;case 1:case 2:case 5:Bt=!0,isNaN(or.R*or.L*or.C)&&(Mt=!0),or.R>-1&&or.L>-1&&or.R==or.L&&(Mt=!0);break;default:Mt=!0;break}}if(!(!Mt&&!nr)){var Tr=new Date(1987,1,19),Lr=0,kr=Object.create?Object.create(null):{},Pr=[];for(tr=0;tr<Rt.FullPaths.length;++tr)kr[Rt.FullPaths[tr]]=!0,Rt.FileIndex[tr].type!==0&&Pr.push([Rt.FullPaths[tr],Rt.FileIndex[tr]]);for(tr=0;tr<Pr.length;++tr){var Dr=a(Pr[tr][0]);Bt=kr[Dr],Bt||(Pr.push([Dr,{name:o(Dr).replace("/",""),type:1,clsid:ar,ct:Tr,mt:Tr,content:null}]),kr[Dr]=!0)}for(Pr.sort(function(un,qr){return s(un[0],qr[0])}),Rt.FullPaths=[],Rt.FileIndex=[],tr=0;tr<Pr.length;++tr)Rt.FullPaths[tr]=Pr[tr][0],Rt.FileIndex[tr]=Pr[tr][1];for(tr=0;tr<Pr.length;++tr){var Gr=Rt.FileIndex[tr],Yr=Rt.FullPaths[tr];if(Gr.name=o(Yr).replace("/",""),Gr.L=Gr.R=Gr.C=-(Gr.color=1),Gr.size=Gr.content?Gr.content.length:0,Gr.start=0,Gr.clsid=Gr.clsid||ar,tr===0)Gr.C=Pr.length>1?1:-1,Gr.size=0,Gr.type=5;else if(Yr.slice(-1)=="/"){for(Lr=tr+1;Lr<Pr.length&&a(Rt.FullPaths[Lr])!=Yr;++Lr);for(Gr.C=Lr>=Pr.length?-1:Lr,Lr=tr+1;Lr<Pr.length&&a(Rt.FullPaths[Lr])!=a(Yr);++Lr);Gr.R=Lr>=Pr.length?-1:Lr,Gr.type=1}else a(Rt.FullPaths[tr+1]||"")==a(Yr)&&(Gr.R=tr+1),Gr.type=2}}}function At(Rt,nr){var Mt=nr||{};if(Mt.fileType=="mad")return Or(Rt,Mt);switch(vt(Rt),Mt.fileType){case"zip":return Nr(Rt,Mt)}var Bt=function(un){for(var qr=0,ln=0,pn=0;pn<un.FileIndex.length;++pn){var gn=un.FileIndex[pn];if(gn.content){var xn=gn.content.length;xn>0&&(xn<4096?qr+=xn+63>>6:ln+=xn+511>>9)}}for(var _n=un.FullPaths.length+3>>2,is=qr+7>>3,ss=qr+127>>7,as=is+ln+_n+ss,Bn=as+127>>7,ks=Bn<=109?0:Math.ceil((Bn-109)/127);as+Bn+ks+127>>7>Bn;)ks=++Bn<=109?0:Math.ceil((Bn-109)/127);var Pn=[1,ks,Bn,ss,_n,ln,qr,0];return un.FileIndex[0].size=qr<<6,Pn[7]=(un.FileIndex[0].start=Pn[0]+Pn[1]+Pn[2]+Pn[3]+Pn[4]+Pn[5])+(Pn[6]+7>>3),Pn}(Rt),tr=new_buf(Bt[7]<<9),or=0,Tr=0;{for(or=0;or<8;++or)tr.write_shift(1,zt[or]);for(or=0;or<8;++or)tr.write_shift(2,0);for(tr.write_shift(2,62),tr.write_shift(2,3),tr.write_shift(2,65534),tr.write_shift(2,9),tr.write_shift(2,6),or=0;or<3;++or)tr.write_shift(2,0);for(tr.write_shift(4,0),tr.write_shift(4,Bt[2]),tr.write_shift(4,Bt[0]+Bt[1]+Bt[2]+Bt[3]-1),tr.write_shift(4,0),tr.write_shift(4,4096),tr.write_shift(4,Bt[3]?Bt[0]+Bt[1]+Bt[2]-1:Tt),tr.write_shift(4,Bt[3]),tr.write_shift(-4,Bt[1]?Bt[0]-1:Tt),tr.write_shift(4,Bt[1]),or=0;or<109;++or)tr.write_shift(-4,or<Bt[2]?Bt[1]+or:-1)}if(Bt[1])for(Tr=0;Tr<Bt[1];++Tr){for(;or<236+Tr*127;++or)tr.write_shift(-4,or<Bt[2]?Bt[1]+or:-1);tr.write_shift(-4,Tr===Bt[1]-1?Tt:Tr+1)}var Lr=function(un){for(Tr+=un;or<Tr-1;++or)tr.write_shift(-4,or+1);un&&(++or,tr.write_shift(-4,Tt))};for(Tr=or=0,Tr+=Bt[1];or<Tr;++or)tr.write_shift(-4,Jt.DIFSECT);for(Tr+=Bt[2];or<Tr;++or)tr.write_shift(-4,Jt.FATSECT);Lr(Bt[3]),Lr(Bt[4]);for(var kr=0,Pr=0,Dr=Rt.FileIndex[0];kr<Rt.FileIndex.length;++kr)Dr=Rt.FileIndex[kr],Dr.content&&(Pr=Dr.content.length,!(Pr<4096)&&(Dr.start=Tr,Lr(Pr+511>>9)));for(Lr(Bt[6]+7>>3);tr.l&511;)tr.write_shift(-4,Jt.ENDOFCHAIN);for(Tr=or=0,kr=0;kr<Rt.FileIndex.length;++kr)Dr=Rt.FileIndex[kr],Dr.content&&(Pr=Dr.content.length,!(!Pr||Pr>=4096)&&(Dr.start=Tr,Lr(Pr+63>>6)));for(;tr.l&511;)tr.write_shift(-4,Jt.ENDOFCHAIN);for(or=0;or<Bt[4]<<2;++or){var Gr=Rt.FullPaths[or];if(!Gr||Gr.length===0){for(kr=0;kr<17;++kr)tr.write_shift(4,0);for(kr=0;kr<3;++kr)tr.write_shift(4,-1);for(kr=0;kr<12;++kr)tr.write_shift(4,0);continue}Dr=Rt.FileIndex[or],or===0&&(Dr.start=Dr.size?Dr.start-1:Tt);var Yr=or===0&&Mt.root||Dr.name;if(Pr=2*(Yr.length+1),tr.write_shift(64,Yr,"utf16le"),tr.write_shift(2,Pr),tr.write_shift(1,Dr.type),tr.write_shift(1,Dr.color),tr.write_shift(-4,Dr.L),tr.write_shift(-4,Dr.R),tr.write_shift(-4,Dr.C),Dr.clsid)tr.write_shift(16,Dr.clsid,"hex");else for(kr=0;kr<4;++kr)tr.write_shift(4,0);tr.write_shift(4,Dr.state||0),tr.write_shift(4,0),tr.write_shift(4,0),tr.write_shift(4,0),tr.write_shift(4,0),tr.write_shift(4,Dr.start),tr.write_shift(4,Dr.size),tr.write_shift(4,0)}for(or=1;or<Rt.FileIndex.length;++or)if(Dr=Rt.FileIndex[or],Dr.size>=4096)if(tr.l=Dr.start+1<<9,has_buf&&Buffer.isBuffer(Dr.content))Dr.content.copy(tr,tr.l,0,Dr.size),tr.l+=Dr.size+511&-512;else{for(kr=0;kr<Dr.size;++kr)tr.write_shift(1,Dr.content[kr]);for(;kr&511;++kr)tr.write_shift(1,0)}for(or=1;or<Rt.FileIndex.length;++or)if(Dr=Rt.FileIndex[or],Dr.size>0&&Dr.size<4096)if(has_buf&&Buffer.isBuffer(Dr.content))Dr.content.copy(tr,tr.l,0,Dr.size),tr.l+=Dr.size+63&-64;else{for(kr=0;kr<Dr.size;++kr)tr.write_shift(1,Dr.content[kr]);for(;kr&63;++kr)tr.write_shift(1,0)}if(has_buf)tr.l=tr.length;else for(;tr.l<tr.length;)tr.write_shift(1,0);return tr}function yt(Rt,nr){var Mt=Rt.FullPaths.map(function(kr){return kr.toUpperCase()}),Bt=Mt.map(function(kr){var Pr=kr.split("/");return Pr[Pr.length-(kr.slice(-1)=="/"?2:1)]}),tr=!1;nr.charCodeAt(0)===47?(tr=!0,nr=Mt[0].slice(0,-1)+nr):tr=nr.indexOf("/")!==-1;var or=nr.toUpperCase(),Tr=tr===!0?Mt.indexOf(or):Bt.indexOf(or);if(Tr!==-1)return Rt.FileIndex[Tr];var Lr=!or.match(chr1);for(or=or.replace(chr0,""),Lr&&(or=or.replace(chr1,"!")),Tr=0;Tr<Mt.length;++Tr)if((Lr?Mt[Tr].replace(chr1,"!"):Mt[Tr]).replace(chr0,"")==or||(Lr?Bt[Tr].replace(chr1,"!"):Bt[Tr]).replace(chr0,"")==or)return Rt.FileIndex[Tr];return null}var bt=64,Tt=-2,er="d0cf11e0a1b11ae1",zt=[208,207,17,224,161,177,26,225],ar="00000000000000000000000000000000",Jt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Tt,FREESECT:-1,HEADER_SIGNATURE:er,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ar,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Yt(Rt,nr,Mt){_();var Bt=At(Rt,Mt);g.writeFileSync(nr,Bt)}function kt(Rt){for(var nr=new Array(Rt.length),Mt=0;Mt<Rt.length;++Mt)nr[Mt]=String.fromCharCode(Rt[Mt]);return nr.join("")}function ir(Rt,nr){var Mt=At(Rt,nr);switch(nr&&nr.type||"buffer"){case"file":return _(),g.writeFileSync(nr.filename,Mt),Mt;case"binary":return typeof Mt=="string"?Mt:kt(Mt);case"base64":return Base64_encode(typeof Mt=="string"?Mt:kt(Mt));case"buffer":if(has_buf)return Buffer.isBuffer(Mt)?Mt:Buffer_from(Mt);case"array":return typeof Mt=="string"?s2a(Mt):Mt}return Mt}var fr;function Et(Rt){try{var nr=Rt.InflateRaw,Mt=new nr;if(Mt._processChunk(new Uint8Array([3,0]),Mt._finishFlushFlag),Mt.bytesRead)fr=Rt;else throw new Error("zlib does not expose bytesRead")}catch(Bt){console.error("cannot use native zlib: "+(Bt.message||Bt))}}function xt(Rt,nr){if(!fr)return Hr(Rt,nr);var Mt=fr.InflateRaw,Bt=new Mt,tr=Bt._processChunk(Rt.slice(Rt.l),Bt._finishFlushFlag);return Rt.l+=Bt.bytesRead,tr}function mt(Rt){return fr?fr.deflateRawSync(Rt):dn(Rt)}var St=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Pt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Nt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Lt(Rt){var nr=(Rt<<1|Rt<<11)&139536|(Rt<<5|Rt<<15)&558144;return(nr>>16|nr>>8|nr)&255}for(var lr=typeof Uint8Array<"u",ur=lr?new Uint8Array(256):[],wr=0;wr<256;++wr)ur[wr]=Lt(wr);function vr(Rt,nr){var Mt=ur[Rt&255];return nr<=8?Mt>>>8-nr:(Mt=Mt<<8|ur[Rt>>8&255],nr<=16?Mt>>>16-nr:(Mt=Mt<<8|ur[Rt>>16&255],Mt>>>24-nr))}function Fr(Rt,nr){var Mt=nr&7,Bt=nr>>>3;return(Rt[Bt]|(Mt<=6?0:Rt[Bt+1]<<8))>>>Mt&3}function Rr(Rt,nr){var Mt=nr&7,Bt=nr>>>3;return(Rt[Bt]|(Mt<=5?0:Rt[Bt+1]<<8))>>>Mt&7}function jr(Rt,nr){var Mt=nr&7,Bt=nr>>>3;return(Rt[Bt]|(Mt<=4?0:Rt[Bt+1]<<8))>>>Mt&15}function xr(Rt,nr){var Mt=nr&7,Bt=nr>>>3;return(Rt[Bt]|(Mt<=3?0:Rt[Bt+1]<<8))>>>Mt&31}function hr(Rt,nr){var Mt=nr&7,Bt=nr>>>3;return(Rt[Bt]|(Mt<=1?0:Rt[Bt+1]<<8))>>>Mt&127}function jt(Rt,nr,Mt){var Bt=nr&7,tr=nr>>>3,or=(1<<Mt)-1,Tr=Rt[tr]>>>Bt;return Mt<8-Bt||(Tr|=Rt[tr+1]<<8-Bt,Mt<16-Bt)||(Tr|=Rt[tr+2]<<16-Bt,Mt<24-Bt)||(Tr|=Rt[tr+3]<<24-Bt),Tr&or}function sr(Rt,nr,Mt){var Bt=nr&7,tr=nr>>>3;return Bt<=5?Rt[tr]|=(Mt&7)<<Bt:(Rt[tr]|=Mt<<Bt&255,Rt[tr+1]=(Mt&7)>>8-Bt),nr+3}function _r(Rt,nr,Mt){var Bt=nr&7,tr=nr>>>3;return Mt=(Mt&1)<<Bt,Rt[tr]|=Mt,nr+1}function Ar(Rt,nr,Mt){var Bt=nr&7,tr=nr>>>3;return Mt<<=Bt,Rt[tr]|=Mt&255,Mt>>>=8,Rt[tr+1]=Mt,nr+8}function Mr(Rt,nr,Mt){var Bt=nr&7,tr=nr>>>3;return Mt<<=Bt,Rt[tr]|=Mt&255,Mt>>>=8,Rt[tr+1]=Mt&255,Rt[tr+2]=Mt>>>8,nr+16}function Ur(Rt,nr){var Mt=Rt.length,Bt=2*Mt>nr?2*Mt:nr+5,tr=0;if(Mt>=nr)return Rt;if(has_buf){var or=new_unsafe_buf(Bt);if(Rt.copy)Rt.copy(or);else for(;tr<Rt.length;++tr)or[tr]=Rt[tr];return or}else if(lr){var Tr=new Uint8Array(Bt);if(Tr.set)Tr.set(Rt);else for(;tr<Mt;++tr)Tr[tr]=Rt[tr];return Tr}return Rt.length=Bt,Rt}function Er(Rt){for(var nr=new Array(Rt),Mt=0;Mt<Rt;++Mt)nr[Mt]=0;return nr}function pr(Rt,nr,Mt){var Bt=1,tr=0,or=0,Tr=0,Lr=0,kr=Rt.length,Pr=lr?new Uint16Array(32):Er(32);for(or=0;or<32;++or)Pr[or]=0;for(or=kr;or<Mt;++or)Rt[or]=0;kr=Rt.length;var Dr=lr?new Uint16Array(kr):Er(kr);for(or=0;or<kr;++or)Pr[tr=Rt[or]]++,Bt<tr&&(Bt=tr),Dr[or]=0;for(Pr[0]=0,or=1;or<=Bt;++or)Pr[or+16]=Lr=Lr+Pr[or-1]<<1;for(or=0;or<kr;++or)Lr=Rt[or],Lr!=0&&(Dr[or]=Pr[Lr+16]++);var Gr=0;for(or=0;or<kr;++or)if(Gr=Rt[or],Gr!=0)for(Lr=vr(Dr[or],Bt)>>Bt-Gr,Tr=(1<<Bt+4-Gr)-1;Tr>=0;--Tr)nr[Lr|Tr<<Gr]=Gr&15|or<<4;return Bt}var Wr=lr?new Uint16Array(512):Er(512),zr=lr?new Uint16Array(32):Er(32);if(!lr){for(var en=0;en<512;++en)Wr[en]=0;for(en=0;en<32;++en)zr[en]=0}(function(){for(var Rt=[],nr=0;nr<32;nr++)Rt.push(5);pr(Rt,zr,32);var Mt=[];for(nr=0;nr<=143;nr++)Mt.push(8);for(;nr<=255;nr++)Mt.push(9);for(;nr<=279;nr++)Mt.push(7);for(;nr<=287;nr++)Mt.push(8);pr(Mt,Wr,288)})();var sn=function(){for(var nr=lr?new Uint8Array(32768):[],Mt=0,Bt=0;Mt<Nt.length-1;++Mt)for(;Bt<Nt[Mt+1];++Bt)nr[Bt]=Mt;for(;Bt<32768;++Bt)nr[Bt]=29;var tr=lr?new Uint8Array(259):[];for(Mt=0,Bt=0;Mt<Pt.length-1;++Mt)for(;Bt<Pt[Mt+1];++Bt)tr[Bt]=Mt;function or(Lr,kr){for(var Pr=0;Pr<Lr.length;){var Dr=Math.min(65535,Lr.length-Pr),Gr=Pr+Dr==Lr.length;for(kr.write_shift(1,+Gr),kr.write_shift(2,Dr),kr.write_shift(2,~Dr&65535);Dr-- >0;)kr[kr.l++]=Lr[Pr++]}return kr.l}function Tr(Lr,kr){for(var Pr=0,Dr=0,Gr=lr?new Uint16Array(32768):[];Dr<Lr.length;){var Yr=Math.min(65535,Lr.length-Dr);if(Yr<10){for(Pr=sr(kr,Pr,+(Dr+Yr==Lr.length)),Pr&7&&(Pr+=8-(Pr&7)),kr.l=Pr/8|0,kr.write_shift(2,Yr),kr.write_shift(2,~Yr&65535);Yr-- >0;)kr[kr.l++]=Lr[Dr++];Pr=kr.l*8;continue}Pr=sr(kr,Pr,+(Dr+Yr==Lr.length)+2);for(var un=0;Yr-- >0;){var qr=Lr[Dr];un=(un<<5^qr)&32767;var ln=-1,pn=0;if((ln=Gr[un])&&(ln|=Dr&-32768,ln>Dr&&(ln-=32768),ln<Dr))for(;Lr[ln+pn]==Lr[Dr+pn]&&pn<250;)++pn;if(pn>2){qr=tr[pn],qr<=22?Pr=Ar(kr,Pr,ur[qr+1]>>1)-1:(Ar(kr,Pr,3),Pr+=5,Ar(kr,Pr,ur[qr-23]>>5),Pr+=3);var gn=qr<8?0:qr-4>>2;gn>0&&(Mr(kr,Pr,pn-Pt[qr]),Pr+=gn),qr=nr[Dr-ln],Pr=Ar(kr,Pr,ur[qr]>>3),Pr-=3;var xn=qr<4?0:qr-2>>1;xn>0&&(Mr(kr,Pr,Dr-ln-Nt[qr]),Pr+=xn);for(var _n=0;_n<pn;++_n)Gr[un]=Dr&32767,un=(un<<5^Lr[Dr])&32767,++Dr;Yr-=pn-1}else qr<=143?qr=qr+48:Pr=_r(kr,Pr,1),Pr=Ar(kr,Pr,ur[qr]),Gr[un]=Dr&32767,++Dr}Pr=Ar(kr,Pr,0)-1}return kr.l=(Pr+7)/8|0,kr.l}return function(kr,Pr){return kr.length<8?or(kr,Pr):Tr(kr,Pr)}}();function dn(Rt){var nr=new_buf(50+Math.floor(Rt.length*1.1)),Mt=sn(Rt,nr);return nr.slice(0,Mt)}var Kr=lr?new Uint16Array(32768):Er(32768),tn=lr?new Uint16Array(32768):Er(32768),fn=lr?new Uint16Array(128):Er(128),hn=1,Br=1;function br(Rt,nr){var Mt=xr(Rt,nr)+257;nr+=5;var Bt=xr(Rt,nr)+1;nr+=5;var tr=jr(Rt,nr)+4;nr+=4;for(var or=0,Tr=lr?new Uint8Array(19):Er(19),Lr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],kr=1,Pr=lr?new Uint8Array(8):Er(8),Dr=lr?new Uint8Array(8):Er(8),Gr=Tr.length,Yr=0;Yr<tr;++Yr)Tr[St[Yr]]=or=Rr(Rt,nr),kr<or&&(kr=or),Pr[or]++,nr+=3;var un=0;for(Pr[0]=0,Yr=1;Yr<=kr;++Yr)Dr[Yr]=un=un+Pr[Yr-1]<<1;for(Yr=0;Yr<Gr;++Yr)(un=Tr[Yr])!=0&&(Lr[Yr]=Dr[un]++);var qr=0;for(Yr=0;Yr<Gr;++Yr)if(qr=Tr[Yr],qr!=0){un=ur[Lr[Yr]]>>8-qr;for(var ln=(1<<7-qr)-1;ln>=0;--ln)fn[un|ln<<qr]=qr&7|Yr<<3}var pn=[];for(kr=1;pn.length<Mt+Bt;)switch(un=fn[hr(Rt,nr)],nr+=un&7,un>>>=3){case 16:for(or=3+Fr(Rt,nr),nr+=2,un=pn[pn.length-1];or-- >0;)pn.push(un);break;case 17:for(or=3+Rr(Rt,nr),nr+=3;or-- >0;)pn.push(0);break;case 18:for(or=11+hr(Rt,nr),nr+=7;or-- >0;)pn.push(0);break;default:pn.push(un),kr<un&&(kr=un);break}var gn=pn.slice(0,Mt),xn=pn.slice(Mt);for(Yr=Mt;Yr<286;++Yr)gn[Yr]=0;for(Yr=Bt;Yr<30;++Yr)xn[Yr]=0;return hn=pr(gn,Kr,286),Br=pr(xn,tn,30),nr}function Cr(Rt,nr){if(Rt[0]==3&&!(Rt[1]&3))return[new_raw_buf(nr),2];for(var Mt=0,Bt=0,tr=new_unsafe_buf(nr||1<<18),or=0,Tr=tr.length>>>0,Lr=0,kr=0;!(Bt&1);){if(Bt=Rr(Rt,Mt),Mt+=3,Bt>>>1)Bt>>1==1?(Lr=9,kr=5):(Mt=br(Rt,Mt),Lr=hn,kr=Br);else{Mt&7&&(Mt+=8-(Mt&7));var Pr=Rt[Mt>>>3]|Rt[(Mt>>>3)+1]<<8;if(Mt+=32,Pr>0)for(!nr&&Tr<or+Pr&&(tr=Ur(tr,or+Pr),Tr=tr.length);Pr-- >0;)tr[or++]=Rt[Mt>>>3],Mt+=8;continue}for(;;){!nr&&Tr<or+32767&&(tr=Ur(tr,or+32767),Tr=tr.length);var Dr=jt(Rt,Mt,Lr),Gr=Bt>>>1==1?Wr[Dr]:Kr[Dr];if(Mt+=Gr&15,Gr>>>=4,!(Gr>>>8&255))tr[or++]=Gr;else{if(Gr==256)break;Gr-=257;var Yr=Gr<8?0:Gr-4>>2;Yr>5&&(Yr=0);var un=or+Pt[Gr];Yr>0&&(un+=jt(Rt,Mt,Yr),Mt+=Yr),Dr=jt(Rt,Mt,kr),Gr=Bt>>>1==1?zr[Dr]:tn[Dr],Mt+=Gr&15,Gr>>>=4;var qr=Gr<4?0:Gr-2>>1,ln=Nt[Gr];for(qr>0&&(ln+=jt(Rt,Mt,qr),Mt+=qr),!nr&&Tr<un&&(tr=Ur(tr,un+100),Tr=tr.length);or<un;)tr[or]=tr[or-ln],++or}}}return nr?[tr,Mt+7>>>3]:[tr.slice(0,or),Mt+7>>>3]}function Hr(Rt,nr){var Mt=Rt.slice(Rt.l||0),Bt=Cr(Mt,nr);return Rt.l+=Bt[1],Bt[0]}function an(Rt,nr){if(Rt)typeof console<"u"&&console.error(nr);else throw new Error(nr)}function rn(Rt,nr){var Mt=Rt;prep_blob(Mt,0);var Bt=[],tr=[],or={FileIndex:Bt,FullPaths:tr};lt(or,{root:nr.root});for(var Tr=Mt.length-4;(Mt[Tr]!=80||Mt[Tr+1]!=75||Mt[Tr+2]!=5||Mt[Tr+3]!=6)&&Tr>=0;)--Tr;Mt.l=Tr+4,Mt.l+=4;var Lr=Mt.read_shift(2);Mt.l+=6;var kr=Mt.read_shift(4);for(Mt.l=kr,Tr=0;Tr<Lr;++Tr){Mt.l+=20;var Pr=Mt.read_shift(4),Dr=Mt.read_shift(4),Gr=Mt.read_shift(2),Yr=Mt.read_shift(2),un=Mt.read_shift(2);Mt.l+=8;var qr=Mt.read_shift(4),ln=h(Mt.slice(Mt.l+Gr,Mt.l+Gr+Yr));Mt.l+=Gr+Yr+un;var pn=Mt.l;Mt.l=qr+4,dr(Mt,Pr,Dr,or,ln),Mt.l=pn}return or}function dr(Rt,nr,Mt,Bt,tr){Rt.l+=2;var or=Rt.read_shift(2),Tr=Rt.read_shift(2),Lr=d(Rt);if(or&8257)throw new Error("Unsupported ZIP encryption");for(var kr=Rt.read_shift(4),Pr=Rt.read_shift(4),Dr=Rt.read_shift(4),Gr=Rt.read_shift(2),Yr=Rt.read_shift(2),un="",qr=0;qr<Gr;++qr)un+=String.fromCharCode(Rt[Rt.l++]);if(Yr){var ln=h(Rt.slice(Rt.l,Rt.l+Yr));(ln[21589]||{}).mt&&(Lr=ln[21589].mt),((tr||{})[21589]||{}).mt&&(Lr=tr[21589].mt)}Rt.l+=Yr;var pn=Rt.slice(Rt.l,Rt.l+Pr);switch(Tr){case 8:pn=xt(Rt,Dr);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Tr)}var gn=!1;or&8&&(kr=Rt.read_shift(4),kr==134695760&&(kr=Rt.read_shift(4),gn=!0),Pr=Rt.read_shift(4),Dr=Rt.read_shift(4)),Pr!=nr&&an(gn,"Bad compressed size: "+nr+" != "+Pr),Dr!=Mt&&an(gn,"Bad uncompressed size: "+Mt+" != "+Dr),$r(Bt,un,pn,{unsafe:!0,mt:Lr})}function Nr(Rt,nr){var Mt=nr||{},Bt=[],tr=[],or=new_buf(1),Tr=Mt.compression?8:0,Lr=0,kr=0,Pr=0,Dr=0,Gr=0,Yr=Rt.FullPaths[0],un=Yr,qr=Rt.FileIndex[0],ln=[],pn=0;for(kr=1;kr<Rt.FullPaths.length;++kr)if(un=Rt.FullPaths[kr].slice(Yr.length),qr=Rt.FileIndex[kr],!(!qr.size||!qr.content||un=="Sh33tJ5")){var gn=Dr,xn=new_buf(un.length);for(Pr=0;Pr<un.length;++Pr)xn.write_shift(1,un.charCodeAt(Pr)&127);xn=xn.slice(0,xn.l),ln[Gr]=CRC32.buf(qr.content,0);var _n=qr.content;Tr==8&&(_n=mt(_n)),or=new_buf(30),or.write_shift(4,67324752),or.write_shift(2,20),or.write_shift(2,Lr),or.write_shift(2,Tr),qr.mt?c(or,qr.mt):or.write_shift(4,0),or.write_shift(-4,ln[Gr]),or.write_shift(4,_n.length),or.write_shift(4,qr.content.length),or.write_shift(2,xn.length),or.write_shift(2,0),Dr+=or.length,Bt.push(or),Dr+=xn.length,Bt.push(xn),Dr+=_n.length,Bt.push(_n),or=new_buf(46),or.write_shift(4,33639248),or.write_shift(2,0),or.write_shift(2,20),or.write_shift(2,Lr),or.write_shift(2,Tr),or.write_shift(4,0),or.write_shift(-4,ln[Gr]),or.write_shift(4,_n.length),or.write_shift(4,qr.content.length),or.write_shift(2,xn.length),or.write_shift(2,0),or.write_shift(2,0),or.write_shift(2,0),or.write_shift(2,0),or.write_shift(4,0),or.write_shift(4,gn),pn+=or.l,tr.push(or),pn+=xn.length,tr.push(xn),++Gr}return or=new_buf(22),or.write_shift(4,101010256),or.write_shift(2,0),or.write_shift(2,0),or.write_shift(2,Gr),or.write_shift(2,Gr),or.write_shift(4,pn),or.write_shift(4,Dr),or.write_shift(2,0),bconcat([bconcat(Bt),bconcat(tr),or])}var Xr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Jr(Rt,nr){if(Rt.ctype)return Rt.ctype;var Mt=Rt.name||"",Bt=Mt.match(/\.([^\.]+)$/);return Bt&&Xr[Bt[1]]||nr&&(Bt=(Mt=nr).match(/[\.\\]([^\.\\])+$/),Bt&&Xr[Bt[1]])?Xr[Bt[1]]:"application/octet-stream"}function on(Rt){for(var nr=Base64_encode(Rt),Mt=[],Bt=0;Bt<nr.length;Bt+=76)Mt.push(nr.slice(Bt,Bt+76));return Mt.join(`\r
`)+`\r
`}function Qr(Rt){var nr=Rt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pr){var Dr=Pr.charCodeAt(0).toString(16).toUpperCase();return"="+(Dr.length==1?"0"+Dr:Dr)});nr=nr.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),nr.charAt(0)==`
`&&(nr="=0D"+nr.slice(1)),nr=nr.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Mt=[],Bt=nr.split(`\r
`),tr=0;tr<Bt.length;++tr){var or=Bt[tr];if(or.length==0){Mt.push("");continue}for(var Tr=0;Tr<or.length;){var Lr=76,kr=or.slice(Tr,Tr+Lr);kr.charAt(Lr-1)=="="?Lr--:kr.charAt(Lr-2)=="="?Lr-=2:kr.charAt(Lr-3)=="="&&(Lr-=3),kr=or.slice(Tr,Tr+Lr),Tr+=Lr,Tr<or.length&&(kr+="="),Mt.push(kr)}}return Mt.join(`\r
`)}function cr(Rt){for(var nr=[],Mt=0;Mt<Rt.length;++Mt){for(var Bt=Rt[Mt];Mt<=Rt.length&&Bt.charAt(Bt.length-1)=="=";)Bt=Bt.slice(0,Bt.length-1)+Rt[++Mt];nr.push(Bt)}for(var tr=0;tr<nr.length;++tr)nr[tr]=nr[tr].replace(/[=][0-9A-Fa-f]{2}/g,function(or){return String.fromCharCode(parseInt(or.slice(1),16))});return s2a(nr.join(`\r
`))}function rr(Rt,nr,Mt){for(var Bt="",tr="",or="",Tr,Lr=0;Lr<10;++Lr){var kr=nr[Lr];if(!kr||kr.match(/^\s*$/))break;var Pr=kr.match(/^(.*?):\s*([^\s].*)$/);if(Pr)switch(Pr[1].toLowerCase()){case"content-location":Bt=Pr[2].trim();break;case"content-type":or=Pr[2].trim();break;case"content-transfer-encoding":tr=Pr[2].trim();break}}switch(++Lr,tr.toLowerCase()){case"base64":Tr=s2a(Base64_decode(nr.slice(Lr).join("")));break;case"quoted-printable":Tr=cr(nr.slice(Lr));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+tr)}var Dr=$r(Rt,Bt.slice(Mt.length),Tr,{unsafe:!0});or&&(Dr.ctype=or)}function gr(Rt,nr){if(kt(Rt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Mt=nr&&nr.root||"",Bt=(has_buf&&Buffer.isBuffer(Rt)?Rt.toString("binary"):kt(Rt)).split(`\r
`),tr=0,or="";for(tr=0;tr<Bt.length;++tr)if(or=Bt[tr],!!/^Content-Location:/i.test(or)&&(or=or.slice(or.indexOf("file")),Mt||(Mt=or.slice(0,or.lastIndexOf("/")+1)),or.slice(0,Mt.length)!=Mt))for(;Mt.length>0&&(Mt=Mt.slice(0,Mt.length-1),Mt=Mt.slice(0,Mt.lastIndexOf("/")+1),or.slice(0,Mt.length)!=Mt););var Tr=(Bt[1]||"").match(/boundary="(.*?)"/);if(!Tr)throw new Error("MAD cannot find boundary");var Lr="--"+(Tr[1]||""),kr=[],Pr=[],Dr={FileIndex:kr,FullPaths:Pr};lt(Dr);var Gr,Yr=0;for(tr=0;tr<Bt.length;++tr){var un=Bt[tr];un!==Lr&&un!==Lr+"--"||(Yr++&&rr(Dr,Bt.slice(Gr,tr),Mt),Gr=tr)}return Dr}function Or(Rt,nr){var Mt=nr||{},Bt=Mt.boundary||"SheetJS";Bt="------="+Bt;for(var tr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Bt.slice(2)+'"',"","",""],or=Rt.FullPaths[0],Tr=or,Lr=Rt.FileIndex[0],kr=1;kr<Rt.FullPaths.length;++kr)if(Tr=Rt.FullPaths[kr].slice(or.length),Lr=Rt.FileIndex[kr],!(!Lr.size||!Lr.content||Tr=="Sh33tJ5")){Tr=Tr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pn){return"_x"+pn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pn){return"_u"+pn.charCodeAt(0).toString(16)+"_"});for(var Pr=Lr.content,Dr=has_buf&&Buffer.isBuffer(Pr)?Pr.toString("binary"):kt(Pr),Gr=0,Yr=Math.min(1024,Dr.length),un=0,qr=0;qr<=Yr;++qr)(un=Dr.charCodeAt(qr))>=32&&un<128&&++Gr;var ln=Gr>=Yr*4/5;tr.push(Bt),tr.push("Content-Location: "+(Mt.root||"file:///C:/SheetJS/")+Tr),tr.push("Content-Transfer-Encoding: "+(ln?"quoted-printable":"base64")),tr.push("Content-Type: "+Jr(Lr,Tr)),tr.push(""),tr.push(ln?Qr(Dr):on(Dr))}return tr.push(Bt+`--\r
`),tr.join(`\r
`)}function Ir(Rt){var nr={};return lt(nr,Rt),nr}function $r(Rt,nr,Mt,Bt){var tr=Bt&&Bt.unsafe;tr||lt(Rt);var or=!tr&&CFB.find(Rt,nr);if(!or){var Tr=Rt.FullPaths[0];nr.slice(0,Tr.length)==Tr?Tr=nr:(Tr.slice(-1)!="/"&&(Tr+="/"),Tr=(Tr+nr).replace("//","/")),or={name:o(nr),type:2},Rt.FileIndex.push(or),Rt.FullPaths.push(Tr),tr||CFB.utils.cfb_gc(Rt)}return or.content=Mt,or.size=Mt?Mt.length:0,Bt&&(Bt.CLSID&&(or.clsid=Bt.CLSID),Bt.mt&&(or.mt=Bt.mt),Bt.ct&&(or.ct=Bt.ct)),or}function Vr(Rt,nr){lt(Rt);var Mt=CFB.find(Rt,nr);if(Mt){for(var Bt=0;Bt<Rt.FileIndex.length;++Bt)if(Rt.FileIndex[Bt]==Mt)return Rt.FileIndex.splice(Bt,1),Rt.FullPaths.splice(Bt,1),!0}return!1}function nn(Rt,nr,Mt){lt(Rt);var Bt=CFB.find(Rt,nr);if(Bt){for(var tr=0;tr<Rt.FileIndex.length;++tr)if(Rt.FileIndex[tr]==Bt)return Rt.FileIndex[tr].name=o(Mt),Rt.FullPaths[tr]=Mt,!0}return!1}function Zr(Rt){vt(Rt,!0)}return i.find=yt,i.read=wt,i.parse=b,i.write=ir,i.writeFile=Yt,i.utils={cfb_new:Ir,cfb_add:$r,cfb_del:Vr,cfb_mov:nn,cfb_gc:Zr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:Et,_deflateRaw:dn,_inflateRaw:Hr,consts:Jt},i}();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,i,s){if(typeof Deno<"u"){if(s&&typeof i=="string")switch(s){case"utf8":i=new TextEncoder(s).encode(i);break;case"binary":i=s2ab(i);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(e,i)}var a=s=="utf8"?utf8write(i):i;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var o=new Blob([blobify(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=e,d.href=c,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(i)&&(i=a2s(i)),h.write(i),h.close(),i}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function keys(e){for(var i=Object.keys(e),s=[],a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e,i[a])&&s.push(i[a]);return s}function evert_key(e,i){for(var s=[],a=keys(e),o=0;o!==a.length;++o)s[e[a[o]][i]]==null&&(s[e[a[o]][i]]=a[o]);return s}function evert(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]=s[a];return i}function evert_num(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]=parseInt(s[a],10);return i}function evert_arr(e){for(var i=[],s=keys(e),a=0;a!==s.length;++a)i[e[s[a]]]==null&&(i[e[s[a]]]=[]),i[e[s[a]]].push(s[a]);return i}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,i){var s=e.getTime(),a=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(s-a)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var i=new Date;return i.setTime(e*24*60*60*1e3+dnthresh),i.getTimezoneOffset()!==refoffset&&i.setTime(i.getTime()+(i.getTimezoneOffset()-refoffset)*6e4),i}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,i){var s=new Date(e);if(good_pd)return i>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):i<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(s.getFullYear())){var a=s.getFullYear();return e.indexOf(""+a)>-1||s.setFullYear(s.getFullYear()+100),s}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function cc2str(e,i){if(has_buf&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return s[c]||c})}catch{}for(var a=[],o=0;o!=e.length;++o)a.push(String.fromCharCode(e[o]));return a.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=dup(e[s]));return i}function fill(e,i){for(var s="";s.length<i;)s+=e;return s}function fuzzynum(e){var i=Number(e);if(!isNaN(i))return isFinite(i)?i:NaN;if(!/\d/.test(e))return i;var s=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(i=Number(a))||(a=a.replace(/[(](.*)[)]/,function(o,c){return s=-s,c}),!isNaN(i=Number(a)))?i/s:i}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var i=new Date(e),s=new Date(NaN),a=i.getYear(),o=i.getMonth(),c=i.getDate();if(isNaN(c))return s;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&lower_months.indexOf(d)==-1)return s}else if(d.match(/[a-z]/))return s;return a<0||a>8099?s:(o>0||c>1)&&a!=101?i:e.match(/[^-0-9:,\/\\]/)?s:i}function zip_add_file(e,i,s){if(e.FullPaths){if(typeof s=="string"){var a;return has_buf?a=Buffer_from(s):a=utf8decode(s),CFB.utils.cfb_add(e,i,a)}CFB.utils.cfb_add(e,i,s)}else e.file(i,s)}function zip_new(){return CFB.utils.cfb_new()}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(charegex,function(s){return"_x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var i=e+"";return i.replace(decregex,function(s){return rencoding[s]}).replace(htmlcharegex,function(s){return"&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"})}function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var i="",s=0,a=0,o=0,c=0,d=0,h=0;s<e.length;){if(a=e.charCodeAt(s++),a<128){i+=String.fromCharCode(a);continue}if(o=e.charCodeAt(s++),a>191&&a<224){d=(a&31)<<6,d|=o&63,i+=String.fromCharCode(d);continue}if(c=e.charCodeAt(s++),a<240){i+=String.fromCharCode((a&15)<<12|(o&63)<<6|c&63);continue}d=e.charCodeAt(s++),h=((a&7)<<18|(o&63)<<12|(c&63)<<6|d&63)-65536,i+=String.fromCharCode(55296+(h>>>10&1023)),i+=String.fromCharCode(56320+(h&1023))}return i}function utf8readb(e){var i=new_raw_buf(2*e.length),s,a,o=1,c=0,d=0,h;for(a=0;a<e.length;a+=o)o=1,(h=e.charCodeAt(a))<128?s=h:h<224?(s=(h&31)*64+(e.charCodeAt(a+1)&63),o=2):h<240?(s=(h&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),o=3):(o=4,s=(h&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),s-=65536,d=55296+(s>>>10&1023),s=56320+(s&1023)),d!==0&&(i[c++]=d&255,i[c++]=d>>>8,d=0),i[c++]=s%256,i[c++]=s>>>8;return i.slice(0,c).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var i=[],s=0,a=0,o=0;s<e.length;)switch(a=e.charCodeAt(s++),!0){case a<128:i.push(String.fromCharCode(a));break;case a<2048:i.push(String.fromCharCode(192+(a>>6))),i.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,o=e.charCodeAt(s++)-56320+(a<<10),i.push(String.fromCharCode(240+(o>>18&7))),i.push(String.fromCharCode(144+(o>>12&63))),i.push(String.fromCharCode(128+(o>>6&63))),i.push(String.fromCharCode(128+(o&63)));break;default:i.push(String.fromCharCode(224+(a>>12))),i.push(String.fromCharCode(128+(a>>6&63))),i.push(String.fromCharCode(128+(a&63)))}return i.join("")},htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(i){return[new RegExp("&"+i[0]+";","ig"),i[1]]});return function(s){for(var a=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)a=a.replace(e[o][0],e[o][1]);return a}}(),wtregex=/(^\s|\s$|\n)/;function writetag(e,i){return"<"+e+(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(i){return" "+i+'="'+e[i]+'"'}).join("")}function writextag(e,i,s){return"<"+e+(s!=null?wxt_helper(s):"")+(i!=null?(i.match(wtregex)?' xml:space="preserve"':"")+">"+i+"</"+e:"/")+">"}function write_w3cdtf(e,i){try{return e.toISOString().replace(/\.\d*/,"")}catch(s){if(i)throw s}return""}function write_vt(e,i){switch(typeof e){case"string":var s=writextag("vt:lpwstr",escapexml(e));return s=s.replace(/&quot;/g,"_x0022_"),s;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}var XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,i){for(var s=1-2*(e[i+7]>>>7),a=((e[i+7]&127)<<4)+(e[i+6]>>>4&15),o=e[i+6]&15,c=5;c>=0;--c)o=o*256+e[i+c];return a==2047?o==0?s*(1/0):NaN:(a==0?a=-1022:(a-=1023,o+=Math.pow(2,52)),s*Math.pow(2,a-52)*o)}function write_double_le(e,i,s){var a=(i<0||1/i==-1/0?1:0)<<7,o=0,c=0,d=a?-i:i;isFinite(d)?d==0?o=c=0:(o=Math.floor(Math.log(d)/Math.LN2),c=d*Math.pow(2,52-o),o<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?o=-1022:(c-=Math.pow(2,52),o+=1023)):(o=2047,c=isNaN(i)?26985:0);for(var h=0;h<=5;++h,c/=256)e[s+h]=c&255;e[s+6]=(o&15)<<4|c&15,e[s+7]=o>>4|a}var ___toBuffer=function(e){for(var i=[],s=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var o=0,c=e[0][a].length;o<c;o+=s)i.push.apply(i,e[0][a].slice(o,o+s));return i},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(i){return Buffer.isBuffer(i)?i:Buffer_from(i)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,i,s){for(var a=[],o=i;o<s;o+=2)a.push(String.fromCharCode(__readUInt16LE(e,o)));return a.join("").replace(chr0,"")},__utf16le=has_buf?function(e,i,s){return Buffer.isBuffer(e)?e.toString("utf16le",i,s).replace(chr0,""):___utf16le(e,i,s)}:___utf16le,___hexlify=function(e,i,s){for(var a=[],o=i;o<i+s;++o)a.push(("0"+e[o].toString(16)).slice(-2));return a.join("")},__hexlify=has_buf?function(e,i,s){return Buffer.isBuffer(e)?e.toString("hex",i,i+s):___hexlify(e,i,s)}:___hexlify,___utf8=function(e,i,s){for(var a=[],o=i;o<s;o++)a.push(String.fromCharCode(__readUInt8(e,o)));return a.join("")},__utf8=has_buf?function(i,s,a){return Buffer.isBuffer(i)?i.toString("utf8",s,a):___utf8(i,s,a)}:___utf8,___lpstr=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__lpstr=___lpstr,___cpstr=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__cpstr=___cpstr,___lpwstr=function(e,i){var s=2*__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s-1):""},__lpwstr=___lpwstr,___lpp4=function(i,s){var a=__readUInt32LE(i,s);return a>0?__utf16le(i,s+4,s+4+a):""},__lpp4=___lpp4,___8lpp4=function(e,i){var s=__readUInt32LE(e,i);return s>0?__utf8(e,i+4,i+4+s):""},__8lpp4=___8lpp4,___double=function(e,i){return read_double_le(e,i)},__double=___double,is_buf=function(i){return Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array};has_buf&&(__lpstr=function(i,s){if(!Buffer.isBuffer(i))return ___lpstr(i,s);var a=i.readUInt32LE(s);return a>0?i.toString("utf8",s+4,s+4+a-1):""},__cpstr=function(i,s){if(!Buffer.isBuffer(i))return ___cpstr(i,s);var a=i.readUInt32LE(s);return a>0?i.toString("utf8",s+4,s+4+a-1):""},__lpwstr=function(i,s){if(!Buffer.isBuffer(i))return ___lpwstr(i,s);var a=2*i.readUInt32LE(s);return i.toString("utf16le",s+4,s+4+a-1)},__lpp4=function(i,s){if(!Buffer.isBuffer(i))return ___lpp4(i,s);var a=i.readUInt32LE(s);return i.toString("utf16le",s+4,s+4+a)},__8lpp4=function(i,s){if(!Buffer.isBuffer(i))return ___8lpp4(i,s);var a=i.readUInt32LE(s);return i.toString("utf8",s+4,s+4+a)},__double=function(i,s){return Buffer.isBuffer(i)?i.readDoubleLE(s):___double(i,s)},is_buf=function(i){return Buffer.isBuffer(i)||Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array});var __readUInt8=function(e,i){return e[i]},__readUInt16LE=function(e,i){return e[i+1]*256+e[i]},__readInt16LE=function(e,i){var s=e[i+1]*256+e[i];return s<32768?s:(65535-s+1)*-1},__readUInt32LE=function(e,i){return e[i+3]*(1<<24)+(e[i+2]<<16)+(e[i+1]<<8)+e[i]},__readInt32LE=function(e,i){return e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]},__readInt32BE=function(e,i){return e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]};function ReadShift(e,i){var s="",a,o,c=[],d,h,g,_;switch(i){case"dbcs":if(_=this.l,has_buf&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)s+=String.fromCharCode(__readUInt16LE(this,_)),_+=2;e*=2;break;case"utf8":s=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,s=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":s=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":s=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":s=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),s=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),s=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,s="";(d=__readUInt8(this,this.l+e++))!==0;)c.push(_getchar(d));s=c.join("");break;case"_wstr":for(e=0,s="";(d=__readUInt16LE(this,this.l+e))!==0;)c.push(_getchar(d)),e+=2;e+=2,s=c.join("");break;case"dbcs-cont":for(s="",_=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return d=__readUInt8(this,_),this.l=_+1,h=ReadShift.call(this,e-g,d?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(_getchar(__readUInt16LE(this,_))),_+=2}s=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(s="",_=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(_)!==-1)return d=__readUInt8(this,_),this.l=_+1,h=ReadShift.call(this,e-g,d?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(_getchar(__readUInt8(this,_))),_+=1}s=c.join("");break;default:switch(e){case 1:return a=__readUInt8(this,this.l),this.l++,a;case 2:return a=(i==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,a;case 4:case-4:return i==="i"||!(this[this.l+3]&128)?(a=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,a):(o=__readUInt32LE(this,this.l),this.l+=4,o);case 8:case-8:if(i==="f")return e==8?o=__double(this,this.l):o=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:s=__hexlify(this,this.l,e);break}}return this.l+=e,s}var __writeUInt32LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>>8&255,e[s+2]=i>>>16&255,e[s+3]=i>>>24&255},__writeInt32LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>8&255,e[s+2]=i>>16&255,e[s+3]=i>>24&255},__writeUInt16LE=function(e,i,s){e[s]=i&255,e[s+1]=i>>>8&255};function WriteShift(e,i,s){var a=0,o=0;if(s==="dbcs"){for(o=0;o!=i.length;++o)__writeUInt16LE(this,i.charCodeAt(o),this.l+2*o);a=2*i.length}else if(s==="sbcs"){for(i=i.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=i.length;++o)this[this.l+o]=i.charCodeAt(o)&255;a=i.length}else if(s==="hex"){for(;o<e;++o)this[this.l++]=parseInt(i.slice(2*o,2*o+2),16)||0;return this}else if(s==="utf16le"){var c=Math.min(this.l+e,this.length);for(o=0;o<Math.min(i.length,e);++o){var d=i.charCodeAt(o);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=i&255;break;case 2:a=2,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255;break;case 3:a=3,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255,i>>>=8,this[this.l+2]=i&255;break;case 4:a=4,__writeUInt32LE(this,i,this.l);break;case 8:if(a=8,s==="f"){write_double_le(this,i,this.l);break}case 16:break;case-4:a=4,__writeInt32LE(this,i,this.l);break}return this.l+=a,this}function CheckField(e,i){var s=__hexlify(this,this.l,e.length>>1);if(s!==e)throw new Error(i+"Expected "+e+" saw "+s);this.l+=e.length>>1}function prep_blob(e,i){e.l=i,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,i){e.l+=i}function new_buf(e){var i=new_raw_buf(e);return prep_blob(i,0),i}function buf_array(){var e=[],i=has_buf?256:2048,s=function(_){var b=new_buf(_);return prep_blob(b,0),b},a=s(i),o=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},c=function(_){return a&&_<a.length-a.l?a:(o(),a=s(Math.max(_+1,i)))},d=function(){return o(),bconcat(e)},h=function(_){o(),a=_,a.l==null&&(a.l=a.length),c(i)};return{next:c,push:h,end:d,_bufs:e}}function write_record(e,i,s,a){var o=+i,c;if(!isNaN(o)){a||(a=XLSBRecordEnum[o].p||(s||[]).length||0),c=1+(o>=128?1:0)+1,a>=128&&++c,a>=16384&&++c,a>=2097152&&++c;var d=e.next(c);o<=127?d.write_shift(1,o):(d.write_shift(1,(o&127)+128),d.write_shift(1,o>>7));for(var h=0;h!=4;++h)if(a>=128)d.write_shift(1,(a&127)+128),a>>=7;else{d.write_shift(1,a);break}a>0&&is_buf(s)&&e.push(s)}}function shift_cell_xls(e,i,s){var a=dup(e);if(i.s?(a.cRel&&(a.c+=i.s.c),a.rRel&&(a.r+=i.s.r)):(a.cRel&&(a.c+=i.c),a.rRel&&(a.r+=i.r)),!s||s.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function shift_range_xls(e,i,s){var a=dup(e);return a.s=shift_cell_xls(a.s,i.s,s),a.e=shift_cell_xls(a.e,i.s,s),a}function encode_cell_xls(e,i){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=i>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=i>8?1048576:i>5?65536:16384;var s=encode_cell(e);return!e.cRel&&e.cRel!=null&&(s=fix_col(s)),!e.rRel&&e.rRel!=null&&(s=fix_row(s)),s}function encode_range_xls(e,i){return e.s.r==0&&!e.s.rRel&&e.e.r==(i.biff>=12?1048575:i.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(i.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,i.biff)+":"+encode_cell_xls(e.e,i.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var i=unfix_col(e),s=0,a=0;a!==i.length;++a)s=26*s+i.charCodeAt(a)-64;return s-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var i="";for(++e;e;e=Math.floor((e-1)/26))i=String.fromCharCode((e-1)%26+65)+i;return i}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var i=0,s=0,a=0;a<e.length;++a){var o=e.charCodeAt(a);o>=48&&o<=57?i=10*i+(o-48):o>=65&&o<=90&&(s=26*s+(o-64))}return{c:s-1,r:i-1}}function encode_cell(e){for(var i=e.c+1,s="";i;i=(i-1)/26|0)s=String.fromCharCode((i-1)%26+65)+s;return s+(e.r+1)}function decode_range(e){var i=e.indexOf(":");return i==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,i)),e:decode_cell(e.slice(i+1))}}function encode_range(e,i){return typeof i>"u"||typeof i=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof i!="string"&&(i=encode_cell(i)),e==i?e:e+":"+i)}function safe_decode_range(e){var i={s:{c:0,r:0},e:{c:0,r:0}},s=0,a=0,o=0,c=e.length;for(s=0;a<c&&!((o=e.charCodeAt(a)-64)<1||o>26);++a)s=26*s+o;for(i.s.c=--s,s=0;a<c&&!((o=e.charCodeAt(a)-48)<0||o>9);++a)s=10*s+o;if(i.s.r=--s,a===c||o!=10)return i.e.c=i.s.c,i.e.r=i.s.r,i;for(++a,s=0;a!=c&&!((o=e.charCodeAt(a)-64)<1||o>26);++a)s=26*s+o;for(i.e.c=--s,s=0;a!=c&&!((o=e.charCodeAt(a)-48)<0||o>9);++a)s=10*s+o;return i.e.r=--s,i}function safe_format_cell(e,i){var s=e.t=="d"&&i instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,s?datenum(i):i)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(s?14:0),s?datenum(i):i)}catch{return""+i}}function format_cell(e,i,s){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&s&&s.dateNF&&(e.z=s.dateNF),e.t=="e"?BErr[e.v]||e.v:i==null?safe_format_cell(e,e.v):safe_format_cell(e,i))}function sheet_to_workbook(e,i){var s=i&&i.sheet?i.sheet:"Sheet1",a={};return a[s]=e,{SheetNames:[s],Sheets:a}}function sheet_add_aoa(e,i,s){var a=s||{},o=e?Array.isArray(e):a.dense,c=e||(o?[]:{}),d=0,h=0;if(c&&a.origin!=null){if(typeof a.origin=="number")d=a.origin;else{var g=typeof a.origin=="string"?decode_cell(a.origin):a.origin;d=g.r,h=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var _={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var b=safe_decode_range(c["!ref"]);_.s.c=b.s.c,_.s.r=b.s.r,_.e.c=Math.max(_.e.c,b.e.c),_.e.r=Math.max(_.e.r,b.e.r),d==-1&&(_.e.r=d=b.e.r+1)}for(var tt=0;tt!=i.length;++tt)if(i[tt]){if(!Array.isArray(i[tt]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _e=0;_e!=i[tt].length;++_e)if(!(typeof i[tt][_e]>"u")){var rt={v:i[tt][_e]},it=d+tt,et=h+_e;if(_.s.r>it&&(_.s.r=it),_.s.c>et&&(_.s.c=et),_.e.r<it&&(_.e.r=it),_.e.c<et&&(_.e.c=et),i[tt][_e]&&typeof i[tt][_e]=="object"&&!Array.isArray(i[tt][_e])&&!(i[tt][_e]instanceof Date))rt=i[tt][_e];else if(Array.isArray(rt.v)&&(rt.f=i[tt][_e][1],rt.v=rt.v[0]),rt.v===null)if(rt.f)rt.t="n";else if(a.nullError)rt.t="e",rt.v=0;else if(a.sheetStubs)rt.t="z";else continue;else typeof rt.v=="number"?rt.t="n":typeof rt.v=="boolean"?rt.t="b":rt.v instanceof Date?(rt.z=a.dateNF||table_fmt[14],a.cellDates?(rt.t="d",rt.w=SSF_format(rt.z,datenum(rt.v))):(rt.t="n",rt.v=datenum(rt.v),rt.w=SSF_format(rt.z,rt.v))):rt.t="s";if(o)c[it]||(c[it]=[]),c[it][et]&&c[it][et].z&&(rt.z=c[it][et].z),c[it][et]=rt;else{var nt=encode_cell({c:et,r:it});c[nt]&&c[nt].z&&(rt.z=c[nt].z),c[nt]=rt}}}return _.s.c<1e7&&(c["!ref"]=encode_range(_)),c}function aoa_to_sheet(e,i){return sheet_add_aoa(null,e,i)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,i){return i||(i=new_buf(4)),i.write_shift(4,e),i}function parse_XLWideString(e){var i=e.read_shift(4);return i===0?"":e.read_shift(i,"dbcs")}function write_XLWideString(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(4+2*e.length)),i.write_shift(4,e.length),e.length>0&&i.write_shift(0,e,"dbcs"),s?i.slice(0,i.l):i}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,i){return i||(i=new_buf(4)),i.write_shift(2,0),i.write_shift(2,0),i}function parse_RichStr(e,i){var s=e.l,a=e.read_shift(1),o=parse_XLWideString(e),c=[],d={t:o,h:o};if(a&1){for(var h=e.read_shift(4),g=0;g!=h;++g)c.push(parse_StrRun(e));d.r=c}else d.r=[{ich:0,ifnt:0}];return e.l=s+i,d}function write_RichStr(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(15+4*e.t.length)),i.write_shift(1,0),write_XLWideString(e.t,i),s?i.slice(0,i.l):i}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(23+4*e.t.length)),i.write_shift(1,1),write_XLWideString(e.t,i),i.write_shift(4,1),write_StrRun({ich:0,ifnt:0},i),s?i.slice(0,i.l):i}function parse_XLSBCell(e){var i=e.read_shift(4),s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:i,iStyleRef:s}}function write_XLSBCell(e,i){return i==null&&(i=new_buf(8)),i.write_shift(-4,e.c),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}function parse_XLSBShortCell(e){var i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:i}}function write_XLSBShortCell(e,i){return i==null&&(i=new_buf(4)),i.write_shift(3,e.iStyleRef||e.s),i.write_shift(1,0),i}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var i=e.read_shift(4);return i===0||i===4294967295?"":e.read_shift(i,"dbcs")}function write_XLNullableWideString(e,i){var s=!1;return i==null&&(s=!0,i=new_buf(127)),i.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&i.write_shift(0,e,"dbcs"),s?i.slice(0,i.l):i}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var i=e.slice(e.l,e.l+4),s=i[0]&1,a=i[0]&2;e.l+=4;var o=a===0?__double([0,0,0,0,i[0]&252,i[1],i[2],i[3]],0):__readInt32LE(i,0)>>2;return s?o/100:o}function write_RkNumber(e,i){i==null&&(i=new_buf(4));var s=0,a=0,o=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:o==(o|0)&&o>=-(1<<29)&&o<1<<29&&(a=1,s=1),a)i.write_shift(-4,((s?o:e)<<2)+(s+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var i={s:{},e:{}};return i.s.r=e.read_shift(4),i.e.r=e.read_shift(4),i.s.c=e.read_shift(4),i.e.c=e.read_shift(4),i}function write_RfX(e,i){return i||(i=new_buf(16)),i.write_shift(4,e.s.r),i.write_shift(4,e.e.r),i.write_shift(4,e.s.c),i.write_shift(4,e.e.c),i}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,i){return(i||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var i={},s=e.read_shift(1),a=s>>>1,o=e.read_shift(1),c=e.read_shift(2,"i"),d=e.read_shift(1),h=e.read_shift(1),g=e.read_shift(1);switch(e.l++,a){case 0:i.auto=1;break;case 1:i.index=o;var _=XLSIcv[o];_&&(i.rgb=rgb2Hex(_));break;case 2:i.rgb=rgb2Hex([d,h,g]);break;case 3:i.theme=o;break}return c!=0&&(i.tint=c>0?c/32767:c/32768),i}function write_BrtColor(e,i){if(i||(i=new_buf(8)),!e||e.auto)return i.write_shift(4,0),i.write_shift(4,0),i;e.index!=null?(i.write_shift(1,2),i.write_shift(1,e.index)):e.theme!=null?(i.write_shift(1,6),i.write_shift(1,e.theme)):(i.write_shift(1,5),i.write_shift(1,0));var s=e.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),i.write_shift(2,s),!e.rgb||e.theme!=null)i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),i.write_shift(1,parseInt(a.slice(0,2),16)),i.write_shift(1,parseInt(a.slice(2,4),16)),i.write_shift(1,parseInt(a.slice(4,6),16)),i.write_shift(1,255)}return i}function parse_FontFlags(e){var i=e.read_shift(1);e.l++;var s={fBold:i&1,fItalic:i&2,fUnderline:i&4,fStrikeout:i&8,fOutline:i&16,fShadow:i&32,fCondense:i&64,fExtend:i&128};return s}function write_FontFlags(e,i){i||(i=new_buf(2));var s=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return i.write_shift(1,s),i.write_shift(1,0),i}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}};function rgbify(e){return e.map(function(i){return[i>>16&255,i>>8&255,i&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function write_ct(e,i){var s=evert_arr(ct2type),a=[],o;a[a.length]=XML_HEADER,a[a.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return writextag("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(o=e[g][0],a[a.length]=writextag("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:CT_LIST[g][i.bookType]||CT_LIST[g].xlsx}))},d=function(g){(e[g]||[]).forEach(function(_){a[a.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:CT_LIST[g][i.bookType]||CT_LIST[g].xlsx})})},h=function(g){(e[g]||[]).forEach(function(_){a[a.length]=writextag("Override",null,{PartName:(_[0]=="/"?"":"/")+_,ContentType:s[g][0]})})};return c("workbooks"),d("sheets"),d("charts"),h("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),d("metadata"),h("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var i=e.lastIndexOf("/");return e.slice(0,i+1)+"_rels/"+e.slice(i+1)+".rels"}function write_rels(e){var i=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(s){i[i.length]=writextag("Relationship",null,e["!id"][s])}),i.length>2&&(i[i.length]="</Relationships>",i[1]=i[1].replace("/>",">")),i.join("")}function add_rels(e,i,s,a,o,c){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),i<0)for(i=e["!idx"];e["!id"]["rId"+i];++i);if(e["!idx"]=i+1,o.Id="rId"+i,o.Type=a,o.Target=s,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+i);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,i}function write_manifest(e){var i=[XML_HEADER];i.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),i.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var s=0;s<e.length;++s)i.push('  <manifest:file-entry manifest:full-path="'+e[s][0]+'" manifest:media-type="'+e[s][1]+`"/>
`);return i.push("</manifest:manifest>"),i.join("")}function write_rdf_type(e,i,s){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,i){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var i=[XML_HEADER];i.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var s=0;s!=e.length;++s)i.push(write_rdf_type(e[s][0],e[s][1])),i.push(write_rdf_has("",e[s][0]));return i.push(write_rdf_type("","Document","pkg")),i.push("</rdf:RDF>"),i.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cp_doit(e,i,s,a,o){o[e]!=null||i==null||i===""||(o[e]=i,i=escapexml(i),a[a.length]=s?writextag(e,i,s):writetag(e,i))}function write_core_props(e,i){var s=i||{},a=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],o={};if(!e&&!s.Props)return a.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,o),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},a,o));for(var c=0;c!=CORE_PROPS.length;++c){var d=CORE_PROPS[c],h=s.Props&&s.Props[d[1]]!=null?s.Props[d[1]]:e?e[d[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&cp_doit(d[0],h,null,a,o)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function write_ext_props(e){var i=[],s=writextag;return e||(e={}),e.Application="SheetJS",i[i.length]=XML_HEADER,i[i.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(a){if(e[a[1]]!==void 0){var o;switch(a[2]){case"string":o=escapexml(String(e[a[1]]));break;case"bool":o=e[a[1]]?"true":"false";break}o!==void 0&&(i[i.length]=s(a[0],o))}}),i[i.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),i[i.length]=s("TitlesOfParts",s("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+escapexml(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}function write_cust_props(e){var i=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return i.join("");var s=1;return keys(e).forEach(function(o){++s,i[i.length]=writextag("property",write_vt(e[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:escapexml(o)})}),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xlml_write_docprops(e,i){var s=[];return keys(XLMLDocPropsMap).map(function(a){for(var o=0;o<CORE_PROPS.length;++o)if(CORE_PROPS[o][1]==a)return CORE_PROPS[o];for(o=0;o<EXT_PROPS.length;++o)if(EXT_PROPS[o][1]==a)return EXT_PROPS[o];throw a}).forEach(function(a){if(e[a[1]]!=null){var o=i&&i.Props&&i.Props[a[1]]!=null?i.Props[a[1]]:e[a[1]];switch(a[2]){case"date":o=new Date(o).toISOString().replace(/\.\d*Z/,"Z");break}typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),s.push(writetag(XLMLDocPropsMap[a[1]]||a[1],o))}}),writextag("DocumentProperties",s.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,i){var s=["Worksheets","SheetNames"],a="CustomDocumentProperties",o=[];return e&&keys(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var d=0;d<CORE_PROPS.length;++d)if(c==CORE_PROPS[d][1])return;for(d=0;d<EXT_PROPS.length;++d)if(c==EXT_PROPS[d][1])return;for(d=0;d<s.length;++d)if(c==s[d])return;var h=e[c],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),o.push(writextag(escapexmltag(c),h,{"dt:dt":g}))}}),i&&keys(i).forEach(function(c){if(Object.prototype.hasOwnProperty.call(i,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var d=i[c],h="string";typeof d=="number"?(h="float",d=String(d)):d===!0||d===!1?(h="boolean",d=d?"1":"0"):d instanceof Date?(h="dateTime.tz",d=d.toISOString()):d=String(d),o.push(writextag(escapexmltag(c),d,{"dt:dt":h}))}}),"<"+a+' xmlns="'+XLMLNS.o+'">'+o.join("")+"</"+a+">"}function write_FILETIME(e){var i=typeof e=="string"?new Date(Date.parse(e)):e,s=i.getTime()/1e3+11644473600,a=s%Math.pow(2,32),o=(s-a)/Math.pow(2,32);a*=1e7,o*=1e7;var c=a/Math.pow(2,32)|0;c>0&&(a=a%Math.pow(2,32),o+=c);var d=new_buf(8);return d.write_shift(4,a),d.write_shift(4,o),d}function write_TypedPropertyValue(e,i){var s=new_buf(4),a=new_buf(4);switch(s.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,i);break;case 5:a=new_buf(8),a.write_shift(8,i,"f");break;case 11:a.write_shift(4,i?1:0);break;case 64:a=write_FILETIME(i);break;case 31:case 80:for(a=new_buf(4+2*(i.length+1)+(i.length%2?0:2)),a.write_shift(4,i.length+1),a.write_shift(0,i,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}return bconcat([s,a])}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,i,s){var a=new_buf(8),o=[],c=[],d=8,h=0,g=new_buf(8),_=new_buf(8);if(g.write_shift(4,2),g.write_shift(4,1200),_.write_shift(4,1),c.push(g),o.push(_),d+=8+g.length,!i){_=new_buf(8),_.write_shift(4,0),o.unshift(_);var b=[new_buf(4)];for(b[0].write_shift(4,e.length),h=0;h<e.length;++h){var tt=e[h][0];for(g=new_buf(8+2*(tt.length+1)+(tt.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,tt.length+1),g.write_shift(0,tt,"dbcs");g.l!=g.length;)g.write_shift(1,0);b.push(g)}g=bconcat(b),c.unshift(g),d+=8+g.length}for(h=0;h<e.length;++h)if(!(i&&!i[e[h][0]])&&!(XLSPSSkip.indexOf(e[h][0])>-1||PseudoPropsPairs.indexOf(e[h][0])>-1)&&e[h][1]!=null){var _e=e[h][1],rt=0;if(i){rt=+i[e[h][0]];var it=s[rt];if(it.p=="version"&&typeof _e=="string"){var et=_e.split(".");_e=(+et[0]<<16)+(+et[1]||0)}g=write_TypedPropertyValue(it.t,_e)}else{var nt=guess_property_type(_e);nt==-1&&(nt=31,_e=String(_e)),g=write_TypedPropertyValue(nt,_e)}c.push(g),_=new_buf(8),_.write_shift(4,i?rt:2+h),o.push(_),d+=8+g.length}var at=8*(c.length+1);for(h=0;h<c.length;++h)o[h].write_shift(4,at),at+=c[h].length;return a.write_shift(4,d),a.write_shift(4,c.length),bconcat([a].concat(o).concat(c))}function write_PropertySetStream(e,i,s,a,o,c){var d=new_buf(o?68:48),h=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,o?2:1),d.write_shift(16,i,"hex"),d.write_shift(4,o?68:48);var g=write_PropertySet(e,s,a);if(h.push(g),o){var _=write_PropertySet(o,null,null);d.write_shift(16,c,"hex"),d.write_shift(4,68+g.length),h.push(_)}return bconcat(h)}function writezeroes(e,i){i||(i=new_buf(e));for(var s=0;s<e;++s)i.write_shift(1,0);return i}function parsebool(e,i){return e.read_shift(i)===1}function writebool(e,i){return i||(i=new_buf(2)),i.write_shift(2,+!!e),i}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,i){return i||(i=new_buf(2)),i.write_shift(2,e),i}function write_Bes(e,i,s){return s||(s=new_buf(2)),s.write_shift(1,i=="e"?+e:+!!e),s.write_shift(1,i=="e"?1:0),s}function parse_ShortXLUnicodeString(e,i,s){var a=e.read_shift(s&&s.biff>=12?2:1),o="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var c=e.read_shift(1);c&&(o="dbcs-cont")}else s.biff==12&&(o="wstr");s.biff>=2&&s.biff<=5&&(o="cpstr");var d=a?e.read_shift(a,o):"";return d}function write_XLUnicodeRichExtendedString(e){var i=e.t||"",s=new_buf(3);s.write_shift(2,i.length),s.write_shift(1,1);var a=new_buf(2*i.length);a.write_shift(2*i.length,i,"utf16le");var o=[s,a];return bconcat(o)}function parse_XLUnicodeStringNoCch(e,i,s){var a;if(s){if(s.biff>=2&&s.biff<=5)return e.read_shift(i,"cpstr");if(s.biff>=12)return e.read_shift(i,"dbcs-cont")}var o=e.read_shift(1);return o===0?a=e.read_shift(i,"sbcs-cont"):a=e.read_shift(i,"dbcs-cont"),a}function parse_XLUnicodeString(e,i,s){var a=e.read_shift(s&&s.biff==2?1:2);return a===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,a,s)}function parse_XLUnicodeString2(e,i,s){if(s.biff>5)return parse_XLUnicodeString(e,i,s);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,s.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,i,s){return s||(s=new_buf(3+2*e.length)),s.write_shift(2,e.length),s.write_shift(1,1),s.write_shift(31,e,"utf16le"),s}function write_HyperlinkString(e,i){i||(i=new_buf(6+e.length*2)),i.write_shift(4,1+e.length);for(var s=0;s<e.length;++s)i.write_shift(2,e.charCodeAt(s));return i.write_shift(2,0),i}function write_Hyperlink(e){var i=new_buf(512),s=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var o=a.indexOf("#"),c=o>-1?31:23;switch(a.charAt(0)){case"#":c=28;break;case".":c&=-3;break}i.write_shift(4,2),i.write_shift(4,c);var d=[8,6815827,6619237,4849780,83];for(s=0;s<d.length;++s)i.write_shift(4,d[s]);if(c==28)a=a.slice(1),write_HyperlinkString(a,i);else if(c&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<d.length;++s)i.write_shift(1,parseInt(d[s],16));var h=o>-1?a.slice(0,o):a;for(i.write_shift(4,2*(h.length+1)),s=0;s<h.length;++s)i.write_shift(2,h.charCodeAt(s));i.write_shift(2,0),c&8&&write_HyperlinkString(o>-1?a.slice(o+1):"",i)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<d.length;++s)i.write_shift(1,parseInt(d[s],16));for(var g=0;a.slice(g*3,g*3+3)=="../"||a.slice(g*3,g*3+3)=="..\\";)++g;for(i.write_shift(2,g),i.write_shift(4,a.length-3*g+1),s=0;s<a.length-3*g;++s)i.write_shift(1,a.charCodeAt(s+3*g)&255);for(i.write_shift(1,0),i.write_shift(2,65535),i.write_shift(2,57005),s=0;s<6;++s)i.write_shift(4,0)}return i.slice(0,i.l)}function write_XLSCell(e,i,s,a){return a||(a=new_buf(6)),a.write_shift(2,e),a.write_shift(2,i),a.write_shift(2,s||0),a}function parse_XTI(e,i,s){var a=s.biff>8?4:2,o=e.read_shift(a),c=e.read_shift(a,"i"),d=e.read_shift(a,"i");return[o,c,d]}function parse_Ref8U(e){var i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);return{s:{c:a,r:i},e:{c:o,r:s}}}function write_Ref8U(e,i){return i||(i=new_buf(8)),i.write_shift(2,e.s.r),i.write_shift(2,e.e.r),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c),i}function write_BOF(e,i,s){var a=1536,o=16;switch(s.bookType){case"biff8":break;case"biff5":a=1280,o=8;break;case"biff4":a=4,o=6;break;case"biff3":a=3,o=6;break;case"biff2":a=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=new_buf(o);return c.write_shift(2,a),c.write_shift(2,i),o>4&&c.write_shift(2,29282),o>6&&c.write_shift(2,1997),o>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function write_WriteAccess(e,i){var s=!i||i.biff==8,a=new_buf(s?112:54);for(a.write_shift(i.biff==8?2:1,7),s&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(s?0:536870912));a.l<a.length;)a.write_shift(1,s?0:32);return a}function write_BoundSheet8(e,i){var s=!i||i.biff>=8?2:1,a=new_buf(8+s*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),i.biff>=8&&a.write_shift(1,1),a.write_shift(s*e.name.length,e.name,i.biff<8?"sbcs":"utf16le");var o=a.slice(0,a.l);return o.l=a.l,o}function write_SST(e,i){var s=new_buf(8);s.write_shift(4,e.Count),s.write_shift(4,e.Unique);for(var a=[],o=0;o<e.length;++o)a[o]=write_XLUnicodeRichExtendedString(e[o]);var c=bconcat([s].concat(a));return c.parts=[s.length].concat(a.map(function(d){return d.length})),c}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function write_Window2(e){var i=new_buf(18),s=1718;return e&&e.RTL&&(s|=64),i.write_shift(2,s),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i}function write_Font(e,i){var s=e.name||"Arial",a=i&&i.biff==5,o=a?15+s.length:16+2*s.length,c=new_buf(o);return c.write_shift(2,(e.sz||12)*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,s.length),a||c.write_shift(1,1),c.write_shift((a?1:2)*s.length,s,a?"sbcs":"utf16le"),c}function write_LabelSst(e,i,s,a){var o=new_buf(10);return write_XLSCell(e,i,a,o),o.write_shift(4,s),o}function write_Label(e,i,s,a,o){var c=!o||o.biff==8,d=new_buf(8+ +c+(1+c)*s.length);return write_XLSCell(e,i,a,d),d.write_shift(2,s.length),c&&d.write_shift(1,1),d.write_shift((1+c)*s.length,s,c?"utf16le":"sbcs"),d}function write_Format(e,i,s,a){var o=s&&s.biff==5;a||(a=new_buf(o?3+i.length:5+2*i.length)),a.write_shift(2,e),a.write_shift(o?1:2,i.length),o||a.write_shift(1,1),a.write_shift((o?1:2)*i.length,i,o?"sbcs":"utf16le");var c=a.length>a.l?a.slice(0,a.l):a;return c.l==null&&(c.l=c.length),c}function write_Dimensions(e,i){var s=i.biff==8||!i.biff?4:2,a=new_buf(2*s+6);return a.write_shift(s,e.s.r),a.write_shift(s,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function write_XF(e,i,s,a){var o=s&&s.biff==5;a||(a=new_buf(o?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,i<<4));var c=0;return e.numFmtId>0&&o&&(c|=1024),a.write_shift(4,c),a.write_shift(4,0),o||a.write_shift(4,0),a.write_shift(2,0),a}function write_Guts(e){var i=new_buf(8);return i.write_shift(4,0),i.write_shift(2,0),i.write_shift(2,0),i}function write_BoolErr(e,i,s,a,o,c){var d=new_buf(8);return write_XLSCell(e,i,a,d),write_Bes(s,c,d),d}function write_Number(e,i,s,a){var o=new_buf(14);return write_XLSCell(e,i,a,o),write_Xnum(s,o),o}function parse_ExternSheet(e,i,s){if(s.biff<8)return parse_BIFF5ExternSheet(e,i,s);for(var a=[],o=e.l+i,c=e.read_shift(s.biff>8?4:2);c--!==0;)a.push(parse_XTI(e,s.biff>8?12:6,s));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return a}function parse_BIFF5ExternSheet(e,i,s){e[e.l+1]==3&&e[e.l]++;var a=parse_ShortXLUnicodeString(e,i,s);return a.charCodeAt(0)==3?a.slice(1):a}function write_MergeCells(e){var i=new_buf(2+e.length*8);i.write_shift(2,e.length);for(var s=0;s<e.length;++s)write_Ref8U(e[s],i);return i}function write_HLink(e){var i=new_buf(24),s=decode_cell(e[0]);i.write_shift(2,s.r),i.write_shift(2,s.r),i.write_shift(2,s.c),i.write_shift(2,s.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)i.write_shift(1,parseInt(a[o],16));return bconcat([i,write_Hyperlink(e[1])])}function write_HLinkTooltip(e){var i=e[1].Tooltip,s=new_buf(10+2*(i.length+1));s.write_shift(2,2048);var a=decode_cell(e[0]);s.write_shift(2,a.r),s.write_shift(2,a.r),s.write_shift(2,a.c),s.write_shift(2,a.c);for(var o=0;o<i.length;++o)s.write_shift(2,i.charCodeAt(o));return s.write_shift(2,0),s}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ColInfo(e,i,s){if(!s.cellStyles)return parsenoop(e,i);var a=s&&s.biff>=12?4:2,o=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(a),h=e.read_shift(a),g=e.read_shift(2);a==2&&(e.l+=2);var _={s:o,e:c,w:d,ixfe:h,flags:g};return(s.biff>=5||!s.biff)&&(_.level=g>>8&7),_}function write_ColInfo(e,i){var s=new_buf(12);s.write_shift(2,i),s.write_shift(2,i),s.write_shift(2,e.width*256),s.write_shift(2,0);var a=0;return e.hidden&&(a|=1),s.write_shift(1,a),a=e.level||0,s.write_shift(1,a),s.write_shift(2,0),s}function write_RRTabId(e){for(var i=new_buf(2*e),s=0;s<e;++s)i.write_shift(2,s+1);return i}function write_BIFF2NUM(e,i,s){var a=new_buf(15);return write_BIFF2Cell(a,e,i),a.write_shift(8,s,"f"),a}function write_BIFF2INT(e,i,s){var a=new_buf(9);return write_BIFF2Cell(a,e,i),a.write_shift(2,s),a}var DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},i=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(h,g){var _=[],b=new_raw_buf(1);switch(g.type){case"base64":b=s2a(Base64_decode(h));break;case"binary":b=s2a(h);break;case"buffer":case"array":b=h;break}prep_blob(b,0);var tt=b.read_shift(1),_e=!!(tt&136),rt=!1,it=!1;switch(tt){case 2:break;case 3:break;case 48:rt=!0,_e=!0;break;case 49:rt=!0,_e=!0;break;case 131:break;case 139:break;case 140:it=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+tt.toString(16))}var et=0,nt=521;tt==2&&(et=b.read_shift(2)),b.l+=3,tt!=2&&(et=b.read_shift(4)),et>1048576&&(et=1e6),tt!=2&&(nt=b.read_shift(2));var at=b.read_shift(2),st=g.codepage||1252;tt!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(st=e[b[b.l]]),b.l+=1,b.l+=2),it&&(b.l+=36);for(var ot=[],pt={},dt=Math.min(b.length,tt==2?521:nt-10-(rt?264:0)),wt=it?32:11;b.l<dt&&b[b.l]!=13;)switch(pt={},pt.name=$cptable.utils.decode(st,b.slice(b.l,b.l+wt)).replace(/[\u0000\r\n].*$/g,""),b.l+=wt,pt.type=String.fromCharCode(b.read_shift(1)),tt!=2&&!it&&(pt.offset=b.read_shift(4)),pt.len=b.read_shift(1),tt==2&&(pt.offset=b.read_shift(2)),pt.dec=b.read_shift(1),pt.name.length&&ot.push(pt),tt!=2&&(b.l+=it?13:14),pt.type){case"B":(!rt||pt.len!=8)&&g.WTF&&console.log("Skipping "+pt.name+":"+pt.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+pt.name+":"+pt.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+pt.type)}if(b[b.l]!==13&&(b.l=nt-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=nt;var lt=0,gt=0;for(_[0]=[],gt=0;gt!=ot.length;++gt)_[0][gt]=ot[gt].name;for(;et-- >0;){if(b[b.l]===42){b.l+=at;continue}for(++b.l,_[++lt]=[],gt=0,gt=0;gt!=ot.length;++gt){var vt=b.slice(b.l,b.l+ot[gt].len);b.l+=ot[gt].len,prep_blob(vt,0);var At=$cptable.utils.decode(st,vt);switch(ot[gt].type){case"C":At.trim().length&&(_[lt][gt]=At.replace(/\s+$/,""));break;case"D":At.length===8?_[lt][gt]=new Date(+At.slice(0,4),+At.slice(4,6)-1,+At.slice(6,8)):_[lt][gt]=At;break;case"F":_[lt][gt]=parseFloat(At.trim());break;case"+":case"I":_[lt][gt]=it?vt.read_shift(-4,"i")^2147483648:vt.read_shift(4,"i");break;case"L":switch(At.trim().toUpperCase()){case"Y":case"T":_[lt][gt]=!0;break;case"N":case"F":_[lt][gt]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+At+"|")}break;case"M":if(!_e)throw new Error("DBF Unexpected MEMO for type "+tt.toString(16));_[lt][gt]="##MEMO##"+(it?parseInt(At.trim(),10):vt.read_shift(4));break;case"N":At=At.replace(/\u0000/g,"").trim(),At&&At!="."&&(_[lt][gt]=+At||0);break;case"@":_[lt][gt]=new Date(vt.read_shift(-8,"f")-621356832e5);break;case"T":_[lt][gt]=new Date((vt.read_shift(4)-2440588)*864e5+vt.read_shift(4));break;case"Y":_[lt][gt]=vt.read_shift(4,"i")/1e4+vt.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":_[lt][gt]=-vt.read_shift(-8,"f");break;case"B":if(rt&&ot[gt].len==8){_[lt][gt]=vt.read_shift(8,"f");break}case"G":case"P":vt.l+=ot[gt].len;break;case"0":if(ot[gt].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+ot[gt].type)}}}if(tt!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),g.DBF=ot,_}function a(h,g){var _=g||{};_.dateNF||(_.dateNF="yyyymmdd");var b=aoa_to_sheet(s(h,_),_);return b["!cols"]=_.DBF.map(function(tt){return{wch:tt.len,DBF:tt}}),delete _.DBF,b}function o(h,g){try{return sheet_to_workbook(a(h,g),g)}catch(_){if(g&&g.WTF)throw _}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function d(h,g){var _=g||{};if(+_.codepage>=0&&set_cp(+_.codepage),_.type=="string")throw new Error("Cannot write DBF to JS string");var b=buf_array(),tt=sheet_to_json(h,{header:1,raw:!0,cellDates:!0}),_e=tt[0],rt=tt.slice(1),it=h["!cols"]||[],et=0,nt=0,at=0,st=1;for(et=0;et<_e.length;++et){if(((it[et]||{}).DBF||{}).name){_e[et]=it[et].DBF.name,++at;continue}if(_e[et]!=null){if(++at,typeof _e[et]=="number"&&(_e[et]=_e[et].toString(10)),typeof _e[et]!="string")throw new Error("DBF Invalid column name "+_e[et]+" |"+typeof _e[et]+"|");if(_e.indexOf(_e[et])!==et){for(nt=0;nt<1024;++nt)if(_e.indexOf(_e[et]+"_"+nt)==-1){_e[et]+="_"+nt;break}}}}var ot=safe_decode_range(h["!ref"]),pt=[],dt=[],wt=[];for(et=0;et<=ot.e.c-ot.s.c;++et){var lt="",gt="",vt=0,At=[];for(nt=0;nt<rt.length;++nt)rt[nt][et]!=null&&At.push(rt[nt][et]);if(At.length==0||_e[et]==null){pt[et]="?";continue}for(nt=0;nt<At.length;++nt){switch(typeof At[nt]){case"number":gt="B";break;case"string":gt="C";break;case"boolean":gt="L";break;case"object":gt=At[nt]instanceof Date?"D":"C";break;default:gt="C"}vt=Math.max(vt,String(At[nt]).length),lt=lt&&lt!=gt?"C":gt}vt>250&&(vt=250),gt=((it[et]||{}).DBF||{}).type,gt=="C"&&it[et].DBF.len>vt&&(vt=it[et].DBF.len),lt=="B"&&gt=="N"&&(lt="N",wt[et]=it[et].DBF.dec,vt=it[et].DBF.len),dt[et]=lt=="C"||gt=="N"?vt:c[lt]||0,st+=dt[et],pt[et]=lt}var yt=b.next(32);for(yt.write_shift(4,318902576),yt.write_shift(4,rt.length),yt.write_shift(2,296+32*at),yt.write_shift(2,st),et=0;et<4;++et)yt.write_shift(4,0);for(yt.write_shift(4,0|(+i[current_ansi]||3)<<8),et=0,nt=0;et<_e.length;++et)if(_e[et]!=null){var bt=b.next(32),Tt=(_e[et].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);bt.write_shift(1,Tt,"sbcs"),bt.write_shift(1,pt[et]=="?"?"C":pt[et],"sbcs"),bt.write_shift(4,nt),bt.write_shift(1,dt[et]||c[pt[et]]||0),bt.write_shift(1,wt[et]||0),bt.write_shift(1,2),bt.write_shift(4,0),bt.write_shift(1,0),bt.write_shift(4,0),bt.write_shift(4,0),nt+=dt[et]||c[pt[et]]||0}var er=b.next(264);for(er.write_shift(4,13),et=0;et<65;++et)er.write_shift(4,0);for(et=0;et<rt.length;++et){var zt=b.next(st);for(zt.write_shift(1,0),nt=0;nt<_e.length;++nt)if(_e[nt]!=null)switch(pt[nt]){case"L":zt.write_shift(1,rt[et][nt]==null?63:rt[et][nt]?84:70);break;case"B":zt.write_shift(8,rt[et][nt]||0,"f");break;case"N":var ar="0";for(typeof rt[et][nt]=="number"&&(ar=rt[et][nt].toFixed(wt[nt]||0)),at=0;at<dt[nt]-ar.length;++at)zt.write_shift(1,32);zt.write_shift(1,ar,"sbcs");break;case"D":rt[et][nt]?(zt.write_shift(4,("0000"+rt[et][nt].getFullYear()).slice(-4),"sbcs"),zt.write_shift(2,("00"+(rt[et][nt].getMonth()+1)).slice(-2),"sbcs"),zt.write_shift(2,("00"+rt[et][nt].getDate()).slice(-2),"sbcs")):zt.write_shift(8,"00000000","sbcs");break;case"C":var Jt=String(rt[et][nt]!=null?rt[et][nt]:"").slice(0,dt[nt]);for(zt.write_shift(1,Jt,"sbcs"),at=0;at<dt[nt]-Jt.length;++at)zt.write_shift(1,32);break}}return b.next(1).write_shift(1,26),b.end()}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},i=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(_e,rt){var it=e[rt];return typeof it=="number"?_getansi(it):it},a=function(_e,rt,it){var et=rt.charCodeAt(0)-32<<4|it.charCodeAt(0)-48;return et==59?_e:_getansi(et)};e["|"]=254;function o(_e,rt){switch(rt.type){case"base64":return c(Base64_decode(_e),rt);case"binary":return c(_e,rt);case"buffer":return c(has_buf&&Buffer.isBuffer(_e)?_e.toString("binary"):a2s(_e),rt);case"array":return c(cc2str(_e),rt)}throw new Error("Unrecognized type "+rt.type)}function c(_e,rt){var it=_e.split(/[\n\r]+/),et=-1,nt=-1,at=0,st=0,ot=[],pt=[],dt=null,wt={},lt=[],gt=[],vt=[],At=0,yt;for(+rt.codepage>=0&&set_cp(+rt.codepage);at!==it.length;++at){At=0;var bt=it[at].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(i,s),Tt=bt.replace(/;;/g,"\0").split(";").map(function(St){return St.replace(/\u0000/g,";")}),er=Tt[0],zt;if(bt.length>0)switch(er){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Tt[1].charAt(0)=="P"&&pt.push(bt.slice(3).replace(/;;/g,";"));break;case"C":var ar=!1,Jt=!1,Yt=!1,kt=!1,ir=-1,fr=-1;for(st=1;st<Tt.length;++st)switch(Tt[st].charAt(0)){case"A":break;case"X":nt=parseInt(Tt[st].slice(1))-1,Jt=!0;break;case"Y":for(et=parseInt(Tt[st].slice(1))-1,Jt||(nt=0),yt=ot.length;yt<=et;++yt)ot[yt]=[];break;case"K":zt=Tt[st].slice(1),zt.charAt(0)==='"'?zt=zt.slice(1,zt.length-1):zt==="TRUE"?zt=!0:zt==="FALSE"?zt=!1:isNaN(fuzzynum(zt))?isNaN(fuzzydate(zt).getDate())||(zt=parseDate(zt)):(zt=fuzzynum(zt),dt!==null&&fmt_is_date(dt)&&(zt=numdate(zt))),ar=!0;break;case"E":kt=!0;var Et=rc_to_a1(Tt[st].slice(1),{r:et,c:nt});ot[et][nt]=[ot[et][nt],Et];break;case"S":Yt=!0,ot[et][nt]=[ot[et][nt],"S5S"];break;case"G":break;case"R":ir=parseInt(Tt[st].slice(1))-1;break;case"C":fr=parseInt(Tt[st].slice(1))-1;break;default:if(rt&&rt.WTF)throw new Error("SYLK bad record "+bt)}if(ar&&(ot[et][nt]&&ot[et][nt].length==2?ot[et][nt][0]=zt:ot[et][nt]=zt,dt=null),Yt){if(kt)throw new Error("SYLK shared formula cannot have own formula");var xt=ir>-1&&ot[ir][fr];if(!xt||!xt[1])throw new Error("SYLK shared formula cannot find base");ot[et][nt][1]=shift_formula_str(xt[1],{r:et-ir,c:nt-fr})}break;case"F":var mt=0;for(st=1;st<Tt.length;++st)switch(Tt[st].charAt(0)){case"X":nt=parseInt(Tt[st].slice(1))-1,++mt;break;case"Y":for(et=parseInt(Tt[st].slice(1))-1,yt=ot.length;yt<=et;++yt)ot[yt]=[];break;case"M":At=parseInt(Tt[st].slice(1))/20;break;case"F":break;case"G":break;case"P":dt=pt[parseInt(Tt[st].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(vt=Tt[st].slice(1).split(" "),yt=parseInt(vt[0],10);yt<=parseInt(vt[1],10);++yt)At=parseInt(vt[2],10),gt[yt-1]=At===0?{hidden:!0}:{wch:At},process_col(gt[yt-1]);break;case"C":nt=parseInt(Tt[st].slice(1))-1,gt[nt]||(gt[nt]={});break;case"R":et=parseInt(Tt[st].slice(1))-1,lt[et]||(lt[et]={}),At>0?(lt[et].hpt=At,lt[et].hpx=pt2px(At)):At===0&&(lt[et].hidden=!0);break;default:if(rt&&rt.WTF)throw new Error("SYLK bad record "+bt)}mt<1&&(dt=null);break;default:if(rt&&rt.WTF)throw new Error("SYLK bad record "+bt)}}return lt.length>0&&(wt["!rows"]=lt),gt.length>0&&(wt["!cols"]=gt),rt&&rt.sheetRows&&(ot=ot.slice(0,rt.sheetRows)),[ot,wt]}function d(_e,rt){var it=o(_e,rt),et=it[0],nt=it[1],at=aoa_to_sheet(et,rt);return keys(nt).forEach(function(st){at[st]=nt[st]}),at}function h(_e,rt){return sheet_to_workbook(d(_e,rt),rt)}function g(_e,rt,it,et){var nt="C;Y"+(it+1)+";X"+(et+1)+";K";switch(_e.t){case"n":nt+=_e.v||0,_e.f&&!_e.F&&(nt+=";E"+a1_to_rc(_e.f,{r:it,c:et}));break;case"b":nt+=_e.v?"TRUE":"FALSE";break;case"e":nt+=_e.w||_e.v;break;case"d":nt+='"'+(_e.w||_e.v)+'"';break;case"s":nt+='"'+_e.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return nt}function _(_e,rt){rt.forEach(function(it,et){var nt="F;W"+(et+1)+" "+(et+1)+" ";it.hidden?nt+="0":(typeof it.width=="number"&&!it.wpx&&(it.wpx=width2px(it.width)),typeof it.wpx=="number"&&!it.wch&&(it.wch=px2char(it.wpx)),typeof it.wch=="number"&&(nt+=Math.round(it.wch))),nt.charAt(nt.length-1)!=" "&&_e.push(nt)})}function b(_e,rt){rt.forEach(function(it,et){var nt="F;";it.hidden?nt+="M0;":it.hpt?nt+="M"+20*it.hpt+";":it.hpx&&(nt+="M"+20*px2pt(it.hpx)+";"),nt.length>2&&_e.push(nt+"R"+(et+1))})}function tt(_e,rt){var it=["ID;PWXL;N;E"],et=[],nt=safe_decode_range(_e["!ref"]),at,st=Array.isArray(_e),ot=`\r
`;it.push("P;PGeneral"),it.push("F;P0;DG0G8;M255"),_e["!cols"]&&_(it,_e["!cols"]),_e["!rows"]&&b(it,_e["!rows"]),it.push("B;Y"+(nt.e.r-nt.s.r+1)+";X"+(nt.e.c-nt.s.c+1)+";D"+[nt.s.c,nt.s.r,nt.e.c,nt.e.r].join(" "));for(var pt=nt.s.r;pt<=nt.e.r;++pt)for(var dt=nt.s.c;dt<=nt.e.c;++dt){var wt=encode_cell({r:pt,c:dt});at=st?(_e[pt]||[])[dt]:_e[wt],!(!at||at.v==null&&(!at.f||at.F))&&et.push(g(at,_e,pt,dt))}return it.join(ot)+ot+et.join(ot)+ot+"E"+ot}return{to_workbook:h,to_sheet:d,from_sheet:tt}}(),DIF=function(){function e(c,d){switch(d.type){case"base64":return i(Base64_decode(c),d);case"binary":return i(c,d);case"buffer":return i(has_buf&&Buffer.isBuffer(c)?c.toString("binary"):a2s(c),d);case"array":return i(cc2str(c),d)}throw new Error("Unrecognized type "+d.type)}function i(c,d){for(var h=c.split(`
`),g=-1,_=-1,b=0,tt=[];b!==h.length;++b){if(h[b].trim()==="BOT"){tt[++g]=[],_=0;continue}if(!(g<0)){var _e=h[b].trim().split(","),rt=_e[0],it=_e[1];++b;for(var et=h[b]||"";(et.match(/["]/g)||[]).length&1&&b<h.length-1;)et+=`
`+h[++b];switch(et=et.trim(),+rt){case-1:if(et==="BOT"){tt[++g]=[],_=0;continue}else if(et!=="EOD")throw new Error("Unrecognized DIF special command "+et);break;case 0:et==="TRUE"?tt[g][_]=!0:et==="FALSE"?tt[g][_]=!1:isNaN(fuzzynum(it))?isNaN(fuzzydate(it).getDate())?tt[g][_]=it:tt[g][_]=parseDate(it):tt[g][_]=fuzzynum(it),++_;break;case 1:et=et.slice(1,et.length-1),et=et.replace(/""/g,'"'),et&&et.match(/^=".*"$/)&&(et=et.slice(2,-1)),tt[g][_++]=et!==""?et:null;break}if(et==="EOD")break}}return d&&d.sheetRows&&(tt=tt.slice(0,d.sheetRows)),tt}function s(c,d){return aoa_to_sheet(e(c,d),d)}function a(c,d){return sheet_to_workbook(s(c,d),d)}var o=function(){var c=function(g,_,b,tt,_e){g.push(_),g.push(b+","+tt),g.push('"'+_e.replace(/"/g,'""')+'"')},d=function(g,_,b,tt){g.push(_+","+b),g.push(_==1?'"'+tt.replace(/"/g,'""')+'"':tt)};return function(g){var _=[],b=safe_decode_range(g["!ref"]),tt,_e=Array.isArray(g);c(_,"TABLE",0,1,"sheetjs"),c(_,"VECTORS",0,b.e.r-b.s.r+1,""),c(_,"TUPLES",0,b.e.c-b.s.c+1,""),c(_,"DATA",0,0,"");for(var rt=b.s.r;rt<=b.e.r;++rt){d(_,-1,0,"BOT");for(var it=b.s.c;it<=b.e.c;++it){var et=encode_cell({r:rt,c:it});if(tt=_e?(g[rt]||[])[it]:g[et],!tt){d(_,1,0,"");continue}switch(tt.t){case"n":var nt=tt.w;!nt&&tt.v!=null&&(nt=tt.v),nt==null?tt.f&&!tt.F?d(_,1,0,"="+tt.f):d(_,1,0,""):d(_,0,nt,"V");break;case"b":d(_,0,tt.v?1:0,tt.v?"TRUE":"FALSE");break;case"s":d(_,1,0,isNaN(tt.v)?tt.v:'="'+tt.v+'"');break;case"d":tt.w||(tt.w=SSF_format(tt.z||table_fmt[14],datenum(parseDate(tt.v)))),d(_,0,tt.w,"V");break;default:d(_,1,0,"")}}}d(_,-1,0,"EOD");var at=`\r
`,st=_.join(at);return st}}();return{to_workbook:a,to_sheet:s,from_sheet:o}}(),ETH=function(){function e(tt){return tt.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function i(tt){return tt.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(tt,_e){for(var rt=tt.split(`
`),it=-1,et=-1,nt=0,at=[];nt!==rt.length;++nt){var st=rt[nt].trim().split(":");if(st[0]==="cell"){var ot=decode_cell(st[1]);if(at.length<=ot.r)for(it=at.length;it<=ot.r;++it)at[it]||(at[it]=[]);switch(it=ot.r,et=ot.c,st[2]){case"t":at[it][et]=e(st[3]);break;case"v":at[it][et]=+st[3];break;case"vtf":var pt=st[st.length-1];case"vtc":switch(st[3]){case"nl":at[it][et]=!!+st[4];break;default:at[it][et]=+st[4];break}st[2]=="vtf"&&(at[it][et]=[at[it][et],pt])}}}return _e&&_e.sheetRows&&(at=at.slice(0,_e.sheetRows)),at}function a(tt,_e){return aoa_to_sheet(s(tt,_e),_e)}function o(tt,_e){return sheet_to_workbook(a(tt,_e),_e)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function _(tt){if(!tt||!tt["!ref"])return"";for(var _e=[],rt=[],it,et="",nt=decode_range(tt["!ref"]),at=Array.isArray(tt),st=nt.s.r;st<=nt.e.r;++st)for(var ot=nt.s.c;ot<=nt.e.c;++ot)if(et=encode_cell({r:st,c:ot}),it=at?(tt[st]||[])[ot]:tt[et],!(!it||it.v==null||it.t==="z")){switch(rt=["cell",et,"t"],it.t){case"s":case"str":rt.push(i(it.v));break;case"n":it.f?(rt[2]="vtf",rt[3]="n",rt[4]=it.v,rt[5]=i(it.f)):(rt[2]="v",rt[3]=it.v);break;case"b":rt[2]="vt"+(it.f?"f":"c"),rt[3]="nl",rt[4]=it.v?"1":"0",rt[5]=i(it.f||(it.v?"TRUE":"FALSE"));break;case"d":var pt=datenum(parseDate(it.v));rt[2]="vtc",rt[3]="nd",rt[4]=""+pt,rt[5]=it.w||SSF_format(it.z||table_fmt[14],pt);break;case"e":continue}_e.push(rt.join(":"))}return _e.push("sheet:c:"+(nt.e.c-nt.s.c+1)+":r:"+(nt.e.r-nt.s.r+1)+":tvf:1"),_e.push("valueformat:1:text-wiki"),_e.join(`
`)}function b(tt){return[c,d,h,d,_(tt),g].join(`
`)}return{to_workbook:o,to_sheet:a,from_sheet:b}}(),PRN=function(){function e(b,tt,_e,rt,it){it.raw?tt[_e][rt]=b:b===""||(b==="TRUE"?tt[_e][rt]=!0:b==="FALSE"?tt[_e][rt]=!1:isNaN(fuzzynum(b))?isNaN(fuzzydate(b).getDate())?tt[_e][rt]=b:tt[_e][rt]=parseDate(b):tt[_e][rt]=fuzzynum(b))}function i(b,tt){var _e=tt||{},rt=[];if(!b||b.length===0)return rt;for(var it=b.split(/[\r\n]/),et=it.length-1;et>=0&&it[et].length===0;)--et;for(var nt=10,at=0,st=0;st<=et;++st)at=it[st].indexOf(" "),at==-1?at=it[st].length:at++,nt=Math.max(nt,at);for(st=0;st<=et;++st){rt[st]=[];var ot=0;for(e(it[st].slice(0,nt).trim(),rt,st,ot,_e),ot=1;ot<=(it[st].length-nt)/10+1;++ot)e(it[st].slice(nt+(ot-1)*10,nt+ot*10).trim(),rt,st,ot,_e)}return _e.sheetRows&&(rt=rt.slice(0,_e.sheetRows)),rt}var s={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function o(b){for(var tt={},_e=!1,rt=0,it=0;rt<b.length;++rt)(it=b.charCodeAt(rt))==34?_e=!_e:!_e&&it in s&&(tt[it]=(tt[it]||0)+1);it=[];for(rt in tt)Object.prototype.hasOwnProperty.call(tt,rt)&&it.push([tt[rt],rt]);if(!it.length){tt=a;for(rt in tt)Object.prototype.hasOwnProperty.call(tt,rt)&&it.push([tt[rt],rt])}return it.sort(function(et,nt){return et[0]-nt[0]||a[et[1]]-a[nt[1]]}),s[it.pop()[1]]||44}function c(b,tt){var _e=tt||{},rt="",it=_e.dense?[]:{},et={s:{c:0,r:0},e:{c:0,r:0}};b.slice(0,4)=="sep="?b.charCodeAt(5)==13&&b.charCodeAt(6)==10?(rt=b.charAt(4),b=b.slice(7)):b.charCodeAt(5)==13||b.charCodeAt(5)==10?(rt=b.charAt(4),b=b.slice(6)):rt=o(b.slice(0,1024)):_e&&_e.FS?rt=_e.FS:rt=o(b.slice(0,1024));var nt=0,at=0,st=0,ot=0,pt=0,dt=rt.charCodeAt(0),wt=!1,lt=0,gt=b.charCodeAt(0);b=b.replace(/\r\n/mg,`
`);var vt=_e.dateNF!=null?dateNF_regex(_e.dateNF):null;function At(){var yt=b.slice(ot,pt),bt={};if(yt.charAt(0)=='"'&&yt.charAt(yt.length-1)=='"'&&(yt=yt.slice(1,-1).replace(/""/g,'"')),yt.length===0)bt.t="z";else if(_e.raw)bt.t="s",bt.v=yt;else if(yt.trim().length===0)bt.t="s",bt.v=yt;else if(yt.charCodeAt(0)==61)yt.charCodeAt(1)==34&&yt.charCodeAt(yt.length-1)==34?(bt.t="s",bt.v=yt.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(yt)?(bt.t="n",bt.f=yt.slice(1)):(bt.t="s",bt.v=yt);else if(yt=="TRUE")bt.t="b",bt.v=!0;else if(yt=="FALSE")bt.t="b",bt.v=!1;else if(!isNaN(st=fuzzynum(yt)))bt.t="n",_e.cellText!==!1&&(bt.w=yt),bt.v=st;else if(!isNaN(fuzzydate(yt).getDate())||vt&&yt.match(vt)){bt.z=_e.dateNF||table_fmt[14];var Tt=0;vt&&yt.match(vt)&&(yt=dateNF_fix(yt,_e.dateNF,yt.match(vt)||[]),Tt=1),_e.cellDates?(bt.t="d",bt.v=parseDate(yt,Tt)):(bt.t="n",bt.v=datenum(parseDate(yt,Tt))),_e.cellText!==!1&&(bt.w=SSF_format(bt.z,bt.v instanceof Date?datenum(bt.v):bt.v)),_e.cellNF||delete bt.z}else bt.t="s",bt.v=yt;if(bt.t=="z"||(_e.dense?(it[nt]||(it[nt]=[]),it[nt][at]=bt):it[encode_cell({c:at,r:nt})]=bt),ot=pt+1,gt=b.charCodeAt(ot),et.e.c<at&&(et.e.c=at),et.e.r<nt&&(et.e.r=nt),lt==dt)++at;else if(at=0,++nt,_e.sheetRows&&_e.sheetRows<=nt)return!0}e:for(;pt<b.length;++pt)switch(lt=b.charCodeAt(pt)){case 34:gt===34&&(wt=!wt);break;case dt:case 10:case 13:if(!wt&&At())break e;break}return pt-ot>0&&At(),it["!ref"]=encode_range(et),it}function d(b,tt){return!(tt&&tt.PRN)||tt.FS||b.slice(0,4)=="sep="||b.indexOf("	")>=0||b.indexOf(",")>=0||b.indexOf(";")>=0?c(b,tt):aoa_to_sheet(i(b,tt),tt)}function h(b,tt){var _e="",rt=tt.type=="string"?[0,0,0,0]:firstbyte(b,tt);switch(tt.type){case"base64":_e=Base64_decode(b);break;case"binary":_e=b;break;case"buffer":tt.codepage==65001?_e=b.toString("utf8"):tt.codepage&&typeof $cptable<"u"?_e=$cptable.utils.decode(tt.codepage,b):_e=has_buf&&Buffer.isBuffer(b)?b.toString("binary"):a2s(b);break;case"array":_e=cc2str(b);break;case"string":_e=b;break;default:throw new Error("Unrecognized type "+tt.type)}return rt[0]==239&&rt[1]==187&&rt[2]==191?_e=utf8read(_e.slice(3)):tt.type!="string"&&tt.type!="buffer"&&tt.codepage==65001?_e=utf8read(_e):tt.type=="binary"&&typeof $cptable<"u"&&tt.codepage&&(_e=$cptable.utils.decode(tt.codepage,$cptable.utils.encode(28591,_e))),_e.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(tt.type=="string"?_e:utf8read(_e),tt):d(_e,tt)}function g(b,tt){return sheet_to_workbook(h(b,tt),tt)}function _(b){for(var tt=[],_e=safe_decode_range(b["!ref"]),rt,it=Array.isArray(b),et=_e.s.r;et<=_e.e.r;++et){for(var nt=[],at=_e.s.c;at<=_e.e.c;++at){var st=encode_cell({r:et,c:at});if(rt=it?(b[et]||[])[at]:b[st],!rt||rt.v==null){nt.push("          ");continue}for(var ot=(rt.w||(format_cell(rt),rt.w)||"").slice(0,10);ot.length<10;)ot+=" ";nt.push(ot+(at===0?" ":""))}tt.push(nt.join(""))}return tt.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:_}}(),WK_=function(){function e(Et,xt,mt){if(Et){prep_blob(Et,Et.l||0);for(var St=mt.Enum||ir;Et.l<Et.length;){var Pt=Et.read_shift(2),Nt=St[Pt]||St[65535],Lt=Et.read_shift(2),lr=Et.l+Lt,ur=Nt.f&&Nt.f(Et,Lt,mt);if(Et.l=lr,xt(ur,Nt,Pt))return}}}function i(Et,xt){switch(xt.type){case"base64":return s(s2a(Base64_decode(Et)),xt);case"binary":return s(s2a(Et),xt);case"buffer":case"array":return s(Et,xt)}throw"Unsupported type "+xt.type}function s(Et,xt){if(!Et)return Et;var mt=xt||{},St=mt.dense?[]:{},Pt="Sheet1",Nt="",Lt=0,lr={},ur=[],wr=[],vr={s:{r:0,c:0},e:{r:0,c:0}},Fr=mt.sheetRows||0;if(Et[2]==0&&(Et[3]==8||Et[3]==9)&&Et.length>=16&&Et[14]==5&&Et[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Et[2]==2)mt.Enum=ir,e(Et,function(hr,jt,sr){switch(sr){case 0:mt.vers=hr,hr>=4096&&(mt.qpro=!0);break;case 6:vr=hr;break;case 204:hr&&(Nt=hr);break;case 222:Nt=hr;break;case 15:case 51:mt.qpro||(hr[1].v=hr[1].v.slice(1));case 13:case 14:case 16:sr==14&&(hr[2]&112)==112&&(hr[2]&15)>1&&(hr[2]&15)<15&&(hr[1].z=mt.dateNF||table_fmt[14],mt.cellDates&&(hr[1].t="d",hr[1].v=numdate(hr[1].v))),mt.qpro&&hr[3]>Lt&&(St["!ref"]=encode_range(vr),lr[Pt]=St,ur.push(Pt),St=mt.dense?[]:{},vr={s:{r:0,c:0},e:{r:0,c:0}},Lt=hr[3],Pt=Nt||"Sheet"+(Lt+1),Nt="");var _r=mt.dense?(St[hr[0].r]||[])[hr[0].c]:St[encode_cell(hr[0])];if(_r){_r.t=hr[1].t,_r.v=hr[1].v,hr[1].z!=null&&(_r.z=hr[1].z),hr[1].f!=null&&(_r.f=hr[1].f);break}mt.dense?(St[hr[0].r]||(St[hr[0].r]=[]),St[hr[0].r][hr[0].c]=hr[1]):St[encode_cell(hr[0])]=hr[1];break}},mt);else if(Et[2]==26||Et[2]==14)mt.Enum=fr,Et[2]==14&&(mt.qpro=!0,Et.l=0),e(Et,function(hr,jt,sr){switch(sr){case 204:Pt=hr;break;case 22:hr[1].v=hr[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(hr[3]>Lt&&(St["!ref"]=encode_range(vr),lr[Pt]=St,ur.push(Pt),St=mt.dense?[]:{},vr={s:{r:0,c:0},e:{r:0,c:0}},Lt=hr[3],Pt="Sheet"+(Lt+1)),Fr>0&&hr[0].r>=Fr)break;mt.dense?(St[hr[0].r]||(St[hr[0].r]=[]),St[hr[0].r][hr[0].c]=hr[1]):St[encode_cell(hr[0])]=hr[1],vr.e.c<hr[0].c&&(vr.e.c=hr[0].c),vr.e.r<hr[0].r&&(vr.e.r=hr[0].r);break;case 27:hr[14e3]&&(wr[hr[14e3][0]]=hr[14e3][1]);break;case 1537:wr[hr[0]]=hr[1],hr[0]==Lt&&(Pt=hr[1]);break}},mt);else throw new Error("Unrecognized LOTUS BOF "+Et[2]);if(St["!ref"]=encode_range(vr),lr[Nt||Pt]=St,ur.push(Nt||Pt),!wr.length)return{SheetNames:ur,Sheets:lr};for(var Rr={},jr=[],xr=0;xr<wr.length;++xr)lr[ur[xr]]?(jr.push(wr[xr]||ur[xr]),Rr[wr[xr]]=lr[wr[xr]]||lr[ur[xr]]):(jr.push(wr[xr]),Rr[wr[xr]]={"!ref":"A1"});return{SheetNames:jr,Sheets:Rr}}function a(Et,xt){var mt=xt||{};if(+mt.codepage>=0&&set_cp(+mt.codepage),mt.type=="string")throw new Error("Cannot write WK1 to JS string");var St=buf_array(),Pt=safe_decode_range(Et["!ref"]),Nt=Array.isArray(Et),Lt=[];write_biff_rec(St,0,c(1030)),write_biff_rec(St,6,g(Pt));for(var lr=Math.min(Pt.e.r,8191),ur=Pt.s.r;ur<=lr;++ur)for(var wr=encode_row(ur),vr=Pt.s.c;vr<=Pt.e.c;++vr){ur===Pt.s.r&&(Lt[vr]=encode_col(vr));var Fr=Lt[vr]+wr,Rr=Nt?(Et[ur]||[])[vr]:Et[Fr];if(!(!Rr||Rr.t=="z"))if(Rr.t=="n")(Rr.v|0)==Rr.v&&Rr.v>=-32768&&Rr.v<=32767?write_biff_rec(St,13,rt(ur,vr,Rr.v)):write_biff_rec(St,14,et(ur,vr,Rr.v));else{var jr=format_cell(Rr);write_biff_rec(St,15,tt(ur,vr,jr.slice(0,239)))}}return write_biff_rec(St,1),St.end()}function o(Et,xt){var mt=xt||{};if(+mt.codepage>=0&&set_cp(+mt.codepage),mt.type=="string")throw new Error("Cannot write WK3 to JS string");var St=buf_array();write_biff_rec(St,0,d(Et));for(var Pt=0,Nt=0;Pt<Et.SheetNames.length;++Pt)(Et.Sheets[Et.SheetNames[Pt]]||{})["!ref"]&&write_biff_rec(St,27,kt(Et.SheetNames[Pt],Nt++));var Lt=0;for(Pt=0;Pt<Et.SheetNames.length;++Pt){var lr=Et.Sheets[Et.SheetNames[Pt]];if(!(!lr||!lr["!ref"])){for(var ur=safe_decode_range(lr["!ref"]),wr=Array.isArray(lr),vr=[],Fr=Math.min(ur.e.r,8191),Rr=ur.s.r;Rr<=Fr;++Rr)for(var jr=encode_row(Rr),xr=ur.s.c;xr<=ur.e.c;++xr){Rr===ur.s.r&&(vr[xr]=encode_col(xr));var hr=vr[xr]+jr,jt=wr?(lr[Rr]||[])[xr]:lr[hr];if(!(!jt||jt.t=="z"))if(jt.t=="n")write_biff_rec(St,23,At(Rr,xr,Lt,jt.v));else{var sr=format_cell(jt);write_biff_rec(St,22,lt(Rr,xr,Lt,sr.slice(0,239)))}}++Lt}}return write_biff_rec(St,1),St.end()}function c(Et){var xt=new_buf(2);return xt.write_shift(2,Et),xt}function d(Et){var xt=new_buf(26);xt.write_shift(2,4096),xt.write_shift(2,4),xt.write_shift(4,0);for(var mt=0,St=0,Pt=0,Nt=0;Nt<Et.SheetNames.length;++Nt){var Lt=Et.SheetNames[Nt],lr=Et.Sheets[Lt];if(!(!lr||!lr["!ref"])){++Pt;var ur=decode_range(lr["!ref"]);mt<ur.e.r&&(mt=ur.e.r),St<ur.e.c&&(St=ur.e.c)}}return mt>8191&&(mt=8191),xt.write_shift(2,mt),xt.write_shift(1,Pt),xt.write_shift(1,St),xt.write_shift(2,0),xt.write_shift(2,0),xt.write_shift(1,1),xt.write_shift(1,2),xt.write_shift(4,0),xt.write_shift(4,0),xt}function h(Et,xt,mt){var St={s:{c:0,r:0},e:{c:0,r:0}};return xt==8&&mt.qpro?(St.s.c=Et.read_shift(1),Et.l++,St.s.r=Et.read_shift(2),St.e.c=Et.read_shift(1),Et.l++,St.e.r=Et.read_shift(2),St):(St.s.c=Et.read_shift(2),St.s.r=Et.read_shift(2),xt==12&&mt.qpro&&(Et.l+=2),St.e.c=Et.read_shift(2),St.e.r=Et.read_shift(2),xt==12&&mt.qpro&&(Et.l+=2),St.s.c==65535&&(St.s.c=St.e.c=St.s.r=St.e.r=0),St)}function g(Et){var xt=new_buf(8);return xt.write_shift(2,Et.s.c),xt.write_shift(2,Et.s.r),xt.write_shift(2,Et.e.c),xt.write_shift(2,Et.e.r),xt}function _(Et,xt,mt){var St=[{c:0,r:0},{t:"n",v:0},0,0];return mt.qpro&&mt.vers!=20768?(St[0].c=Et.read_shift(1),St[3]=Et.read_shift(1),St[0].r=Et.read_shift(2),Et.l+=2):(St[2]=Et.read_shift(1),St[0].c=Et.read_shift(2),St[0].r=Et.read_shift(2)),St}function b(Et,xt,mt){var St=Et.l+xt,Pt=_(Et,xt,mt);if(Pt[1].t="s",mt.vers==20768){Et.l++;var Nt=Et.read_shift(1);return Pt[1].v=Et.read_shift(Nt,"utf8"),Pt}return mt.qpro&&Et.l++,Pt[1].v=Et.read_shift(St-Et.l,"cstr"),Pt}function tt(Et,xt,mt){var St=new_buf(7+mt.length);St.write_shift(1,255),St.write_shift(2,xt),St.write_shift(2,Et),St.write_shift(1,39);for(var Pt=0;Pt<St.length;++Pt){var Nt=mt.charCodeAt(Pt);St.write_shift(1,Nt>=128?95:Nt)}return St.write_shift(1,0),St}function _e(Et,xt,mt){var St=_(Et,xt,mt);return St[1].v=Et.read_shift(2,"i"),St}function rt(Et,xt,mt){var St=new_buf(7);return St.write_shift(1,255),St.write_shift(2,xt),St.write_shift(2,Et),St.write_shift(2,mt,"i"),St}function it(Et,xt,mt){var St=_(Et,xt,mt);return St[1].v=Et.read_shift(8,"f"),St}function et(Et,xt,mt){var St=new_buf(13);return St.write_shift(1,255),St.write_shift(2,xt),St.write_shift(2,Et),St.write_shift(8,mt,"f"),St}function nt(Et,xt,mt){var St=Et.l+xt,Pt=_(Et,xt,mt);if(Pt[1].v=Et.read_shift(8,"f"),mt.qpro)Et.l=St;else{var Nt=Et.read_shift(2);pt(Et.slice(Et.l,Et.l+Nt),Pt),Et.l+=Nt}return Pt}function at(Et,xt,mt){var St=xt&32768;return xt&=-32769,xt=(St?Et:0)+(xt>=8192?xt-16384:xt),(St?"":"$")+(mt?encode_col(xt):encode_row(xt))}var st={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},ot=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function pt(Et,xt){prep_blob(Et,0);for(var mt=[],St=0,Pt="",Nt="",Lt="",lr="";Et.l<Et.length;){var ur=Et[Et.l++];switch(ur){case 0:mt.push(Et.read_shift(8,"f"));break;case 1:Nt=at(xt[0].c,Et.read_shift(2),!0),Pt=at(xt[0].r,Et.read_shift(2),!1),mt.push(Nt+Pt);break;case 2:{var wr=at(xt[0].c,Et.read_shift(2),!0),vr=at(xt[0].r,Et.read_shift(2),!1);Nt=at(xt[0].c,Et.read_shift(2),!0),Pt=at(xt[0].r,Et.read_shift(2),!1),mt.push(wr+vr+":"+Nt+Pt)}break;case 3:if(Et.l<Et.length){console.error("WK1 premature formula end");return}break;case 4:mt.push("("+mt.pop()+")");break;case 5:mt.push(Et.read_shift(2));break;case 6:{for(var Fr="";ur=Et[Et.l++];)Fr+=String.fromCharCode(ur);mt.push('"'+Fr.replace(/"/g,'""')+'"')}break;case 8:mt.push("-"+mt.pop());break;case 23:mt.push("+"+mt.pop());break;case 22:mt.push("NOT("+mt.pop()+")");break;case 20:case 21:lr=mt.pop(),Lt=mt.pop(),mt.push(["AND","OR"][ur-20]+"("+Lt+","+lr+")");break;default:if(ur<32&&ot[ur])lr=mt.pop(),Lt=mt.pop(),mt.push(Lt+ot[ur]+lr);else if(st[ur]){if(St=st[ur][1],St==69&&(St=Et[Et.l++]),St>mt.length){console.error("WK1 bad formula parse 0x"+ur.toString(16)+":|"+mt.join("|")+"|");return}var Rr=mt.slice(-St);mt.length-=St,mt.push(st[ur][0]+"("+Rr.join(",")+")")}else return ur<=7?console.error("WK1 invalid opcode "+ur.toString(16)):ur<=24?console.error("WK1 unsupported op "+ur.toString(16)):ur<=30?console.error("WK1 invalid opcode "+ur.toString(16)):ur<=115?console.error("WK1 unsupported function opcode "+ur.toString(16)):console.error("WK1 unrecognized opcode "+ur.toString(16))}}mt.length==1?xt[1].f=""+mt[0]:console.error("WK1 bad formula parse |"+mt.join("|")+"|")}function dt(Et){var xt=[{c:0,r:0},{t:"n",v:0},0];return xt[0].r=Et.read_shift(2),xt[3]=Et[Et.l++],xt[0].c=Et[Et.l++],xt}function wt(Et,xt){var mt=dt(Et);return mt[1].t="s",mt[1].v=Et.read_shift(xt-4,"cstr"),mt}function lt(Et,xt,mt,St){var Pt=new_buf(6+St.length);Pt.write_shift(2,Et),Pt.write_shift(1,mt),Pt.write_shift(1,xt),Pt.write_shift(1,39);for(var Nt=0;Nt<St.length;++Nt){var Lt=St.charCodeAt(Nt);Pt.write_shift(1,Lt>=128?95:Lt)}return Pt.write_shift(1,0),Pt}function gt(Et,xt){var mt=dt(Et);mt[1].v=Et.read_shift(2);var St=mt[1].v>>1;if(mt[1].v&1)switch(St&7){case 0:St=(St>>3)*5e3;break;case 1:St=(St>>3)*500;break;case 2:St=(St>>3)/20;break;case 3:St=(St>>3)/200;break;case 4:St=(St>>3)/2e3;break;case 5:St=(St>>3)/2e4;break;case 6:St=(St>>3)/16;break;case 7:St=(St>>3)/64;break}return mt[1].v=St,mt}function vt(Et,xt){var mt=dt(Et),St=Et.read_shift(4),Pt=Et.read_shift(4),Nt=Et.read_shift(2);if(Nt==65535)return St===0&&Pt===3221225472?(mt[1].t="e",mt[1].v=15):St===0&&Pt===3489660928?(mt[1].t="e",mt[1].v=42):mt[1].v=0,mt;var Lt=Nt&32768;return Nt=(Nt&32767)-16446,mt[1].v=(1-Lt*2)*(Pt*Math.pow(2,Nt+32)+St*Math.pow(2,Nt)),mt}function At(Et,xt,mt,St){var Pt=new_buf(14);if(Pt.write_shift(2,Et),Pt.write_shift(1,mt),Pt.write_shift(1,xt),St==0)return Pt.write_shift(4,0),Pt.write_shift(4,0),Pt.write_shift(2,65535),Pt;var Nt=0,Lt=0,lr=0,ur=0;return St<0&&(Nt=1,St=-St),Lt=Math.log2(St)|0,St/=Math.pow(2,Lt-31),ur=St>>>0,ur&2147483648||(St/=2,++Lt,ur=St>>>0),St-=ur,ur|=2147483648,ur>>>=0,St*=Math.pow(2,32),lr=St>>>0,Pt.write_shift(4,lr),Pt.write_shift(4,ur),Lt+=16383+(Nt?32768:0),Pt.write_shift(2,Lt),Pt}function yt(Et,xt){var mt=vt(Et);return Et.l+=xt-14,mt}function bt(Et,xt){var mt=dt(Et),St=Et.read_shift(4);return mt[1].v=St>>6,mt}function Tt(Et,xt){var mt=dt(Et),St=Et.read_shift(8,"f");return mt[1].v=St,mt}function er(Et,xt){var mt=Tt(Et);return Et.l+=xt-10,mt}function zt(Et,xt){return Et[Et.l+xt-1]==0?Et.read_shift(xt,"cstr"):""}function ar(Et,xt){var mt=Et[Et.l++];mt>xt-1&&(mt=xt-1);for(var St="";St.length<mt;)St+=String.fromCharCode(Et[Et.l++]);return St}function Jt(Et,xt,mt){if(!(!mt.qpro||xt<21)){var St=Et.read_shift(1);Et.l+=17,Et.l+=1,Et.l+=2;var Pt=Et.read_shift(xt-21,"cstr");return[St,Pt]}}function Yt(Et,xt){for(var mt={},St=Et.l+xt;Et.l<St;){var Pt=Et.read_shift(2);if(Pt==14e3){for(mt[Pt]=[0,""],mt[Pt][0]=Et.read_shift(2);Et[Et.l];)mt[Pt][1]+=String.fromCharCode(Et[Et.l]),Et.l++;Et.l++}}return mt}function kt(Et,xt){var mt=new_buf(5+Et.length);mt.write_shift(2,14e3),mt.write_shift(2,xt);for(var St=0;St<Et.length;++St){var Pt=Et.charCodeAt(St);mt[mt.l++]=Pt>127?95:Pt}return mt[mt.l++]=0,mt}var ir={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_e},14:{n:"NUMBER",f:it},15:{n:"LABEL",f:b},16:{n:"FORMULA",f:nt},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:zt},222:{n:"SHEETNAMELP",f:ar},65535:{n:""}},fr={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:wt},23:{n:"NUMBER17",f:vt},24:{n:"NUMBER18",f:gt},25:{n:"FORMULA19",f:yt},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Yt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:bt},38:{n:"??"},39:{n:"NUMBER27",f:Tt},40:{n:"FORMULA28",f:er},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:zt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Jt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:o,to_workbook:i}}(),straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,i){if(!i.bookSST)return"";var s=[XML_HEADER];s[s.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var o=e[a],c="<si>";o.r?c+=o.r:(c+="<t",o.t||(o.t=""),o.t.match(straywsregex)&&(c+=' xml:space="preserve"'),c+=">"+escapexml(o.t)+"</t>"),c+="</si>",s[s.length]=c}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function write_BrtBeginSst(e,i){return i||(i=new_buf(8)),i.write_shift(4,e.Count),i.write_shift(4,e.Unique),i}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var i=buf_array();write_record(i,159,write_BrtBeginSst(e));for(var s=0;s<e.length;++s)write_record(i,19,write_BrtSSTItem(e[s]));return write_record(i,160),i.end()}function _JS2ANSI(e){for(var i=[],s=e.split(""),a=0;a<s.length;++a)i[a]=s[a].charCodeAt(0);return i}function crypto_CreatePasswordVerifier_Method1(e){var i=0,s,a=_JS2ANSI(e),o=a.length+1,c,d,h,g,_;for(s=new_raw_buf(o),s[0]=a.length,c=1;c!=o;++c)s[c]=a[c-1];for(c=o-1;c>=0;--c)d=s[c],h=i&16384?1:0,g=i<<1&32767,_=h|g,i=_^d;return i^52811}var RTF=function(){function e(o,c){switch(c.type){case"base64":return i(Base64_decode(o),c);case"binary":return i(o,c);case"buffer":return i(has_buf&&Buffer.isBuffer(o)?o.toString("binary"):a2s(o),c);case"array":return i(cc2str(o),c)}throw new Error("Unrecognized type "+c.type)}function i(o,c){var d=c||{},h=d.dense?[]:{},g=o.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var _={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(b,tt){Array.isArray(h)&&(h[tt]=[]);for(var _e=/\\\w+\b/g,rt=0,it,et=-1;it=_e.exec(b);){switch(it[0]){case"\\cell":var nt=b.slice(rt,_e.lastIndex-it[0].length);if(nt[0]==" "&&(nt=nt.slice(1)),++et,nt.length){var at={v:nt,t:"s"};Array.isArray(h)?h[tt][et]=at:h[encode_cell({r:tt,c:et})]=at}break}rt=_e.lastIndex}et>_.e.c&&(_.e.c=et)}),h["!ref"]=encode_range(_),h}function s(o,c){return sheet_to_workbook(e(o,c),c)}function a(o){for(var c=["{\\rtf1\\ansi"],d=safe_decode_range(o["!ref"]),h,g=Array.isArray(o),_=d.s.r;_<=d.e.r;++_){c.push("\\trowd\\trautofit1");for(var b=d.s.c;b<=d.e.c;++b)c.push("\\cellx"+(b+1));for(c.push("\\pard\\intbl"),b=d.s.c;b<=d.e.c;++b){var tt=encode_cell({r:_,c:b});h=g?(o[_]||[])[b]:o[tt],!(!h||h.v==null&&(!h.f||h.F))&&(c.push(" "+(h.w||(format_cell(h),h.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:s,to_sheet:e,from_sheet:a}}();function rgb2Hex(e){for(var i=0,s=1;i!=3;++i)s=s*256+(e[i]>255?255:e[i]<0?0:e[i]);return s.toString(16).toUpperCase().slice(1)}var DEF_MDW=6,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}function write_numFmts(e){var i=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)e[a]!=null&&(i[i.length]=writextag("numFmt",null,{numFmtId:a,formatCode:escapexml(e[a])}))}),i.length===1?"":(i[i.length]="</numFmts>",i[0]=writextag("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function write_cellXfs(e){var i=[];return i[i.length]=writextag("cellXfs",null),e.forEach(function(s){i[i.length]=writextag("xf",null,s)}),i[i.length]="</cellXfs>",i.length===2?"":(i[0]=writextag("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function write_sty_xml(e,i){var s=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],a;return e.SSF&&(a=write_numFmts(e.SSF))!=null&&(s[s.length]=a),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=write_cellXfs(i.cellXfs))&&(s[s.length]=a),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function parse_BrtFmt(e,i){var s=e.read_shift(2),a=parse_XLWideString(e);return[s,a]}function write_BrtFmt(e,i,s){s||(s=new_buf(6+4*i.length)),s.write_shift(2,e),write_XLWideString(i,s);var a=s.length>s.l?s.slice(0,s.l):s;return s.l==null&&(s.l=s.length),a}function parse_BrtFont(e,i,s){var a={};a.sz=e.read_shift(2)/20;var o=parse_FontFlags(e);o.fItalic&&(a.italic=1),o.fCondense&&(a.condense=1),o.fExtend&&(a.extend=1),o.fShadow&&(a.shadow=1),o.fOutline&&(a.outline=1),o.fStrikeout&&(a.strike=1);var c=e.read_shift(2);switch(c===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(a.underline=d);var h=e.read_shift(1);h>0&&(a.family=h);var g=e.read_shift(1);switch(g>0&&(a.charset=g),e.l++,a.color=parse_BrtColor(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=parse_XLWideString(e),a}function write_BrtFont(e,i){i||(i=new_buf(25+4*32)),i.write_shift(2,e.sz*20),write_FontFlags(e,i),i.write_shift(2,e.bold?700:400);var s=0;e.vertAlign=="superscript"?s=1:e.vertAlign=="subscript"&&(s=2),i.write_shift(2,s),i.write_shift(1,e.underline||0),i.write_shift(1,e.family||0),i.write_shift(1,e.charset||0),i.write_shift(1,0),write_BrtColor(e.color,i);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),i.write_shift(1,a),write_XLWideString(e.name,i),i.length>i.l?i.slice(0,i.l):i}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,i){i||(i=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var s=rev_XLSBFillPTNames[e.patternType];s==null&&(s=40),i.write_shift(4,s);var a=0;if(s!=40)for(write_BrtColor({auto:1},i),write_BrtColor({auto:1},i);a<12;++a)i.write_shift(4,0);else{for(;a<4;++a)i.write_shift(4,0);for(;a<12;++a)i.write_shift(4,0)}return i.length>i.l?i.slice(0,i.l):i}function parse_BrtXF(e,i){var s=e.l+i,a=e.read_shift(2),o=e.read_shift(2);return e.l=s,{ixfe:a,numFmtId:o}}function write_BrtXF(e,i,s){s||(s=new_buf(16)),s.write_shift(2,i||0),s.write_shift(2,e.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);var a=0;return s.write_shift(1,a),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function write_Blxf(e,i){return i||(i=new_buf(10)),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,i){return i||(i=new_buf(51)),i.write_shift(1,0),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),write_Blxf(null,i),i.length>i.l?i.slice(0,i.l):i}function write_BrtStyle(e,i){return i||(i=new_buf(12+4*10)),i.write_shift(4,e.xfId),i.write_shift(2,1),i.write_shift(1,+e.builtinId),i.write_shift(1,0),write_XLNullableWideString(e.name||"",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBeginTableStyles(e,i,s){var a=new_buf(2052);return a.write_shift(4,e),write_XLNullableWideString(i,a),write_XLNullableWideString(s,a),a.length>a.l?a.slice(0,a.l):a}function write_FMTS_bin(e,i){if(i){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)i[o]!=null&&++s}),s!=0&&(write_record(e,615,write_UInt32LE(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)i[o]!=null&&write_record(e,44,write_BrtFmt(o,i[o]))}),write_record(e,616))}}function write_FONTS_bin(e){var i=1;write_record(e,611,write_UInt32LE(i)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(e,612)}function write_FILLS_bin(e){var i=2;write_record(e,603,write_UInt32LE(i)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var i=1;write_record(e,613,write_UInt32LE(i)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var i=1;write_record(e,626,write_UInt32LE(i)),write_record(e,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,i){write_record(e,617,write_UInt32LE(i.length)),i.forEach(function(s){write_record(e,47,write_BrtXF(s,0))}),write_record(e,618)}function write_STYLES_bin(e){var i=1;write_record(e,619,write_UInt32LE(i)),write_record(e,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var i=0;write_record(e,505,write_UInt32LE(i)),write_record(e,506)}function write_TABLESTYLES_bin(e){var i=0;write_record(e,508,write_BrtBeginTableStyles(i,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,i){var s=buf_array();return write_record(s,278),write_FMTS_bin(s,e.SSF),write_FONTS_bin(s),write_FILLS_bin(s),write_BORDERS_bin(s),write_CELLSTYLEXFS_bin(s),write_CELLXFS_bin(s,i.cellXfs),write_STYLES_bin(s),write_DXFS_bin(s),write_TABLESTYLES_bin(s),write_record(s,279),s.end()}function write_theme(e,i){if(i&&i.themeXLSX)return i.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var s=[XML_HEADER];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function parse_BrtMdtinfo(e,i){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var i=new_buf(12+2*e.name.length);return i.write_shift(4,e.flags),i.write_shift(4,e.version),write_XLWideString(e.name,i),i.slice(0,i.l)}function parse_BrtMdb(e){for(var i=[],s=e.read_shift(4);s-- >0;)i.push([e.read_shift(4),e.read_shift(4)]);return i}function write_BrtMdb(e){var i=new_buf(4+8*e.length);i.write_shift(4,e.length);for(var s=0;s<e.length;++s)i.write_shift(4,e[s][0]),i.write_shift(4,e[s][1]);return i}function write_BrtBeginEsfmd(e,i){var s=new_buf(8+2*i.length);return s.write_shift(4,e),write_XLWideString(i,s),s.slice(0,s.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,i){var s=new_buf(8);return s.write_shift(4,e),s.write_shift(4,1),s}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_BrtCalcChainItem$(e){var i={};i.i=e.read_shift(4);var s={};s.r=e.read_shift(4),s.c=e.read_shift(4),i.r=encode_cell(s);var a=e.read_shift(1);return a&2&&(i.l="1"),a&8&&(i.a="1"),i}var _shapeid=1024;function write_comments_vml(e,i){for(var s=[21600,21600],a=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),o=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:a})];_shapeid<e*1e3;)_shapeid+=1e3;return i.forEach(function(c){var d=decode_cell(c[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,_=writextag("v:fill",g,h),b={on:"t",obscured:"t"};++_shapeid,o=o.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",_,writextag("v:shadow",null,b),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[d.c+1,0,d.r+1,0,d.c+3,20,d.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(d.r)),writetag("x:Column",String(d.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function write_comments_xml(e){var i=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],s=[];return i.push("<authors>"),e.forEach(function(a){a[1].forEach(function(o){var c=escapexml(o.a);s.indexOf(c)==-1&&(s.push(c),i.push("<author>"+c+"</author>")),o.T&&o.ID&&s.indexOf("tc="+o.ID)==-1&&(s.push("tc="+o.ID),i.push("<author>tc="+o.ID+"</author>"))})}),s.length==0&&(s.push("SheetJ5"),i.push("<author>SheetJ5</author>")),i.push("</authors>"),i.push("<commentList>"),e.forEach(function(a){var o=0,c=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?o=s.indexOf("tc="+a[1][0].ID):a[1].forEach(function(g){g.a&&(o=s.indexOf(escapexml(g.a))),c.push(g.t||"")}),i.push('<comment ref="'+a[0]+'" authorId="'+o+'"><text>'),c.length<=1)i.push(writetag("t",escapexml(c[0]||"")));else{for(var d=`Comment:
    `+c[0]+`
`,h=1;h<c.length;++h)d+=`Reply:
    `+c[h]+`
`;i.push(writetag("t",escapexml(d)))}i.push("</text></comment>")}),i.push("</commentList>"),i.length>2&&(i[i.length]="</comments>",i[1]=i[1].replace("/>",">")),i.join("")}function write_tcmnt_xml(e,i,s){var a=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var c="";(o[1]||[]).forEach(function(d,h){if(!d.T){delete d.ID;return}d.a&&i.indexOf(d.a)==-1&&i.push(d.a);var g={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};h==0?c=g.id:g.parentId=c,d.ID=g.id,d.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+i.indexOf(d.a)).slice(-12)+"}"),a.push(writextag("threadedComment",writetag("text",d.t||""),g))})}),a.push("</ThreadedComments>"),a.join("")}function write_people_xml(e){var i=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(s,a){i.push(writextag("person",null,{displayName:s,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:s,providerId:"None"}))}),i.push("</personList>"),i.join("")}function parse_BrtBeginComment(e){var i={};i.iauthor=e.read_shift(4);var s=parse_UncheckedRfX(e);return i.rfx=s.s,i.ref=encode_cell(s.s),e.l+=16,i}function write_BrtBeginComment(e,i){return i==null&&(i=new_buf(36)),i.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],i),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function write_comments_bin(e){var i=buf_array(),s=[];return write_record(i,628),write_record(i,630),e.forEach(function(a){a[1].forEach(function(o){s.indexOf(o.a)>-1||(s.push(o.a.slice(0,54)),write_record(i,632,write_BrtCommentAuthor(o.a)))})}),write_record(i,631),write_record(i,633),e.forEach(function(a){a[1].forEach(function(o){o.iauthor=s.indexOf(o.a);var c={s:decode_cell(a[0]),e:decode_cell(a[0])};write_record(i,635,write_BrtBeginComment([c,o])),o.t&&o.t.length>0&&write_record(i,637,write_BrtCommentText(o)),write_record(i,636),delete o.iauthor})}),write_record(i,634),write_record(i,629),i.end()}function fill_vba_xls(e,i){i.FullPaths.forEach(function(s,a){if(a!=0){var o=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&CFB.utils.cfb_add(e,o,i.FileIndex[a].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"],rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,i={r:0,c:0};function s(a,o,c,d){var h=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),d.length==0?h=!0:d.charAt(0)=="["&&(h=!0,d=d.slice(1,-1));var _=c.length>0?parseInt(c,10)|0:0,b=d.length>0?parseInt(d,10)|0:0;return h?b+=i.c:--b,g?_+=i.r:--_,o+(h?"":"$")+encode_col(b)+(g?"":"$")+encode_row(_)}return function(o,c){return i=c,o.replace(e,s)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(i,s){return i.replace(crefregex,function(a,o,c,d,h,g){var _=decode_col(d)-(c?0:s.c),b=decode_row(g)-(h?0:s.r),tt=b==0?"":h?b+1:"["+b+"]",_e=_==0?"":c?_+1:"["+_+"]";return o+"R"+tt+"C"+_e})}}();function shift_formula_str(e,i){return e.replace(crefregex,function(s,a,o,c,d,h){return a+(o=="$"?o+c:encode_col(decode_col(c)+i.c))+(d=="$"?d+h:encode_row(decode_row(h)+i.r))})}function fuzzyfmla(e){return e.length!=1}function parseread1(e){e.l+=1}function parse_ColRelU(e,i){var s=e.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function parse_RgceArea(e,i,s){var a=2;if(s){if(s.biff>=2&&s.biff<=5)return parse_RgceArea_BIFF2(e);s.biff==12&&(a=4)}var o=e.read_shift(a),c=e.read_shift(a),d=parse_ColRelU(e),h=parse_ColRelU(e);return{s:{r:o,c:d[0],cRel:d[1],rRel:d[2]},e:{r:c,c:h[0],cRel:h[1],rRel:h[2]}}}function parse_RgceArea_BIFF2(e){var i=parse_ColRelU(e),s=parse_ColRelU(e),a=e.read_shift(1),o=e.read_shift(1);return{s:{r:i[0],c:a,cRel:i[1],rRel:i[2]},e:{r:s[0],c:o,cRel:s[1],rRel:s[2]}}}function parse_RgceAreaRel(e,i,s){if(s.biff<8)return parse_RgceArea_BIFF2(e);var a=e.read_shift(s.biff==12?4:2),o=e.read_shift(s.biff==12?4:2),c=parse_ColRelU(e),d=parse_ColRelU(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function parse_RgceLoc(e,i,s){if(s&&s.biff>=2&&s.biff<=5)return parse_RgceLoc_BIFF2(e);var a=e.read_shift(s&&s.biff==12?4:2),o=parse_ColRelU(e);return{r:a,c:o[0],cRel:o[1],rRel:o[2]}}function parse_RgceLoc_BIFF2(e){var i=parse_ColRelU(e),s=e.read_shift(1);return{r:i[0],c:s,cRel:i[1],rRel:i[2]}}function parse_RgceElfLoc(e){var i=e.read_shift(2),s=e.read_shift(2);return{r:i,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function parse_RgceLocRel(e,i,s){var a=s&&s.biff?s.biff:8;if(a>=2&&a<=5)return parse_RgceLocRel_BIFF2(e);var o=e.read_shift(a>=12?4:2),c=e.read_shift(2),d=(c&16384)>>14,h=(c&32768)>>15;if(c&=16383,h==1)for(;o>524287;)o-=1048576;if(d==1)for(;c>8191;)c=c-16384;return{r:o,c,cRel:d,rRel:h}}function parse_RgceLocRel_BIFF2(e){var i=e.read_shift(2),s=e.read_shift(1),a=(i&32768)>>15,o=(i&16384)>>14;return i&=16383,a==1&&i>=8192&&(i=i-16384),o==1&&s>=128&&(s=s-256),{r:i,c:s,cRel:o,rRel:a}}function parse_PtgArea(e,i,s){var a=(e[e.l++]&96)>>5,o=parse_RgceArea(e,s.biff>=2&&s.biff<=5?6:8,s);return[a,o]}function parse_PtgArea3d(e,i,s){var a=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),c=8;if(s)switch(s.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var d=parse_RgceArea(e,c,s);return[a,o,d]}function parse_PtgAreaErr(e,i,s){var a=(e[e.l++]&96)>>5;return e.l+=s&&s.biff>8?12:s.biff<8?6:8,[a]}function parse_PtgAreaErr3d(e,i,s){var a=(e[e.l++]&96)>>5,o=e.read_shift(2),c=8;if(s)switch(s.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[a,o]}function parse_PtgAreaN(e,i,s){var a=(e[e.l++]&96)>>5,o=parse_RgceAreaRel(e,i-1,s);return[a,o]}function parse_PtgArray(e,i,s){var a=(e[e.l++]&96)>>5;return e.l+=s.biff==2?6:s.biff==12?14:7,[a]}function parse_PtgAttrBaxcel(e){var i=e[e.l+1]&1,s=1;return e.l+=4,[i,s]}function parse_PtgAttrChoose(e,i,s){e.l+=2;for(var a=e.read_shift(s&&s.biff==2?1:2),o=[],c=0;c<=a;++c)o.push(e.read_shift(s&&s.biff==2?1:2));return o}function parse_PtgAttrGoto(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function parse_PtgAttrIf(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function parse_PtgAttrIfError(e){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(2)]}function parse_PtgAttrSemi(e,i,s){var a=e[e.l+1]&255?1:0;return e.l+=s&&s.biff==2?3:4,[a]}function parse_PtgAttrSpaceType(e){var i=e.read_shift(1),s=e.read_shift(1);return[i,s]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLoc(e,0,s);return[a,o]}function parse_PtgRefN(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var o=parse_RgceLocRel(e,0,s);return[a,o]}function parse_PtgRef3d(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);s&&s.biff==5&&(e.l+=12);var c=parse_RgceLoc(e,0,s);return[a,o,c]}function parse_PtgFunc(e,i,s){var a=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(s&&s.biff<=3?1:2);return[FtabArgc[o],Ftab[o],a]}function parse_PtgFuncVar(e,i,s){var a=e[e.l++],o=e.read_shift(1),c=s&&s.biff<=3?[a==88?-1:0,e.read_shift(1)]:parsetab(e);return[o,(c[0]===0?Ftab:Cetab)[c[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,i,s){e.l+=s&&s.biff==2?3:4}function parse_PtgExp(e,i,s){if(e.l++,s&&s.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),o=e.read_shift(s&&s.biff==2?1:2);return[a,o]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,i,s){return e.l++,parse_ShortXLUnicodeString(e,i-1,s)}function parse_SerAr(e,i){var s=[e.read_shift(1)];if(i==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=parsebool(e,1)?"TRUE":"FALSE",i!=12&&(e.l+=7);break;case 37:case 16:s[1]=BErr[e[e.l]],e.l+=i==12?4:8;break;case 0:e.l+=8;break;case 1:s[1]=parse_Xnum(e);break;case 2:s[1]=parse_XLUnicodeString2(e,0,{biff:i>0&&i<8?2:i});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function parse_PtgExtraMem(e,i,s){for(var a=e.read_shift(s.biff==12?4:2),o=[],c=0;c!=a;++c)o.push((s.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return o}function parse_PtgExtraArray(e,i,s){var a=0,o=0;s.biff==12?(a=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),a=1+e.read_shift(2)),s.biff>=2&&s.biff<8&&(--a,--o==0&&(o=256));for(var c=0,d=[];c!=a&&(d[c]=[]);++c)for(var h=0;h!=o;++h)d[c][h]=parse_SerAr(e,s.biff);return d}function parse_PtgName(e,i,s){var a=e.read_shift(1)>>>5&3,o=!s||s.biff>=8?4:2,c=e.read_shift(o);switch(s.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,c]}function parse_PtgNameX(e,i,s){if(s.biff==5)return parse_PtgNameX_BIFF5(e);var a=e.read_shift(1)>>>5&3,o=e.read_shift(2),c=e.read_shift(4);return[a,o,c]}function parse_PtgNameX_BIFF5(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[i,s,a]}function parse_PtgMemArea(e,i,s){var a=e.read_shift(1)>>>5&3;e.l+=s&&s.biff==2?3:4;var o=e.read_shift(s&&s.biff==2?1:2);return[a,o]}function parse_PtgMemFunc(e,i,s){var a=e.read_shift(1)>>>5&3,o=e.read_shift(s&&s.biff==2?1:2);return[a,o]}function parse_PtgRefErr(e,i,s){var a=e.read_shift(1)>>>5&3;return e.l+=4,s.biff<8&&e.l--,s.biff==12&&(e.l+=2),[a]}function parse_PtgRefErr3d(e,i,s){var a=(e[e.l++]&96)>>5,o=e.read_shift(2),c=4;if(s)switch(s.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[a,o]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,i,s){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),o=e.read_shift(2),c=e.read_shift(2),d=PtgListRT[s>>2&31];return{ixti:i,coltype:s&3,rt:d,idx:a,c:o,C:c}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,i,s){return e.l+=5,e.l+=2,e.l+=s.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,i,s){return e.l+=s.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[i,s]}function parse_PtgMemNoMemN(e){var i=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[i,s]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,i,s,a){if(a.biff<8)return parsenoop(e,i);for(var o=e.l+i,c=[],d=0;d!==s.length;++d)switch(s[d][0]){case"PtgArray":s[d][1]=parse_PtgExtraArray(e,0,a),c.push(s[d][1]);break;case"PtgMemArea":s[d][2]=parse_PtgExtraMem(e,s[d][1],a),c.push(s[d][2]);break;case"PtgExp":a&&a.biff==12&&(s[d][1][1]=e.read_shift(4),c.push(s[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[d][0]}return i=o-e.l,i!==0&&c.push(parsenoop(e,i)),c}function parse_Rgce(e,i,s){for(var a=e.l+i,o,c,d=[];a!=e.l;)i=a-e.l,c=e[e.l],o=PtgTypes[c]||PtgTypes[PtgDupes[c]],(c===24||c===25)&&(o=(c===24?Ptg18:Ptg19)[e[e.l+1]]),!o||!o.f?parsenoop(e,i):d.push([o.n,o.f(e,i,s)]);return d}function stringify_array(e){for(var i=[],s=0;s<e.length;++s){for(var a=e[s],o=[],c=0;c<a.length;++c){var d=a[c];if(d)switch(d[0]){case 2:o.push('"'+d[1].replace(/"/g,'""')+'"');break;default:o.push(d[1])}else o.push("")}i.push(o.join(","))}return i.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,i){if(!e&&!(i&&i.biff<=5&&i.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,i,s){if(!e)return"SH33TJSERR0";if(s.biff>8&&(!e.XTI||!e.XTI[i]))return e.SheetNames[i];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[i];if(s.biff<8)return i>1e4&&(i-=65536),i<0&&(i=-i),i==0?"":e.XTI[i-1];if(!a)return"SH33TJSERR1";var o="";if(s.biff>8)switch(e[a[0]][0]){case 357:return o=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?o:o+":"+e.SheetNames[a[2]];case 358:return s.SID!=null?e.SheetNames[s.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return o=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?o:o+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[a[0]][0][3]?(o=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?o:o+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function get_ixti(e,i,s){var a=get_ixti_raw(e,i,s);return a=="#REF"?a:formula_quote_sheet_name(a,s)}function stringify_formula(e,i,s,a,o){var c=o&&o.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},h=[],g,_,b,tt=0,_e=0,rt,it="";if(!e[0]||!e[0][0])return"";for(var et=-1,nt="",at=0,st=e[0].length;at<st;++at){var ot=e[0][at];switch(ot[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),_=h.pop(),et>=0){switch(e[0][et][1][0]){case 0:nt=fill(" ",e[0][et][1][1]);break;case 1:nt=fill("\r",e[0][et][1][1]);break;default:if(nt="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][et][1][0])}_=_+nt,et=-1}h.push(_+PtgBinOp[ot[0]]+g);break;case"PtgIsect":g=h.pop(),_=h.pop(),h.push(_+" "+g);break;case"PtgUnion":g=h.pop(),_=h.pop(),h.push(_+","+g);break;case"PtgRange":g=h.pop(),_=h.pop(),h.push(_+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":b=shift_cell_xls(ot[1][1],d,o),h.push(encode_cell_xls(b,c));break;case"PtgRefN":b=s?shift_cell_xls(ot[1][1],s,o):ot[1][1],h.push(encode_cell_xls(b,c));break;case"PtgRef3d":tt=ot[1][1],b=shift_cell_xls(ot[1][2],d,o),it=get_ixti(a,tt,o),h.push(it+"!"+encode_cell_xls(b,c));break;case"PtgFunc":case"PtgFuncVar":var pt=ot[1][0],dt=ot[1][1];pt||(pt=0),pt&=127;var wt=pt==0?[]:h.slice(-pt);h.length-=pt,dt==="User"&&(dt=wt.shift()),h.push(dt+"("+wt.join(",")+")");break;case"PtgBool":h.push(ot[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(ot[1]);break;case"PtgNum":h.push(String(ot[1]));break;case"PtgStr":h.push('"'+ot[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(ot[1]);break;case"PtgAreaN":rt=shift_range_xls(ot[1][1],s?{s}:d,o),h.push(encode_range_xls(rt,o));break;case"PtgArea":rt=shift_range_xls(ot[1][1],d,o),h.push(encode_range_xls(rt,o));break;case"PtgArea3d":tt=ot[1][1],rt=ot[1][2],it=get_ixti(a,tt,o),h.push(it+"!"+encode_range_xls(rt,o));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_e=ot[1][2];var lt=(a.names||[])[_e-1]||(a[0]||[])[_e],gt=lt?lt.Name:"SH33TJSNAME"+String(_e);gt&&gt.slice(0,6)=="_xlfn."&&!o.xlfn&&(gt=gt.slice(6)),h.push(gt);break;case"PtgNameX":var vt=ot[1][1];_e=ot[1][2];var At;if(o.biff<=5)vt<0&&(vt=-vt),a[vt]&&(At=a[vt][_e]);else{var yt="";if(((a[vt]||[])[0]||[])[0]==14849||(((a[vt]||[])[0]||[])[0]==1025?a[vt][_e]&&a[vt][_e].itab>0&&(yt=a.SheetNames[a[vt][_e].itab-1]+"!"):yt=a.SheetNames[_e-1]+"!"),a[vt]&&a[vt][_e])yt+=a[vt][_e].Name;else if(a[0]&&a[0][_e])yt+=a[0][_e].Name;else{var bt=(get_ixti_raw(a,vt,o)||"").split(";;");bt[_e-1]?yt=bt[_e-1]:yt+="SH33TJSERRX"}h.push(yt);break}At||(At={Name:"SH33TJSERRY"}),h.push(At.Name);break;case"PtgParen":var Tt="(",er=")";if(et>=0){switch(nt="",e[0][et][1][0]){case 2:Tt=fill(" ",e[0][et][1][1])+Tt;break;case 3:Tt=fill("\r",e[0][et][1][1])+Tt;break;case 4:er=fill(" ",e[0][et][1][1])+er;break;case 5:er=fill("\r",e[0][et][1][1])+er;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][et][1][0])}et=-1}h.push(Tt+h.pop()+er);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":b={c:ot[1][1],r:ot[1][0]};var zt={c:s.c,r:s.r};if(a.sharedf[encode_cell(b)]){var ar=a.sharedf[encode_cell(b)];h.push(stringify_formula(ar,d,zt,a,o))}else{var Jt=!1;for(g=0;g!=a.arrayf.length;++g)if(_=a.arrayf[g],!(b.c<_[0].s.c||b.c>_[0].e.c)&&!(b.r<_[0].s.r||b.r>_[0].e.r)){h.push(stringify_formula(_[1],d,zt,a,o)),Jt=!0;break}Jt||h.push(ot[1])}break;case"PtgArray":h.push("{"+stringify_array(ot[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":et=at;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+ot[1].idx+"[#"+ot[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(ot));default:throw new Error("Unrecognized Formula Token: "+String(ot))}var Yt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&et>=0&&Yt.indexOf(e[0][at][0])==-1){ot=e[0][et];var kt=!0;switch(ot[1][0]){case 4:kt=!1;case 0:nt=fill(" ",ot[1][1]);break;case 5:kt=!1;case 1:nt=fill("\r",ot[1][1]);break;default:if(nt="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+ot[1][0])}h.push((kt?nt:"")+h.pop()+(kt?"":nt)),et=-1}}if(h.length>1&&o.WTF)throw new Error("bad formula stack");return h[0]}function write_FormulaValue(e){if(e==null){var i=new_buf(8);return i.write_shift(1,3),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,65535),i}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function write_Formula(e,i,s,a,o){var c=write_XLSCell(i,s,o),d=write_FormulaValue(e.v),h=new_buf(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var _=new_buf(e.bf.length),b=0;b<e.bf.length;++b)_[b]=e.bf[b];var tt=bconcat([c,d,h,_]);return tt}function parse_XLSBParsedFormula(e,i,s){var a=e.read_shift(4),o=parse_Rgce(e,a,s),c=e.read_shift(4),d=c>0?parse_RgbExtra(e,c,o,s):null;return[o,d]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function csf_to_ods_formula(e){var i="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return i.replace(/;/g,"|").replace(/,/g,";")}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var browser_has_Map=typeof Map<"u";function get_sst_id(e,i,s){var a=0,o=e.length;if(s){if(browser_has_Map?s.has(i):Object.prototype.hasOwnProperty.call(s,i)){for(var c=browser_has_Map?s.get(i):s[i];a<c.length;++a)if(e[c[a]].t===i)return e.Count++,c[a]}}else for(;a<o;++a)if(e[a].t===i)return e.Count++,a;return e[o]={t:i},e.Count++,e.Unique++,s&&(browser_has_Map?(s.has(i)||s.set(i,[]),s.get(i).push(o)):(Object.prototype.hasOwnProperty.call(s,i)||(s[i]=[]),s[i].push(o))),o}function col_obj_w(e,i){var s={min:e+1,max:e+1},a=-1;return i.MDW&&(MDW=i.MDW),i.width!=null?s.customWidth=1:i.wpx!=null?a=px2char(i.wpx):i.wch!=null&&(a=i.wch),a>-1?(s.width=char2width(a),s.customWidth=1):i.width!=null&&(s.width=i.width),i.hidden&&(s.hidden=!0),i.level!=null&&(s.outlineLevel=s.level=i.level),s}function default_margins(e,i){if(e){var s=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=s[0]),e.right==null&&(e.right=s[1]),e.top==null&&(e.top=s[2]),e.bottom==null&&(e.bottom=s[3]),e.header==null&&(e.header=s[4]),e.footer==null&&(e.footer=s[5])}}function get_cell_style(e,i,s){var a=s.revssf[i.z!=null?i.z:"General"],o=60,c=e.length;if(a==null&&s.ssf){for(;o<392;++o)if(s.ssf[o]==null){SSF_load(i.z,o),s.ssf[o]=i.z,s.revssf[i.z]=a=o;break}}for(o=0;o!=c;++o)if(e[o].numFmtId===a)return o;return e[c]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function check_ws(e,i,s){if(e&&e["!ref"]){var a=safe_decode_range(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+s+"): "+e["!ref"])}}function write_ws_xml_merges(e){if(e.length===0)return"";for(var i='<mergeCells count="'+e.length+'">',s=0;s!=e.length;++s)i+='<mergeCell ref="'+encode_range(e[s])+'"/>';return i+"</mergeCells>"}function write_ws_xml_sheetpr(e,i,s,a,o){var c=!1,d={},h=null;if(a.bookType!=="xlsx"&&i.vbaraw){var g=i.SheetNames[s];try{i.Workbook&&(g=i.Workbook.Sheets[s].CodeName||g)}catch{}c=!0,d.codeName=utf8write(escapexml(g))}if(e&&e["!outline"]){var _={summaryBelow:1,summaryRight:1};e["!outline"].above&&(_.summaryBelow=0),e["!outline"].left&&(_.summaryRight=0),h=(h||"")+writextag("outlinePr",null,_)}!c&&!h||(o[o.length]=writextag("sheetPr",h,d))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var i={sheet:1};return sheetprot_deffalse.forEach(function(s){e[s]!=null&&e[s]&&(i[s]="1")}),sheetprot_deftrue.forEach(function(s){e[s]!=null&&!e[s]&&(i[s]="0")}),e.password&&(i.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,i)}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function write_ws_xml_cols(e,i){for(var s=["<cols>"],a,o=0;o!=i.length;++o)(a=i[o])&&(s[s.length]=writextag("col",null,col_obj_w(o,a)));return s[s.length]="</cols>",s.join("")}function write_ws_xml_autofilter(e,i,s,a){var o=typeof e.ref=="string"?e.ref:encode_range(e.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var c=s.Workbook.Names,d=decode_range(o);d.s.r==d.e.r&&(d.e.r=decode_range(i["!ref"]).e.r,o=encode_range(d));for(var h=0;h<c.length;++h){var g=c[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==a){g.Ref="'"+s.SheetNames[a]+"'!"+o;break}}return h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+o}),writextag("autoFilter",null,{ref:o})}function write_ws_xml_sheetviews(e,i,s,a){var o={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,o),{})}function write_ws_xml_cell(e,i,s,a){if(e.c&&s["!comments"].push([i,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",c=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=BErr[e.v];break;case"d":a&&a.cellDates?o=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",o=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:o=e.v;break}var h=writetag("v",escapexml(o)),g={r:i},_=get_cell_style(a.cellXfs,e,a);switch(_!==0&&(g.s=_),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){h=writetag("v",""+get_sst_id(a.Strings,e.v,a.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=d),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,i.length)==i?{t:"array",ref:e.F}:null;h=writextag("f",escapexml(e.f),b)+(e.v!=null?h:"")}return e.l&&s["!links"].push([i,e.l]),e.D&&(g.cm=1),writextag("c",h,g)}function write_ws_xml_data(e,i,s,a){var o=[],c=[],d=safe_decode_range(e["!ref"]),h="",g,_="",b=[],tt=0,_e=0,rt=e["!rows"],it=Array.isArray(e),et={r:_},nt,at=-1;for(_e=d.s.c;_e<=d.e.c;++_e)b[_e]=encode_col(_e);for(tt=d.s.r;tt<=d.e.r;++tt){for(c=[],_=encode_row(tt),_e=d.s.c;_e<=d.e.c;++_e){g=b[_e]+_;var st=it?(e[tt]||[])[_e]:e[g];st!==void 0&&(h=write_ws_xml_cell(st,g,e,i))!=null&&c.push(h)}(c.length>0||rt&&rt[tt])&&(et={r:_},rt&&rt[tt]&&(nt=rt[tt],nt.hidden&&(et.hidden=1),at=-1,nt.hpx?at=px2pt(nt.hpx):nt.hpt&&(at=nt.hpt),at>-1&&(et.ht=at,et.customHeight=1),nt.level&&(et.outlineLevel=nt.level)),o[o.length]=writextag("row",c.join(""),et))}if(rt)for(;tt<rt.length;++tt)rt&&rt[tt]&&(et={r:tt+1},nt=rt[tt],nt.hidden&&(et.hidden=1),at=-1,nt.hpx?at=px2pt(nt.hpx):nt.hpt&&(at=nt.hpt),at>-1&&(et.ht=at,et.customHeight=1),nt.level&&(et.outlineLevel=nt.level),o[o.length]=writextag("row","",et));return o.join("")}function write_ws_xml(e,i,s,a){var o=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],c=s.SheetNames[e],d=0,h="",g=s.Sheets[c];g==null&&(g={});var _=g["!ref"]||"A1",b=safe_decode_range(_);if(b.e.c>16383||b.e.r>1048575){if(i.WTF)throw new Error("Range "+_+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),_=encode_range(b)}a||(a={}),g["!comments"]=[];var tt=[];write_ws_xml_sheetpr(g,s,e,i,o),o[o.length]=writextag("dimension",null,{ref:_}),o[o.length]=write_ws_xml_sheetviews(g,i,e,s),i.sheetFormat&&(o[o.length]=writextag("sheetFormatPr",null,{defaultRowHeight:i.sheetFormat.defaultRowHeight||"16",baseColWidth:i.sheetFormat.baseColWidth||"10",outlineLevelRow:i.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(o[o.length]=write_ws_xml_cols(g,g["!cols"])),o[d=o.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=write_ws_xml_data(g,i),h.length>0&&(o[o.length]=h)),o.length>d+1&&(o[o.length]="</sheetData>",o[d]=o[d].replace("/>",">")),g["!protect"]&&(o[o.length]=write_ws_xml_protection(g["!protect"])),g["!autofilter"]!=null&&(o[o.length]=write_ws_xml_autofilter(g["!autofilter"],g,s,e)),g["!merges"]!=null&&g["!merges"].length>0&&(o[o.length]=write_ws_xml_merges(g["!merges"]));var _e=-1,rt,it=-1;return g["!links"].length>0&&(o[o.length]="<hyperlinks>",g["!links"].forEach(function(et){et[1].Target&&(rt={ref:et[0]},et[1].Target.charAt(0)!="#"&&(it=add_rels(a,-1,escapexml(et[1].Target).replace(/#.*$/,""),RELS.HLINK),rt["r:id"]="rId"+it),(_e=et[1].Target.indexOf("#"))>-1&&(rt.location=escapexml(et[1].Target.slice(_e+1))),et[1].Tooltip&&(rt.tooltip=escapexml(et[1].Tooltip)),o[o.length]=writextag("hyperlink",null,rt))}),o[o.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(o[o.length]=write_ws_xml_margins(g["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&(o[o.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:_}))),tt.length>0&&(it=add_rels(a,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),o[o.length]=writextag("drawing",null,{"r:id":"rId"+it}),g["!drawing"]=tt),g["!comments"].length>0&&(it=add_rels(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),o[o.length]=writextag("legacyDrawing",null,{"r:id":"rId"+it}),g["!legacy"]=it),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function parse_BrtRowHdr(e,i){var s={},a=e.l+i;s.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=a,c&7&&(s.level=c&7),c&16&&(s.hidden=!0),c&32&&(s.hpt=o/20),s}function write_BrtRowHdr(e,i,s){var a=new_buf(145),o=(s["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var c=320;o.hpx?c=px2pt(o.hpx)*20:o.hpt&&(c=o.hpt*20),a.write_shift(2,c),a.write_shift(1,0);var d=0;o.level&&(d|=o.level),o.hidden&&(d|=16),(o.hpx||o.hpt)&&(d|=32),a.write_shift(1,d),a.write_shift(1,0);var h=0,g=a.l;a.l+=4;for(var _={r:e,c:0},b=0;b<16;++b)if(!(i.s.c>b+1<<10||i.e.c<b<<10)){for(var tt=-1,_e=-1,rt=b<<10;rt<b+1<<10;++rt){_.c=rt;var it=Array.isArray(s)?(s[_.r]||[])[_.c]:s[encode_cell(_)];it&&(tt<0&&(tt=rt),_e=rt)}tt<0||(++h,a.write_shift(4,tt),a.write_shift(4,_e))}var et=a.l;return a.l=g,a.write_shift(4,h),a.l=et,a.length>a.l?a.slice(0,a.l):a}function write_row_header(e,i,s,a){var o=write_BrtRowHdr(a,s,i);(o.length>17||(i["!rows"]||[])[a])&&write_record(e,0,o)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,i){var s={},a=e[e.l];return++e.l,s.above=!(a&64),s.left=!(a&128),e.l+=18,s.name=parse_XLSBCodeName(e),s}function write_BrtWsProp(e,i,s){s==null&&(s=new_buf(84+4*e.length));var a=192;i&&(i.above&&(a&=-65),i.left&&(a&=-129)),s.write_shift(1,a);for(var o=1;o<3;++o)s.write_shift(1,0);return write_BrtColor({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),write_XLSBCodeName(e,s),s.slice(0,s.l)}function parse_BrtCellBlank(e){var i=parse_XLSBCell(e);return[i]}function write_BrtCellBlank(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBCell(i,s)}function parse_BrtShortBlank(e){var i=parse_XLSBShortCell(e);return[i]}function write_BrtShortBlank(e,i,s){return s==null&&(s=new_buf(4)),write_XLSBShortCell(i,s)}function parse_BrtCellBool(e){var i=parse_XLSBCell(e),s=e.read_shift(1);return[i,s,"b"]}function write_BrtCellBool(e,i,s){return s==null&&(s=new_buf(9)),write_XLSBCell(i,s),s.write_shift(1,e.v?1:0),s}function parse_BrtShortBool(e){var i=parse_XLSBShortCell(e),s=e.read_shift(1);return[i,s,"b"]}function write_BrtShortBool(e,i,s){return s==null&&(s=new_buf(5)),write_XLSBShortCell(i,s),s.write_shift(1,e.v?1:0),s}function parse_BrtCellError(e){var i=parse_XLSBCell(e),s=e.read_shift(1);return[i,s,"e"]}function write_BrtCellError(e,i,s){return s==null&&(s=new_buf(9)),write_XLSBCell(i,s),s.write_shift(1,e.v),s}function parse_BrtShortError(e){var i=parse_XLSBShortCell(e),s=e.read_shift(1);return[i,s,"e"]}function write_BrtShortError(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),s.write_shift(1,e.v),s.write_shift(2,0),s.write_shift(1,0),s}function parse_BrtCellIsst(e){var i=parse_XLSBCell(e),s=e.read_shift(4);return[i,s,"s"]}function write_BrtCellIsst(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBCell(i,s),s.write_shift(4,i.v),s}function parse_BrtShortIsst(e){var i=parse_XLSBShortCell(e),s=e.read_shift(4);return[i,s,"s"]}function write_BrtShortIsst(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),s.write_shift(4,i.v),s}function parse_BrtCellReal(e){var i=parse_XLSBCell(e),s=parse_Xnum(e);return[i,s,"n"]}function write_BrtCellReal(e,i,s){return s==null&&(s=new_buf(16)),write_XLSBCell(i,s),write_Xnum(e.v,s),s}function parse_BrtShortReal(e){var i=parse_XLSBShortCell(e),s=parse_Xnum(e);return[i,s,"n"]}function write_BrtShortReal(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBShortCell(i,s),write_Xnum(e.v,s),s}function parse_BrtCellRk(e){var i=parse_XLSBCell(e),s=parse_RkNumber(e);return[i,s,"n"]}function write_BrtCellRk(e,i,s){return s==null&&(s=new_buf(12)),write_XLSBCell(i,s),write_RkNumber(e.v,s),s}function parse_BrtShortRk(e){var i=parse_XLSBShortCell(e),s=parse_RkNumber(e);return[i,s,"n"]}function write_BrtShortRk(e,i,s){return s==null&&(s=new_buf(8)),write_XLSBShortCell(i,s),write_RkNumber(e.v,s),s}function parse_BrtCellRString(e){var i=parse_XLSBCell(e),s=parse_RichStr(e);return[i,s,"is"]}function parse_BrtCellSt(e){var i=parse_XLSBCell(e),s=parse_XLWideString(e);return[i,s,"str"]}function write_BrtCellSt(e,i,s){return s==null&&(s=new_buf(12+4*e.v.length)),write_XLSBCell(i,s),write_XLWideString(e.v,s),s.length>s.l?s.slice(0,s.l):s}function parse_BrtShortSt(e){var i=parse_XLSBShortCell(e),s=parse_XLWideString(e);return[i,s,"str"]}function write_BrtShortSt(e,i,s){return s==null&&(s=new_buf(8+4*e.v.length)),write_XLSBShortCell(i,s),write_XLWideString(e.v,s),s.length>s.l?s.slice(0,s.l):s}function parse_BrtFmlaBool(e,i,s){var a=e.l+i,o=parse_XLSBCell(e);o.r=s["!row"];var c=e.read_shift(1),d=[o,c,"b"];if(s.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,a-e.l,s);d[3]=stringify_formula(h,null,o,s.supbooks,s)}else e.l=a;return d}function parse_BrtFmlaError(e,i,s){var a=e.l+i,o=parse_XLSBCell(e);o.r=s["!row"];var c=e.read_shift(1),d=[o,c,"e"];if(s.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,a-e.l,s);d[3]=stringify_formula(h,null,o,s.supbooks,s)}else e.l=a;return d}function parse_BrtFmlaNum(e,i,s){var a=e.l+i,o=parse_XLSBCell(e);o.r=s["!row"];var c=parse_Xnum(e),d=[o,c,"n"];if(s.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,a-e.l,s);d[3]=stringify_formula(h,null,o,s.supbooks,s)}else e.l=a;return d}function parse_BrtFmlaString(e,i,s){var a=e.l+i,o=parse_XLSBCell(e);o.r=s["!row"];var c=parse_XLWideString(e),d=[o,c,"str"];if(s.cellFormula){e.l+=2;var h=parse_XLSBCellParsedFormula(e,a-e.l,s);d[3]=stringify_formula(h,null,o,s.supbooks,s)}else e.l=a;return d}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,i){return i==null&&(i=new_buf(4)),i.write_shift(4,e),i}function parse_BrtHLink(e,i){var s=e.l+i,a=parse_UncheckedRfX(e),o=parse_XLNullableWideString(e),c=parse_XLWideString(e),d=parse_XLWideString(e),h=parse_XLWideString(e);e.l=s;var g={rfx:a,relId:o,loc:c,display:h};return d&&(g.Tooltip=d),g}function write_BrtHLink(e,i){var s=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},s),write_RelID("rId"+i,s);var a=e[1].Target.indexOf("#"),o=a==-1?"":e[1].Target.slice(a+1);return write_XLWideString(o||"",s),write_XLWideString(e[1].Tooltip||"",s),write_XLWideString("",s),s.slice(0,s.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,i,s){var a=e.l+i,o=parse_RfX(e),c=e.read_shift(1),d=[o];if(d[2]=c,s.cellFormula){var h=parse_XLSBArrayParsedFormula(e,a-e.l,s);d[1]=h}else e.l=a;return d}function parse_BrtShrFmla(e,i,s){var a=e.l+i,o=parse_UncheckedRfX(e),c=[o];if(s.cellFormula){var d=parse_XLSBSharedParsedFormula(e,a-e.l,s);c[1]=d,e.l=a}else e.l=a;return c}function write_BrtColInfo(e,i,s){s==null&&(s=new_buf(18));var a=col_obj_w(e,i);s.write_shift(-4,e),s.write_shift(-4,e),s.write_shift(4,(a.width||10)*256),s.write_shift(4,0);var o=0;return i.hidden&&(o|=1),typeof a.width=="number"&&(o|=2),i.level&&(o|=i.level<<8),s.write_shift(2,o),s}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var i={};return BrtMarginKeys.forEach(function(s){i[s]=parse_Xnum(e)}),i}function write_BrtMargins(e,i){return i==null&&(i=new_buf(6*8)),default_margins(e),BrtMarginKeys.forEach(function(s){write_Xnum(e[s],i)}),i}function parse_BrtBeginWsView(e){var i=e.read_shift(2);return e.l+=28,{RTL:i&32}}function write_BrtBeginWsView(e,i,s){s==null&&(s=new_buf(30));var a=924;return(((i||{}).Views||[])[0]||{}).RTL&&(a|=32),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}function write_BrtCellIgnoreEC(e){var i=new_buf(24);return i.write_shift(4,4),i.write_shift(4,1),write_UncheckedRfX(e,i),i}function write_BrtSheetProtection(e,i){return i==null&&(i=new_buf(16*4+2)),i.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(s){s[1]?i.write_shift(4,e[s[0]]!=null&&!e[s[0]]?1:0):i.write_shift(4,e[s[0]]!=null&&e[s[0]]?0:1)}),i}function parse_BrtDVal(){}function parse_BrtDVal14(){}function write_ws_bin_cell(e,i,s,a,o,c,d){if(i.v===void 0)return!1;var h="";switch(i.t){case"b":h=i.v?"1":"0";break;case"d":i=dup(i),i.z=i.z||table_fmt[14],i.v=datenum(parseDate(i.v)),i.t="n";break;case"n":case"e":h=""+i.v;break;default:h=i.v;break}var g={r:s,c:a};switch(g.s=get_cell_style(o.cellXfs,i,o),i.l&&c["!links"].push([encode_cell(g),i.l]),i.c&&c["!comments"].push([encode_cell(g),i.c]),i.t){case"s":case"str":return o.bookSST?(h=get_sst_id(o.Strings,i.v,o.revStrings),g.t="s",g.v=h,d?write_record(e,18,write_BrtShortIsst(i,g)):write_record(e,7,write_BrtCellIsst(i,g))):(g.t="str",d?write_record(e,17,write_BrtShortSt(i,g)):write_record(e,6,write_BrtCellSt(i,g))),!0;case"n":return i.v==(i.v|0)&&i.v>-1e3&&i.v<1e3?d?write_record(e,13,write_BrtShortRk(i,g)):write_record(e,2,write_BrtCellRk(i,g)):d?write_record(e,16,write_BrtShortReal(i,g)):write_record(e,5,write_BrtCellReal(i,g)),!0;case"b":return g.t="b",d?write_record(e,15,write_BrtShortBool(i,g)):write_record(e,4,write_BrtCellBool(i,g)),!0;case"e":return g.t="e",d?write_record(e,14,write_BrtShortError(i,g)):write_record(e,3,write_BrtCellError(i,g)),!0}return d?write_record(e,12,write_BrtShortBlank(i,g)):write_record(e,1,write_BrtCellBlank(i,g)),!0}function write_CELLTABLE(e,i,s,a){var o=safe_decode_range(i["!ref"]||"A1"),c,d="",h=[];write_record(e,145);var g=Array.isArray(i),_=o.e.r;i["!rows"]&&(_=Math.max(o.e.r,i["!rows"].length-1));for(var b=o.s.r;b<=_;++b){d=encode_row(b),write_row_header(e,i,o,b);var tt=!1;if(b<=o.e.r)for(var _e=o.s.c;_e<=o.e.c;++_e){b===o.s.r&&(h[_e]=encode_col(_e)),c=h[_e]+d;var rt=g?(i[b]||[])[_e]:i[c];if(!rt){tt=!1;continue}tt=write_ws_bin_cell(e,rt,b,_e,a,i,tt)}}write_record(e,146)}function write_MERGECELLS(e,i){!i||!i["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(i["!merges"].length)),i["!merges"].forEach(function(s){write_record(e,176,write_BrtMergeCell(s))}),write_record(e,178))}function write_COLINFOS(e,i){!i||!i["!cols"]||(write_record(e,390),i["!cols"].forEach(function(s,a){s&&write_record(e,60,write_BrtColInfo(a,s))}),write_record(e,391))}function write_IGNOREECS(e,i){!i||!i["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(i["!ref"]))),write_record(e,650))}function write_HLINKS(e,i,s){i["!links"].forEach(function(a){if(a[1].Target){var o=add_rels(s,-1,a[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(a,o))}}),delete i["!links"]}function write_LEGACYDRAWING(e,i,s,a){if(i["!comments"].length>0){var o=add_rels(a,-1,"../drawings/vmlDrawing"+(s+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+o)),i["!legacy"]=o}}function write_AUTOFILTER(e,i,s,a){if(i["!autofilter"]){var o=i["!autofilter"],c=typeof o.ref=="string"?o.ref:encode_range(o.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var d=s.Workbook.Names,h=decode_range(c);h.s.r==h.e.r&&(h.e.r=decode_range(i["!ref"]).e.r,c=encode_range(h));for(var g=0;g<d.length;++g){var _=d[g];if(_.Name=="_xlnm._FilterDatabase"&&_.Sheet==a){_.Ref="'"+s.SheetNames[a]+"'!"+c;break}}g==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+s.SheetNames[a]+"'!"+c}),write_record(e,161,write_UncheckedRfX(safe_decode_range(c))),write_record(e,162)}}function write_WSVIEWS2(e,i,s){write_record(e,133),write_record(e,137,write_BrtBeginWsView(i,s)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,i){i["!protect"]&&write_record(e,535,write_BrtSheetProtection(i["!protect"]))}function write_ws_bin(e,i,s,a){var o=buf_array(),c=s.SheetNames[e],d=s.Sheets[c]||{},h=c;try{s&&s.Workbook&&(h=s.Workbook.Sheets[e].CodeName||h)}catch{}var g=safe_decode_range(d["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(i.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],write_record(o,129),(s.vbaraw||d["!outline"])&&write_record(o,147,write_BrtWsProp(h,d["!outline"])),write_record(o,148,write_BrtWsDim(g)),write_WSVIEWS2(o,d,s.Workbook),write_COLINFOS(o,d),write_CELLTABLE(o,d,e,i),write_SHEETPROTECT(o,d),write_AUTOFILTER(o,d,s,e),write_MERGECELLS(o,d),write_HLINKS(o,d,a),d["!margins"]&&write_record(o,476,write_BrtMargins(d["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&write_IGNOREECS(o,d),write_LEGACYDRAWING(o,d,e,a),write_record(o,130),o.end()}function parse_BrtCsProp(e,i){e.l+=10;var s=parse_XLWideString(e);return{name:s}}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,i){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return badchars.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}function check_wb_names(e,i,s){e.forEach(function(a,o){check_ws_name(a);for(var c=0;c<o;++c)if(a==e[c])throw new Error("Duplicate Sheet Name: "+a);if(s){var d=i&&i[o]&&i[o].CodeName||a;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,i,!!e.vbaraw);for(var s=0;s<e.SheetNames.length;++s)check_ws(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}function write_wb_xml(e){var i=[XML_HEADER];i[i.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var s=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(a[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),i[i.length]=writextag("workbookPr",null,a);var o=e.Workbook&&e.Workbook.Sheets||[],c=0;if(o&&o[0]&&o[0].Hidden){for(i[i.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!o[c]||!o[c].Hidden);++c);c==e.SheetNames.length&&(c=0),i[i.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',i[i.length]="</bookViews>"}for(i[i.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var d={name:escapexml(e.SheetNames[c].slice(0,31))};if(d.sheetId=""+(c+1),d["r:id"]="rId"+(c+1),o[c])switch(o[c].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}i[i.length]=writextag("sheet",null,d)}return i[i.length]="</sheets>",s&&(i[i.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(i[i.length]=writextag("definedName",escapexml(h.Ref),g))}),i[i.length]="</definedNames>"),i.length>2&&(i[i.length]="</workbook>",i[1]=i[1].replace("/>",">")),i.join("")}function parse_BrtBundleSh(e,i){var s={};return s.Hidden=e.read_shift(4),s.iTabID=e.read_shift(4),s.strRelID=parse_RelID(e),s.name=parse_XLWideString(e),s}function write_BrtBundleSh(e,i){return i||(i=new_buf(127)),i.write_shift(4,e.Hidden),i.write_shift(4,e.iTabID),write_RelID(e.strRelID,i),write_XLWideString(e.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i}function parse_BrtWbProp(e,i){var s={},a=e.read_shift(4);s.defaultThemeVersion=e.read_shift(4);var o=i>8?parse_XLWideString(e):"";return o.length>0&&(s.CodeName=o),s.autoCompressPictures=!!(a&65536),s.backupFile=!!(a&64),s.checkCompatibility=!!(a&4096),s.date1904=!!(a&1),s.filterPrivacy=!!(a&8),s.hidePivotFieldList=!!(a&1024),s.promptedSolutions=!!(a&16),s.publishItems=!!(a&2048),s.refreshAllConnections=!!(a&262144),s.saveExternalLinkValues=!!(a&128),s.showBorderUnselectedTables=!!(a&4),s.showInkAnnotation=!!(a&32),s.showObjects=["all","placeholders","none"][a>>13&3],s.showPivotChartFilter=!!(a&32768),s.updateLinks=["userSet","never","always"][a>>8&3],s}function write_BrtWbProp(e,i){i||(i=new_buf(72));var s=0;return e&&e.filterPrivacy&&(s|=8),i.write_shift(4,s),i.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",i),i.slice(0,i.l)}function parse_BrtName(e,i,s){var a=e.l+i;e.l+=4,e.l+=1;var o=e.read_shift(4),c=parse_XLNameWideString(e),d=parse_XLSBNameParsedFormula(e,0,s),h=parse_XLNullableWideString(e);e.l=a;var g={Name:c,Ptg:d};return o<268435455&&(g.Sheet=o),h&&(g.Comment=h),g}function write_BUNDLESHS(e,i){write_record(e,143);for(var s=0;s!=i.SheetNames.length;++s){var a=i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[s]&&i.Workbook.Sheets[s].Hidden||0,o={Hidden:a,iTabID:s+1,strRelID:"rId"+(s+1),name:i.SheetNames[s]};write_record(e,156,write_BrtBundleSh(o))}write_record(e,144)}function write_BrtFileVersion(e,i){i||(i=new_buf(127));for(var s=0;s!=4;++s)i.write_shift(4,0);return write_XLWideString("SheetJS",i),write_XLWideString(XLSX.version,i),write_XLWideString(XLSX.version,i),write_XLWideString("7262",i),i.length>i.l?i.slice(0,i.l):i}function write_BrtBookView(e,i){i||(i=new_buf(29)),i.write_shift(-4,0),i.write_shift(-4,460),i.write_shift(4,28800),i.write_shift(4,17600),i.write_shift(4,500),i.write_shift(4,e),i.write_shift(4,e);var s=120;return i.write_shift(1,s),i.length>i.l?i.slice(0,i.l):i}function write_BOOKVIEWS(e,i){if(!(!i.Workbook||!i.Workbook.Sheets)){for(var s=i.Workbook.Sheets,a=0,o=-1,c=-1;a<s.length;++a)!s[a]||!s[a].Hidden&&o==-1?o=a:s[a].Hidden==1&&c==-1&&(c=a);c>o||(write_record(e,135),write_record(e,158,write_BrtBookView(o)),write_record(e,136))}}function write_wb_bin(e,i){var s=buf_array();return write_record(s,131),write_record(s,128,write_BrtFileVersion()),write_record(s,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(s,e),write_BUNDLESHS(s,e),write_record(s,132),s.end()}function write_wb(e,i,s){return(i.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,i,s,a,o){return(i.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,s,a,o)}function write_sty(e,i,s){return(i.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,s)}function write_sst(e,i,s){return(i.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,s)}function write_cmnt(e,i,s){return(i.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}function write_props_xlml(e,i){var s=[];return e.Props&&s.push(xlml_write_docprops(e.Props,i)),e.Custprops&&s.push(xlml_write_custprops(e.Props,e.Custprops)),s.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,i){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return i.cellXfs.forEach(function(a,o){var c=[];c.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[a.numFmtId])}));var d={"ss:ID":"s"+(21+o)};s.push(writextag("Style",c.join(""),d))}),writextag("Styles",s.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var i=e.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||s.push(write_name_xlml(o)))}return writextag("Names",s.join(""))}function write_ws_xlml_names(e,i,s,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var o=a.Workbook.Names,c=[],d=0;d<o.length;++d){var h=o[d];h.Sheet==s&&(h.Name.match(/^_xlfn\./)||c.push(write_name_xlml(h)))}return c.join("")}function write_ws_xlml_wsopts(e,i,s,a){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[s])if(a.Workbook.Sheets[s].Hidden)o.push(writextag("Visible",a.Workbook.Sheets[s].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<s&&!(a.Workbook.Sheets[c]&&!a.Workbook.Sheets[c].Hidden);++c);c==s&&o.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(writetag("ProtectContents","True")),e["!protect"].objects&&o.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&o.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){e["!protect"][d[0]]&&o.push("<"+d[1]+"/>")})),o.length==0?"":writextag("WorksheetOptions",o.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(i){var s=xlml_unfixstr(i.t||""),a=writextag("ss:Data",s,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",a,{"ss:Author":i.a})}).join("")}function write_ws_xlml_cell(e,i,s,a,o,c,d){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+escapexml(a1_to_rc(e.f,d))),e.F&&e.F.slice(0,i.length)==i){var g=decode_cell(e.F.slice(i.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==d.r?"":"["+(g.r-d.r)+"]")+"C"+(g.c==d.c?"":"["+(g.c-d.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),s["!merges"])for(var _=s["!merges"],b=0;b!=_.length;++b)_[b].s.c!=d.c||_[b].s.r!=d.r||(_[b].e.c>_[b].s.c&&(h["ss:MergeAcross"]=_[b].e.c-_[b].s.c),_[b].e.r>_[b].s.r&&(h["ss:MergeDown"]=_[b].e.r-_[b].s.r));var tt="",_e="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":tt="Number",_e=String(e.v);break;case"b":tt="Boolean",_e=e.v?"1":"0";break;case"e":tt="Error",_e=BErr[e.v];break;case"d":tt="DateTime",_e=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":tt="String",_e=escapexlml(e.v||"");break}var rt=get_cell_style(a.cellXfs,e,a);h["ss:StyleID"]="s"+(21+rt),h["ss:Index"]=d.c+1;var it=e.v!=null?_e:"",et=e.t=="z"?"":'<Data ss:Type="'+tt+'">'+it+"</Data>";return(e.c||[]).length>0&&(et+=write_ws_xlml_comment(e.c)),writextag("Cell",et,h)}function write_ws_xlml_row(e,i){var s='<Row ss:Index="'+(e+1)+'"';return i&&(i.hpt&&!i.hpx&&(i.hpx=pt2px(i.hpt)),i.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+i.hpx+'"'),i.hidden&&(s+=' ss:Hidden="1"')),s+">"}function write_ws_xlml_table(e,i,s,a){if(!e["!ref"])return"";var o=safe_decode_range(e["!ref"]),c=e["!merges"]||[],d=0,h=[];e["!cols"]&&e["!cols"].forEach(function(nt,at){process_col(nt);var st=!!nt.width,ot=col_obj_w(at,nt),pt={"ss:Index":at+1};st&&(pt["ss:Width"]=width2px(ot.width)),nt.hidden&&(pt["ss:Hidden"]="1"),h.push(writextag("Column",null,pt))});for(var g=Array.isArray(e),_=o.s.r;_<=o.e.r;++_){for(var b=[write_ws_xlml_row(_,(e["!rows"]||[])[_])],tt=o.s.c;tt<=o.e.c;++tt){var _e=!1;for(d=0;d!=c.length;++d)if(!(c[d].s.c>tt)&&!(c[d].s.r>_)&&!(c[d].e.c<tt)&&!(c[d].e.r<_)){(c[d].s.c!=tt||c[d].s.r!=_)&&(_e=!0);break}if(!_e){var rt={r:_,c:tt},it=encode_cell(rt),et=g?(e[_]||[])[tt]:e[it];b.push(write_ws_xlml_cell(et,it,e,i,s,a,rt))}}b.push("</Row>"),b.length>2&&h.push(b.join(""))}return h.join("")}function write_ws_xlml(e,i,s){var a=[],o=s.SheetNames[e],c=s.Sheets[o],d=c?write_ws_xlml_names(c,i,e,s):"";return d.length>0&&a.push("<Names>"+d+"</Names>"),d=c?write_ws_xlml_table(c,i,e,s):"",d.length>0&&a.push("<Table>"+d+"</Table>"),a.push(write_ws_xlml_wsopts(c,i,e,s)),a.join("")}function write_xlml(e,i){i||(i={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF,i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(write_props_xlml(e,i)),s.push(write_wb_xlml()),s.push(""),s.push("");for(var a=0;a<e.SheetNames.length;++a)s.push(writextag("Worksheet",write_ws_xlml(a,i,e),{"ss:Name":escapexml(e.SheetNames[a])}));return s[2]=write_sty_xlml(e,i),s[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",s.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function write_xls_props(e,i){var s=[],a=[],o=[],c=0,d,h=evert_key(DocSummaryPIDDSI,"n"),g=evert_key(SummaryPIDSI,"n");if(e.Props)for(d=keys(e.Props),c=0;c<d.length;++c)(Object.prototype.hasOwnProperty.call(h,d[c])?s:Object.prototype.hasOwnProperty.call(g,d[c])?a:o).push([d[c],e.Props[d[c]]]);if(e.Custprops)for(d=keys(e.Custprops),c=0;c<d.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},d[c])||(Object.prototype.hasOwnProperty.call(h,d[c])?s:Object.prototype.hasOwnProperty.call(g,d[c])?a:o).push([d[c],e.Custprops[d[c]]]);var _=[];for(c=0;c<o.length;++c)XLSPSSkip.indexOf(o[c][0])>-1||PseudoPropsPairs.indexOf(o[c][0])>-1||o[c][1]!=null&&_.push(o[c]);a.length&&CFB.utils.cfb_add(i,"/SummaryInformation",write_PropertySetStream(a,PSCLSID.SI,g,SummaryPIDSI)),(s.length||_.length)&&CFB.utils.cfb_add(i,"/DocumentSummaryInformation",write_PropertySetStream(s,PSCLSID.DSI,h,DocSummaryPIDDSI,_.length?_:null,PSCLSID.UDI))}function write_xlscfb(e,i){var s=i||{},a=CFB.utils.cfb_new({root:"R"}),o="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":o="/Workbook",s.biff=8;break;case"biff5":o="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return CFB.utils.cfb_add(a,o,write_biff_buf(e,s)),s.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,a),s.biff==8&&e.vbaraw&&fill_vba_xls(a,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function write_biff_rec(e,i,s,a){var o=i;if(!isNaN(o)){var c=a||(s||[]).length||0,d=e.next(4);d.write_shift(2,o),d.write_shift(2,c),c>0&&is_buf(s)&&e.push(s)}}function write_biff_continue(e,i,s,a){var o=(s||[]).length||0;if(o<=8224)return write_biff_rec(e,i,s,o);var c=i;if(!isNaN(c)){for(var d=s.parts||[],h=0,g=0,_=0;_+(d[h]||8224)<=8224;)_+=d[h]||8224,h++;var b=e.next(4);for(b.write_shift(2,c),b.write_shift(2,_),e.push(s.slice(g,g+_)),g+=_;g<o;){for(b=e.next(4),b.write_shift(2,60),_=0;_+(d[h]||8224)<=8224;)_+=d[h]||8224,h++;b.write_shift(2,_),e.push(s.slice(g,g+_)),g+=_}}}function write_BIFF2Cell(e,i,s){return e||(e=new_buf(7)),e.write_shift(2,i),e.write_shift(2,s),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,i,s,a){var o=new_buf(9);return write_BIFF2Cell(o,e,i),write_Bes(s,a||"b",o),o}function write_BIFF2LABEL(e,i,s){var a=new_buf(8+2*s.length);return write_BIFF2Cell(a,e,i),a.write_shift(1,s.length),a.write_shift(s.length,s,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function write_ws_biff2_cell(e,i,s,a){if(i.v!=null)switch(i.t){case"d":case"n":var o=i.t=="d"?datenum(parseDate(i.v)):i.v;o==(o|0)&&o>=0&&o<65536?write_biff_rec(e,2,write_BIFF2INT(s,a,o)):write_biff_rec(e,3,write_BIFF2NUM(s,a,o));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(s,a,i.v,i.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(s,a,(i.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,s,a))}function write_ws_biff2(e,i,s,a){var o=Array.isArray(i),c=safe_decode_range(i["!ref"]||"A1"),d,h="",g=[];if(c.e.c>255||c.e.r>16383){if(a.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),d=encode_range(c)}for(var _=c.s.r;_<=c.e.r;++_){h=encode_row(_);for(var b=c.s.c;b<=c.e.c;++b){_===c.s.r&&(g[b]=encode_col(b)),d=g[b]+h;var tt=o?(i[_]||[])[b]:i[d];tt&&write_ws_biff2_cell(e,tt,_,b)}}}function write_biff2_buf(e,i){for(var s=i||{},a=buf_array(),o=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==s.sheet&&(o=c);if(o==0&&s.sheet&&e.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return write_biff_rec(a,s.biff==4?1033:s.biff==3?521:9,write_BOF(e,16,s)),write_ws_biff2(a,e.Sheets[e.SheetNames[o]],o,s),write_biff_rec(a,10),a.end()}function write_FONTS_biff8(e,i,s){write_biff_rec(e,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},s))}function write_FMTS_biff8(e,i,s){i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)i[o]!=null&&write_biff_rec(e,1054,write_Format(o,i[o],s))})}function write_FEAT(e,i){var s=new_buf(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),write_biff_rec(e,2151,s),s=new_buf(39),s.write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),write_Ref8U(safe_decode_range(i["!ref"]||"A1"),s),s.write_shift(4,4),write_biff_rec(e,2152,s)}function write_CELLXFS_biff8(e,i){for(var s=0;s<16;++s)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,i));i.cellXfs.forEach(function(a){write_biff_rec(e,224,write_XF(a,0,i))})}function write_ws_biff8_hlinks(e,i){for(var s=0;s<i["!links"].length;++s){var a=i["!links"][s];write_biff_rec(e,440,write_HLink(a)),a[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(a))}delete i["!links"]}function write_ws_cols_biff8(e,i){if(i){var s=0;i.forEach(function(a,o){++s<=256&&a&&write_biff_rec(e,125,write_ColInfo(col_obj_w(o,a),o))})}}function write_ws_biff8_cell(e,i,s,a,o){var c=16+get_cell_style(o.cellXfs,i,o);if(i.v==null&&!i.bf){write_biff_rec(e,513,write_XLSCell(s,a,c));return}if(i.bf)write_biff_rec(e,6,write_Formula(i,s,a,o,c));else switch(i.t){case"d":case"n":var d=i.t=="d"?datenum(parseDate(i.v)):i.v;write_biff_rec(e,515,write_Number(s,a,d,c));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(s,a,i.v,c,o,i.t));break;case"s":case"str":if(o.bookSST){var h=get_sst_id(o.Strings,i.v,o.revStrings);write_biff_rec(e,253,write_LabelSst(s,a,h,c))}else write_biff_rec(e,516,write_Label(s,a,(i.v||"").slice(0,255),c,o));break;default:write_biff_rec(e,513,write_XLSCell(s,a,c))}}function write_ws_biff8(e,i,s){var a=buf_array(),o=s.SheetNames[e],c=s.Sheets[o]||{},d=(s||{}).Workbook||{},h=(d.Sheets||[])[e]||{},g=Array.isArray(c),_=i.biff==8,b,tt="",_e=[],rt=safe_decode_range(c["!ref"]||"A1"),it=_?65536:16384;if(rt.e.c>255||rt.e.r>=it){if(i.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");rt.e.c=Math.min(rt.e.c,255),rt.e.r=Math.min(rt.e.c,it-1)}write_biff_rec(a,2057,write_BOF(s,16,i)),write_biff_rec(a,13,writeuint16(1)),write_biff_rec(a,12,writeuint16(100)),write_biff_rec(a,15,writebool(!0)),write_biff_rec(a,17,writebool(!1)),write_biff_rec(a,16,write_Xnum(.001)),write_biff_rec(a,95,writebool(!0)),write_biff_rec(a,42,writebool(!1)),write_biff_rec(a,43,writebool(!1)),write_biff_rec(a,130,writeuint16(1)),write_biff_rec(a,128,write_Guts()),write_biff_rec(a,131,writebool(!1)),write_biff_rec(a,132,writebool(!1)),_&&write_ws_cols_biff8(a,c["!cols"]),write_biff_rec(a,512,write_Dimensions(rt,i)),_&&(c["!links"]=[]);for(var et=rt.s.r;et<=rt.e.r;++et){tt=encode_row(et);for(var nt=rt.s.c;nt<=rt.e.c;++nt){et===rt.s.r&&(_e[nt]=encode_col(nt)),b=_e[nt]+tt;var at=g?(c[et]||[])[nt]:c[b];at&&(write_ws_biff8_cell(a,at,et,nt,i),_&&at.l&&c["!links"].push([b,at.l]))}}var st=h.CodeName||h.name||o;return _&&write_biff_rec(a,574,write_Window2((d.Views||[])[0])),_&&(c["!merges"]||[]).length&&write_biff_rec(a,229,write_MergeCells(c["!merges"])),_&&write_ws_biff8_hlinks(a,c),write_biff_rec(a,442,write_XLUnicodeString(st)),_&&write_FEAT(a,c),write_biff_rec(a,10),a.end()}function write_biff8_global(e,i,s){var a=buf_array(),o=(e||{}).Workbook||{},c=o.Sheets||[],d=o.WBProps||{},h=s.biff==8,g=s.biff==5;if(write_biff_rec(a,2057,write_BOF(e,5,s)),s.bookType=="xla"&&write_biff_rec(a,135),write_biff_rec(a,225,h?writeuint16(1200):null),write_biff_rec(a,193,writezeroes(2)),g&&write_biff_rec(a,191),g&&write_biff_rec(a,192),write_biff_rec(a,226),write_biff_rec(a,92,write_WriteAccess("SheetJS",s)),write_biff_rec(a,66,writeuint16(h?1200:1252)),h&&write_biff_rec(a,353,writeuint16(0)),h&&write_biff_rec(a,448),write_biff_rec(a,317,write_RRTabId(e.SheetNames.length)),h&&e.vbaraw&&write_biff_rec(a,211),h&&e.vbaraw){var _=d.CodeName||"ThisWorkbook";write_biff_rec(a,442,write_XLUnicodeString(_))}write_biff_rec(a,156,writeuint16(17)),write_biff_rec(a,25,writebool(!1)),write_biff_rec(a,18,writebool(!1)),write_biff_rec(a,19,writeuint16(0)),h&&write_biff_rec(a,431,writebool(!1)),h&&write_biff_rec(a,444,writeuint16(0)),write_biff_rec(a,61,write_Window1()),write_biff_rec(a,64,writebool(!1)),write_biff_rec(a,141,writeuint16(0)),write_biff_rec(a,34,writebool(safe1904(e)=="true")),write_biff_rec(a,14,writebool(!0)),h&&write_biff_rec(a,439,writebool(!1)),write_biff_rec(a,218,writeuint16(0)),write_FONTS_biff8(a,e,s),write_FMTS_biff8(a,e.SSF,s),write_CELLXFS_biff8(a,s),h&&write_biff_rec(a,352,writebool(!1));var b=a.end(),tt=buf_array();h&&write_biff_rec(tt,140,write_Country()),h&&s.Strings&&write_biff_continue(tt,252,write_SST(s.Strings)),write_biff_rec(tt,10);var _e=tt.end(),rt=buf_array(),it=0,et=0;for(et=0;et<e.SheetNames.length;++et)it+=(h?12:11)+(h?2:1)*e.SheetNames[et].length;var nt=b.length+it+_e.length;for(et=0;et<e.SheetNames.length;++et){var at=c[et]||{};write_biff_rec(rt,133,write_BoundSheet8({pos:nt,hs:at.Hidden||0,dt:0,name:e.SheetNames[et]},s)),nt+=i[et].length}var st=rt.end();if(it!=st.length)throw new Error("BS8 "+it+" != "+st.length);var ot=[];return b.length&&ot.push(b),st.length&&ot.push(st),_e.length&&ot.push(_e),bconcat(ot)}function write_biff8_buf(e,i){var s=i||{},a=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),s.revssf=evert_num(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,fix_write_opts(s),s.cellXfs=[],get_cell_style(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)a[a.length]=write_ws_biff8(o,s,e);return a.unshift(write_biff8_global(e,a,s)),bconcat(a)}function write_biff_buf(e,i){for(var s=0;s<=e.SheetNames.length;++s){var a=e.Sheets[e.SheetNames[s]];if(!(!a||!a["!ref"])){var o=decode_range(a["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[s]+"' extends beyond column IV (255).  Data may be lost.")}}var c=i||{};switch(c.biff||2){case 8:case 5:return write_biff8_buf(e,i);case 4:case 3:case 2:return write_biff2_buf(e,i)}throw new Error("invalid type "+c.bookType+" for BIFF")}function make_html_row(e,i,s,a){for(var o=e["!merges"]||[],c=[],d=i.s.c;d<=i.e.c;++d){for(var h=0,g=0,_=0;_<o.length;++_)if(!(o[_].s.r>s||o[_].s.c>d)&&!(o[_].e.r<s||o[_].e.c<d)){if(o[_].s.r<s||o[_].s.c<d){h=-1;break}h=o[_].e.r-o[_].s.r+1,g=o[_].e.c-o[_].s.c+1;break}if(!(h<0)){var b=encode_cell({r:s,c:d}),tt=a.dense?(e[s]||[])[d]:e[b],_e=tt&&tt.v!=null&&(tt.h||escapehtml(tt.w||(format_cell(tt),tt.w)||""))||"",rt={};h>1&&(rt.rowspan=h),g>1&&(rt.colspan=g),a.editable?_e='<span contenteditable="true">'+_e+"</span>":tt&&(rt["data-t"]=tt&&tt.t||"z",tt.v!=null&&(rt["data-v"]=tt.v),tt.z!=null&&(rt["data-z"]=tt.z),tt.l&&(tt.l.Target||"#").charAt(0)!="#"&&(_e='<a href="'+tt.l.Target+'">'+_e+"</a>")),rt.id=(a.id||"sjs")+"-"+b,c.push(writextag("td",_e,rt))}}var it="<tr>";return it+c.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function make_html_preamble(e,i,s){var a=[];return a.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function sheet_to_html(e,i){var s=i||{},a=s.header!=null?s.header:HTML_BEGIN,o=s.footer!=null?s.footer:HTML_END,c=[a],d=decode_range(e["!ref"]);s.dense=Array.isArray(e),c.push(make_html_preamble(e,d,s));for(var h=d.s.r;h<=d.e.r;++h)c.push(make_html_row(e,d,h,s));return c.push("</table>"+o),c.join("")}function sheet_add_dom(e,i,s){var a=s||{},o=0,c=0;if(a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?decode_cell(a.origin):a.origin;o=d.r,c=d.c}var h=i.getElementsByTagName("tr"),g=Math.min(a.sheetRows||1e7,h.length),_={s:{r:0,c:0},e:{r:o,c}};if(e["!ref"]){var b=decode_range(e["!ref"]);_.s.r=Math.min(_.s.r,b.s.r),_.s.c=Math.min(_.s.c,b.s.c),_.e.r=Math.max(_.e.r,b.e.r),_.e.c=Math.max(_.e.c,b.e.c),o==-1&&(_.e.r=o=b.e.r+1)}var tt=[],_e=0,rt=e["!rows"]||(e["!rows"]=[]),it=0,et=0,nt=0,at=0,st=0,ot=0;for(e["!cols"]||(e["!cols"]=[]);it<h.length&&et<g;++it){var pt=h[it];if(is_dom_element_hidden(pt)){if(a.display)continue;rt[et]={hidden:!0}}var dt=pt.children;for(nt=at=0;nt<dt.length;++nt){var wt=dt[nt];if(!(a.display&&is_dom_element_hidden(wt))){var lt=wt.hasAttribute("data-v")?wt.getAttribute("data-v"):wt.hasAttribute("v")?wt.getAttribute("v"):htmldecode(wt.innerHTML),gt=wt.getAttribute("data-z")||wt.getAttribute("z");for(_e=0;_e<tt.length;++_e){var vt=tt[_e];vt.s.c==at+c&&vt.s.r<et+o&&et+o<=vt.e.r&&(at=vt.e.c+1-c,_e=-1)}ot=+wt.getAttribute("colspan")||1,((st=+wt.getAttribute("rowspan")||1)>1||ot>1)&&tt.push({s:{r:et+o,c:at+c},e:{r:et+o+(st||1)-1,c:at+c+(ot||1)-1}});var At={t:"s",v:lt},yt=wt.getAttribute("data-t")||wt.getAttribute("t")||"";lt!=null&&(lt.length==0?At.t=yt||"z":a.raw||lt.trim().length==0||yt=="s"||(lt==="TRUE"?At={t:"b",v:!0}:lt==="FALSE"?At={t:"b",v:!1}:isNaN(fuzzynum(lt))?isNaN(fuzzydate(lt).getDate())||(At={t:"d",v:parseDate(lt)},a.cellDates||(At={t:"n",v:datenum(At.v)}),At.z=a.dateNF||table_fmt[14]):At={t:"n",v:fuzzynum(lt)})),At.z===void 0&&gt!=null&&(At.z=gt);var bt="",Tt=wt.getElementsByTagName("A");if(Tt&&Tt.length)for(var er=0;er<Tt.length&&!(Tt[er].hasAttribute("href")&&(bt=Tt[er].getAttribute("href"),bt.charAt(0)!="#"));++er);bt&&bt.charAt(0)!="#"&&(At.l={Target:bt}),a.dense?(e[et+o]||(e[et+o]=[]),e[et+o][at+c]=At):e[encode_cell({c:at+c,r:et+o})]=At,_.e.c<at+c&&(_.e.c=at+c),at+=ot}}++et}return tt.length&&(e["!merges"]=(e["!merges"]||[]).concat(tt)),_.e.r=Math.max(_.e.r,et-1+o),e["!ref"]=encode_range(_),et>=g&&(e["!fullref"]=encode_range((_.e.r=h.length-it+et-1+o,_))),e}function parse_dom_table(e,i){var s=i||{},a=s.dense?[]:{};return sheet_add_dom(a,e,i)}function table_to_book(e,i){return sheet_to_workbook(parse_dom_table(e,i),i)}function is_dom_element_hidden(e){var i="",s=get_get_computed_style_function(e);return s&&(i=s(e).getPropertyValue("display")),i||(i=e.style&&e.style.display),i==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),i="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+i}}(),write_content_ods=function(){var e=function(c){return escapexml(c).replace(/  +/g,function(d){return'<text:s text:c="'+d.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},i=`          <table:table-cell />
`,s=`          <table:covered-table-cell/>
`,a=function(c,d,h){var g=[];g.push('      <table:table table:name="'+escapexml(d.SheetNames[h])+`" table:style-name="ta1">
`);var _=0,b=0,tt=decode_range(c["!ref"]||"A1"),_e=c["!merges"]||[],rt=0,it=Array.isArray(c);if(c["!cols"])for(b=0;b<=tt.e.c;++b)g.push("        <table:table-column"+(c["!cols"][b]?' table:style-name="co'+c["!cols"][b].ods+'"':"")+`></table:table-column>
`);var et="",nt=c["!rows"]||[];for(_=0;_<tt.s.r;++_)et=nt[_]?' table:style-name="ro'+nt[_].ods+'"':"",g.push("        <table:table-row"+et+`></table:table-row>
`);for(;_<=tt.e.r;++_){for(et=nt[_]?' table:style-name="ro'+nt[_].ods+'"':"",g.push("        <table:table-row"+et+`>
`),b=0;b<tt.s.c;++b)g.push(i);for(;b<=tt.e.c;++b){var at=!1,st={},ot="";for(rt=0;rt!=_e.length;++rt)if(!(_e[rt].s.c>b)&&!(_e[rt].s.r>_)&&!(_e[rt].e.c<b)&&!(_e[rt].e.r<_)){(_e[rt].s.c!=b||_e[rt].s.r!=_)&&(at=!0),st["table:number-columns-spanned"]=_e[rt].e.c-_e[rt].s.c+1,st["table:number-rows-spanned"]=_e[rt].e.r-_e[rt].s.r+1;break}if(at){g.push(s);continue}var pt=encode_cell({r:_,c:b}),dt=it?(c[_]||[])[b]:c[pt];if(dt&&dt.f&&(st["table:formula"]=escapexml(csf_to_ods_formula(dt.f)),dt.F&&dt.F.slice(0,pt.length)==pt)){var wt=decode_range(dt.F);st["table:number-matrix-columns-spanned"]=wt.e.c-wt.s.c+1,st["table:number-matrix-rows-spanned"]=wt.e.r-wt.s.r+1}if(!dt){g.push(i);continue}switch(dt.t){case"b":ot=dt.v?"TRUE":"FALSE",st["office:value-type"]="boolean",st["office:boolean-value"]=dt.v?"true":"false";break;case"n":ot=dt.w||String(dt.v||0),st["office:value-type"]="float",st["office:value"]=dt.v||0;break;case"s":case"str":ot=dt.v==null?"":dt.v,st["office:value-type"]="string";break;case"d":ot=dt.w||parseDate(dt.v).toISOString(),st["office:value-type"]="date",st["office:date-value"]=parseDate(dt.v).toISOString(),st["table:style-name"]="ce1";break;default:g.push(i);continue}var lt=e(ot);if(dt.l&&dt.l.Target){var gt=dt.l.Target;gt=gt.charAt(0)=="#"?"#"+csf_to_ods_3D(gt.slice(1)):gt,gt.charAt(0)!="#"&&!gt.match(/^\w+:/)&&(gt="../"+gt),lt=writextag("text:a",lt,{"xlink:href":gt.replace(/&/g,"&amp;")})}g.push("          "+writextag("table:table-cell",writextag("text:p",lt,{}),st)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},o=function(c,d){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var h=0;d.SheetNames.map(function(_){return d.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var b=0;b<_["!cols"].length;++b)if(_["!cols"][b]){var tt=_["!cols"][b];if(tt.width==null&&tt.wpx==null&&tt.wch==null)continue;process_col(tt),tt.ods=h;var _e=_["!cols"][b].wpx+"px";c.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_e+`"/>
`),c.push(`  </style:style>
`),++h}}});var g=0;d.SheetNames.map(function(_){return d.Sheets[_]}).forEach(function(_){if(_&&_["!rows"]){for(var b=0;b<_["!rows"].length;++b)if(_["!rows"][b]){_["!rows"][b].ods=g;var tt=_["!rows"][b].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+tt+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(d,h){var g=[XML_HEADER],_=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),b=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+_+b+`>
`),g.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+_+`>
`),o(g,d),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var tt=0;tt!=d.SheetNames.length;++tt)g.push(a(d.Sheets[d.SheetNames[tt]],d,tt));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}}();function write_ods(e,i){if(i.bookType=="fods")return write_content_ods(e,i);var s=zip_new(),a="",o=[],c=[];return a="mimetype",zip_add_file(s,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",zip_add_file(s,a,write_content_ods(e,i)),o.push([a,"text/xml"]),c.push([a,"ContentFile"]),a="styles.xml",zip_add_file(s,a,write_styles_ods(e,i)),o.push([a,"text/xml"]),c.push([a,"StylesFile"]),a="meta.xml",zip_add_file(s,a,XML_HEADER+write_meta_ods()),o.push([a,"text/xml"]),c.push([a,"MetadataFile"]),a="manifest.rdf",zip_add_file(s,a,write_rdf(c)),o.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",zip_add_file(s,a,write_manifest(o)),s}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,i){e:for(var s=0;s<=e.length-i.length;++s){for(var a=0;a<i.length;++a)if(e[s+a]!=i[a])continue e;return!0}return!1}function u8concat(e){var i=e.reduce(function(o,c){return o+c.length},0),s=new Uint8Array(i),a=0;return e.forEach(function(o){s.set(o,a),a+=o.length}),s}function writeDecimal128LE(e,i,s){var a=Math.floor(s==0?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,o=s/Math.pow(10,a-6176);e[i+15]|=a>>7,e[i+14]|=(a&127)<<1;for(var c=0;o>=1;++c,o/=256)e[i+c]=o&255;e[i+15]|=s>=0?0:128}function parse_varint49(e,i){var s=i?i[0]:0,a=e[s]&127;e:if(e[s++]>=128&&(a|=(e[s]&127)<<7,e[s++]<128||(a|=(e[s]&127)<<14,e[s++]<128)||(a|=(e[s]&127)<<21,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,28),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,35),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,42),++s,e[s++]<128)))break e;return i&&(i[0]=s),a}function write_varint49(e){var i=new Uint8Array(7);i[0]=e&127;var s=1;e:if(e>127){if(i[s-1]|=128,i[s]=e>>7&127,++s,e<=16383||(i[s-1]|=128,i[s]=e>>14&127,++s,e<=2097151)||(i[s-1]|=128,i[s]=e>>21&127,++s,e<=268435455)||(i[s-1]|=128,i[s]=e/256>>>21&127,++s,e<=34359738367)||(i[s-1]|=128,i[s]=e/65536>>>21&127,++s,e<=4398046511103))break e;i[s-1]|=128,i[s]=e/16777216>>>21&127,++s}return i.slice(0,s)}function varint_to_i32(e){var i=0,s=e[i]&127;e:if(e[i++]>=128){if(s|=(e[i]&127)<<7,e[i++]<128||(s|=(e[i]&127)<<14,e[i++]<128)||(s|=(e[i]&127)<<21,e[i++]<128))break e;s|=(e[i]&127)<<28}return s}function parse_shallow(e){for(var i=[],s=[0];s[0]<e.length;){var a=s[0],o=parse_varint49(e,s),c=o&7;o=Math.floor(o/8);var d=0,h;if(o==0)break;switch(c){case 0:{for(var g=s[0];e[s[0]++]>=128;);h=e.slice(g,s[0])}break;case 5:d=4,h=e.slice(s[0],s[0]+d),s[0]+=d;break;case 1:d=8,h=e.slice(s[0],s[0]+d),s[0]+=d;break;case 2:d=parse_varint49(e,s),h=e.slice(s[0],s[0]+d),s[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(o," at offset ").concat(a))}var _={data:h,type:c};i[o]==null?i[o]=[_]:i[o].push(_)}return i}function write_shallow(e){var i=[];return e.forEach(function(s,a){s.forEach(function(o){o.data&&(i.push(write_varint49(a*8+o.type)),o.type==2&&i.push(write_varint49(o.data.length)),i.push(o.data))})}),u8concat(i)}function parse_iwa_file(e){for(var i,s=[],a=[0];a[0]<e.length;){var o=parse_varint49(e,a),c=parse_shallow(e.slice(a[0],a[0]+o));a[0]+=o;var d={id:varint_to_i32(c[1][0].data),messages:[]};c[2].forEach(function(h){var g=parse_shallow(h.data),_=varint_to_i32(g[3][0].data);d.messages.push({meta:g,data:e.slice(a[0],a[0]+_)}),a[0]+=_}),(i=c[3])!=null&&i[0]&&(d.merge=varint_to_i32(c[3][0].data)>>>0>0),s.push(d)}return s}function write_iwa_file(e){var i=[];return e.forEach(function(s){var a=[];a[1]=[{data:write_varint49(s.id),type:0}],a[2]=[],s.merge!=null&&(a[3]=[{data:write_varint49(+!!s.merge),type:0}]);var o=[];s.messages.forEach(function(d){o.push(d.data),d.meta[3]=[{type:0,data:write_varint49(d.data.length)}],a[2].push({data:write_shallow(d.meta),type:2})});var c=write_shallow(a);i.push(write_varint49(c.length)),i.push(c),o.forEach(function(d){return i.push(d)})}),u8concat(i)}function parse_snappy_chunk(e,i){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var s=[0],a=parse_varint49(i,s),o=[];s[0]<i.length;){var c=i[s[0]]&3;if(c==0){var d=i[s[0]++]>>2;if(d<60)++d;else{var h=d-59;d=i[s[0]],h>1&&(d|=i[s[0]+1]<<8),h>2&&(d|=i[s[0]+2]<<16),h>3&&(d|=i[s[0]+3]<<24),d>>>=0,d++,s[0]+=h}o.push(i.slice(s[0],s[0]+d)),s[0]+=d;continue}else{var g=0,_=0;if(c==1?(_=(i[s[0]]>>2&7)+4,g=(i[s[0]++]&224)<<3,g|=i[s[0]++]):(_=(i[s[0]++]>>2)+1,c==2?(g=i[s[0]]|i[s[0]+1]<<8,s[0]+=2):(g=(i[s[0]]|i[s[0]+1]<<8|i[s[0]+2]<<16|i[s[0]+3]<<24)>>>0,s[0]+=4)),o=[u8concat(o)],g==0)throw new Error("Invalid offset 0");if(g>o[0].length)throw new Error("Invalid offset beyond length");if(_>=g)for(o.push(o[0].slice(-g)),_-=g;_>=o[o.length-1].length;)o.push(o[o.length-1]),_-=o[o.length-1].length;o.push(o[0].slice(-g,-g+_))}}var b=u8concat(o);if(b.length!=a)throw new Error("Unexpected length: ".concat(b.length," != ").concat(a));return b}function decompress_iwa_file(e){for(var i=[],s=0;s<e.length;){var a=e[s++],o=e[s]|e[s+1]<<8|e[s+2]<<16;s+=3,i.push(parse_snappy_chunk(a,e.slice(s,s+o))),s+=o}if(s!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(i)}function compress_iwa_file(e){for(var i=[],s=0;s<e.length;){var a=Math.min(e.length-s,268435455),o=new Uint8Array(4);i.push(o);var c=write_varint49(a),d=c.length;i.push(c),a<=60?(d++,i.push(new Uint8Array([a-1<<2]))):a<=256?(d+=2,i.push(new Uint8Array([240,a-1&255]))):a<=65536?(d+=3,i.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(d+=4,i.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(d+=5,i.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),i.push(e.slice(s,s+a)),d+=a,o[0]=0,o[1]=d&255,o[2]=d>>8&255,o[3]=d>>16&255,s+=a}return u8concat(i)}function write_new_storage(e,i){var s=new Uint8Array(32),a=u8_to_dataview(s),o=12,c=0;switch(s[0]=5,e.t){case"n":s[1]=2,writeDecimal128LE(s,o,e.v),c|=1,o+=16;break;case"b":s[1]=6,a.setFloat64(o,e.v?1:0,!0),c|=2,o+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[1]=3,a.setUint32(o,i.indexOf(e.v),!0),c|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,c,!0),s.slice(0,o)}function write_old_storage(e,i){var s=new Uint8Array(32),a=u8_to_dataview(s),o=12,c=0;switch(s[0]=3,e.t){case"n":s[2]=2,a.setFloat64(o,e.v,!0),c|=32,o+=8;break;case"b":s[2]=6,a.setFloat64(o,e.v?1:0,!0),c|=32,o+=8;break;case"s":if(i.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));s[2]=3,a.setUint32(o,i.indexOf(e.v),!0),c|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,c,!0),s.slice(0,o)}function parse_TSP_Reference(e){var i=parse_shallow(e);return parse_varint49(i[1][0].data)}function write_tile_row(e,i,s){var a,o,c,d;if(!((a=e[6])!=null&&a[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var h=((d=(c=e[8])==null?void 0:c[0])==null?void 0:d.data)&&varint_to_i32(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,_=u8_to_dataview(e[7][0].data),b=0,tt=[],_e=u8_to_dataview(e[4][0].data),rt=0,it=[],et=0;et<i.length;++et){if(i[et]==null){_.setUint16(et*2,65535,!0),_e.setUint16(et*2,65535);continue}_.setUint16(et*2,b,!0),_e.setUint16(et*2,rt,!0);var nt,at;switch(typeof i[et]){case"string":nt=write_new_storage({t:"s",v:i[et]},s),at=write_old_storage({t:"s",v:i[et]},s);break;case"number":nt=write_new_storage({t:"n",v:i[et]},s),at=write_old_storage({t:"n",v:i[et]},s);break;case"boolean":nt=write_new_storage({t:"b",v:i[et]},s),at=write_old_storage({t:"b",v:i[et]},s);break;default:throw new Error("Unsupported value "+i[et])}tt.push(nt),b+=nt.length,it.push(at),rt+=at.length,++g}for(e[2][0].data=write_varint49(g);et<e[7][0].data.length/2;++et)_.setUint16(et*2,65535,!0),_e.setUint16(et*2,65535,!0);return e[6][0].data=u8concat(tt),e[3][0].data=u8concat(it),g}function write_numbers_iwa(e,i){if(!i||!i.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=decode_range(s["!ref"]);a.s.r=a.s.c=0;var o=!1;a.e.c>9&&(o=!0,a.e.c=9),a.e.r>49&&(o=!0,a.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(encode_range(a)));var c=sheet_to_json(s,{range:a,header:1}),d=["~Sh33tJ5~"];c.forEach(function(xt){return xt.forEach(function(mt){typeof mt=="string"&&d.push(mt)})});var h={},g=[],_=CFB.read(i.numbers,{type:"base64"});_.FileIndex.map(function(xt,mt){return[xt,_.FullPaths[mt]]}).forEach(function(xt){var mt=xt[0],St=xt[1];if(mt.type==2&&mt.name.match(/\.iwa/)){var Pt=mt.content,Nt=decompress_iwa_file(Pt),Lt=parse_iwa_file(Nt);Lt.forEach(function(lr){g.push(lr.id),h[lr.id]={deps:[],location:St,type:varint_to_i32(lr.messages[0].meta[1][0].data)}})}}),g.sort(function(xt,mt){return xt-mt});var b=g.filter(function(xt){return xt>1}).map(function(xt){return[xt,write_varint49(xt)]});_.FileIndex.map(function(xt,mt){return[xt,_.FullPaths[mt]]}).forEach(function(xt){var mt=xt[0];if(xt[1],!!mt.name.match(/\.iwa/)){var St=parse_iwa_file(decompress_iwa_file(mt.content));St.forEach(function(Pt){Pt.messages.forEach(function(Nt){b.forEach(function(Lt){Pt.messages.some(function(lr){return varint_to_i32(lr.meta[1][0].data)!=11006&&u8contains(lr.data,Lt[1])})&&h[Lt[0]].deps.push(Pt.id)})})})}});for(var tt=CFB.find(_,h[1].location),_e=parse_iwa_file(decompress_iwa_file(tt.content)),rt,it=0;it<_e.length;++it){var et=_e[it];et.id==1&&(rt=et)}var nt=parse_TSP_Reference(parse_shallow(rt.messages[0].data)[1][0].data);for(tt=CFB.find(_,h[nt].location),_e=parse_iwa_file(decompress_iwa_file(tt.content)),it=0;it<_e.length;++it)et=_e[it],et.id==nt&&(rt=et);for(nt=parse_TSP_Reference(parse_shallow(rt.messages[0].data)[2][0].data),tt=CFB.find(_,h[nt].location),_e=parse_iwa_file(decompress_iwa_file(tt.content)),it=0;it<_e.length;++it)et=_e[it],et.id==nt&&(rt=et);for(nt=parse_TSP_Reference(parse_shallow(rt.messages[0].data)[2][0].data),tt=CFB.find(_,h[nt].location),_e=parse_iwa_file(decompress_iwa_file(tt.content)),it=0;it<_e.length;++it)et=_e[it],et.id==nt&&(rt=et);var at=parse_shallow(rt.messages[0].data);{at[6][0].data=write_varint49(a.e.r+1),at[7][0].data=write_varint49(a.e.c+1);var st=parse_TSP_Reference(at[46][0].data),ot=CFB.find(_,h[st].location),pt=parse_iwa_file(decompress_iwa_file(ot.content));{for(var dt=0;dt<pt.length&&pt[dt].id!=st;++dt);if(pt[dt].id!=st)throw"Bad ColumnRowUIDMapArchive";var wt=parse_shallow(pt[dt].messages[0].data);wt[1]=[],wt[2]=[],wt[3]=[];for(var lt=0;lt<=a.e.c;++lt){var gt=[];gt[1]=gt[2]=[{type:0,data:write_varint49(lt+420690)}],wt[1].push({type:2,data:write_shallow(gt)}),wt[2].push({type:0,data:write_varint49(lt)}),wt[3].push({type:0,data:write_varint49(lt)})}wt[4]=[],wt[5]=[],wt[6]=[];for(var vt=0;vt<=a.e.r;++vt)gt=[],gt[1]=gt[2]=[{type:0,data:write_varint49(vt+726270)}],wt[4].push({type:2,data:write_shallow(gt)}),wt[5].push({type:0,data:write_varint49(vt)}),wt[6].push({type:0,data:write_varint49(vt)});pt[dt].messages[0].data=write_shallow(wt)}ot.content=compress_iwa_file(write_iwa_file(pt)),ot.size=ot.content.length,delete at[46];var At=parse_shallow(at[4][0].data);{At[7][0].data=write_varint49(a.e.r+1);var yt=parse_shallow(At[1][0].data),bt=parse_TSP_Reference(yt[2][0].data);ot=CFB.find(_,h[bt].location),pt=parse_iwa_file(decompress_iwa_file(ot.content));{if(pt[0].id!=bt)throw"Bad HeaderStorageBucket";var Tt=parse_shallow(pt[0].messages[0].data);for(vt=0;vt<c.length;++vt){var er=parse_shallow(Tt[2][0].data);er[1][0].data=write_varint49(vt),er[4][0].data=write_varint49(c[vt].length),Tt[2][vt]={type:Tt[2][0].type,data:write_shallow(er)}}pt[0].messages[0].data=write_shallow(Tt)}ot.content=compress_iwa_file(write_iwa_file(pt)),ot.size=ot.content.length;var zt=parse_TSP_Reference(At[2][0].data);ot=CFB.find(_,h[zt].location),pt=parse_iwa_file(decompress_iwa_file(ot.content));{if(pt[0].id!=zt)throw"Bad HeaderStorageBucket";for(Tt=parse_shallow(pt[0].messages[0].data),lt=0;lt<=a.e.c;++lt)er=parse_shallow(Tt[2][0].data),er[1][0].data=write_varint49(lt),er[4][0].data=write_varint49(a.e.r+1),Tt[2][lt]={type:Tt[2][0].type,data:write_shallow(er)};pt[0].messages[0].data=write_shallow(Tt)}ot.content=compress_iwa_file(write_iwa_file(pt)),ot.size=ot.content.length;var ar=parse_TSP_Reference(At[4][0].data);(function(){for(var xt=CFB.find(_,h[ar].location),mt=parse_iwa_file(decompress_iwa_file(xt.content)),St,Pt=0;Pt<mt.length;++Pt){var Nt=mt[Pt];Nt.id==ar&&(St=Nt)}var Lt=parse_shallow(St.messages[0].data);{Lt[3]=[];var lr=[];d.forEach(function(vr,Fr){lr[1]=[{type:0,data:write_varint49(Fr)}],lr[2]=[{type:0,data:write_varint49(1)}],lr[3]=[{type:2,data:stru8(vr)}],Lt[3].push({type:2,data:write_shallow(lr)})})}St.messages[0].data=write_shallow(Lt);var ur=write_iwa_file(mt),wr=compress_iwa_file(ur);xt.content=wr,xt.size=xt.content.length})();var Jt=parse_shallow(At[3][0].data);{var Yt=Jt[1][0];delete Jt[2];var kt=parse_shallow(Yt.data);{var ir=parse_TSP_Reference(kt[2][0].data);(function(){for(var xt=CFB.find(_,h[ir].location),mt=parse_iwa_file(decompress_iwa_file(xt.content)),St,Pt=0;Pt<mt.length;++Pt){var Nt=mt[Pt];Nt.id==ir&&(St=Nt)}var Lt=parse_shallow(St.messages[0].data);{delete Lt[6],delete Jt[7];var lr=new Uint8Array(Lt[5][0].data);Lt[5]=[];for(var ur=0,wr=0;wr<=a.e.r;++wr){var vr=parse_shallow(lr);ur+=write_tile_row(vr,c[wr],d),vr[1][0].data=write_varint49(wr),Lt[5].push({data:write_shallow(vr),type:2})}Lt[1]=[{type:0,data:write_varint49(a.e.c+1)}],Lt[2]=[{type:0,data:write_varint49(a.e.r+1)}],Lt[3]=[{type:0,data:write_varint49(ur)}],Lt[4]=[{type:0,data:write_varint49(a.e.r+1)}]}St.messages[0].data=write_shallow(Lt);var Fr=write_iwa_file(mt),Rr=compress_iwa_file(Fr);xt.content=Rr,xt.size=xt.content.length})()}Yt.data=write_shallow(kt)}At[3][0].data=write_shallow(Jt)}at[4][0].data=write_shallow(At)}rt.messages[0].data=write_shallow(at);var fr=write_iwa_file(_e),Et=compress_iwa_file(fr);return tt.content=Et,tt.size=tt.content.length,_}function fix_opts_func(e){return function(s){for(var a=0;a!=e.length;++a){var o=e[a];s[o[0]]===void 0&&(s[o[0]]=o[1]),o[2]==="n"&&(s[o[0]]=Number(s[o[0]]))}}}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function write_zip(e,i){return i.bookType=="ods"?write_ods(e,i):i.bookType=="numbers"?write_numbers_iwa(e,i):i.bookType=="xlsb"?write_zip_xlsxb(e,i):write_zip_xlsx(e,i)}function write_zip_xlsxb(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var s=i.bookType=="xlsb"?"bin":"xml",a=VBAFMTS.indexOf(i.bookType)>-1,o=new_ct();fix_write_opts(i=i||{});var c=zip_new(),d="",h=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",zip_add_file(c,d,write_core_props(e.Props,i)),o.coreprops.push(d),add_rels(i.rels,2,d,RELS.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,d,write_ext_props(e.Props)),o.extprops.push(d),add_rels(i.rels,3,d,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(d="docProps/custom.xml",zip_add_file(c,d,write_cust_props(e.Custprops)),o.custprops.push(d),add_rels(i.rels,4,d,RELS.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var b={"!id":{}},tt=e.Sheets[e.SheetNames[h-1]],_e=(tt||{})["!type"]||"sheet";switch(_e){case"chart":default:d="xl/worksheets/sheet"+h+"."+s,zip_add_file(c,d,write_ws(h-1,d,i,e,b)),o.sheets.push(d),add_rels(i.wbrels,-1,"worksheets/sheet"+h+"."+s,RELS.WS[0])}if(tt){var rt=tt["!comments"],it=!1,et="";rt&&rt.length>0&&(et="xl/comments"+h+"."+s,zip_add_file(c,et,write_cmnt(rt,et)),o.comments.push(et),add_rels(b,-1,"../comments"+h+"."+s,RELS.CMNT),it=!0),tt["!legacy"]&&it&&zip_add_file(c,"xl/drawings/vmlDrawing"+h+".vml",write_comments_vml(h,tt["!comments"])),delete tt["!comments"],delete tt["!legacy"]}b["!id"].rId1&&zip_add_file(c,get_rels_path(d),write_rels(b))}return i.Strings!=null&&i.Strings.length>0&&(d="xl/sharedStrings."+s,zip_add_file(c,d,write_sst(i.Strings,d,i)),o.strs.push(d),add_rels(i.wbrels,-1,"sharedStrings."+s,RELS.SST)),d="xl/workbook."+s,zip_add_file(c,d,write_wb(e,d)),o.workbooks.push(d),add_rels(i.rels,1,d,RELS.WB),d="xl/theme/theme1.xml",zip_add_file(c,d,write_theme(e.Themes,i)),o.themes.push(d),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),d="xl/styles."+s,zip_add_file(c,d,write_sty(e,d,i)),o.styles.push(d),add_rels(i.wbrels,-1,"styles."+s,RELS.STY),e.vbaraw&&a&&(d="xl/vbaProject.bin",zip_add_file(c,d,e.vbaraw),o.vba.push(d),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),d="xl/metadata."+s,zip_add_file(c,d,write_xlmeta(d)),o.metadata.push(d),add_rels(i.wbrels,-1,"metadata."+s,RELS.XLMETA),zip_add_file(c,"[Content_Types].xml",write_ct(o,i)),zip_add_file(c,"_rels/.rels",write_rels(i.rels)),zip_add_file(c,"xl/_rels/workbook."+s+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,c}function write_zip_xlsx(e,i){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),i.revssf=evert_num(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,browser_has_Map?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var s="xml",a=VBAFMTS.indexOf(i.bookType)>-1,o=new_ct();fix_write_opts(i=i||{});var c=zip_new(),d="",h=0;if(i.cellXfs=[],get_cell_style(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",zip_add_file(c,d,write_core_props(e.Props,i)),o.coreprops.push(d),add_rels(i.rels,2,d,RELS.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],_=0;_<e.SheetNames.length;++_)(e.Workbook.Sheets[_]||{}).Hidden!=2&&g.push(e.SheetNames[_]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(c,d,write_ext_props(e.Props)),o.extprops.push(d),add_rels(i.rels,3,d,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(d="docProps/custom.xml",zip_add_file(c,d,write_cust_props(e.Custprops)),o.custprops.push(d),add_rels(i.rels,4,d,RELS.CUST_PROPS));var b=["SheetJ5"];for(i.tcid=0,h=1;h<=e.SheetNames.length;++h){var tt={"!id":{}},_e=e.Sheets[e.SheetNames[h-1]],rt=(_e||{})["!type"]||"sheet";switch(rt){case"chart":default:d="xl/worksheets/sheet"+h+"."+s,zip_add_file(c,d,write_ws_xml(h-1,i,e,tt)),o.sheets.push(d),add_rels(i.wbrels,-1,"worksheets/sheet"+h+"."+s,RELS.WS[0])}if(_e){var it=_e["!comments"],et=!1,nt="";if(it&&it.length>0){var at=!1;it.forEach(function(st){st[1].forEach(function(ot){ot.T==!0&&(at=!0)})}),at&&(nt="xl/threadedComments/threadedComment"+h+"."+s,zip_add_file(c,nt,write_tcmnt_xml(it,b,i)),o.threadedcomments.push(nt),add_rels(tt,-1,"../threadedComments/threadedComment"+h+"."+s,RELS.TCMNT)),nt="xl/comments"+h+"."+s,zip_add_file(c,nt,write_comments_xml(it)),o.comments.push(nt),add_rels(tt,-1,"../comments"+h+"."+s,RELS.CMNT),et=!0}_e["!legacy"]&&et&&zip_add_file(c,"xl/drawings/vmlDrawing"+h+".vml",write_comments_vml(h,_e["!comments"])),delete _e["!comments"],delete _e["!legacy"]}tt["!id"].rId1&&zip_add_file(c,get_rels_path(d),write_rels(tt))}return i.Strings!=null&&i.Strings.length>0&&(d="xl/sharedStrings."+s,zip_add_file(c,d,write_sst_xml(i.Strings,i)),o.strs.push(d),add_rels(i.wbrels,-1,"sharedStrings."+s,RELS.SST)),d="xl/workbook."+s,zip_add_file(c,d,write_wb_xml(e)),o.workbooks.push(d),add_rels(i.rels,1,d,RELS.WB),d="xl/theme/theme1.xml",zip_add_file(c,d,write_theme(e.Themes,i)),o.themes.push(d),add_rels(i.wbrels,-1,"theme/theme1.xml",RELS.THEME),d="xl/styles."+s,zip_add_file(c,d,write_sty_xml(e,i)),o.styles.push(d),add_rels(i.wbrels,-1,"styles."+s,RELS.STY),e.vbaraw&&a&&(d="xl/vbaProject.bin",zip_add_file(c,d,e.vbaraw),o.vba.push(d),add_rels(i.wbrels,-1,"vbaProject.bin",RELS.VBA)),d="xl/metadata."+s,zip_add_file(c,d,write_xlmeta_xml()),o.metadata.push(d),add_rels(i.wbrels,-1,"metadata."+s,RELS.XLMETA),b.length>1&&(d="xl/persons/person.xml",zip_add_file(c,d,write_people_xml(b)),o.people.push(d),add_rels(i.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(c,"[Content_Types].xml",write_ct(o,i)),zip_add_file(c,"_rels/.rels",write_rels(i.rels)),zip_add_file(c,"xl/_rels/workbook."+s+".rels",write_rels(i.wbrels)),delete i.revssf,delete i.ssf,c}function firstbyte(e,i){var s="";switch((i||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":s=Base64_decode(e.slice(0,12));break;case"binary":s=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(i&&i.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function write_cfb_ctr(e,i){switch(i.type){case"base64":case"binary":break;case"buffer":case"array":i.type="";break;case"file":return write_dl(i.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");default:throw new Error("Unrecognized type "+i.type)}return CFB.write(e,i)}function write_zip_type(e,i){var s=dup(i||{}),a=write_zip(e,s);return write_zip_denouement(a,s)}function write_zip_denouement(e,i){var s={},a=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(i.compression&&(s.compression="DEFLATE"),i.password)s.type=a;else switch(i.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");case"buffer":case"file":s.type=a;break;default:throw new Error("Unrecognized type "+i.type)}var o=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!i.compression}):e.generate(s);if(typeof Deno<"u"&&typeof o=="string"){if(i.type=="binary"||i.type=="base64")return o;o=new Uint8Array(s2ab(o))}return i.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(o,i.password),i):i.type==="file"?write_dl(i.file,o):i.type=="string"?utf8read(o):o}function write_cfb_type(e,i){var s=i||{},a=write_xlscfb(e,s);return write_cfb_ctr(a,s)}function write_string_type(e,i,s){s||(s="");var a=s+e;switch(i.type){case"base64":return Base64_encode(utf8write(a));case"binary":return utf8write(a);case"string":return e;case"file":return write_dl(i.file,a,"utf8");case"buffer":return has_buf?Buffer_from(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):write_string_type(a,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_stxt_type(e,i){switch(i.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(i.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function write_binary_type(e,i){switch(i.type){case"string":case"base64":case"binary":for(var s="",a=0;a<e.length;++a)s+=String.fromCharCode(e[a]);return i.type=="base64"?Base64_encode(s):i.type=="string"?utf8read(s):s;case"file":return write_dl(i.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+i.type)}}function writeSync(e,i){reset_cp(),check_wb(e);var s=dup(i||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),s.type=="array"){s.type="binary";var a=writeSync(e,s);return s.type="array",s2ab(a)}var o=0;if(s.sheet&&(typeof s.sheet=="number"?o=s.sheet:o=e.SheetNames.indexOf(s.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,s),s);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[o]],s),s);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[o]],s),s);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[o]],s),s,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[o]],s),s);case"fods":return write_string_type(write_ods(e,s),s);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[o]],s),s);case"wk3":return write_binary_type(WK_.book_to_wk3(e,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),write_binary_type(write_biff_buf(e,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),write_cfb_type(e,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var i={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},s=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(e.bookType=s.slice(1)),e.bookType=i[e.bookType]||e.bookType}}function writeFileSync(e,i,s){var a={};return a.type="file",a.file=i,resolve_book_type(a),writeSync(e,a)}function make_json_row(e,i,s,a,o,c,d,h){var g=encode_row(s),_=h.defval,b=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),tt=!0,_e=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(_e,"__rowNum__",{value:s,enumerable:!1})}catch{_e.__rowNum__=s}else _e.__rowNum__=s;if(!d||e[s])for(var rt=i.s.c;rt<=i.e.c;++rt){var it=d?e[s][rt]:e[a[rt]+g];if(it===void 0||it.t===void 0){if(_===void 0)continue;c[rt]!=null&&(_e[c[rt]]=_);continue}var et=it.v;switch(it.t){case"z":if(et==null)break;continue;case"e":et=et==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+it.t)}if(c[rt]!=null){if(et==null)if(it.t=="e"&&et===null)_e[c[rt]]=null;else if(_!==void 0)_e[c[rt]]=_;else if(b&&et===null)_e[c[rt]]=null;else continue;else _e[c[rt]]=b&&(it.t!=="n"||it.t==="n"&&h.rawNumbers!==!1)?et:format_cell(it,et,h);et!=null&&(tt=!1)}}return{row:_e,isempty:tt}}function sheet_to_json(e,i){if(e==null||e["!ref"]==null)return[];var s={t:"n",v:0},a=0,o=1,c=[],d=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},_=i||{},b=_.range!=null?_.range:e["!ref"];switch(_.header===1?a=1:_.header==="A"?a=2:Array.isArray(_.header)?a=3:_.header==null&&(a=0),typeof b){case"string":g=safe_decode_range(b);break;case"number":g=safe_decode_range(e["!ref"]),g.s.r=b;break;default:g=b}a>0&&(o=0);var tt=encode_row(g.s.r),_e=[],rt=[],it=0,et=0,nt=Array.isArray(e),at=g.s.r,st=0,ot={};nt&&!e[at]&&(e[at]=[]);var pt=_.skipHidden&&e["!cols"]||[],dt=_.skipHidden&&e["!rows"]||[];for(st=g.s.c;st<=g.e.c;++st)if(!(pt[st]||{}).hidden)switch(_e[st]=encode_col(st),s=nt?e[at][st]:e[_e[st]+tt],a){case 1:c[st]=st-g.s.c;break;case 2:c[st]=_e[st];break;case 3:c[st]=_.header[st-g.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),h=d=format_cell(s,null,_),et=ot[d]||0,!et)ot[d]=1;else{do h=d+"_"+et++;while(ot[h]);ot[d]=et,ot[h]=1}c[st]=h}for(at=g.s.r+o;at<=g.e.r;++at)if(!(dt[at]||{}).hidden){var wt=make_json_row(e,g,at,_e,a,c,nt,_);(wt.isempty===!1||(a===1?_.blankrows!==!1:_.blankrows))&&(rt[it++]=wt.row)}return rt.length=it,rt}var qreg=/"/g;function make_csv_row(e,i,s,a,o,c,d,h){for(var g=!0,_=[],b="",tt=encode_row(s),_e=i.s.c;_e<=i.e.c;++_e)if(a[_e]){var rt=h.dense?(e[s]||[])[_e]:e[a[_e]+tt];if(rt==null)b="";else if(rt.v!=null){g=!1,b=""+(h.rawNumbers&&rt.t=="n"?rt.v:format_cell(rt,null,h));for(var it=0,et=0;it!==b.length;++it)if((et=b.charCodeAt(it))===o||et===c||et===34||h.forceQuotes){b='"'+b.replace(qreg,'""')+'"';break}b=="ID"&&(b='"ID"')}else rt.f!=null&&!rt.F?(g=!1,b="="+rt.f,b.indexOf(",")>=0&&(b='"'+b.replace(qreg,'""')+'"')):b="";_.push(b)}return h.blankrows===!1&&g?null:_.join(d)}function sheet_to_csv(e,i){var s=[],a=i??{};if(e==null||e["!ref"]==null)return"";var o=safe_decode_range(e["!ref"]),c=a.FS!==void 0?a.FS:",",d=c.charCodeAt(0),h=a.RS!==void 0?a.RS:`
`,g=h.charCodeAt(0),_=new RegExp((c=="|"?"\\|":c)+"+$"),b="",tt=[];a.dense=Array.isArray(e);for(var _e=a.skipHidden&&e["!cols"]||[],rt=a.skipHidden&&e["!rows"]||[],it=o.s.c;it<=o.e.c;++it)(_e[it]||{}).hidden||(tt[it]=encode_col(it));for(var et=0,nt=o.s.r;nt<=o.e.r;++nt)(rt[nt]||{}).hidden||(b=make_csv_row(e,o,nt,tt,d,g,c,a),b!=null&&(a.strip&&(b=b.replace(_,"")),(b||a.blankrows!==!1)&&s.push((et++?h:"")+b)));return delete a.dense,s.join("")}function sheet_to_txt(e,i){i||(i={}),i.FS="	",i.RS=`
`;var s=sheet_to_csv(e,i);return s}function sheet_to_formulae(e){var i="",s,a="";if(e==null||e["!ref"]==null)return[];var o=safe_decode_range(e["!ref"]),c="",d=[],h,g=[],_=Array.isArray(e);for(h=o.s.c;h<=o.e.c;++h)d[h]=encode_col(h);for(var b=o.s.r;b<=o.e.r;++b)for(c=encode_row(b),h=o.s.c;h<=o.e.c;++h)if(i=d[h]+c,s=_?(e[b]||[])[h]:e[i],a="",s!==void 0){if(s.F!=null){if(i=s.F,!s.f)continue;a=s.f,i.indexOf(":")==-1&&(i=i+":"+i)}if(s.f!=null)a=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)a=""+s.v;else if(s.t=="b")a=s.v?"TRUE":"FALSE";else if(s.w!==void 0)a="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?a="'"+s.v:a=""+s.v}}g[g.length]=i+"="+a}return g}function sheet_add_json(e,i,s){var a=s||{},o=+!a.skipHeader,c=e||{},d=0,h=0;if(c&&a.origin!=null)if(typeof a.origin=="number")d=a.origin;else{var g=typeof a.origin=="string"?decode_cell(a.origin):a.origin;d=g.r,h=g.c}var _,b={s:{c:0,r:0},e:{c:h,r:d+i.length-1+o}};if(c["!ref"]){var tt=safe_decode_range(c["!ref"]);b.e.c=Math.max(b.e.c,tt.e.c),b.e.r=Math.max(b.e.r,tt.e.r),d==-1&&(d=tt.e.r+1,b.e.r=d+i.length-1+o)}else d==-1&&(d=0,b.e.r=i.length-1+o);var _e=a.header||[],rt=0;i.forEach(function(et,nt){keys(et).forEach(function(at){(rt=_e.indexOf(at))==-1&&(_e[rt=_e.length]=at);var st=et[at],ot="z",pt="",dt=encode_cell({c:h+rt,r:d+nt+o});_=ws_get_cell_stub(c,dt),st&&typeof st=="object"&&!(st instanceof Date)?c[dt]=st:(typeof st=="number"?ot="n":typeof st=="boolean"?ot="b":typeof st=="string"?ot="s":st instanceof Date?(ot="d",a.cellDates||(ot="n",st=datenum(st)),pt=a.dateNF||table_fmt[14]):st===null&&a.nullError&&(ot="e",st=0),_?(_.t=ot,_.v=st,delete _.w,delete _.R,pt&&(_.z=pt)):c[dt]=_={t:ot,v:st},pt&&(_.z=pt))})}),b.e.c=Math.max(b.e.c,h+_e.length-1);var it=encode_row(d);if(o)for(rt=0;rt<_e.length;++rt)c[encode_col(rt+h)+it]={t:"s",v:_e[rt]};return c["!ref"]=encode_range(b),c}function json_to_sheet(e,i){return sheet_add_json(null,e,i)}function ws_get_cell_stub(e,i,s){if(typeof i=="string"){if(Array.isArray(e)){var a=decode_cell(i);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[i]||(e[i]={t:"z"})}return typeof i!="number"?ws_get_cell_stub(e,encode_cell(i)):ws_get_cell_stub(e,encode_cell({r:i,c:s||0}))}function wb_sheet_idx(e,i){if(typeof i=="number"){if(i>=0&&e.SheetNames.length>i)return i;throw new Error("Cannot find sheet # "+i)}else if(typeof i=="string"){var s=e.SheetNames.indexOf(i);if(s>-1)return s;throw new Error("Cannot find sheet name |"+i+"|")}else throw new Error("Cannot find sheet |"+i+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,i,s,a){var o=1;if(!s)for(;o<=65535&&e.SheetNames.indexOf(s="Sheet"+o)!=-1;++o,s=void 0);if(!s||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(s)>=0){var c=s.match(/(^.*?)(\d+)$/);o=c&&+c[2]||0;var d=c&&c[1]||s;for(++o;o<=65535&&e.SheetNames.indexOf(s=d+o)!=-1;++o);}if(check_ws_name(s),e.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return e.SheetNames.push(s),e.Sheets[s]=i,s}function book_set_sheet_visibility(e,i,s){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=wb_sheet_idx(e,i);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}e.Workbook.Sheets[a].Hidden=s}function cell_set_number_format(e,i){return e.z=i,e}function cell_set_hyperlink(e,i,s){return i?(e.l={Target:i},s&&(e.l.Tooltip=s)):delete e.l,e}function cell_set_internal_link(e,i,s){return cell_set_hyperlink(e,"#"+i,s)}function cell_add_comment(e,i,s){e.c||(e.c=[]),e.c.push({t:i,a:s||"SheetJS"})}function sheet_set_array_formula(e,i,s,a){for(var o=typeof i!="string"?i:safe_decode_range(i),c=typeof i=="string"?i:encode_range(i),d=o.s.r;d<=o.e.r;++d)for(var h=o.s.c;h<=o.e.c;++h){var g=ws_get_cell_stub(e,d,h);g.t="n",g.F=c,delete g.v,d==o.s.r&&h==o.s.c&&(g.f=s,a&&(g.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function EmployeeTable({employees:e}){console.log("[DEBUG][EmployeeTable props]",JSON.stringify(e,null,2));const[i,s]=reactExports.useState(""),[a,o]=reactExports.useState("all"),[c,d]=reactExports.useState("all"),[h,g]=reactExports.useState("name"),[_,b]=reactExports.useState("asc"),[tt,_e]=reactExports.useState([]),[rt,it]=reactExports.useState(!1),et=lt=>{_e(gt=>gt.includes(lt)?gt.filter(vt=>vt!==lt):[...gt,lt])},nt=reactExports.useMemo(()=>[...new Set(e.map(lt=>lt.filial).filter(Boolean))],[e]),at=reactExports.useMemo(()=>[...new Set(e.map(lt=>lt.funcao).filter(Boolean))],[e]),st=reactExports.useMemo(()=>{const lt=e.filter(gt=>{var Tt;const vt=gt.name.toLowerCase().includes(i.toLowerCase())||gt.matricula.includes(i)||((Tt=gt.funcao)==null?void 0:Tt.toLowerCase().includes(i.toLowerCase())),At=a==="all"||gt.filial===a,yt=c==="all"||gt.funcao===c,bt=!rt||!(gt.eventos&&gt.eventos.length>0);return vt&&At&&yt&&bt});return lt.sort((gt,vt)=>{let At=gt[h],yt=vt[h];return h==="valores"&&(At=gt.valores.liquido,yt=vt.valores.liquido),typeof At=="string"&&typeof yt=="string"?_==="asc"?At.localeCompare(yt):yt.localeCompare(At):typeof At=="number"&&typeof yt=="number"?_==="asc"?At-yt:yt-At:0}),lt},[e,i,a,c,h,_,rt]),ot=reactExports.useMemo(()=>{const lt=st.reduce((vt,At)=>vt+At.valores.liquido,0),gt=st.length>0?lt/st.length:0;return{total:st.length,totalLiquido:lt,avgSalary:gt}},[st]),pt=lt=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(lt),dt=()=>{const lt=[];st.forEach(bt=>{bt.eventos&&bt.eventos.length>0?bt.eventos.forEach(Tt=>{lt.push({Filial:bt.filial,Matrcula:bt.matricula,"Cdigo do Evento":Tt.codigo,Descrio:Tt.tipo,"Ref.":Tt.ref,Valor:Tt.valor})}):lt.push({Filial:bt.filial,Matrcula:bt.matricula,"Cdigo do Evento":"",Descrio:"","Ref.":"",Valor:""})});const gt=utils.json_to_sheet(lt),vt=utils.book_new();utils.book_append_sheet(vt,gt,"Folha Analtica");const yt=`folha_analitica_${new Date().toISOString().slice(0,10)}.xlsx`;writeFileSync(vt,yt)},wt=lt=>{h===lt?b(_==="asc"?"desc":"asc"):(g(lt),b("asc"))};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(Users,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de Funcionrios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-foreground",children:ot.total})]})]})})})}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(Filter,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{children:"Filtros e Busca"})]}),jsxRuntimeExports.jsxs(Button,{onClick:dt,className:"bg-gradient-success hover:shadow-primary",disabled:st.length===0,children:[jsxRuntimeExports.jsx(Download,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]})]})}),jsxRuntimeExports.jsx(CardContent,{className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),jsxRuntimeExports.jsx(Input,{placeholder:"Buscar por nome, matrcula ou funo...",value:i,onChange:lt=>s(lt.target.value),className:"pl-10"})]}),jsxRuntimeExports.jsxs(Select,{value:a,onValueChange:o,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Filtrar por filial"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Todas as Filiais"}),nt.map(lt=>jsxRuntimeExports.jsx(SelectItem,{value:lt,children:lt},lt))]})]}),jsxRuntimeExports.jsxs(Select,{value:c,onValueChange:d,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Filtrar por funo"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Todas as Funes"}),at.map(lt=>jsxRuntimeExports.jsx(SelectItem,{value:lt,children:lt},lt))]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 mt-2 md:mt-0",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",id:"no-events-filter",checked:rt,onChange:lt=>it(lt.target.checked),style:{accentColor:"#f59e42",width:16,height:16}}),jsxRuntimeExports.jsx("label",{htmlFor:"no-events-filter",style:{fontSize:14,color:"#555",cursor:"pointer"},children:"Mostrar apenas colaboradores sem eventos"})]})]})})]}),jsxRuntimeExports.jsx(Card,{className:"shadow-lg-custom",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsxs(TableHead,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>wt("name"),children:["Nome ",h==="name"&&(_==="asc"?"":"")]}),jsxRuntimeExports.jsxs(TableHead,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>wt("matricula"),children:["Matrcula ",h==="matricula"&&(_==="asc"?"":"")]}),jsxRuntimeExports.jsx(TableHead,{children:"Funo"}),jsxRuntimeExports.jsx(TableHead,{children:"Filial"}),jsxRuntimeExports.jsx(TableHead,{children:"Eventos"})]})}),jsxRuntimeExports.jsx(TableBody,{children:st.map(lt=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsxs(TableRow,{className:`transition-colors ${!lt.eventos||lt.eventos.length===0?"bg-yellow-50":"hover:bg-muted/30"}`,children:[jsxRuntimeExports.jsxs(TableCell,{className:"font-medium",children:[jsxRuntimeExports.jsx("button",{onClick:()=>et(lt.id),style:{background:"none",border:"none",cursor:"pointer",marginRight:6,verticalAlign:"middle"},"aria-label":tt.includes(lt.id)?"Colapsar":"Expandir",children:tt.includes(lt.id)?jsxRuntimeExports.jsx(ChevronDown,{size:16}):jsxRuntimeExports.jsx(ChevronRight,{size:16})}),lt.name]}),jsxRuntimeExports.jsx(TableCell,{children:jsxRuntimeExports.jsx(Badge,{variant:"outline",children:lt.matricula})}),jsxRuntimeExports.jsx(TableCell,{children:lt.funcao||"-"}),jsxRuntimeExports.jsx(TableCell,{children:lt.filial||"-"}),jsxRuntimeExports.jsx(TableCell,{children:lt.eventos&&lt.eventos.length>0?jsxRuntimeExports.jsxs("span",{style:{color:"#888",fontSize:12},children:[lt.eventos.length," evento(s)"]}):"-"})]}),tt.includes(lt.id)&&lt.eventos&&lt.eventos.length>0&&lt.eventos.map(gt=>jsxRuntimeExports.jsxs(TableRow,{style:{background:"#f9f9f9"},children:[jsxRuntimeExports.jsx(TableCell,{style:{padding:0},children:jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:12,fontSize:13,padding:"4px 0 4px 8px"},children:[jsxRuntimeExports.jsx("span",{style:{minWidth:60,fontWeight:500},children:gt.codigo}),jsxRuntimeExports.jsx("span",{style:{flex:1},children:gt.tipo}),jsxRuntimeExports.jsx("span",{style:{minWidth:40},children:gt.ref}),jsxRuntimeExports.jsx("span",{style:{minWidth:80,textAlign:"right"},children:pt(gt.valor)})]})}),jsxRuntimeExports.jsx(TableCell,{}),jsxRuntimeExports.jsx(TableCell,{}),jsxRuntimeExports.jsx(TableCell,{}),jsxRuntimeExports.jsx(TableCell,{})]},lt.id+"-"+gt.codigo+"-"+gt.ref))]},lt.id))})]})}),st.length===0&&jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-muted-foreground",children:jsxRuntimeExports.jsx("p",{children:"Nenhum funcionrio encontrado com os filtros aplicados."})})]})})]})}function ProcessingResults({stats:e}){const i=a=>a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`,s=e.totalFiles>0?e.successfulExtractions/e.totalFiles*100:0;return jsxRuntimeExports.jsxs(Card,{className:"shadow-card animate-slide-up",children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-success"}),jsxRuntimeExports.jsx("span",{children:"Resultados do Processamento"})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-gradient-secondary rounded-lg",children:[jsxRuntimeExports.jsx(FileText,{className:"w-6 h-6 mx-auto text-primary mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Arquivos"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-foreground",children:e.totalFiles})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-gradient-success rounded-lg",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-6 h-6 mx-auto text-success-foreground mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-success-foreground",children:"Processados"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-success-foreground",children:e.successfulExtractions})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-gradient-primary rounded-lg",children:[jsxRuntimeExports.jsx(FileText,{className:"w-6 h-6 mx-auto text-primary-foreground mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-primary-foreground",children:"Colaboradores"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-primary-foreground",children:e.totalEmployees})]}),jsxRuntimeExports.jsxs("div",{className:"text-center p-3 bg-muted rounded-lg",children:[jsxRuntimeExports.jsx(Clock,{className:"w-6 h-6 mx-auto text-muted-foreground mb-2"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Tempo"}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-foreground",children:i(e.processingTime)})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-muted-foreground",children:"Taxa de Sucesso"}),jsxRuntimeExports.jsxs(Badge,{variant:s===100?"default":s>80?"secondary":"destructive",className:"bg-gradient-success text-success-foreground",children:[s.toFixed(1),"%"]})]}),e.errors.length>0&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 text-destructive",children:[jsxRuntimeExports.jsx(TriangleAlert,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Erros Encontrados:"})]}),jsxRuntimeExports.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:jsxRuntimeExports.jsx("ul",{className:"text-sm space-y-1",children:e.errors.map((a,o)=>jsxRuntimeExports.jsxs("li",{className:"text-destructive",children:[" ",a]},o))})})]}),e.errors.length===0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 text-success bg-success/10 border border-success/20 rounded-lg p-3",children:[jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Todos os arquivos foram processados com sucesso!"})]})]})]})}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,s){module.exports=i.pdfjsLib=s()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,i)=>{var hn;Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationReplyType=i.AnnotationPrefix=i.AnnotationMode=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=kt,i.bytesToString=wr,i.createValidAbsoluteUrl=fr,i.getModificationDate=zr,i.getUuid=tn,i.getVerbosityLevel=zt,i.info=ar,i.isArrayBuffer=pr,i.isArrayEqual=Wr,i.isNodeJS=void 0,i.normalizeUnicode=Kr,i.objectFromMap=jr,i.objectSize=Rr,i.setVerbosityLevel=er,i.shadow=Et,i.string32=Fr,i.stringToBytes=vr,i.stringToPDFString=Mr,i.stringToUTF8String=Ur,i.unreachable=Yt,i.utf8StringToString=Er,i.warn=Jt;const s=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=s;const a=[1,0,0,1,0,0];i.IDENTITY_MATRIX=a;const o=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=o;const c=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=c;const d=1.35;i.LINE_FACTOR=d;const h=.35;i.LINE_DESCENT_FACTOR=h;const g=h/d;i.BASELINE_FACTOR=g;const _={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=_;const b={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=b;const tt="pdfjs_internal_editor_";i.AnnotationEditorPrefix=tt;const _e={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};i.AnnotationEditorType=_e;const rt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};i.AnnotationEditorParamsType=rt;const it={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=it;const et={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=et;const nt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=nt;const at={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=at;const st={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=st;const ot={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=ot;const pt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=pt;const dt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=dt;const wt={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=wt;const lt={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=lt;const gt={O:"PageOpen",C:"PageClose"};i.PageActionEventType=gt;const vt={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=vt;const At={NONE:0,BINARY:1};i.CMapCompressionType=At;const yt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=yt;const bt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=bt;let Tt=vt.WARNINGS;function er(Br){Number.isInteger(Br)&&(Tt=Br)}function zt(){return Tt}function ar(Br){Tt>=vt.INFOS&&console.log(`Info: ${Br}`)}function Jt(Br){Tt>=vt.WARNINGS&&console.log(`Warning: ${Br}`)}function Yt(Br){throw new Error(Br)}function kt(Br,br){Br||Yt(br)}function ir(Br){switch(Br==null?void 0:Br.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function fr(Br,br=null,Cr=null){if(!Br)return null;try{if(Cr&&typeof Br=="string"){if(Cr.addDefaultProtocol&&Br.startsWith("www.")){const an=Br.match(/\./g);(an==null?void 0:an.length)>=2&&(Br=`http://${Br}`)}if(Cr.tryConvertEncoding)try{Br=Ur(Br)}catch{}}const Hr=br?new URL(Br,br):new URL(Br);if(ir(Hr))return Hr}catch{}return null}function Et(Br,br,Cr,Hr=!1){return Object.defineProperty(Br,br,{value:Cr,enumerable:!Hr,configurable:!0,writable:!1}),Cr}const xt=function(){function br(Cr,Hr){this.constructor===br&&Yt("Cannot initialize BaseException."),this.message=Cr,this.name=Hr}return br.prototype=new Error,br.constructor=br,br}();i.BaseException=xt;class mt extends xt{constructor(br,Cr){super(br,"PasswordException"),this.code=Cr}}i.PasswordException=mt;class St extends xt{constructor(br,Cr){super(br,"UnknownErrorException"),this.details=Cr}}i.UnknownErrorException=St;class Pt extends xt{constructor(br){super(br,"InvalidPDFException")}}i.InvalidPDFException=Pt;class Nt extends xt{constructor(br){super(br,"MissingPDFException")}}i.MissingPDFException=Nt;class Lt extends xt{constructor(br,Cr){super(br,"UnexpectedResponseException"),this.status=Cr}}i.UnexpectedResponseException=Lt;class lr extends xt{constructor(br){super(br,"FormatError")}}i.FormatError=lr;class ur extends xt{constructor(br){super(br,"AbortException")}}i.AbortException=ur;function wr(Br){(typeof Br!="object"||(Br==null?void 0:Br.length)===void 0)&&Yt("Invalid argument for bytesToString");const br=Br.length,Cr=8192;if(br<Cr)return String.fromCharCode.apply(null,Br);const Hr=[];for(let an=0;an<br;an+=Cr){const rn=Math.min(an+Cr,br),dr=Br.subarray(an,rn);Hr.push(String.fromCharCode.apply(null,dr))}return Hr.join("")}function vr(Br){typeof Br!="string"&&Yt("Invalid argument for stringToBytes");const br=Br.length,Cr=new Uint8Array(br);for(let Hr=0;Hr<br;++Hr)Cr[Hr]=Br.charCodeAt(Hr)&255;return Cr}function Fr(Br){return String.fromCharCode(Br>>24&255,Br>>16&255,Br>>8&255,Br&255)}function Rr(Br){return Object.keys(Br).length}function jr(Br){const br=Object.create(null);for(const[Cr,Hr]of Br)br[Cr]=Hr;return br}function xr(){const Br=new Uint8Array(4);return Br[0]=1,new Uint32Array(Br.buffer,0,1)[0]===1}function hr(){try{return new Function(""),!0}catch{return!1}}class jt{static get isLittleEndian(){return Et(this,"isLittleEndian",xr())}static get isEvalSupported(){return Et(this,"isEvalSupported",hr())}static get isOffscreenCanvasSupported(){return Et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Et(this,"platform",{isWin:!1,isMac:!1}):Et(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var br,Cr;return Et(this,"isCSSRoundSupported",(Cr=(br=globalThis.CSS)==null?void 0:br.supports)==null?void 0:Cr.call(br,"width: round(1.5px, 1px)"))}}i.FeatureTest=jt;const sr=[...Array(256).keys()].map(Br=>Br.toString(16).padStart(2,"0"));class _r{static makeHexColor(br,Cr,Hr){return`#${sr[br]}${sr[Cr]}${sr[Hr]}`}static scaleMinMax(br,Cr){let Hr;br[0]?(br[0]<0&&(Hr=Cr[0],Cr[0]=Cr[1],Cr[1]=Hr),Cr[0]*=br[0],Cr[1]*=br[0],br[3]<0&&(Hr=Cr[2],Cr[2]=Cr[3],Cr[3]=Hr),Cr[2]*=br[3],Cr[3]*=br[3]):(Hr=Cr[0],Cr[0]=Cr[2],Cr[2]=Hr,Hr=Cr[1],Cr[1]=Cr[3],Cr[3]=Hr,br[1]<0&&(Hr=Cr[2],Cr[2]=Cr[3],Cr[3]=Hr),Cr[2]*=br[1],Cr[3]*=br[1],br[2]<0&&(Hr=Cr[0],Cr[0]=Cr[1],Cr[1]=Hr),Cr[0]*=br[2],Cr[1]*=br[2]),Cr[0]+=br[4],Cr[1]+=br[4],Cr[2]+=br[5],Cr[3]+=br[5]}static transform(br,Cr){return[br[0]*Cr[0]+br[2]*Cr[1],br[1]*Cr[0]+br[3]*Cr[1],br[0]*Cr[2]+br[2]*Cr[3],br[1]*Cr[2]+br[3]*Cr[3],br[0]*Cr[4]+br[2]*Cr[5]+br[4],br[1]*Cr[4]+br[3]*Cr[5]+br[5]]}static applyTransform(br,Cr){const Hr=br[0]*Cr[0]+br[1]*Cr[2]+Cr[4],an=br[0]*Cr[1]+br[1]*Cr[3]+Cr[5];return[Hr,an]}static applyInverseTransform(br,Cr){const Hr=Cr[0]*Cr[3]-Cr[1]*Cr[2],an=(br[0]*Cr[3]-br[1]*Cr[2]+Cr[2]*Cr[5]-Cr[4]*Cr[3])/Hr,rn=(-br[0]*Cr[1]+br[1]*Cr[0]+Cr[4]*Cr[1]-Cr[5]*Cr[0])/Hr;return[an,rn]}static getAxialAlignedBoundingBox(br,Cr){const Hr=this.applyTransform(br,Cr),an=this.applyTransform(br.slice(2,4),Cr),rn=this.applyTransform([br[0],br[3]],Cr),dr=this.applyTransform([br[2],br[1]],Cr);return[Math.min(Hr[0],an[0],rn[0],dr[0]),Math.min(Hr[1],an[1],rn[1],dr[1]),Math.max(Hr[0],an[0],rn[0],dr[0]),Math.max(Hr[1],an[1],rn[1],dr[1])]}static inverseTransform(br){const Cr=br[0]*br[3]-br[1]*br[2];return[br[3]/Cr,-br[1]/Cr,-br[2]/Cr,br[0]/Cr,(br[2]*br[5]-br[4]*br[3])/Cr,(br[4]*br[1]-br[5]*br[0])/Cr]}static singularValueDecompose2dScale(br){const Cr=[br[0],br[2],br[1],br[3]],Hr=br[0]*Cr[0]+br[1]*Cr[2],an=br[0]*Cr[1]+br[1]*Cr[3],rn=br[2]*Cr[0]+br[3]*Cr[2],dr=br[2]*Cr[1]+br[3]*Cr[3],Nr=(Hr+dr)/2,Xr=Math.sqrt((Hr+dr)**2-4*(Hr*dr-rn*an))/2,Jr=Nr+Xr||1,on=Nr-Xr||1;return[Math.sqrt(Jr),Math.sqrt(on)]}static normalizeRect(br){const Cr=br.slice(0);return br[0]>br[2]&&(Cr[0]=br[2],Cr[2]=br[0]),br[1]>br[3]&&(Cr[1]=br[3],Cr[3]=br[1]),Cr}static intersect(br,Cr){const Hr=Math.max(Math.min(br[0],br[2]),Math.min(Cr[0],Cr[2])),an=Math.min(Math.max(br[0],br[2]),Math.max(Cr[0],Cr[2]));if(Hr>an)return null;const rn=Math.max(Math.min(br[1],br[3]),Math.min(Cr[1],Cr[3])),dr=Math.min(Math.max(br[1],br[3]),Math.max(Cr[1],Cr[3]));return rn>dr?null:[Hr,rn,an,dr]}static bezierBoundingBox(br,Cr,Hr,an,rn,dr,Nr,Xr){const Jr=[],on=[[],[]];let Qr,cr,rr,gr,Or,Ir,$r,Vr;for(let nr=0;nr<2;++nr){if(nr===0?(cr=6*br-12*Hr+6*rn,Qr=-3*br+9*Hr-9*rn+3*Nr,rr=3*Hr-3*br):(cr=6*Cr-12*an+6*dr,Qr=-3*Cr+9*an-9*dr+3*Xr,rr=3*an-3*Cr),Math.abs(Qr)<1e-12){if(Math.abs(cr)<1e-12)continue;gr=-rr/cr,0<gr&&gr<1&&Jr.push(gr);continue}$r=cr*cr-4*rr*Qr,Vr=Math.sqrt($r),!($r<0)&&(Or=(-cr+Vr)/(2*Qr),0<Or&&Or<1&&Jr.push(Or),Ir=(-cr-Vr)/(2*Qr),0<Ir&&Ir<1&&Jr.push(Ir))}let nn=Jr.length,Zr;const Rt=nn;for(;nn--;)gr=Jr[nn],Zr=1-gr,on[0][nn]=Zr*Zr*Zr*br+3*Zr*Zr*gr*Hr+3*Zr*gr*gr*rn+gr*gr*gr*Nr,on[1][nn]=Zr*Zr*Zr*Cr+3*Zr*Zr*gr*an+3*Zr*gr*gr*dr+gr*gr*gr*Xr;return on[0][Rt]=br,on[1][Rt]=Cr,on[0][Rt+1]=Nr,on[1][Rt+1]=Xr,on[0].length=on[1].length=Rt+2,[Math.min(...on[0]),Math.min(...on[1]),Math.max(...on[0]),Math.max(...on[1])]}}i.Util=_r;const Ar=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Mr(Br){if(Br[0]>=""){let Cr;if(Br[0]===""&&Br[1]===""?Cr="utf-16be":Br[0]===""&&Br[1]===""?Cr="utf-16le":Br[0]===""&&Br[1]===""&&Br[2]===""&&(Cr="utf-8"),Cr)try{const Hr=new TextDecoder(Cr,{fatal:!0}),an=vr(Br);return Hr.decode(an)}catch(Hr){Jt(`stringToPDFString: "${Hr}".`)}}const br=[];for(let Cr=0,Hr=Br.length;Cr<Hr;Cr++){const an=Ar[Br.charCodeAt(Cr)];br.push(an?String.fromCharCode(an):Br.charAt(Cr))}return br.join("")}function Ur(Br){return decodeURIComponent(escape(Br))}function Er(Br){return unescape(encodeURIComponent(Br))}function pr(Br){return typeof Br=="object"&&(Br==null?void 0:Br.byteLength)!==void 0}function Wr(Br,br){if(Br.length!==br.length)return!1;for(let Cr=0,Hr=Br.length;Cr<Hr;Cr++)if(Br[Cr]!==br[Cr])return!1;return!0}function zr(Br=new Date){return[Br.getUTCFullYear().toString(),(Br.getUTCMonth()+1).toString().padStart(2,"0"),Br.getUTCDate().toString().padStart(2,"0"),Br.getUTCHours().toString().padStart(2,"0"),Br.getUTCMinutes().toString().padStart(2,"0"),Br.getUTCSeconds().toString().padStart(2,"0")].join("")}class en{constructor(){Sr(this,hn,!1);this.promise=new Promise((br,Cr)=>{this.resolve=Hr=>{yr(this,hn,!0),br(Hr)},this.reject=Hr=>{yr(this,hn,!0),Cr(Hr)}})}get settled(){return ht(this,hn)}}hn=new WeakMap,i.PromiseCapability=en;let sn=null,dn=null;function Kr(Br){return sn||(sn=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,dn=new Map([["","t"]])),Br.replaceAll(sn,(br,Cr,Hr)=>Cr?Cr.normalize("NFKC"):dn.get(Hr))}function tn(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Br=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Br);else for(let br=0;br<32;br++)Br[br]=Math.floor(Math.random()*255);return wr(Br)}const fn="pdfjs_internal_id_";i.AnnotationPrefix=fn},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,s,a,o,Vn,gs,h,g,_,b,tt,_e,rt,it,et,xs,at,st,Os,pt,dt;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(lt){if(typeof lt=="string"||lt instanceof URL?lt={url:lt}:(0,_util.isArrayBuffer)(lt)&&(lt={data:lt}),typeof lt!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!lt.url&&!lt.data&&!lt.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const gt=new PDFDocumentLoadingTask,{docId:vt}=gt,At=lt.url?getUrlProp(lt.url):null,yt=lt.data?getDataProp(lt.data):null,bt=lt.httpHeaders||null,Tt=lt.withCredentials===!0,er=lt.password??null,zt=lt.range instanceof PDFDataRangeTransport?lt.range:null,ar=Number.isInteger(lt.rangeChunkSize)&&lt.rangeChunkSize>0?lt.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Jt=lt.worker instanceof PDFWorker?lt.worker:null;const Yt=lt.verbosity,kt=typeof lt.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(lt.docBaseUrl)?lt.docBaseUrl:null,ir=typeof lt.cMapUrl=="string"?lt.cMapUrl:null,fr=lt.cMapPacked!==!1,Et=lt.CMapReaderFactory||DefaultCMapReaderFactory,xt=typeof lt.standardFontDataUrl=="string"?lt.standardFontDataUrl:null,mt=lt.StandardFontDataFactory||DefaultStandardFontDataFactory,St=lt.stopAtErrors!==!0,Pt=Number.isInteger(lt.maxImageSize)&&lt.maxImageSize>-1?lt.maxImageSize:-1,Nt=lt.isEvalSupported!==!1,Lt=typeof lt.isOffscreenCanvasSupported=="boolean"?lt.isOffscreenCanvasSupported:!_util.isNodeJS,lr=Number.isInteger(lt.canvasMaxAreaInBytes)?lt.canvasMaxAreaInBytes:-1,ur=typeof lt.disableFontFace=="boolean"?lt.disableFontFace:_util.isNodeJS,wr=lt.fontExtraProperties===!0,vr=lt.enableXfa===!0,Fr=lt.ownerDocument||globalThis.document,Rr=lt.disableRange===!0,jr=lt.disableStream===!0,xr=lt.disableAutoFetch===!0,hr=lt.pdfBug===!0,jt=zt?zt.length:lt.length??NaN,sr=typeof lt.useSystemFonts=="boolean"?lt.useSystemFonts:!_util.isNodeJS&&!ur,_r=typeof lt.useWorkerFetch=="boolean"?lt.useWorkerFetch:Et===_display_utils.DOMCMapReaderFactory&&mt===_display_utils.DOMStandardFontDataFactory&&ir&&xt&&(0,_display_utils.isValidFetchUrl)(ir,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(xt,document.baseURI),Ar=lt.canvasFactory||new DefaultCanvasFactory({ownerDocument:Fr}),Mr=lt.filterFactory||new DefaultFilterFactory({docId:vt,ownerDocument:Fr}),Ur=null;(0,_util.setVerbosityLevel)(Yt);const Er={canvasFactory:Ar,filterFactory:Mr};if(_r||(Er.cMapReaderFactory=new Et({baseUrl:ir,isCompressed:fr}),Er.standardFontDataFactory=new mt({baseUrl:xt})),!Jt){const zr={verbosity:Yt,port:_worker_options.GlobalWorkerOptions.workerPort};Jt=zr.port?PDFWorker.fromPort(zr):new PDFWorker(zr),gt._worker=Jt}const pr={docId:vt,apiVersion:"3.11.174",data:yt,password:er,disableAutoFetch:xr,rangeChunkSize:ar,length:jt,docBaseUrl:kt,enableXfa:vr,evaluatorOptions:{maxImageSize:Pt,disableFontFace:ur,ignoreErrors:St,isEvalSupported:Nt,isOffscreenCanvasSupported:Lt,canvasMaxAreaInBytes:lr,fontExtraProperties:wr,useSystemFonts:sr,cMapUrl:_r?ir:null,standardFontDataUrl:_r?xt:null}},Wr={ignoreErrors:St,isEvalSupported:Nt,disableFontFace:ur,fontExtraProperties:wr,enableXfa:vr,ownerDocument:Fr,disableAutoFetch:xr,pdfBug:hr,styleElement:Ur};return Jt.promise.then(function(){if(gt.destroyed)throw new Error("Loading aborted");const zr=_fetchDocument(Jt,pr),en=new Promise(function(sn){let dn;zt?dn=new _transport_stream.PDFDataTransportStream({length:jt,initialData:zt.initialData,progressiveDone:zt.progressiveDone,contentDispositionFilename:zt.contentDispositionFilename,disableRange:Rr,disableStream:jr},zt):yt||(dn=(tn=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(tn):(0,_display_utils.isValidFetchUrl)(tn.url)?new _displayFetch_stream.PDFFetchStream(tn):new _displayNetwork.PDFNetworkStream(tn))({url:At,length:jt,httpHeaders:bt,withCredentials:Tt,rangeChunkSize:ar,disableRange:Rr,disableStream:jr})),sn(dn)});return Promise.all([zr,en]).then(function([sn,dn]){if(gt.destroyed)throw new Error("Loading aborted");const Kr=new _message_handler.MessageHandler(vt,sn,Jt.port),tn=new WorkerTransport(Kr,gt,dn,Wr,Er);gt._transport=tn,Kr.send("Ready",null)})}).catch(gt._capability.reject),gt}async function _fetchDocument(lt,gt){if(lt.destroyed)throw new Error("Worker was destroyed");const vt=await lt.messageHandler.sendWithPromise("GetDocRequest",gt,gt.data?[gt.data.buffer]:null);if(lt.destroyed)throw new Error("Worker was destroyed");return vt}function getUrlProp(lt){if(lt instanceof URL)return lt.href;try{return new URL(lt,window.location).href}catch{if(_util.isNodeJS&&typeof lt=="string")return lt}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(lt){if(_util.isNodeJS&&typeof Buffer<"u"&&lt instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(lt instanceof Uint8Array&&lt.byteLength===lt.buffer.byteLength)return lt;if(typeof lt=="string")return(0,_util.stringToBytes)(lt);if(typeof lt=="object"&&!isNaN(lt==null?void 0:lt.length)||(0,_util.isArrayBuffer)(lt))return new Uint8Array(lt);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class i{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${On(i,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var gt,vt,At;this.destroyed=!0;try{(gt=this._worker)!=null&&gt.port&&(this._worker._pendingDestroy=!0),await((vt=this._transport)==null?void 0:vt.destroy())}catch(yt){throw(At=this._worker)!=null&&At.port&&delete this._worker._pendingDestroy,yt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,Sr(i,e,0);let PDFDocumentLoadingTask=i;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(gt,vt,At=!1,yt=null){this.length=gt,this.initialData=vt,this.progressiveDone=At,this.contentDispositionFilename=yt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(gt){this._rangeListeners.push(gt)}addProgressListener(gt){this._progressListeners.push(gt)}addProgressiveReadListener(gt){this._progressiveReadListeners.push(gt)}addProgressiveDoneListener(gt){this._progressiveDoneListeners.push(gt)}onDataRange(gt,vt){for(const At of this._rangeListeners)At(gt,vt)}onDataProgress(gt,vt){this._readyCapability.promise.then(()=>{for(const At of this._progressListeners)At(gt,vt)})}onDataProgressiveRead(gt){this._readyCapability.promise.then(()=>{for(const vt of this._progressiveReadListeners)vt(gt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const gt of this._progressiveDoneListeners)gt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(gt,vt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(gt,vt){this._pdfInfo=gt,this._transport=vt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(At=>{if(!At)return At;const yt=[];for(const bt in At)yt.push(...At[bt]);return yt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(gt){return this._transport.getPage(gt)}getPageIndex(gt){return this._transport.getPageIndex(gt)}getDestinations(){return this._transport.getDestinations()}getDestination(gt){return this._transport.getDestination(gt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(gt=!1){return this._transport.startCleanup(gt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(gt,vt,At,yt=!1){Sr(this,o);Sr(this,s,null);Sr(this,a,!1);this._pageIndex=gt,this._pageInfo=vt,this._transport=At,this._stats=yt?new _display_utils.StatTimer:null,this._pdfBug=yt,this.commonObjs=At.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:gt,rotation:vt=this.rotate,offsetX:At=0,offsetY:yt=0,dontFlip:bt=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:gt,rotation:vt,offsetX:At,offsetY:yt,dontFlip:bt})}getAnnotations({intent:gt="display"}={}){const vt=this._transport.getRenderingIntent(gt);return this._transport.getAnnotations(this._pageIndex,vt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var gt;return((gt=this._transport._htmlForXfa)==null?void 0:gt.children[this._pageIndex])||null}render({canvasContext:gt,viewport:vt,intent:At="display",annotationMode:yt=_util.AnnotationMode.ENABLE,transform:bt=null,background:Tt=null,optionalContentConfigPromise:er=null,annotationCanvasMap:zt=null,pageColors:ar=null,printAnnotationStorage:Jt=null}){var mt,St;(mt=this._stats)==null||mt.time("Overall");const Yt=this._transport.getRenderingIntent(At,yt,Jt);yr(this,a,!1),mr(this,o,gs).call(this),er||(er=this._transport.getOptionalContentConfig());let kt=this._intentStates.get(Yt.cacheKey);kt||(kt=Object.create(null),this._intentStates.set(Yt.cacheKey,kt)),kt.streamReaderCancelTimeout&&(clearTimeout(kt.streamReaderCancelTimeout),kt.streamReaderCancelTimeout=null);const ir=!!(Yt.renderingIntent&_util.RenderingIntentFlag.PRINT);kt.displayReadyCapability||(kt.displayReadyCapability=new _util.PromiseCapability,kt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(St=this._stats)==null||St.time("Page Request"),this._pumpOperatorList(Yt));const fr=Pt=>{var Nt,Lt;kt.renderTasks.delete(Et),(this._maybeCleanupAfterRender||ir)&&yr(this,a,!0),mr(this,o,Vn).call(this,!ir),Pt?(Et.capability.reject(Pt),this._abortOperatorList({intentState:kt,reason:Pt instanceof Error?Pt:new Error(Pt)})):Et.capability.resolve(),(Nt=this._stats)==null||Nt.timeEnd("Rendering"),(Lt=this._stats)==null||Lt.timeEnd("Overall")},Et=new InternalRenderTask({callback:fr,params:{canvasContext:gt,viewport:vt,transform:bt,background:Tt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:zt,operatorList:kt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!ir,pdfBug:this._pdfBug,pageColors:ar});(kt.renderTasks||(kt.renderTasks=new Set)).add(Et);const xt=Et.task;return Promise.all([kt.displayReadyCapability.promise,er]).then(([Pt,Nt])=>{var Lt;if(this.destroyed){fr();return}(Lt=this._stats)==null||Lt.time("Rendering"),Et.initializeGraphics({transparency:Pt,optionalContentConfig:Nt}),Et.operatorListChanged()}).catch(fr),xt}getOperatorList({intent:gt="display",annotationMode:vt=_util.AnnotationMode.ENABLE,printAnnotationStorage:At=null}={}){var zt;function yt(){Tt.operatorList.lastChunk&&(Tt.opListReadCapability.resolve(Tt.operatorList),Tt.renderTasks.delete(er))}const bt=this._transport.getRenderingIntent(gt,vt,At,!0);let Tt=this._intentStates.get(bt.cacheKey);Tt||(Tt=Object.create(null),this._intentStates.set(bt.cacheKey,Tt));let er;return Tt.opListReadCapability||(er=Object.create(null),er.operatorListChanged=yt,Tt.opListReadCapability=new _util.PromiseCapability,(Tt.renderTasks||(Tt.renderTasks=new Set)).add(er),Tt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(zt=this._stats)==null||zt.time("Page Request"),this._pumpOperatorList(bt)),Tt.opListReadCapability.promise}streamTextContent({includeMarkedContent:gt=!1,disableNormalization:vt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:gt===!0,disableNormalization:vt===!0},{highWaterMark:100,size(yt){return yt.items.length}})}getTextContent(gt={}){if(this._transport._htmlForXfa)return this.getXfa().then(At=>_xfa_text.XfaText.textContent(At));const vt=this.streamTextContent(gt);return new Promise(function(At,yt){function bt(){Tt.read().then(function({value:zt,done:ar}){if(ar){At(er);return}Object.assign(er.styles,zt.styles),er.items.push(...zt.items),bt()},yt)}const Tt=vt.getReader(),er={items:[],styles:Object.create(null)};bt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const gt=[];for(const vt of this._intentStates.values())if(this._abortOperatorList({intentState:vt,reason:new Error("Page was destroyed."),force:!0}),!vt.opListReadCapability)for(const At of vt.renderTasks)gt.push(At.completed),At.cancel();return this.objs.clear(),yr(this,a,!1),mr(this,o,gs).call(this),Promise.all(gt)}cleanup(gt=!1){yr(this,a,!0);const vt=mr(this,o,Vn).call(this,!1);return gt&&vt&&this._stats&&(this._stats=new _display_utils.StatTimer),vt}_startRenderPage(gt,vt){var yt,bt;const At=this._intentStates.get(vt);At&&((yt=this._stats)==null||yt.timeEnd("Page Request"),(bt=At.displayReadyCapability)==null||bt.resolve(gt))}_renderPageChunk(gt,vt){for(let At=0,yt=gt.length;At<yt;At++)vt.operatorList.fnArray.push(gt.fnArray[At]),vt.operatorList.argsArray.push(gt.argsArray[At]);vt.operatorList.lastChunk=gt.lastChunk,vt.operatorList.separateAnnots=gt.separateAnnots;for(const At of vt.renderTasks)At.operatorListChanged();gt.lastChunk&&mr(this,o,Vn).call(this,!0)}_pumpOperatorList({renderingIntent:gt,cacheKey:vt,annotationStorageSerializable:At}){const{map:yt,transfers:bt}=At,er=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:gt,cacheKey:vt,annotationStorage:yt},bt).getReader(),zt=this._intentStates.get(vt);zt.streamReader=er;const ar=()=>{er.read().then(({value:Jt,done:Yt})=>{if(Yt){zt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Jt,zt),ar())},Jt=>{if(zt.streamReader=null,!this._transport.destroyed){if(zt.operatorList){zt.operatorList.lastChunk=!0;for(const Yt of zt.renderTasks)Yt.operatorListChanged();mr(this,o,Vn).call(this,!0)}if(zt.displayReadyCapability)zt.displayReadyCapability.reject(Jt);else if(zt.opListReadCapability)zt.opListReadCapability.reject(Jt);else throw Jt}})};ar()}_abortOperatorList({intentState:gt,reason:vt,force:At=!1}){if(gt.streamReader){if(gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null),!At){if(gt.renderTasks.size>0)return;if(vt instanceof _display_utils.RenderingCancelledException){let yt=RENDERING_CANCELLED_TIMEOUT;vt.extraDelay>0&&vt.extraDelay<1e3&&(yt+=vt.extraDelay),gt.streamReaderCancelTimeout=setTimeout(()=>{gt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:gt,reason:vt,force:!0})},yt);return}}if(gt.streamReader.cancel(new _util.AbortException(vt.message)).catch(()=>{}),gt.streamReader=null,!this._transport.destroyed){for(const[yt,bt]of this._intentStates)if(bt===gt){this._intentStates.delete(yt);break}this.cleanup()}}}get stats(){return this._stats}}s=new WeakMap,a=new WeakMap,o=new WeakSet,Vn=function(gt=!1){if(mr(this,o,gs).call(this),!ht(this,a)||this.destroyed)return!1;if(gt)return yr(this,s,setTimeout(()=>{yr(this,s,null),mr(this,o,Vn).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:vt,operatorList:At}of this._intentStates.values())if(vt.size>0||!At.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),yr(this,a,!1),!0},gs=function(){ht(this,s)&&(clearTimeout(ht(this,s)),yr(this,s,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Sr(this,h,new Set);Sr(this,g,Promise.resolve())}postMessage(gt,vt){const At={data:structuredClone(gt,vt?{transfer:vt}:null)};ht(this,g).then(()=>{for(const yt of ht(this,h))yt.call(this,At)})}addEventListener(gt,vt){ht(this,h).add(vt)}removeEventListener(gt,vt){ht(this,h).delete(vt)}terminate(){ht(this,h).clear()}}h=new WeakMap,g=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const lt=(_=document==null?void 0:document.currentScript)==null?void 0:_.src;lt&&(PDFWorkerUtil.fallbackWorkerSrc=lt.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(lt,gt){let vt;try{if(vt=new URL(lt),!vt.origin||vt.origin==="null")return!1}catch{return!1}const At=new URL(gt,vt);return vt.origin===At.origin},PDFWorkerUtil.createCDNWrapper=function(lt){const gt=`importScripts("${lt}");`;return URL.createObjectURL(new Blob([gt]))}}const _PDFWorker=class _PDFWorker{constructor({name:lt=null,port:gt=null,verbosity:vt=(0,_util.getVerbosityLevel)()}={}){var At;if(this.name=lt,this.destroyed=!1,this.verbosity=vt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,gt){if((At=ht(_PDFWorker,b))!=null&&At.has(gt))throw new Error("Cannot use more than one PDFWorker per port.");(ht(_PDFWorker,b)||yr(_PDFWorker,b,new WeakMap)).set(gt,this),this._initializeFromPort(gt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(lt){this._port=lt,this._messageHandler=new _message_handler.MessageHandler("main","worker",lt),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:lt}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,lt)||(lt=PDFWorkerUtil.createCDNWrapper(new URL(lt,window.location).href));const gt=new Worker(lt),vt=new _message_handler.MessageHandler("main","worker",gt),At=()=>{gt.removeEventListener("error",yt),vt.destroy(),gt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},yt=()=>{this._webWorker||At()};gt.addEventListener("error",yt),vt.on("test",Tt=>{if(gt.removeEventListener("error",yt),this.destroyed){At();return}Tt?(this._messageHandler=vt,this._port=gt,this._webWorker=gt,this._readyCapability.resolve(),vt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),vt.destroy(),gt.terminate())}),vt.on("ready",Tt=>{if(gt.removeEventListener("error",yt),this.destroyed){At();return}try{bt()}catch{this._setupFakeWorker()}});const bt=()=>{const Tt=new Uint8Array;vt.send("test",Tt,[Tt.buffer])};bt();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(lt=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const gt=new LoopbackPort;this._port=gt;const vt=`fake${PDFWorkerUtil.fakeWorkerId++}`,At=new _message_handler.MessageHandler(vt+"_worker",vt,gt);lt.setup(At,gt);const yt=new _message_handler.MessageHandler(vt,vt+"_worker",gt);this._messageHandler=yt,this._readyCapability.resolve(),yt.send("configure",{verbosity:this.verbosity})}).catch(lt=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${lt.message}".`))})}destroy(){var lt;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(lt=ht(_PDFWorker,b))==null||lt.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(lt){var vt;if(!(lt!=null&&lt.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const gt=(vt=ht(this,b))==null?void 0:vt.get(lt.port);if(gt){if(gt._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return gt}return new _PDFWorker(lt)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var lt;try{return((lt=globalThis.pdfjsWorker)==null?void 0:lt.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};b=new WeakMap,Sr(_PDFWorker,b);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(gt,vt,At,yt,bt){Sr(this,et);Sr(this,tt,new Map);Sr(this,_e,new Map);Sr(this,rt,new Map);Sr(this,it,null);this.messageHandler=gt,this.loadingTask=vt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:yt.ownerDocument,styleElement:yt.styleElement}),this._params=yt,this.canvasFactory=bt.canvasFactory,this.filterFactory=bt.filterFactory,this.cMapReaderFactory=bt.cMapReaderFactory,this.standardFontDataFactory=bt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=At,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(gt,vt=_util.AnnotationMode.ENABLE,At=null,yt=!1){let bt=_util.RenderingIntentFlag.DISPLAY,Tt=_annotation_storage.SerializableEmpty;switch(gt){case"any":bt=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":bt=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${gt}`)}switch(vt){case _util.AnnotationMode.DISABLE:bt+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:bt+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:bt+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Tt=(bt&_util.RenderingIntentFlag.PRINT&&At instanceof _annotation_storage.PrintAnnotationStorage?At:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${vt}`)}return yt&&(bt+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:bt,cacheKey:`${bt}_${Tt.hash}`,annotationStorageSerializable:Tt}}destroy(){var At;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(At=ht(this,it))==null||At.reject(new Error("Worker was destroyed during onPassword callback"));const gt=[];for(const yt of ht(this,_e).values())gt.push(yt._destroy());ht(this,_e).clear(),ht(this,rt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const vt=this.messageHandler.sendWithPromise("Terminate",null);return gt.push(vt),Promise.all(gt).then(()=>{var yt;this.commonObjs.clear(),this.fontLoader.clear(),ht(this,tt).clear(),this.filterFactory.destroy(),(yt=this._networkStream)==null||yt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:gt,loadingTask:vt}=this;gt.on("GetReader",(At,yt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=bt=>{this._lastProgress={loaded:bt.loaded,total:bt.total}},yt.onPull=()=>{this._fullReader.read().then(function({value:bt,done:Tt}){if(Tt){yt.close();return}(0,_util.assert)(bt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),yt.enqueue(new Uint8Array(bt),1,[bt])}).catch(bt=>{yt.error(bt)})},yt.onCancel=bt=>{this._fullReader.cancel(bt),yt.ready.catch(Tt=>{if(!this.destroyed)throw Tt})}}),gt.on("ReaderHeadersReady",At=>{const yt=new _util.PromiseCapability,bt=this._fullReader;return bt.headersReady.then(()=>{var Tt;(!bt.isStreamingSupported||!bt.isRangeSupported)&&(this._lastProgress&&((Tt=vt.onProgress)==null||Tt.call(vt,this._lastProgress)),bt.onProgress=er=>{var zt;(zt=vt.onProgress)==null||zt.call(vt,{loaded:er.loaded,total:er.total})}),yt.resolve({isStreamingSupported:bt.isStreamingSupported,isRangeSupported:bt.isRangeSupported,contentLength:bt.contentLength})},yt.reject),yt.promise}),gt.on("GetRangeReader",(At,yt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const bt=this._networkStream.getRangeReader(At.begin,At.end);if(!bt){yt.close();return}yt.onPull=()=>{bt.read().then(function({value:Tt,done:er}){if(er){yt.close();return}(0,_util.assert)(Tt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),yt.enqueue(new Uint8Array(Tt),1,[Tt])}).catch(Tt=>{yt.error(Tt)})},yt.onCancel=Tt=>{bt.cancel(Tt),yt.ready.catch(er=>{if(!this.destroyed)throw er})}}),gt.on("GetDoc",({pdfInfo:At})=>{this._numPages=At.numPages,this._htmlForXfa=At.htmlForXfa,delete At.htmlForXfa,vt._capability.resolve(new PDFDocumentProxy(At,this))}),gt.on("DocException",function(At){let yt;switch(At.name){case"PasswordException":yt=new _util.PasswordException(At.message,At.code);break;case"InvalidPDFException":yt=new _util.InvalidPDFException(At.message);break;case"MissingPDFException":yt=new _util.MissingPDFException(At.message);break;case"UnexpectedResponseException":yt=new _util.UnexpectedResponseException(At.message,At.status);break;case"UnknownErrorException":yt=new _util.UnknownErrorException(At.message,At.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}vt._capability.reject(yt)}),gt.on("PasswordRequest",At=>{if(yr(this,it,new _util.PromiseCapability),vt.onPassword){const yt=bt=>{bt instanceof Error?ht(this,it).reject(bt):ht(this,it).resolve({password:bt})};try{vt.onPassword(yt,At.code)}catch(bt){ht(this,it).reject(bt)}}else ht(this,it).reject(new _util.PasswordException(At.message,At.code));return ht(this,it).promise}),gt.on("DataLoaded",At=>{var yt;(yt=vt.onProgress)==null||yt.call(vt,{loaded:At.length,total:At.length}),this.downloadInfoCapability.resolve(At)}),gt.on("StartRenderPage",At=>{if(this.destroyed)return;ht(this,_e).get(At.pageIndex)._startRenderPage(At.transparency,At.cacheKey)}),gt.on("commonobj",([At,yt,bt])=>{var Tt;if(!this.destroyed&&!this.commonObjs.has(At))switch(yt){case"Font":const er=this._params;if("error"in bt){const Jt=bt.error;(0,_util.warn)(`Error during font loading: ${Jt}`),this.commonObjs.resolve(At,Jt);break}const zt=er.pdfBug&&((Tt=globalThis.FontInspector)!=null&&Tt.enabled)?(Jt,Yt)=>globalThis.FontInspector.fontAdded(Jt,Yt):null,ar=new _font_loader.FontFaceObject(bt,{isEvalSupported:er.isEvalSupported,disableFontFace:er.disableFontFace,ignoreErrors:er.ignoreErrors,inspectFont:zt});this.fontLoader.bind(ar).catch(Jt=>gt.sendWithPromise("FontFallback",{id:At})).finally(()=>{!er.fontExtraProperties&&ar.data&&(ar.data=null),this.commonObjs.resolve(At,ar)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(At,bt);break;default:throw new Error(`Got unknown common object type ${yt}`)}}),gt.on("obj",([At,yt,bt,Tt])=>{var zt;if(this.destroyed)return;const er=ht(this,_e).get(yt);if(!er.objs.has(At))switch(bt){case"Image":if(er.objs.resolve(At,Tt),Tt){let ar;if(Tt.bitmap){const{width:Jt,height:Yt}=Tt;ar=Jt*Yt*4}else ar=((zt=Tt.data)==null?void 0:zt.length)||0;ar>_util.MAX_IMAGE_SIZE_TO_CACHE&&(er._maybeCleanupAfterRender=!0)}break;case"Pattern":er.objs.resolve(At,Tt);break;default:throw new Error(`Got unknown object type ${bt}`)}}),gt.on("DocProgress",At=>{var yt;this.destroyed||(yt=vt.onProgress)==null||yt.call(vt,{loaded:At.loaded,total:At.total})}),gt.on("FetchBuiltInCMap",At=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(At):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),gt.on("FetchStandardFontData",At=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(At):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var At;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:gt,transfers:vt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:gt,filename:((At=this._fullReader)==null?void 0:At.filename)??null},vt).finally(()=>{this.annotationStorage.resetModified()})}getPage(gt){if(!Number.isInteger(gt)||gt<=0||gt>this._numPages)return Promise.reject(new Error("Invalid page request."));const vt=gt-1,At=ht(this,rt).get(vt);if(At)return At;const yt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:vt}).then(bt=>{if(this.destroyed)throw new Error("Transport destroyed");const Tt=new PDFPageProxy(vt,bt,this,this._params.pdfBug);return ht(this,_e).set(vt,Tt),Tt});return ht(this,rt).set(vt,yt),yt}getPageIndex(gt){return typeof gt!="object"||gt===null||!Number.isInteger(gt.num)||gt.num<0||!Number.isInteger(gt.gen)||gt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:gt.num,gen:gt.gen})}getAnnotations(gt,vt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:gt,intent:vt})}getFieldObjects(){return mr(this,et,xs).call(this,"GetFieldObjects")}hasJSActions(){return mr(this,et,xs).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(gt){return typeof gt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:gt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return mr(this,et,xs).call(this,"GetDocJSActions")}getPageJSActions(gt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:gt})}getStructTree(gt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:gt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(gt=>new _optional_content_config.OptionalContentConfig(gt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const gt="GetMetadata",vt=ht(this,tt).get(gt);if(vt)return vt;const At=this.messageHandler.sendWithPromise(gt,null).then(yt=>{var bt,Tt;return{info:yt[0],metadata:yt[1]?new _metadata.Metadata(yt[1]):null,contentDispositionFilename:((bt=this._fullReader)==null?void 0:bt.filename)??null,contentLength:((Tt=this._fullReader)==null?void 0:Tt.contentLength)??null}});return ht(this,tt).set(gt,At),At}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(gt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const vt of ht(this,_e).values())if(!vt.cleanup())throw new Error(`startCleanup: Page ${vt.pageNumber} is currently rendering.`);this.commonObjs.clear(),gt||this.fontLoader.clear(),ht(this,tt).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:gt,enableXfa:vt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:gt,enableXfa:vt})}}tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakSet,xs=function(gt,vt=null){const At=ht(this,tt).get(gt);if(At)return At;const yt=this.messageHandler.sendWithPromise(gt,vt);return ht(this,tt).set(gt,yt),yt};class PDFObjects{constructor(){Sr(this,st);Sr(this,at,Object.create(null))}get(gt,vt=null){if(vt){const yt=mr(this,st,Os).call(this,gt);return yt.capability.promise.then(()=>vt(yt.data)),null}const At=ht(this,at)[gt];if(!(At!=null&&At.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${gt}.`);return At.data}has(gt){const vt=ht(this,at)[gt];return(vt==null?void 0:vt.capability.settled)||!1}resolve(gt,vt=null){const At=mr(this,st,Os).call(this,gt);At.data=vt,At.capability.resolve()}clear(){var gt;for(const vt in ht(this,at)){const{data:At}=ht(this,at)[vt];(gt=At==null?void 0:At.bitmap)==null||gt.close()}yr(this,at,Object.create(null))}}at=new WeakMap,st=new WeakSet,Os=function(gt){var vt;return(vt=ht(this,at))[gt]||(vt[gt]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(gt){Sr(this,pt,null);yr(this,pt,gt),this.onContinue=null}get promise(){return ht(this,pt).capability.promise}cancel(gt=0){ht(this,pt).cancel(null,gt)}get separateAnnots(){const{separateAnnots:gt}=ht(this,pt).operatorList;if(!gt)return!1;const{annotationCanvasMap:vt}=ht(this,pt);return gt.form||gt.canvas&&(vt==null?void 0:vt.size)>0}}pt=new WeakMap,exports.RenderTask=RenderTask;const wt=class wt{constructor({callback:gt,params:vt,objs:At,commonObjs:yt,annotationCanvasMap:bt,operatorList:Tt,pageIndex:er,canvasFactory:zt,filterFactory:ar,useRequestAnimationFrame:Jt=!1,pdfBug:Yt=!1,pageColors:kt=null}){this.callback=gt,this.params=vt,this.objs=At,this.commonObjs=yt,this.annotationCanvasMap=bt,this.operatorListIdx=null,this.operatorList=Tt,this._pageIndex=er,this.canvasFactory=zt,this.filterFactory=ar,this._pdfBug=Yt,this.pageColors=kt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Jt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=vt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:gt=!1,optionalContentConfig:vt}){var er,zt;if(this.cancelled)return;if(this._canvas){if(ht(wt,dt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ht(wt,dt).add(this._canvas)}this._pdfBug&&((er=globalThis.StepperManager)!=null&&er.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:At,viewport:yt,transform:bt,background:Tt}=this.params;this.gfx=new _canvas.CanvasGraphics(At,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:vt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:bt,viewport:yt,transparency:gt,background:Tt}),this.operatorListIdx=0,this.graphicsReady=!0,(zt=this.graphicsReadyCallback)==null||zt.call(this)}cancel(gt=null,vt=0){var At;this.running=!1,this.cancelled=!0,(At=this.gfx)==null||At.endDrawing(),ht(wt,dt).delete(this._canvas),this.callback(gt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,vt))}operatorListChanged(){var gt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(gt=this.stepper)==null||gt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ht(wt,dt).delete(this._canvas),this.callback())))}};dt=new WeakMap,Sr(wt,dt,new WeakSet);let InternalRenderTask=wt;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,i,s)=>{var _,b,tt,go,rt;Object.defineProperty(i,"__esModule",{value:!0}),i.SerializableEmpty=i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var a=s(1),o=s(4),c=s(8);const d=Object.freeze({map:null,hash:"",transfers:void 0});i.SerializableEmpty=d;class h{constructor(){Sr(this,tt);Sr(this,_,!1);Sr(this,b,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(et,nt){const at=ht(this,b).get(et);return at===void 0?nt:Object.assign(nt,at)}getRawValue(et){return ht(this,b).get(et)}remove(et){if(ht(this,b).delete(et),ht(this,b).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const nt of ht(this,b).values())if(nt instanceof o.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(et,nt){const at=ht(this,b).get(et);let st=!1;if(at!==void 0)for(const[ot,pt]of Object.entries(nt))at[ot]!==pt&&(st=!0,at[ot]=pt);else st=!0,ht(this,b).set(et,nt);st&&mr(this,tt,go).call(this),nt instanceof o.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(nt.constructor._type)}has(et){return ht(this,b).has(et)}getAll(){return ht(this,b).size>0?(0,a.objectFromMap)(ht(this,b)):null}setAll(et){for(const[nt,at]of Object.entries(et))this.setValue(nt,at)}get size(){return ht(this,b).size}resetModified(){ht(this,_)&&(yr(this,_,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new g(this)}get serializable(){if(ht(this,b).size===0)return d;const et=new Map,nt=new c.MurmurHash3_64,at=[],st=Object.create(null);let ot=!1;for(const[pt,dt]of ht(this,b)){const wt=dt instanceof o.AnnotationEditor?dt.serialize(!1,st):dt;wt&&(et.set(pt,wt),nt.update(`${pt}:${JSON.stringify(wt)}`),ot||(ot=!!wt.bitmap))}if(ot)for(const pt of et.values())pt.bitmap&&at.push(pt.bitmap);return et.size>0?{map:et,hash:nt.hexdigest(),transfers:at}:d}}_=new WeakMap,b=new WeakMap,tt=new WeakSet,go=function(){ht(this,_)||(yr(this,_,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=h;class g extends h{constructor(nt){super();Sr(this,rt);const{map:at,hash:st,transfers:ot}=nt.serializable,pt=structuredClone(at,ot?{transfer:ot}:null);yr(this,rt,{map:pt,hash:st,transfers:ot})}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return ht(this,rt)}}rt=new WeakMap,i.PrintAnnotationStorage=g},(e,i,s)=>{var g,_,b,tt,_e,rt,it,et,nt,at,st,ot,pt,dt,wt,Ns,Is,vt,Ms,Ds,xo,vo,_o,Ls,yo;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var a=s(5),o=s(1),c=s(6);const Jt=class Jt{constructor(kt){Sr(this,wt);Sr(this,g,"");Sr(this,_,!1);Sr(this,b,null);Sr(this,tt,null);Sr(this,_e,null);Sr(this,rt,!1);Sr(this,it,null);Sr(this,et,this.focusin.bind(this));Sr(this,nt,this.focusout.bind(this));Sr(this,at,!1);Sr(this,st,!1);Sr(this,ot,!1);mn(this,"_initialOptions",Object.create(null));mn(this,"_uiManager",null);mn(this,"_focusEventsAllowed",!0);mn(this,"_l10nPromise",null);Sr(this,pt,!1);Sr(this,dt,Jt._zIndex++);this.constructor===Jt&&(0,o.unreachable)("Cannot initialize AnnotationEditor."),this.parent=kt.parent,this.id=kt.id,this.width=this.height=null,this.pageIndex=kt.parent.pageIndex,this.name=kt.name,this.div=null,this._uiManager=kt.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=kt.isCentered,this._structTreeParentId=null;const{rotation:ir,rawDims:{pageWidth:fr,pageHeight:Et,pageX:xt,pageY:mt}}=this.parent.viewport;this.rotation=ir,this.pageRotation=(360+ir-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[fr,Et],this.pageTranslation=[xt,mt];const[St,Pt]=this.parentDimensions;this.x=kt.x/St,this.y=kt.y/Pt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,o.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(kt){const ir=new h({id:kt.parent.getNextId(),parent:kt.parent,uiManager:kt._uiManager});ir.annotationElementId=kt.annotationElementId,ir.deleted=!0,ir._uiManager.addToAnnotationStorage(ir)}static initialize(kt,ir=null){if(Jt._l10nPromise||(Jt._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Et=>[Et,kt.get(Et)]))),ir!=null&&ir.strings)for(const Et of ir.strings)Jt._l10nPromise.set(Et,kt.get(Et));if(Jt._borderLineWidth!==-1)return;const fr=getComputedStyle(document.documentElement);Jt._borderLineWidth=parseFloat(fr.getPropertyValue("--outline-width"))||0}static updateDefaultParams(kt,ir){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(kt){return!1}static paste(kt,ir){(0,o.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return ht(this,pt)}set _isDraggable(kt){var ir;yr(this,pt,kt),(ir=this.div)==null||ir.classList.toggle("draggable",kt)}center(){const[kt,ir]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*ir/(kt*2),this.y+=this.width*kt/(ir*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*ir/(kt*2),this.y-=this.width*kt/(ir*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(kt){this._uiManager.addCommands(kt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=ht(this,dt)}setParent(kt){kt!==null&&(this.pageIndex=kt.pageIndex,this.pageDimensions=kt.pageDimensions),this.parent=kt}focusin(kt){this._focusEventsAllowed&&(ht(this,at)?yr(this,at,!1):this.parent.setSelected(this))}focusout(kt){var fr;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const ir=kt.relatedTarget;ir!=null&&ir.closest(`#${this.id}`)||(kt.preventDefault(),(fr=this.parent)!=null&&fr.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(kt,ir,fr,Et){const[xt,mt]=this.parentDimensions;[fr,Et]=this.screenToPageTranslation(fr,Et),this.x=(kt+fr)/xt,this.y=(ir+Et)/mt,this.fixAndSetPosition()}translate(kt,ir){mr(this,wt,Ns).call(this,this.parentDimensions,kt,ir)}translateInPage(kt,ir){mr(this,wt,Ns).call(this,this.pageDimensions,kt,ir),this.div.scrollIntoView({block:"nearest"})}drag(kt,ir){const[fr,Et]=this.parentDimensions;if(this.x+=kt/fr,this.y+=ir/Et,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Nt,y:Lt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Nt,Lt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:xt,y:mt}=this;const[St,Pt]=mr(this,wt,Is).call(this);xt+=St,mt+=Pt,this.div.style.left=`${(100*xt).toFixed(2)}%`,this.div.style.top=`${(100*mt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[kt,ir]=this.pageDimensions;let{x:fr,y:Et,width:xt,height:mt}=this;switch(xt*=kt,mt*=ir,fr*=kt,Et*=ir,this.rotation){case 0:fr=Math.max(0,Math.min(kt-xt,fr)),Et=Math.max(0,Math.min(ir-mt,Et));break;case 90:fr=Math.max(0,Math.min(kt-mt,fr)),Et=Math.min(ir,Math.max(xt,Et));break;case 180:fr=Math.min(kt,Math.max(xt,fr)),Et=Math.min(ir,Math.max(mt,Et));break;case 270:fr=Math.min(kt,Math.max(mt,fr)),Et=Math.max(0,Math.min(ir-xt,Et));break}this.x=fr/=kt,this.y=Et/=ir;const[St,Pt]=mr(this,wt,Is).call(this);fr+=St,Et+=Pt;const{style:Nt}=this.div;Nt.left=`${(100*fr).toFixed(2)}%`,Nt.top=`${(100*Et).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(kt,ir){var fr;return mr(fr=Jt,vt,Ms).call(fr,kt,ir,this.parentRotation)}pageTranslationToScreen(kt,ir){var fr;return mr(fr=Jt,vt,Ms).call(fr,kt,ir,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:kt,pageDimensions:[ir,fr]}=this,Et=ir*kt,xt=fr*kt;return o.FeatureTest.isCSSRoundSupported?[Math.round(Et),Math.round(xt)]:[Et,xt]}setDims(kt,ir){var xt;const[fr,Et]=this.parentDimensions;this.div.style.width=`${(100*kt/fr).toFixed(2)}%`,ht(this,rt)||(this.div.style.height=`${(100*ir/Et).toFixed(2)}%`),(xt=ht(this,b))==null||xt.classList.toggle("small",kt<Jt.SMALL_EDITOR_SIZE||ir<Jt.SMALL_EDITOR_SIZE)}fixDims(){const{style:kt}=this.div,{height:ir,width:fr}=kt,Et=fr.endsWith("%"),xt=!ht(this,rt)&&ir.endsWith("%");if(Et&&xt)return;const[mt,St]=this.parentDimensions;Et||(kt.width=`${(100*parseFloat(fr)/mt).toFixed(2)}%`),!ht(this,rt)&&!xt&&(kt.height=`${(100*parseFloat(ir)/St).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(ht(this,b))return;const kt=yr(this,b,document.createElement("button"));kt.className="altText";const ir=await Jt._l10nPromise.get("editor_alt_text_button_label");kt.textContent=ir,kt.setAttribute("aria-label",ir),kt.tabIndex="0",kt.addEventListener("contextmenu",c.noContextMenu),kt.addEventListener("pointerdown",fr=>fr.stopPropagation()),kt.addEventListener("click",fr=>{fr.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),kt.addEventListener("keydown",fr=>{fr.target===kt&&fr.key==="Enter"&&(fr.preventDefault(),this._uiManager.editAltText(this))}),mr(this,wt,Ls).call(this),this.div.append(kt),Jt.SMALL_EDITOR_SIZE||(Jt.SMALL_EDITOR_SIZE=Math.min(128,Math.round(kt.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:ht(this,g),decorative:ht(this,_)}}set altTextData({altText:kt,decorative:ir}){ht(this,g)===kt&&ht(this,_)===ir||(yr(this,g,kt),yr(this,_,ir),mr(this,wt,Ls).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",ht(this,et)),this.div.addEventListener("focusout",ht(this,nt));const[kt,ir]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*ir/kt).toFixed(2)}%`,this.div.style.maxHeight=`${(100*kt/ir).toFixed(2)}%`);const[fr,Et]=this.getInitialTranslation();return this.translate(fr,Et),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(kt){const{isMac:ir}=o.FeatureTest.platform;if(kt.button!==0||kt.ctrlKey&&ir){kt.preventDefault();return}yr(this,at,!0),mr(this,wt,yo).call(this,kt)}moveInDOM(){var kt;(kt=this.parent)==null||kt.moveEditorInDOM(this)}_setParentAndPosition(kt,ir,fr){kt.changeParent(this),this.x=ir,this.y=fr,this.fixAndSetPosition()}getRect(kt,ir){const fr=this.parentScale,[Et,xt]=this.pageDimensions,[mt,St]=this.pageTranslation,Pt=kt/fr,Nt=ir/fr,Lt=this.x*Et,lr=this.y*xt,ur=this.width*Et,wr=this.height*xt;switch(this.rotation){case 0:return[Lt+Pt+mt,xt-lr-Nt-wr+St,Lt+Pt+ur+mt,xt-lr-Nt+St];case 90:return[Lt+Nt+mt,xt-lr+Pt+St,Lt+Nt+wr+mt,xt-lr+Pt+ur+St];case 180:return[Lt-Pt-ur+mt,xt-lr+Nt+St,Lt-Pt+mt,xt-lr+Nt+wr+St];case 270:return[Lt-Nt-wr+mt,xt-lr-Pt-ur+St,Lt-Nt+mt,xt-lr-Pt+St];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(kt,ir){const[fr,Et,xt,mt]=kt,St=xt-fr,Pt=mt-Et;switch(this.rotation){case 0:return[fr,ir-mt,St,Pt];case 90:return[fr,ir-Et,Pt,St];case 180:return[xt,ir-Et,St,Pt];case 270:return[xt,ir-mt,Pt,St];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){yr(this,ot,!0)}disableEditMode(){yr(this,ot,!1)}isInEditMode(){return ht(this,ot)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var kt,ir;(kt=this.div)==null||kt.addEventListener("focusin",ht(this,et)),(ir=this.div)==null||ir.addEventListener("focusout",ht(this,nt))}serialize(kt=!1,ir=null){(0,o.unreachable)("An editor must be serializable")}static deserialize(kt,ir,fr){const Et=new this.prototype.constructor({parent:ir,id:ir.getNextId(),uiManager:fr});Et.rotation=kt.rotation;const[xt,mt]=Et.pageDimensions,[St,Pt,Nt,Lt]=Et.getRectInCurrentCoords(kt.rect,mt);return Et.x=St/xt,Et.y=Pt/mt,Et.width=Nt/xt,Et.height=Lt/mt,Et}remove(){var kt;this.div.removeEventListener("focusin",ht(this,et)),this.div.removeEventListener("focusout",ht(this,nt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(kt=ht(this,b))==null||kt.remove(),yr(this,b,null),yr(this,tt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(mr(this,wt,xo).call(this),ht(this,it).classList.remove("hidden"))}select(){var kt;this.makeResizable(),(kt=this.div)==null||kt.classList.add("selectedEditor")}unselect(){var kt,ir,fr;(kt=ht(this,it))==null||kt.classList.add("hidden"),(ir=this.div)==null||ir.classList.remove("selectedEditor"),(fr=this.div)!=null&&fr.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(kt,ir){}disableEditing(){ht(this,b)&&(ht(this,b).hidden=!0)}enableEditing(){ht(this,b)&&(ht(this,b).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return ht(this,st)}set isEditing(kt){yr(this,st,kt),this.parent&&(kt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(kt,ir){yr(this,rt,!0);const fr=kt/ir,{style:Et}=this.div;Et.aspectRatio=fr,Et.height="auto"}static get MIN_SIZE(){return 16}};g=new WeakMap,_=new WeakMap,b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,ot=new WeakMap,pt=new WeakMap,dt=new WeakMap,wt=new WeakSet,Ns=function([kt,ir],fr,Et){[fr,Et]=this.screenToPageTranslation(fr,Et),this.x+=fr/kt,this.y+=Et/ir,this.fixAndSetPosition()},Is=function(){const[kt,ir]=this.parentDimensions,{_borderLineWidth:fr}=Jt,Et=fr/kt,xt=fr/ir;switch(this.rotation){case 90:return[-Et,xt];case 180:return[Et,xt];case 270:return[Et,-xt];default:return[-Et,-xt]}},vt=new WeakSet,Ms=function(kt,ir,fr){switch(fr){case 90:return[ir,-kt];case 180:return[-kt,-ir];case 270:return[-ir,kt];default:return[kt,ir]}},Ds=function(kt){switch(kt){case 90:{const[ir,fr]=this.pageDimensions;return[0,-ir/fr,fr/ir,0]}case 180:return[-1,0,0,-1];case 270:{const[ir,fr]=this.pageDimensions;return[0,ir/fr,-fr/ir,0]}default:return[1,0,0,1]}},xo=function(){if(ht(this,it))return;yr(this,it,document.createElement("div")),ht(this,it).classList.add("resizers");const kt=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||kt.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const ir of kt){const fr=document.createElement("div");ht(this,it).append(fr),fr.classList.add("resizer",ir),fr.addEventListener("pointerdown",mr(this,wt,vo).bind(this,ir)),fr.addEventListener("contextmenu",c.noContextMenu)}this.div.prepend(ht(this,it))},vo=function(kt,ir){ir.preventDefault();const{isMac:fr}=o.FeatureTest.platform;if(ir.button!==0||ir.ctrlKey&&fr)return;const Et=mr(this,wt,_o).bind(this,kt),xt=this._isDraggable;this._isDraggable=!1;const mt={passive:!0,capture:!0};window.addEventListener("pointermove",Et,mt);const St=this.x,Pt=this.y,Nt=this.width,Lt=this.height,lr=this.parent.div.style.cursor,ur=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(ir.target).cursor;const wr=()=>{this._isDraggable=xt,window.removeEventListener("pointerup",wr),window.removeEventListener("blur",wr),window.removeEventListener("pointermove",Et,mt),this.parent.div.style.cursor=lr,this.div.style.cursor=ur;const vr=this.x,Fr=this.y,Rr=this.width,jr=this.height;vr===St&&Fr===Pt&&Rr===Nt&&jr===Lt||this.addCommands({cmd:()=>{this.width=Rr,this.height=jr,this.x=vr,this.y=Fr;const[xr,hr]=this.parentDimensions;this.setDims(xr*Rr,hr*jr),this.fixAndSetPosition()},undo:()=>{this.width=Nt,this.height=Lt,this.x=St,this.y=Pt;const[xr,hr]=this.parentDimensions;this.setDims(xr*Nt,hr*Lt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",wr),window.addEventListener("blur",wr)},_o=function(kt,ir){const[fr,Et]=this.parentDimensions,xt=this.x,mt=this.y,St=this.width,Pt=this.height,Nt=Jt.MIN_SIZE/fr,Lt=Jt.MIN_SIZE/Et,lr=Kr=>Math.round(Kr*1e4)/1e4,ur=mr(this,wt,Ds).call(this,this.rotation),wr=(Kr,tn)=>[ur[0]*Kr+ur[2]*tn,ur[1]*Kr+ur[3]*tn],vr=mr(this,wt,Ds).call(this,360-this.rotation),Fr=(Kr,tn)=>[vr[0]*Kr+vr[2]*tn,vr[1]*Kr+vr[3]*tn];let Rr,jr,xr=!1,hr=!1;switch(kt){case"topLeft":xr=!0,Rr=(Kr,tn)=>[0,0],jr=(Kr,tn)=>[Kr,tn];break;case"topMiddle":Rr=(Kr,tn)=>[Kr/2,0],jr=(Kr,tn)=>[Kr/2,tn];break;case"topRight":xr=!0,Rr=(Kr,tn)=>[Kr,0],jr=(Kr,tn)=>[0,tn];break;case"middleRight":hr=!0,Rr=(Kr,tn)=>[Kr,tn/2],jr=(Kr,tn)=>[0,tn/2];break;case"bottomRight":xr=!0,Rr=(Kr,tn)=>[Kr,tn],jr=(Kr,tn)=>[0,0];break;case"bottomMiddle":Rr=(Kr,tn)=>[Kr/2,tn],jr=(Kr,tn)=>[Kr/2,0];break;case"bottomLeft":xr=!0,Rr=(Kr,tn)=>[0,tn],jr=(Kr,tn)=>[Kr,0];break;case"middleLeft":hr=!0,Rr=(Kr,tn)=>[0,tn/2],jr=(Kr,tn)=>[Kr,tn/2];break}const jt=Rr(St,Pt),sr=jr(St,Pt);let _r=wr(...sr);const Ar=lr(xt+_r[0]),Mr=lr(mt+_r[1]);let Ur=1,Er=1,[pr,Wr]=this.screenToPageTranslation(ir.movementX,ir.movementY);if([pr,Wr]=Fr(pr/fr,Wr/Et),xr){const Kr=Math.hypot(St,Pt);Ur=Er=Math.max(Math.min(Math.hypot(sr[0]-jt[0]-pr,sr[1]-jt[1]-Wr)/Kr,1/St,1/Pt),Nt/St,Lt/Pt)}else hr?Ur=Math.max(Nt,Math.min(1,Math.abs(sr[0]-jt[0]-pr)))/St:Er=Math.max(Lt,Math.min(1,Math.abs(sr[1]-jt[1]-Wr)))/Pt;const zr=lr(St*Ur),en=lr(Pt*Er);_r=wr(...jr(zr,en));const sn=Ar-_r[0],dn=Mr-_r[1];this.width=zr,this.height=en,this.x=sn,this.y=dn,this.setDims(fr*zr,Et*en),this.fixAndSetPosition()},Ls=async function(){var fr;const kt=ht(this,b);if(!kt)return;if(!ht(this,g)&&!ht(this,_)){kt.classList.remove("done"),(fr=ht(this,tt))==null||fr.remove();return}Jt._l10nPromise.get("editor_alt_text_edit_button_label").then(Et=>{kt.setAttribute("aria-label",Et)});let ir=ht(this,tt);if(!ir){yr(this,tt,ir=document.createElement("span")),ir.className="tooltip",ir.setAttribute("role","tooltip");const Et=ir.id=`alt-text-tooltip-${this.id}`;kt.setAttribute("aria-describedby",Et);const xt=100;kt.addEventListener("mouseenter",()=>{yr(this,_e,setTimeout(()=>{yr(this,_e,null),ht(this,tt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},xt))}),kt.addEventListener("mouseleave",()=>{var mt;clearTimeout(ht(this,_e)),yr(this,_e,null),(mt=ht(this,tt))==null||mt.classList.remove("show")})}kt.classList.add("done"),ir.innerText=ht(this,_)?await Jt._l10nPromise.get("editor_alt_text_decorative_tooltip"):ht(this,g),ir.parentNode||kt.append(ir)},yo=function(kt){if(!this._isDraggable)return;const ir=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let fr,Et;ir&&(fr={passive:!0,capture:!0},Et=mt=>{const[St,Pt]=this.screenToPageTranslation(mt.movementX,mt.movementY);this._uiManager.dragSelectedEditors(St,Pt)},window.addEventListener("pointermove",Et,fr));const xt=()=>{if(window.removeEventListener("pointerup",xt),window.removeEventListener("blur",xt),ir&&window.removeEventListener("pointermove",Et,fr),yr(this,at,!1),!this._uiManager.endDragSession()){const{isMac:mt}=o.FeatureTest.platform;kt.ctrlKey&&!mt||kt.shiftKey||kt.metaKey&&mt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",xt),window.addEventListener("blur",xt)},Sr(Jt,vt),mn(Jt,"_borderLineWidth",-1),mn(Jt,"_colorManager",new a.ColorManager),mn(Jt,"_zIndex",1),mn(Jt,"SMALL_EDITOR_SIZE",0);let d=Jt;i.AnnotationEditor=d;class h extends d{constructor(kt){super(kt),this.annotationElementId=kt.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,i,s)=>{var rt,it,et,nt,at,js,pt,dt,wt,lt,gt,wo,yt,bt,Tt,er,zt,ar,Jt,Yt,kt,ir,fr,Et,xt,mt,St,Pt,Nt,Lt,lr,ur,wr,vr,Fr,Rr,jr,xr,hr,jt,sr,_r,Ar,Mr,Ur,Er,pr,Eo,Bs,Us,vs,$s,zs,Sn,os,So,bo,Hs,ls,Ws;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=c,i.opacityToHex=d;var a=s(1),o=s(6);function c(rn,dr,Nr){for(const Xr of Nr)dr.addEventListener(Xr,rn[Xr].bind(rn))}function d(rn){return Math.round(Math.min(255,Math.max(1,255*rn))).toString(16).padStart(2,"0")}class h{constructor(){Sr(this,rt,0)}getId(){return`${a.AnnotationEditorPrefix}${On(this,rt)._++}`}}rt=new WeakMap;const ot=class ot{constructor(){Sr(this,at);Sr(this,it,(0,a.getUuid)());Sr(this,et,0);Sr(this,nt,null)}static get _isSVGFittingCanvas(){const dr='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Xr=new OffscreenCanvas(1,3).getContext("2d"),Jr=new Image;Jr.src=dr;const on=Jr.decode().then(()=>(Xr.drawImage(Jr,0,0,1,1,0,0,1,3),new Uint32Array(Xr.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,a.shadow)(this,"_isSVGFittingCanvas",on)}async getFromFile(dr){const{lastModified:Nr,name:Xr,size:Jr,type:on}=dr;return mr(this,at,js).call(this,`${Nr}_${Xr}_${Jr}_${on}`,dr)}async getFromUrl(dr){return mr(this,at,js).call(this,dr,dr)}async getFromId(dr){ht(this,nt)||yr(this,nt,new Map);const Nr=ht(this,nt).get(dr);return Nr?Nr.bitmap?(Nr.refCounter+=1,Nr):Nr.file?this.getFromFile(Nr.file):this.getFromUrl(Nr.url):null}getSvgUrl(dr){const Nr=ht(this,nt).get(dr);return Nr!=null&&Nr.isSvg?Nr.svgUrl:null}deleteId(dr){ht(this,nt)||yr(this,nt,new Map);const Nr=ht(this,nt).get(dr);Nr&&(Nr.refCounter-=1,Nr.refCounter===0&&(Nr.bitmap=null))}isValidId(dr){return dr.startsWith(`image_${ht(this,it)}_`)}};it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakSet,js=async function(dr,Nr){ht(this,nt)||yr(this,nt,new Map);let Xr=ht(this,nt).get(dr);if(Xr===null)return null;if(Xr!=null&&Xr.bitmap)return Xr.refCounter+=1,Xr;try{Xr||(Xr={bitmap:null,id:`image_${ht(this,it)}_${On(this,et)._++}`,refCounter:0,isSvg:!1});let Jr;if(typeof Nr=="string"){Xr.url=Nr;const on=await fetch(Nr);if(!on.ok)throw new Error(on.statusText);Jr=await on.blob()}else Jr=Xr.file=Nr;if(Jr.type==="image/svg+xml"){const on=ot._isSVGFittingCanvas,Qr=new FileReader,cr=new Image,rr=new Promise((gr,Or)=>{cr.onload=()=>{Xr.bitmap=cr,Xr.isSvg=!0,gr()},Qr.onload=async()=>{const Ir=Xr.svgUrl=Qr.result;cr.src=await on?`${Ir}#svgView(preserveAspectRatio(none))`:Ir},cr.onerror=Qr.onerror=Or});Qr.readAsDataURL(Jr),await rr}else Xr.bitmap=await createImageBitmap(Jr);Xr.refCounter=1}catch(Jr){console.error(Jr),Xr=null}return ht(this,nt).set(dr,Xr),Xr&&ht(this,nt).set(Xr.id,Xr),Xr};let g=ot;class _{constructor(dr=128){Sr(this,pt,[]);Sr(this,dt,!1);Sr(this,wt);Sr(this,lt,-1);yr(this,wt,dr)}add({cmd:dr,undo:Nr,mustExec:Xr,type:Jr=NaN,overwriteIfSameType:on=!1,keepUndo:Qr=!1}){if(Xr&&dr(),ht(this,dt))return;const cr={cmd:dr,undo:Nr,type:Jr};if(ht(this,lt)===-1){ht(this,pt).length>0&&(ht(this,pt).length=0),yr(this,lt,0),ht(this,pt).push(cr);return}if(on&&ht(this,pt)[ht(this,lt)].type===Jr){Qr&&(cr.undo=ht(this,pt)[ht(this,lt)].undo),ht(this,pt)[ht(this,lt)]=cr;return}const rr=ht(this,lt)+1;rr===ht(this,wt)?ht(this,pt).splice(0,1):(yr(this,lt,rr),rr<ht(this,pt).length&&ht(this,pt).splice(rr)),ht(this,pt).push(cr)}undo(){ht(this,lt)!==-1&&(yr(this,dt,!0),ht(this,pt)[ht(this,lt)].undo(),yr(this,dt,!1),yr(this,lt,ht(this,lt)-1))}redo(){ht(this,lt)<ht(this,pt).length-1&&(yr(this,lt,ht(this,lt)+1),yr(this,dt,!0),ht(this,pt)[ht(this,lt)].cmd(),yr(this,dt,!1))}hasSomethingToUndo(){return ht(this,lt)!==-1}hasSomethingToRedo(){return ht(this,lt)<ht(this,pt).length-1}destroy(){yr(this,pt,null)}}pt=new WeakMap,dt=new WeakMap,wt=new WeakMap,lt=new WeakMap,i.CommandManager=_;class b{constructor(dr){Sr(this,gt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Nr}=a.FeatureTest.platform;for(const[Xr,Jr,on={}]of dr)for(const Qr of Xr){const cr=Qr.startsWith("mac+");Nr&&cr?(this.callbacks.set(Qr.slice(4),{callback:Jr,options:on}),this.allKeys.add(Qr.split("+").at(-1))):!Nr&&!cr&&(this.callbacks.set(Qr,{callback:Jr,options:on}),this.allKeys.add(Qr.split("+").at(-1)))}}exec(dr,Nr){if(!this.allKeys.has(Nr.key))return;const Xr=this.callbacks.get(mr(this,gt,wo).call(this,Nr));if(!Xr)return;const{callback:Jr,options:{bubbles:on=!1,args:Qr=[],checker:cr=null}}=Xr;cr&&!cr(dr,Nr)||(Jr.bind(dr,...Qr)(),on||(Nr.stopPropagation(),Nr.preventDefault()))}}gt=new WeakSet,wo=function(dr){dr.altKey&&this.buffer.push("alt"),dr.ctrlKey&&this.buffer.push("ctrl"),dr.metaKey&&this.buffer.push("meta"),dr.shiftKey&&this.buffer.push("shift"),this.buffer.push(dr.key);const Nr=this.buffer.join("+");return this.buffer.length=0,Nr},i.KeyboardManager=b;const At=class At{get _colors(){const dr=new Map([["CanvasText",null],["Canvas",null]]);return(0,o.getColorValues)(dr),(0,a.shadow)(this,"_colors",dr)}convert(dr){const Nr=(0,o.getRGB)(dr);if(!window.matchMedia("(forced-colors: active)").matches)return Nr;for(const[Xr,Jr]of this._colors)if(Jr.every((on,Qr)=>on===Nr[Qr]))return At._colorsMapping.get(Xr);return Nr}getHexCode(dr){const Nr=this._colors.get(dr);return Nr?a.Util.makeHexColor(...Nr):dr}};mn(At,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let tt=At;i.ColorManager=tt;const an=class an{constructor(dr,Nr,Xr,Jr,on,Qr){Sr(this,pr);Sr(this,yt,null);Sr(this,bt,new Map);Sr(this,Tt,new Map);Sr(this,er,null);Sr(this,zt,null);Sr(this,ar,new _);Sr(this,Jt,0);Sr(this,Yt,new Set);Sr(this,kt,null);Sr(this,ir,null);Sr(this,fr,new Set);Sr(this,Et,null);Sr(this,xt,new h);Sr(this,mt,!1);Sr(this,St,!1);Sr(this,Pt,null);Sr(this,Nt,a.AnnotationEditorType.NONE);Sr(this,Lt,new Set);Sr(this,lr,null);Sr(this,ur,this.blur.bind(this));Sr(this,wr,this.focus.bind(this));Sr(this,vr,this.copy.bind(this));Sr(this,Fr,this.cut.bind(this));Sr(this,Rr,this.paste.bind(this));Sr(this,jr,this.keydown.bind(this));Sr(this,xr,this.onEditingAction.bind(this));Sr(this,hr,this.onPageChanging.bind(this));Sr(this,jt,this.onScaleChanging.bind(this));Sr(this,sr,this.onRotationChanging.bind(this));Sr(this,_r,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Sr(this,Ar,[0,0]);Sr(this,Mr,null);Sr(this,Ur,null);Sr(this,Er,null);yr(this,Ur,dr),yr(this,Er,Nr),yr(this,er,Xr),this._eventBus=Jr,this._eventBus._on("editingaction",ht(this,xr)),this._eventBus._on("pagechanging",ht(this,hr)),this._eventBus._on("scalechanging",ht(this,jt)),this._eventBus._on("rotationchanging",ht(this,sr)),yr(this,zt,on.annotationStorage),yr(this,Et,on.filterFactory),yr(this,lr,Qr),this.viewParameters={realScale:o.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const dr=an.prototype,Nr=on=>{const{activeElement:Qr}=document;return Qr&&ht(on,Ur).contains(Qr)&&on.hasSomethingToControl()},Xr=this.TRANSLATE_SMALL,Jr=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new b([[["ctrl+a","mac+meta+a"],dr.selectAll],[["ctrl+z","mac+meta+z"],dr.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],dr.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],dr.delete],[["Escape","mac+Escape"],dr.unselectAll],[["ArrowLeft","mac+ArrowLeft"],dr.translateSelectedEditors,{args:[-Xr,0],checker:Nr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],dr.translateSelectedEditors,{args:[-Jr,0],checker:Nr}],[["ArrowRight","mac+ArrowRight"],dr.translateSelectedEditors,{args:[Xr,0],checker:Nr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],dr.translateSelectedEditors,{args:[Jr,0],checker:Nr}],[["ArrowUp","mac+ArrowUp"],dr.translateSelectedEditors,{args:[0,-Xr],checker:Nr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],dr.translateSelectedEditors,{args:[0,-Jr],checker:Nr}],[["ArrowDown","mac+ArrowDown"],dr.translateSelectedEditors,{args:[0,Xr],checker:Nr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],dr.translateSelectedEditors,{args:[0,Jr],checker:Nr}]]))}destroy(){mr(this,pr,vs).call(this),mr(this,pr,Bs).call(this),this._eventBus._off("editingaction",ht(this,xr)),this._eventBus._off("pagechanging",ht(this,hr)),this._eventBus._off("scalechanging",ht(this,jt)),this._eventBus._off("rotationchanging",ht(this,sr));for(const dr of ht(this,Tt).values())dr.destroy();ht(this,Tt).clear(),ht(this,bt).clear(),ht(this,fr).clear(),yr(this,yt,null),ht(this,Lt).clear(),ht(this,ar).destroy(),ht(this,er).destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",ht(this,lr)?ht(this,Et).addHCMFilter(ht(this,lr).foreground,ht(this,lr).background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(ht(this,Ur)).direction)}editAltText(dr){var Nr;(Nr=ht(this,er))==null||Nr.editAltText(this,dr)}onPageChanging({pageNumber:dr}){yr(this,Jt,dr-1)}focusMainContainer(){ht(this,Ur).focus()}findParent(dr,Nr){for(const Xr of ht(this,Tt).values()){const{x:Jr,y:on,width:Qr,height:cr}=Xr.div.getBoundingClientRect();if(dr>=Jr&&dr<=Jr+Qr&&Nr>=on&&Nr<=on+cr)return Xr}return null}disableUserSelect(dr=!1){ht(this,Er).classList.toggle("noUserSelect",dr)}addShouldRescale(dr){ht(this,fr).add(dr)}removeShouldRescale(dr){ht(this,fr).delete(dr)}onScaleChanging({scale:dr}){this.commitOrRemove(),this.viewParameters.realScale=dr*o.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Nr of ht(this,fr))Nr.onScaleChanging()}onRotationChanging({pagesRotation:dr}){this.commitOrRemove(),this.viewParameters.rotation=dr}addToAnnotationStorage(dr){!dr.isEmpty()&&ht(this,zt)&&!ht(this,zt).has(dr.id)&&ht(this,zt).setValue(dr.id,dr)}blur(){if(!this.hasSelection)return;const{activeElement:dr}=document;for(const Nr of ht(this,Lt))if(Nr.div.contains(dr)){yr(this,Pt,[Nr,dr]),Nr._focusEventsAllowed=!1;break}}focus(){if(!ht(this,Pt))return;const[dr,Nr]=ht(this,Pt);yr(this,Pt,null),Nr.addEventListener("focusin",()=>{dr._focusEventsAllowed=!0},{once:!0}),Nr.focus()}addEditListeners(){mr(this,pr,Us).call(this),mr(this,pr,$s).call(this)}removeEditListeners(){mr(this,pr,vs).call(this),mr(this,pr,zs).call(this)}copy(dr){var Xr;if(dr.preventDefault(),(Xr=ht(this,yt))==null||Xr.commitOrRemove(),!this.hasSelection)return;const Nr=[];for(const Jr of ht(this,Lt)){const on=Jr.serialize(!0);on&&Nr.push(on)}Nr.length!==0&&dr.clipboardData.setData("application/pdfjs",JSON.stringify(Nr))}cut(dr){this.copy(dr),this.delete()}paste(dr){dr.preventDefault();const{clipboardData:Nr}=dr;for(const on of Nr.items)for(const Qr of ht(this,ir))if(Qr.isHandlingMimeForPasting(on.type)){Qr.paste(on,this.currentLayer);return}let Xr=Nr.getData("application/pdfjs");if(!Xr)return;try{Xr=JSON.parse(Xr)}catch(on){(0,a.warn)(`paste: "${on.message}".`);return}if(!Array.isArray(Xr))return;this.unselectAll();const Jr=this.currentLayer;try{const on=[];for(const rr of Xr){const gr=Jr.deserialize(rr);if(!gr)return;on.push(gr)}const Qr=()=>{for(const rr of on)mr(this,pr,Hs).call(this,rr);mr(this,pr,Ws).call(this,on)},cr=()=>{for(const rr of on)rr.remove()};this.addCommands({cmd:Qr,undo:cr,mustExec:!0})}catch(on){(0,a.warn)(`paste: "${on.message}".`)}}keydown(dr){var Nr;(Nr=this.getActive())!=null&&Nr.shouldGetKeyboardEvents()||an._keyboardManager.exec(this,dr)}onEditingAction(dr){["undo","redo","delete","selectAll"].includes(dr.name)&&this[dr.name]()}setEditingState(dr){dr?(mr(this,pr,Eo).call(this),mr(this,pr,Us).call(this),mr(this,pr,$s).call(this),mr(this,pr,Sn).call(this,{isEditing:ht(this,Nt)!==a.AnnotationEditorType.NONE,isEmpty:mr(this,pr,ls).call(this),hasSomethingToUndo:ht(this,ar).hasSomethingToUndo(),hasSomethingToRedo:ht(this,ar).hasSomethingToRedo(),hasSelectedEditor:!1})):(mr(this,pr,Bs).call(this),mr(this,pr,vs).call(this),mr(this,pr,zs).call(this),mr(this,pr,Sn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(dr){if(!ht(this,ir)){yr(this,ir,dr);for(const Nr of ht(this,ir))mr(this,pr,os).call(this,Nr.defaultPropertiesToUpdate)}}getId(){return ht(this,xt).getId()}get currentLayer(){return ht(this,Tt).get(ht(this,Jt))}getLayer(dr){return ht(this,Tt).get(dr)}get currentPageIndex(){return ht(this,Jt)}addLayer(dr){ht(this,Tt).set(dr.pageIndex,dr),ht(this,mt)?dr.enable():dr.disable()}removeLayer(dr){ht(this,Tt).delete(dr.pageIndex)}updateMode(dr,Nr=null){if(ht(this,Nt)!==dr){if(yr(this,Nt,dr),dr===a.AnnotationEditorType.NONE){this.setEditingState(!1),mr(this,pr,bo).call(this);return}this.setEditingState(!0),mr(this,pr,So).call(this),this.unselectAll();for(const Xr of ht(this,Tt).values())Xr.updateMode(dr);if(Nr){for(const Xr of ht(this,bt).values())if(Xr.annotationElementId===Nr){this.setSelected(Xr),Xr.enterInEditMode();break}}}}updateToolbar(dr){dr!==ht(this,Nt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:dr})}updateParams(dr,Nr){if(ht(this,ir)){if(dr===a.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(dr);return}for(const Xr of ht(this,Lt))Xr.updateParams(dr,Nr);for(const Xr of ht(this,ir))Xr.updateDefaultParams(dr,Nr)}}enableWaiting(dr=!1){if(ht(this,St)!==dr){yr(this,St,dr);for(const Nr of ht(this,Tt).values())dr?Nr.disableClick():Nr.enableClick(),Nr.div.classList.toggle("waiting",dr)}}getEditors(dr){const Nr=[];for(const Xr of ht(this,bt).values())Xr.pageIndex===dr&&Nr.push(Xr);return Nr}getEditor(dr){return ht(this,bt).get(dr)}addEditor(dr){ht(this,bt).set(dr.id,dr)}removeEditor(dr){var Nr;ht(this,bt).delete(dr.id),this.unselect(dr),(!dr.annotationElementId||!ht(this,Yt).has(dr.annotationElementId))&&((Nr=ht(this,zt))==null||Nr.remove(dr.id))}addDeletedAnnotationElement(dr){ht(this,Yt).add(dr.annotationElementId),dr.deleted=!0}isDeletedAnnotationElement(dr){return ht(this,Yt).has(dr)}removeDeletedAnnotationElement(dr){ht(this,Yt).delete(dr.annotationElementId),dr.deleted=!1}setActiveEditor(dr){ht(this,yt)!==dr&&(yr(this,yt,dr),dr&&mr(this,pr,os).call(this,dr.propertiesToUpdate))}toggleSelected(dr){if(ht(this,Lt).has(dr)){ht(this,Lt).delete(dr),dr.unselect(),mr(this,pr,Sn).call(this,{hasSelectedEditor:this.hasSelection});return}ht(this,Lt).add(dr),dr.select(),mr(this,pr,os).call(this,dr.propertiesToUpdate),mr(this,pr,Sn).call(this,{hasSelectedEditor:!0})}setSelected(dr){for(const Nr of ht(this,Lt))Nr!==dr&&Nr.unselect();ht(this,Lt).clear(),ht(this,Lt).add(dr),dr.select(),mr(this,pr,os).call(this,dr.propertiesToUpdate),mr(this,pr,Sn).call(this,{hasSelectedEditor:!0})}isSelected(dr){return ht(this,Lt).has(dr)}unselect(dr){dr.unselect(),ht(this,Lt).delete(dr),mr(this,pr,Sn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return ht(this,Lt).size!==0}undo(){ht(this,ar).undo(),mr(this,pr,Sn).call(this,{hasSomethingToUndo:ht(this,ar).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:mr(this,pr,ls).call(this)})}redo(){ht(this,ar).redo(),mr(this,pr,Sn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:ht(this,ar).hasSomethingToRedo(),isEmpty:mr(this,pr,ls).call(this)})}addCommands(dr){ht(this,ar).add(dr),mr(this,pr,Sn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:mr(this,pr,ls).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const dr=[...ht(this,Lt)],Nr=()=>{for(const Jr of dr)Jr.remove()},Xr=()=>{for(const Jr of dr)mr(this,pr,Hs).call(this,Jr)};this.addCommands({cmd:Nr,undo:Xr,mustExec:!0})}commitOrRemove(){var dr;(dr=ht(this,yt))==null||dr.commitOrRemove()}hasSomethingToControl(){return ht(this,yt)||this.hasSelection}selectAll(){for(const dr of ht(this,Lt))dr.commit();mr(this,pr,Ws).call(this,ht(this,bt).values())}unselectAll(){if(ht(this,yt)){ht(this,yt).commitOrRemove();return}if(this.hasSelection){for(const dr of ht(this,Lt))dr.unselect();ht(this,Lt).clear(),mr(this,pr,Sn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(dr,Nr,Xr=!1){if(Xr||this.commitOrRemove(),!this.hasSelection)return;ht(this,Ar)[0]+=dr,ht(this,Ar)[1]+=Nr;const[Jr,on]=ht(this,Ar),Qr=[...ht(this,Lt)],cr=1e3;ht(this,Mr)&&clearTimeout(ht(this,Mr)),yr(this,Mr,setTimeout(()=>{yr(this,Mr,null),ht(this,Ar)[0]=ht(this,Ar)[1]=0,this.addCommands({cmd:()=>{for(const rr of Qr)ht(this,bt).has(rr.id)&&rr.translateInPage(Jr,on)},undo:()=>{for(const rr of Qr)ht(this,bt).has(rr.id)&&rr.translateInPage(-Jr,-on)},mustExec:!1})},cr));for(const rr of Qr)rr.translateInPage(dr,Nr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),yr(this,kt,new Map);for(const dr of ht(this,Lt))ht(this,kt).set(dr,{savedX:dr.x,savedY:dr.y,savedPageIndex:dr.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!ht(this,kt))return!1;this.disableUserSelect(!1);const dr=ht(this,kt);yr(this,kt,null);let Nr=!1;for(const[{x:Jr,y:on,pageIndex:Qr},cr]of dr)cr.newX=Jr,cr.newY=on,cr.newPageIndex=Qr,Nr||(Nr=Jr!==cr.savedX||on!==cr.savedY||Qr!==cr.savedPageIndex);if(!Nr)return!1;const Xr=(Jr,on,Qr,cr)=>{if(ht(this,bt).has(Jr.id)){const rr=ht(this,Tt).get(cr);rr?Jr._setParentAndPosition(rr,on,Qr):(Jr.pageIndex=cr,Jr.x=on,Jr.y=Qr)}};return this.addCommands({cmd:()=>{for(const[Jr,{newX:on,newY:Qr,newPageIndex:cr}]of dr)Xr(Jr,on,Qr,cr)},undo:()=>{for(const[Jr,{savedX:on,savedY:Qr,savedPageIndex:cr}]of dr)Xr(Jr,on,Qr,cr)},mustExec:!0}),!0}dragSelectedEditors(dr,Nr){if(ht(this,kt))for(const Xr of ht(this,kt).keys())Xr.drag(dr,Nr)}rebuild(dr){if(dr.parent===null){const Nr=this.getLayer(dr.pageIndex);Nr?(Nr.changeParent(dr),Nr.addOrRebuild(dr)):(this.addEditor(dr),this.addToAnnotationStorage(dr),dr.rebuild())}else dr.parent.addOrRebuild(dr)}isActive(dr){return ht(this,yt)===dr}getActive(){return ht(this,yt)}getMode(){return ht(this,Nt)}get imageManager(){return(0,a.shadow)(this,"imageManager",new g)}};yt=new WeakMap,bt=new WeakMap,Tt=new WeakMap,er=new WeakMap,zt=new WeakMap,ar=new WeakMap,Jt=new WeakMap,Yt=new WeakMap,kt=new WeakMap,ir=new WeakMap,fr=new WeakMap,Et=new WeakMap,xt=new WeakMap,mt=new WeakMap,St=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,Lt=new WeakMap,lr=new WeakMap,ur=new WeakMap,wr=new WeakMap,vr=new WeakMap,Fr=new WeakMap,Rr=new WeakMap,jr=new WeakMap,xr=new WeakMap,hr=new WeakMap,jt=new WeakMap,sr=new WeakMap,_r=new WeakMap,Ar=new WeakMap,Mr=new WeakMap,Ur=new WeakMap,Er=new WeakMap,pr=new WeakSet,Eo=function(){window.addEventListener("focus",ht(this,wr)),window.addEventListener("blur",ht(this,ur))},Bs=function(){window.removeEventListener("focus",ht(this,wr)),window.removeEventListener("blur",ht(this,ur))},Us=function(){window.addEventListener("keydown",ht(this,jr),{capture:!0})},vs=function(){window.removeEventListener("keydown",ht(this,jr),{capture:!0})},$s=function(){document.addEventListener("copy",ht(this,vr)),document.addEventListener("cut",ht(this,Fr)),document.addEventListener("paste",ht(this,Rr))},zs=function(){document.removeEventListener("copy",ht(this,vr)),document.removeEventListener("cut",ht(this,Fr)),document.removeEventListener("paste",ht(this,Rr))},Sn=function(dr){Object.entries(dr).some(([Xr,Jr])=>ht(this,_r)[Xr]!==Jr)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(ht(this,_r),dr)})},os=function(dr){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:dr})},So=function(){if(!ht(this,mt)){yr(this,mt,!0);for(const dr of ht(this,Tt).values())dr.enable()}},bo=function(){if(this.unselectAll(),ht(this,mt)){yr(this,mt,!1);for(const dr of ht(this,Tt).values())dr.disable()}},Hs=function(dr){const Nr=ht(this,Tt).get(dr.pageIndex);Nr?Nr.addOrRebuild(dr):this.addEditor(dr)},ls=function(){if(ht(this,bt).size===0)return!0;if(ht(this,bt).size===1)for(const dr of ht(this,bt).values())return dr.isEmpty();return!1},Ws=function(dr){ht(this,Lt).clear();for(const Nr of dr)Nr.isEmpty()||(ht(this,Lt).add(Nr),Nr.select());mr(this,pr,Sn).call(this,{hasSelectedEditor:!0})},mn(an,"TRANSLATE_SMALL",1),mn(an,"TRANSLATE_BIG",10);let _e=an;i.AnnotationEditorUIManager=_e},(e,i,s)=>{var Jt,Yt,kt,ir,fr,Et,xt,mt,St,Pt,Nt,Lt,Xn,Gn,Vs,_s,ys,cs,us;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=void 0,i.deprecated=lt,i.getColorValues=bt,i.getCurrentTransform=Tt,i.getCurrentTransformInverse=er,i.getFilenameFromUrl=at,i.getPdfFilenameFromUrl=st,i.getRGB=yt,i.getXfaPageViewport=At,i.isDataScheme=et,i.isPdfFile=nt,i.isValidFetchUrl=pt,i.loadScript=wt,i.noContextMenu=dt,i.setLayerDimensions=zt;var a=s(7),o=s(1);const c="http://www.w3.org/2000/svg",ar=class ar{};mn(ar,"CSS",96),mn(ar,"PDF",72),mn(ar,"PDF_TO_CSS_UNITS",ar.CSS/ar.PDF);let d=ar;i.PixelsPerInch=d;class h extends a.BaseFilterFactory{constructor({docId:jt,ownerDocument:sr=globalThis.document}={}){super();Sr(this,Lt);Sr(this,Jt);Sr(this,Yt);Sr(this,kt);Sr(this,ir);Sr(this,fr);Sr(this,Et);Sr(this,xt);Sr(this,mt);Sr(this,St);Sr(this,Pt);Sr(this,Nt,0);yr(this,kt,jt),yr(this,ir,sr)}addFilter(jt){if(!jt)return"none";let sr=ht(this,Lt,Xn).get(jt);if(sr)return sr;let _r,Ar,Mr,Ur;if(jt.length===1){const zr=jt[0],en=new Array(256);for(let sn=0;sn<256;sn++)en[sn]=zr[sn]/255;Ur=_r=Ar=Mr=en.join(",")}else{const[zr,en,sn]=jt,dn=new Array(256),Kr=new Array(256),tn=new Array(256);for(let fn=0;fn<256;fn++)dn[fn]=zr[fn]/255,Kr[fn]=en[fn]/255,tn[fn]=sn[fn]/255;_r=dn.join(","),Ar=Kr.join(","),Mr=tn.join(","),Ur=`${_r}${Ar}${Mr}`}if(sr=ht(this,Lt,Xn).get(Ur),sr)return ht(this,Lt,Xn).set(jt,sr),sr;const Er=`g_${ht(this,kt)}_transfer_map_${On(this,Nt)._++}`,pr=`url(#${Er})`;ht(this,Lt,Xn).set(jt,pr),ht(this,Lt,Xn).set(Ur,pr);const Wr=mr(this,Lt,_s).call(this,Er);return mr(this,Lt,cs).call(this,_r,Ar,Mr,Wr),pr}addHCMFilter(jt,sr){var en;const _r=`${jt}-${sr}`;if(ht(this,Et)===_r)return ht(this,xt);if(yr(this,Et,_r),yr(this,xt,"none"),(en=ht(this,fr))==null||en.remove(),!jt||!sr)return ht(this,xt);const Ar=mr(this,Lt,us).call(this,jt);jt=o.Util.makeHexColor(...Ar);const Mr=mr(this,Lt,us).call(this,sr);if(sr=o.Util.makeHexColor(...Mr),ht(this,Lt,Gn).style.color="",jt==="#000000"&&sr==="#ffffff"||jt===sr)return ht(this,xt);const Ur=new Array(256);for(let sn=0;sn<=255;sn++){const dn=sn/255;Ur[sn]=dn<=.03928?dn/12.92:((dn+.055)/1.055)**2.4}const Er=Ur.join(","),pr=`g_${ht(this,kt)}_hcm_filter`,Wr=yr(this,mt,mr(this,Lt,_s).call(this,pr));mr(this,Lt,cs).call(this,Er,Er,Er,Wr),mr(this,Lt,Vs).call(this,Wr);const zr=(sn,dn)=>{const Kr=Ar[sn]/255,tn=Mr[sn]/255,fn=new Array(dn+1);for(let hn=0;hn<=dn;hn++)fn[hn]=Kr+hn/dn*(tn-Kr);return fn.join(",")};return mr(this,Lt,cs).call(this,zr(0,5),zr(1,5),zr(2,5),Wr),yr(this,xt,`url(#${pr})`),ht(this,xt)}addHighlightHCMFilter(jt,sr,_r,Ar){var tn;const Mr=`${jt}-${sr}-${_r}-${Ar}`;if(ht(this,St)===Mr)return ht(this,Pt);if(yr(this,St,Mr),yr(this,Pt,"none"),(tn=ht(this,mt))==null||tn.remove(),!jt||!sr)return ht(this,Pt);const[Ur,Er]=[jt,sr].map(mr(this,Lt,us).bind(this));let pr=Math.round(.2126*Ur[0]+.7152*Ur[1]+.0722*Ur[2]),Wr=Math.round(.2126*Er[0]+.7152*Er[1]+.0722*Er[2]),[zr,en]=[_r,Ar].map(mr(this,Lt,us).bind(this));Wr<pr&&([pr,Wr,zr,en]=[Wr,pr,en,zr]),ht(this,Lt,Gn).style.color="";const sn=(fn,hn,Br)=>{const br=new Array(256),Cr=(Wr-pr)/Br,Hr=fn/255,an=(hn-fn)/(255*Br);let rn=0;for(let dr=0;dr<=Br;dr++){const Nr=Math.round(pr+dr*Cr),Xr=Hr+dr*an;for(let Jr=rn;Jr<=Nr;Jr++)br[Jr]=Xr;rn=Nr+1}for(let dr=rn;dr<256;dr++)br[dr]=br[rn-1];return br.join(",")},dn=`g_${ht(this,kt)}_hcm_highlight_filter`,Kr=yr(this,mt,mr(this,Lt,_s).call(this,dn));return mr(this,Lt,Vs).call(this,Kr),mr(this,Lt,cs).call(this,sn(zr[0],en[0],5),sn(zr[1],en[1],5),sn(zr[2],en[2],5),Kr),yr(this,Pt,`url(#${dn})`),ht(this,Pt)}destroy(jt=!1){jt&&(ht(this,xt)||ht(this,Pt))||(ht(this,Yt)&&(ht(this,Yt).parentNode.parentNode.remove(),yr(this,Yt,null)),ht(this,Jt)&&(ht(this,Jt).clear(),yr(this,Jt,null)),yr(this,Nt,0))}}Jt=new WeakMap,Yt=new WeakMap,kt=new WeakMap,ir=new WeakMap,fr=new WeakMap,Et=new WeakMap,xt=new WeakMap,mt=new WeakMap,St=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,Lt=new WeakSet,Xn=function(){return ht(this,Jt)||yr(this,Jt,new Map)},Gn=function(){if(!ht(this,Yt)){const jt=ht(this,ir).createElement("div"),{style:sr}=jt;sr.visibility="hidden",sr.contain="strict",sr.width=sr.height=0,sr.position="absolute",sr.top=sr.left=0,sr.zIndex=-1;const _r=ht(this,ir).createElementNS(c,"svg");_r.setAttribute("width",0),_r.setAttribute("height",0),yr(this,Yt,ht(this,ir).createElementNS(c,"defs")),jt.append(_r),_r.append(ht(this,Yt)),ht(this,ir).body.append(jt)}return ht(this,Yt)},Vs=function(jt){const sr=ht(this,ir).createElementNS(c,"feColorMatrix");sr.setAttribute("type","matrix"),sr.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),jt.append(sr)},_s=function(jt){const sr=ht(this,ir).createElementNS(c,"filter");return sr.setAttribute("color-interpolation-filters","sRGB"),sr.setAttribute("id",jt),ht(this,Lt,Gn).append(sr),sr},ys=function(jt,sr,_r){const Ar=ht(this,ir).createElementNS(c,sr);Ar.setAttribute("type","discrete"),Ar.setAttribute("tableValues",_r),jt.append(Ar)},cs=function(jt,sr,_r,Ar){const Mr=ht(this,ir).createElementNS(c,"feComponentTransfer");Ar.append(Mr),mr(this,Lt,ys).call(this,Mr,"feFuncR",jt),mr(this,Lt,ys).call(this,Mr,"feFuncG",sr),mr(this,Lt,ys).call(this,Mr,"feFuncB",_r)},us=function(jt){return ht(this,Lt,Gn).style.color=jt,yt(getComputedStyle(ht(this,Lt,Gn)).getPropertyValue("color"))},i.DOMFilterFactory=h;class g extends a.BaseCanvasFactory{constructor({ownerDocument:hr=globalThis.document}={}){super(),this._document=hr}_createCanvas(hr,jt){const sr=this._document.createElement("canvas");return sr.width=hr,sr.height=jt,sr}}i.DOMCanvasFactory=g;async function _(xr,hr=!1){if(pt(xr,document.baseURI)){const jt=await fetch(xr);if(!jt.ok)throw new Error(jt.statusText);return hr?new Uint8Array(await jt.arrayBuffer()):(0,o.stringToBytes)(await jt.text())}return new Promise((jt,sr)=>{const _r=new XMLHttpRequest;_r.open("GET",xr,!0),hr&&(_r.responseType="arraybuffer"),_r.onreadystatechange=()=>{if(_r.readyState===XMLHttpRequest.DONE){if(_r.status===200||_r.status===0){let Ar;if(hr&&_r.response?Ar=new Uint8Array(_r.response):!hr&&_r.responseText&&(Ar=(0,o.stringToBytes)(_r.responseText)),Ar){jt(Ar);return}}sr(new Error(_r.statusText))}},_r.send(null)})}class b extends a.BaseCMapReaderFactory{_fetchData(hr,jt){return _(hr,this.isCompressed).then(sr=>({cMapData:sr,compressionType:jt}))}}i.DOMCMapReaderFactory=b;class tt extends a.BaseStandardFontDataFactory{_fetchData(hr){return _(hr,!0)}}i.DOMStandardFontDataFactory=tt;class _e extends a.BaseSVGFactory{_createSVG(hr){return document.createElementNS(c,hr)}}i.DOMSVGFactory=_e;class rt{constructor({viewBox:hr,scale:jt,rotation:sr,offsetX:_r=0,offsetY:Ar=0,dontFlip:Mr=!1}){this.viewBox=hr,this.scale=jt,this.rotation=sr,this.offsetX=_r,this.offsetY=Ar;const Ur=(hr[2]+hr[0])/2,Er=(hr[3]+hr[1])/2;let pr,Wr,zr,en;switch(sr%=360,sr<0&&(sr+=360),sr){case 180:pr=-1,Wr=0,zr=0,en=1;break;case 90:pr=0,Wr=1,zr=1,en=0;break;case 270:pr=0,Wr=-1,zr=-1,en=0;break;case 0:pr=1,Wr=0,zr=0,en=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Mr&&(zr=-zr,en=-en);let sn,dn,Kr,tn;pr===0?(sn=Math.abs(Er-hr[1])*jt+_r,dn=Math.abs(Ur-hr[0])*jt+Ar,Kr=(hr[3]-hr[1])*jt,tn=(hr[2]-hr[0])*jt):(sn=Math.abs(Ur-hr[0])*jt+_r,dn=Math.abs(Er-hr[1])*jt+Ar,Kr=(hr[2]-hr[0])*jt,tn=(hr[3]-hr[1])*jt),this.transform=[pr*jt,Wr*jt,zr*jt,en*jt,sn-pr*jt*Ur-zr*jt*Er,dn-Wr*jt*Ur-en*jt*Er],this.width=Kr,this.height=tn}get rawDims(){const{viewBox:hr}=this;return(0,o.shadow)(this,"rawDims",{pageWidth:hr[2]-hr[0],pageHeight:hr[3]-hr[1],pageX:hr[0],pageY:hr[1]})}clone({scale:hr=this.scale,rotation:jt=this.rotation,offsetX:sr=this.offsetX,offsetY:_r=this.offsetY,dontFlip:Ar=!1}={}){return new rt({viewBox:this.viewBox.slice(),scale:hr,rotation:jt,offsetX:sr,offsetY:_r,dontFlip:Ar})}convertToViewportPoint(hr,jt){return o.Util.applyTransform([hr,jt],this.transform)}convertToViewportRectangle(hr){const jt=o.Util.applyTransform([hr[0],hr[1]],this.transform),sr=o.Util.applyTransform([hr[2],hr[3]],this.transform);return[jt[0],jt[1],sr[0],sr[1]]}convertToPdfPoint(hr,jt){return o.Util.applyInverseTransform([hr,jt],this.transform)}}i.PageViewport=rt;class it extends o.BaseException{constructor(hr,jt=0){super(hr,"RenderingCancelledException"),this.extraDelay=jt}}i.RenderingCancelledException=it;function et(xr){const hr=xr.length;let jt=0;for(;jt<hr&&xr[jt].trim()==="";)jt++;return xr.substring(jt,jt+5).toLowerCase()==="data:"}function nt(xr){return typeof xr=="string"&&/\.pdf$/i.test(xr)}function at(xr,hr=!1){return hr||([xr]=xr.split(/[#?]/,1)),xr.substring(xr.lastIndexOf("/")+1)}function st(xr,hr="document.pdf"){if(typeof xr!="string")return hr;if(et(xr))return(0,o.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),hr;const jt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,sr=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,_r=jt.exec(xr);let Ar=sr.exec(_r[1])||sr.exec(_r[2])||sr.exec(_r[3]);if(Ar&&(Ar=Ar[0],Ar.includes("%")))try{Ar=sr.exec(decodeURIComponent(Ar))[0]}catch{}return Ar||hr}class ot{constructor(){mn(this,"started",Object.create(null));mn(this,"times",[])}time(hr){hr in this.started&&(0,o.warn)(`Timer is already running for ${hr}`),this.started[hr]=Date.now()}timeEnd(hr){hr in this.started||(0,o.warn)(`Timer has not been started for ${hr}`),this.times.push({name:hr,start:this.started[hr],end:Date.now()}),delete this.started[hr]}toString(){const hr=[];let jt=0;for(const{name:sr}of this.times)jt=Math.max(sr.length,jt);for(const{name:sr,start:_r,end:Ar}of this.times)hr.push(`${sr.padEnd(jt)} ${Ar-_r}ms
`);return hr.join("")}}i.StatTimer=ot;function pt(xr,hr){try{const{protocol:jt}=hr?new URL(xr,hr):new URL(xr);return jt==="http:"||jt==="https:"}catch{return!1}}function dt(xr){xr.preventDefault()}function wt(xr,hr=!1){return new Promise((jt,sr)=>{const _r=document.createElement("script");_r.src=xr,_r.onload=function(Ar){hr&&_r.remove(),jt(Ar)},_r.onerror=function(){sr(new Error(`Cannot load script at: ${_r.src}`))},(document.head||document.documentElement).append(_r)})}function lt(xr){console.log("Deprecated API usage: "+xr)}let gt;class vt{static toDateObject(hr){if(!hr||typeof hr!="string")return null;gt||(gt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const jt=gt.exec(hr);if(!jt)return null;const sr=parseInt(jt[1],10);let _r=parseInt(jt[2],10);_r=_r>=1&&_r<=12?_r-1:0;let Ar=parseInt(jt[3],10);Ar=Ar>=1&&Ar<=31?Ar:1;let Mr=parseInt(jt[4],10);Mr=Mr>=0&&Mr<=23?Mr:0;let Ur=parseInt(jt[5],10);Ur=Ur>=0&&Ur<=59?Ur:0;let Er=parseInt(jt[6],10);Er=Er>=0&&Er<=59?Er:0;const pr=jt[7]||"Z";let Wr=parseInt(jt[8],10);Wr=Wr>=0&&Wr<=23?Wr:0;let zr=parseInt(jt[9],10)||0;return zr=zr>=0&&zr<=59?zr:0,pr==="-"?(Mr+=Wr,Ur+=zr):pr==="+"&&(Mr-=Wr,Ur-=zr),new Date(Date.UTC(sr,_r,Ar,Mr,Ur,Er))}}i.PDFDateString=vt;function At(xr,{scale:hr=1,rotation:jt=0}){const{width:sr,height:_r}=xr.attributes.style,Ar=[0,0,parseInt(sr),parseInt(_r)];return new rt({viewBox:Ar,scale:hr,rotation:jt})}function yt(xr){if(xr.startsWith("#")){const hr=parseInt(xr.slice(1),16);return[(hr&16711680)>>16,(hr&65280)>>8,hr&255]}return xr.startsWith("rgb(")?xr.slice(4,-1).split(",").map(hr=>parseInt(hr)):xr.startsWith("rgba(")?xr.slice(5,-1).split(",").map(hr=>parseInt(hr)).slice(0,3):((0,o.warn)(`Not a valid color format: "${xr}"`),[0,0,0])}function bt(xr){const hr=document.createElement("span");hr.style.visibility="hidden",document.body.append(hr);for(const jt of xr.keys()){hr.style.color=jt;const sr=window.getComputedStyle(hr).color;xr.set(jt,yt(sr))}hr.remove()}function Tt(xr){const{a:hr,b:jt,c:sr,d:_r,e:Ar,f:Mr}=xr.getTransform();return[hr,jt,sr,_r,Ar,Mr]}function er(xr){const{a:hr,b:jt,c:sr,d:_r,e:Ar,f:Mr}=xr.getTransform().invertSelf();return[hr,jt,sr,_r,Ar,Mr]}function zt(xr,hr,jt=!1,sr=!0){if(hr instanceof rt){const{pageWidth:_r,pageHeight:Ar}=hr.rawDims,{style:Mr}=xr,Ur=o.FeatureTest.isCSSRoundSupported,Er=`var(--scale-factor) * ${_r}px`,pr=`var(--scale-factor) * ${Ar}px`,Wr=Ur?`round(${Er}, 1px)`:`calc(${Er})`,zr=Ur?`round(${pr}, 1px)`:`calc(${pr})`;!jt||hr.rotation%180===0?(Mr.width=Wr,Mr.height=zr):(Mr.width=zr,Mr.height=Wr)}sr&&xr.setAttribute("data-main-rotation",hr.rotation)}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var a=s(1);class o{constructor(){this.constructor===o&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(b){return"none"}addHCMFilter(b,tt){return"none"}addHighlightHCMFilter(b,tt,_e,rt){return"none"}destroy(b=!1){}}i.BaseFilterFactory=o;class c{constructor(){this.constructor===c&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(b,tt){if(b<=0||tt<=0)throw new Error("Invalid canvas size");const _e=this._createCanvas(b,tt);return{canvas:_e,context:_e.getContext("2d")}}reset(b,tt,_e){if(!b.canvas)throw new Error("Canvas is not specified");if(tt<=0||_e<=0)throw new Error("Invalid canvas size");b.canvas.width=tt,b.canvas.height=_e}destroy(b){if(!b.canvas)throw new Error("Canvas is not specified");b.canvas.width=0,b.canvas.height=0,b.canvas=null,b.context=null}_createCanvas(b,tt){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=c;class d{constructor({baseUrl:b=null,isCompressed:tt=!0}){this.constructor===d&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=b,this.isCompressed=tt}async fetch({name:b}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!b)throw new Error("CMap name must be specified.");const tt=this.baseUrl+b+(this.isCompressed?".bcmap":""),_e=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(tt,_e).catch(rt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${tt}`)})}_fetchData(b,tt){(0,a.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=d;class h{constructor({baseUrl:b=null}){this.constructor===h&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=b}async fetch({filename:b}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!b)throw new Error("Font filename must be specified.");const tt=`${this.baseUrl}${b}`;return this._fetchData(tt).catch(_e=>{throw new Error(`Unable to load font data at: ${tt}`)})}_fetchData(b){(0,a.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=h;class g{constructor(){this.constructor===g&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(b,tt,_e=!1){if(b<=0||tt<=0)throw new Error("Invalid SVG dimensions");const rt=this._createSVG("svg:svg");return rt.setAttribute("version","1.1"),_e||(rt.setAttribute("width",`${b}px`),rt.setAttribute("height",`${tt}px`)),rt.setAttribute("preserveAspectRatio","none"),rt.setAttribute("viewBox",`0 0 ${b} ${tt}`),rt}createElement(b){if(typeof b!="string")throw new Error("Invalid SVG element type");return this._createSVG(b)}_createSVG(b){(0,a.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=g},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var a=s(1);const o=3285377520,c=4294901760,d=65535;class h{constructor(_){this.h1=_?_&4294967295:o,this.h2=_?_&4294967295:o}update(_){let b,tt;if(typeof _=="string"){b=new Uint8Array(_.length*2),tt=0;for(let lt=0,gt=_.length;lt<gt;lt++){const vt=_.charCodeAt(lt);vt<=255?b[tt++]=vt:(b[tt++]=vt>>>8,b[tt++]=vt&255)}}else if((0,a.isArrayBuffer)(_))b=_.slice(),tt=b.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _e=tt>>2,rt=tt-_e*4,it=new Uint32Array(b.buffer,0,_e);let et=0,nt=0,at=this.h1,st=this.h2;const ot=3432918353,pt=461845907,dt=ot&d,wt=pt&d;for(let lt=0;lt<_e;lt++)lt&1?(et=it[lt],et=et*ot&c|et*dt&d,et=et<<15|et>>>17,et=et*pt&c|et*wt&d,at^=et,at=at<<13|at>>>19,at=at*5+3864292196):(nt=it[lt],nt=nt*ot&c|nt*dt&d,nt=nt<<15|nt>>>17,nt=nt*pt&c|nt*wt&d,st^=nt,st=st<<13|st>>>19,st=st*5+3864292196);switch(et=0,rt){case 3:et^=b[_e*4+2]<<16;case 2:et^=b[_e*4+1]<<8;case 1:et^=b[_e*4],et=et*ot&c|et*dt&d,et=et<<15|et>>>17,et=et*pt&c|et*wt&d,_e&1?at^=et:st^=et}this.h1=at,this.h2=st}hexdigest(){let _=this.h1,b=this.h2;return _^=b>>>1,_=_*3981806797&c|_*36045&d,b=b*4283543511&c|((b<<16|_>>>16)*2950163797&c)>>>16,_^=b>>>1,_=_*444984403&c|_*60499&d,b=b*3301882366&c|((b<<16|_>>>16)*3120437893&c)>>>16,_^=b>>>1,(_>>>0).toString(16).padStart(8,"0")+(b>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=h},(e,i,s)=>{var d;Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var a=s(1);class o{constructor({ownerDocument:g=globalThis.document,styleElement:_=null}){Sr(this,d,new Set);this._document=g,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(g){this.nativeFontFaces.add(g),this._document.fonts.add(g)}removeNativeFontFace(g){this.nativeFontFaces.delete(g),this._document.fonts.delete(g)}insertRule(g){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const _=this.styleElement.sheet;_.insertRule(g,_.cssRules.length)}clear(){for(const g of this.nativeFontFaces)this._document.fonts.delete(g);this.nativeFontFaces.clear(),ht(this,d).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(g){if(!(!g||ht(this,d).has(g.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:_,src:b,style:tt}=g,_e=new FontFace(_,b,tt);this.addNativeFontFace(_e);try{await _e.load(),ht(this,d).add(_)}catch{(0,a.warn)(`Cannot load system font: ${g.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_e)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(g){if(g.attached||g.missingFile&&!g.systemFontInfo)return;if(g.attached=!0,g.systemFontInfo){await this.loadSystemFont(g.systemFontInfo);return}if(this.isFontLoadingAPISupported){const b=g.createNativeFontFace();if(b){this.addNativeFontFace(b);try{await b.loaded}catch(tt){throw(0,a.warn)(`Failed to load font '${b.family}': '${tt}'.`),g.disableFontFace=!0,tt}}return}const _=g.createFontFaceRule();if(_){if(this.insertRule(_),this.isSyncFontLoadingSupported)return;await new Promise(b=>{const tt=this._queueLoadingCallback(b);this._prepareFontLoadEvent(g,tt)})}}get isFontLoadingAPISupported(){var _;const g=!!((_=this._document)!=null&&_.fonts);return(0,a.shadow)(this,"isFontLoadingAPISupported",g)}get isSyncFontLoadingSupported(){let g=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(g=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",g)}_queueLoadingCallback(g){function _(){for((0,a.assert)(!tt.done,"completeRequest() cannot be called twice."),tt.done=!0;b.length>0&&b[0].done;){const _e=b.shift();setTimeout(_e.callback,0)}}const{loadingRequests:b}=this,tt={done:!1,complete:_,callback:g};return b.push(tt),tt}get _loadTestFont(){const g=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",g)}_prepareFontLoadEvent(g,_){function b(yt,bt){return yt.charCodeAt(bt)<<24|yt.charCodeAt(bt+1)<<16|yt.charCodeAt(bt+2)<<8|yt.charCodeAt(bt+3)&255}function tt(yt,bt,Tt,er){const zt=yt.substring(0,bt),ar=yt.substring(bt+Tt);return zt+er+ar}let _e,rt;const it=this._document.createElement("canvas");it.width=1,it.height=1;const et=it.getContext("2d");let nt=0;function at(yt,bt){if(++nt>30){(0,a.warn)("Load test font never loaded."),bt();return}if(et.font="30px "+yt,et.fillText(".",0,20),et.getImageData(0,0,1,1).data[3]>0){bt();return}setTimeout(at.bind(null,yt,bt))}const st=`lt${Date.now()}${this.loadTestFontId++}`;let ot=this._loadTestFont;ot=tt(ot,976,st.length,st);const dt=16,wt=1482184792;let lt=b(ot,dt);for(_e=0,rt=st.length-3;_e<rt;_e+=4)lt=lt-wt+b(st,_e)|0;_e<st.length&&(lt=lt-wt+b(st+"XXX",_e)|0),ot=tt(ot,dt,4,(0,a.string32)(lt));const gt=`url(data:font/opentype;base64,${btoa(ot)});`,vt=`@font-face {font-family:"${st}";src:${gt}}`;this.insertRule(vt);const At=this._document.createElement("div");At.style.visibility="hidden",At.style.width=At.style.height="10px",At.style.position="absolute",At.style.top=At.style.left="0px";for(const yt of[g.loadedName,st]){const bt=this._document.createElement("span");bt.textContent="Hi",bt.style.fontFamily=yt,At.append(bt)}this._document.body.append(At),at(st,()=>{At.remove(),_.complete()})}}d=new WeakMap,i.FontLoader=o;class c{constructor(g,{isEvalSupported:_=!0,disableFontFace:b=!1,ignoreErrors:tt=!1,inspectFont:_e=null}){this.compiledGlyphs=Object.create(null);for(const rt in g)this[rt]=g[rt];this.isEvalSupported=_!==!1,this.disableFontFace=b===!0,this.ignoreErrors=tt===!0,this._inspectFont=_e}createNativeFontFace(){var _;if(!this.data||this.disableFontFace)return null;let g;if(!this.cssFontInfo)g=new FontFace(this.loadedName,this.data,{});else{const b={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(b.style=`oblique ${this.cssFontInfo.italicAngle}deg`),g=new FontFace(this.cssFontInfo.fontFamily,this.data,b)}return(_=this._inspectFont)==null||_.call(this,this),g}createFontFaceRule(){var tt;if(!this.data||this.disableFontFace)return null;const g=(0,a.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(g)});`;let b;if(!this.cssFontInfo)b=`@font-face {font-family:"${this.loadedName}";src:${_}}`;else{let _e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),b=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_e}src:${_}}`}return(tt=this._inspectFont)==null||tt.call(this,this,_),b}getPathGenerator(g,_){if(this.compiledGlyphs[_]!==void 0)return this.compiledGlyphs[_];let b;try{b=g.get(this.loadedName+"_path_"+_)}catch(tt){if(!this.ignoreErrors)throw tt;return(0,a.warn)(`getPathGenerator - ignoring character: "${tt}".`),this.compiledGlyphs[_]=function(_e,rt){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const tt=[];for(const _e of b){const rt=_e.args!==void 0?_e.args.join(","):"";tt.push("c.",_e.cmd,"(",rt,`);
`)}return this.compiledGlyphs[_]=new Function("c","size",tt.join(""))}return this.compiledGlyphs[_]=function(tt,_e){for(const rt of b)rt.cmd==="scale"&&(rt.args=[_e,-_e]),tt[rt.cmd].apply(tt,rt.args)}}}i.FontFaceObject=c},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var a=s(7);s(1);const o=function(_){return new Promise((b,tt)=>{require$$5.readFile(_,(rt,it)=>{if(rt||!it){tt(new Error(rt));return}b(new Uint8Array(it))})})};class c extends a.BaseFilterFactory{}i.NodeFilterFactory=c;class d extends a.BaseCanvasFactory{_createCanvas(b,tt){return require$$5.createCanvas(b,tt)}}i.NodeCanvasFactory=d;class h extends a.BaseCMapReaderFactory{_fetchData(b,tt){return o(b).then(_e=>({cMapData:_e,compressionType:tt}))}}i.NodeCMapReaderFactory=h;class g extends a.BaseStandardFontDataFactory{_fetchData(b){return o(b)}}i.NodeStandardFontDataFactory=g},(e,i,s)=>{var Yt,Xs,Gs;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var a=s(1),o=s(6),c=s(12),d=s(13);const h=16,g=100,_=4096,b=15,tt=10,_e=1e3,rt=16;function it(Et,xt){if(Et._removeMirroring)throw new Error("Context is already forwarding operations.");Et.__originalSave=Et.save,Et.__originalRestore=Et.restore,Et.__originalRotate=Et.rotate,Et.__originalScale=Et.scale,Et.__originalTranslate=Et.translate,Et.__originalTransform=Et.transform,Et.__originalSetTransform=Et.setTransform,Et.__originalResetTransform=Et.resetTransform,Et.__originalClip=Et.clip,Et.__originalMoveTo=Et.moveTo,Et.__originalLineTo=Et.lineTo,Et.__originalBezierCurveTo=Et.bezierCurveTo,Et.__originalRect=Et.rect,Et.__originalClosePath=Et.closePath,Et.__originalBeginPath=Et.beginPath,Et._removeMirroring=()=>{Et.save=Et.__originalSave,Et.restore=Et.__originalRestore,Et.rotate=Et.__originalRotate,Et.scale=Et.__originalScale,Et.translate=Et.__originalTranslate,Et.transform=Et.__originalTransform,Et.setTransform=Et.__originalSetTransform,Et.resetTransform=Et.__originalResetTransform,Et.clip=Et.__originalClip,Et.moveTo=Et.__originalMoveTo,Et.lineTo=Et.__originalLineTo,Et.bezierCurveTo=Et.__originalBezierCurveTo,Et.rect=Et.__originalRect,Et.closePath=Et.__originalClosePath,Et.beginPath=Et.__originalBeginPath,delete Et._removeMirroring},Et.save=function(){xt.save(),this.__originalSave()},Et.restore=function(){xt.restore(),this.__originalRestore()},Et.translate=function(St,Pt){xt.translate(St,Pt),this.__originalTranslate(St,Pt)},Et.scale=function(St,Pt){xt.scale(St,Pt),this.__originalScale(St,Pt)},Et.transform=function(St,Pt,Nt,Lt,lr,ur){xt.transform(St,Pt,Nt,Lt,lr,ur),this.__originalTransform(St,Pt,Nt,Lt,lr,ur)},Et.setTransform=function(St,Pt,Nt,Lt,lr,ur){xt.setTransform(St,Pt,Nt,Lt,lr,ur),this.__originalSetTransform(St,Pt,Nt,Lt,lr,ur)},Et.resetTransform=function(){xt.resetTransform(),this.__originalResetTransform()},Et.rotate=function(St){xt.rotate(St),this.__originalRotate(St)},Et.clip=function(St){xt.clip(St),this.__originalClip(St)},Et.moveTo=function(mt,St){xt.moveTo(mt,St),this.__originalMoveTo(mt,St)},Et.lineTo=function(mt,St){xt.lineTo(mt,St),this.__originalLineTo(mt,St)},Et.bezierCurveTo=function(mt,St,Pt,Nt,Lt,lr){xt.bezierCurveTo(mt,St,Pt,Nt,Lt,lr),this.__originalBezierCurveTo(mt,St,Pt,Nt,Lt,lr)},Et.rect=function(mt,St,Pt,Nt){xt.rect(mt,St,Pt,Nt),this.__originalRect(mt,St,Pt,Nt)},Et.closePath=function(){xt.closePath(),this.__originalClosePath()},Et.beginPath=function(){xt.beginPath(),this.__originalBeginPath()}}class et{constructor(xt){this.canvasFactory=xt,this.cache=Object.create(null)}getCanvas(xt,mt,St){let Pt;return this.cache[xt]!==void 0?(Pt=this.cache[xt],this.canvasFactory.reset(Pt,mt,St)):(Pt=this.canvasFactory.create(mt,St),this.cache[xt]=Pt),Pt}delete(xt){delete this.cache[xt]}clear(){for(const xt in this.cache){const mt=this.cache[xt];this.canvasFactory.destroy(mt),delete this.cache[xt]}}}function nt(Et,xt,mt,St,Pt,Nt,Lt,lr,ur,wr){const[vr,Fr,Rr,jr,xr,hr]=(0,o.getCurrentTransform)(Et);if(Fr===0&&Rr===0){const _r=Lt*vr+xr,Ar=Math.round(_r),Mr=lr*jr+hr,Ur=Math.round(Mr),Er=(Lt+ur)*vr+xr,pr=Math.abs(Math.round(Er)-Ar)||1,Wr=(lr+wr)*jr+hr,zr=Math.abs(Math.round(Wr)-Ur)||1;return Et.setTransform(Math.sign(vr),0,0,Math.sign(jr),Ar,Ur),Et.drawImage(xt,mt,St,Pt,Nt,0,0,pr,zr),Et.setTransform(vr,Fr,Rr,jr,xr,hr),[pr,zr]}if(vr===0&&jr===0){const _r=lr*Rr+xr,Ar=Math.round(_r),Mr=Lt*Fr+hr,Ur=Math.round(Mr),Er=(lr+wr)*Rr+xr,pr=Math.abs(Math.round(Er)-Ar)||1,Wr=(Lt+ur)*Fr+hr,zr=Math.abs(Math.round(Wr)-Ur)||1;return Et.setTransform(0,Math.sign(Fr),Math.sign(Rr),0,Ar,Ur),Et.drawImage(xt,mt,St,Pt,Nt,0,0,zr,pr),Et.setTransform(vr,Fr,Rr,jr,xr,hr),[zr,pr]}Et.drawImage(xt,mt,St,Pt,Nt,Lt,lr,ur,wr);const jt=Math.hypot(vr,Fr),sr=Math.hypot(Rr,jr);return[jt*ur,sr*wr]}function at(Et){const{width:xt,height:mt}=Et;if(xt>_e||mt>_e)return null;const St=1e3,Pt=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Nt=xt+1;let Lt=new Uint8Array(Nt*(mt+1)),lr,ur,wr;const vr=xt+7&-8;let Fr=new Uint8Array(vr*mt),Rr=0;for(const sr of Et.data){let _r=128;for(;_r>0;)Fr[Rr++]=sr&_r?0:255,_r>>=1}let jr=0;for(Rr=0,Fr[Rr]!==0&&(Lt[0]=1,++jr),ur=1;ur<xt;ur++)Fr[Rr]!==Fr[Rr+1]&&(Lt[ur]=Fr[Rr]?2:1,++jr),Rr++;for(Fr[Rr]!==0&&(Lt[ur]=2,++jr),lr=1;lr<mt;lr++){Rr=lr*vr,wr=lr*Nt,Fr[Rr-vr]!==Fr[Rr]&&(Lt[wr]=Fr[Rr]?1:8,++jr);let sr=(Fr[Rr]?4:0)+(Fr[Rr-vr]?8:0);for(ur=1;ur<xt;ur++)sr=(sr>>2)+(Fr[Rr+1]?4:0)+(Fr[Rr-vr+1]?8:0),Pt[sr]&&(Lt[wr+ur]=Pt[sr],++jr),Rr++;if(Fr[Rr-vr]!==Fr[Rr]&&(Lt[wr+ur]=Fr[Rr]?2:4,++jr),jr>St)return null}for(Rr=vr*(mt-1),wr=lr*Nt,Fr[Rr]!==0&&(Lt[wr]=8,++jr),ur=1;ur<xt;ur++)Fr[Rr]!==Fr[Rr+1]&&(Lt[wr+ur]=Fr[Rr]?4:8,++jr),Rr++;if(Fr[Rr]!==0&&(Lt[wr+ur]=4,++jr),jr>St)return null;const xr=new Int32Array([0,Nt,-1,0,-Nt,0,0,0,1]),hr=new Path2D;for(lr=0;jr&&lr<=mt;lr++){let sr=lr*Nt;const _r=sr+xt;for(;sr<_r&&!Lt[sr];)sr++;if(sr===_r)continue;hr.moveTo(sr%Nt,lr);const Ar=sr;let Mr=Lt[sr];do{const Ur=xr[Mr];do sr+=Ur;while(!Lt[sr]);const Er=Lt[sr];Er!==5&&Er!==10?(Mr=Er,Lt[sr]=0):(Mr=Er&51*Mr>>4,Lt[sr]&=Mr>>2|Mr<<2),hr.lineTo(sr%Nt,sr/Nt|0),Lt[sr]||--jr}while(Ar!==sr);--lr}return Fr=null,Lt=null,function(sr){sr.save(),sr.scale(1/xt,-1/mt),sr.translate(0,-mt),sr.fill(hr),sr.beginPath(),sr.restore()}}class st{constructor(xt,mt){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,xt,mt])}clone(){const xt=Object.create(this);return xt.clipBox=this.clipBox.slice(),xt}setCurrentPoint(xt,mt){this.x=xt,this.y=mt}updatePathMinMax(xt,mt,St){[mt,St]=a.Util.applyTransform([mt,St],xt),this.minX=Math.min(this.minX,mt),this.minY=Math.min(this.minY,St),this.maxX=Math.max(this.maxX,mt),this.maxY=Math.max(this.maxY,St)}updateRectMinMax(xt,mt){const St=a.Util.applyTransform(mt,xt),Pt=a.Util.applyTransform(mt.slice(2),xt);this.minX=Math.min(this.minX,St[0],Pt[0]),this.minY=Math.min(this.minY,St[1],Pt[1]),this.maxX=Math.max(this.maxX,St[0],Pt[0]),this.maxY=Math.max(this.maxY,St[1],Pt[1])}updateScalingPathMinMax(xt,mt){a.Util.scaleMinMax(xt,mt),this.minX=Math.min(this.minX,mt[0]),this.maxX=Math.max(this.maxX,mt[1]),this.minY=Math.min(this.minY,mt[2]),this.maxY=Math.max(this.maxY,mt[3])}updateCurvePathMinMax(xt,mt,St,Pt,Nt,Lt,lr,ur,wr,vr){const Fr=a.Util.bezierBoundingBox(mt,St,Pt,Nt,Lt,lr,ur,wr);if(vr){vr[0]=Math.min(vr[0],Fr[0],Fr[2]),vr[1]=Math.max(vr[1],Fr[0],Fr[2]),vr[2]=Math.min(vr[2],Fr[1],Fr[3]),vr[3]=Math.max(vr[3],Fr[1],Fr[3]);return}this.updateRectMinMax(xt,Fr)}getPathBoundingBox(xt=c.PathType.FILL,mt=null){const St=[this.minX,this.minY,this.maxX,this.maxY];if(xt===c.PathType.STROKE){mt||(0,a.unreachable)("Stroke bounding box must include transform.");const Pt=a.Util.singularValueDecompose2dScale(mt),Nt=Pt[0]*this.lineWidth/2,Lt=Pt[1]*this.lineWidth/2;St[0]-=Nt,St[1]-=Lt,St[2]+=Nt,St[3]+=Lt}return St}updateClipFromPath(){const xt=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(xt||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(xt){this.clipBox=xt,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(xt=c.PathType.FILL,mt=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(xt,mt))}}function ot(Et,xt){if(typeof ImageData<"u"&&xt instanceof ImageData){Et.putImageData(xt,0,0);return}const mt=xt.height,St=xt.width,Pt=mt%rt,Nt=(mt-Pt)/rt,Lt=Pt===0?Nt:Nt+1,lr=Et.createImageData(St,rt);let ur=0,wr;const vr=xt.data,Fr=lr.data;let Rr,jr,xr,hr;if(xt.kind===a.ImageKind.GRAYSCALE_1BPP){const jt=vr.byteLength,sr=new Uint32Array(Fr.buffer,0,Fr.byteLength>>2),_r=sr.length,Ar=St+7>>3,Mr=4294967295,Ur=a.FeatureTest.isLittleEndian?4278190080:255;for(Rr=0;Rr<Lt;Rr++){for(xr=Rr<Nt?rt:Pt,wr=0,jr=0;jr<xr;jr++){const Er=jt-ur;let pr=0;const Wr=Er>Ar?St:Er*8-7,zr=Wr&-8;let en=0,sn=0;for(;pr<zr;pr+=8)sn=vr[ur++],sr[wr++]=sn&128?Mr:Ur,sr[wr++]=sn&64?Mr:Ur,sr[wr++]=sn&32?Mr:Ur,sr[wr++]=sn&16?Mr:Ur,sr[wr++]=sn&8?Mr:Ur,sr[wr++]=sn&4?Mr:Ur,sr[wr++]=sn&2?Mr:Ur,sr[wr++]=sn&1?Mr:Ur;for(;pr<Wr;pr++)en===0&&(sn=vr[ur++],en=128),sr[wr++]=sn&en?Mr:Ur,en>>=1}for(;wr<_r;)sr[wr++]=0;Et.putImageData(lr,0,Rr*rt)}}else if(xt.kind===a.ImageKind.RGBA_32BPP){for(jr=0,hr=St*rt*4,Rr=0;Rr<Nt;Rr++)Fr.set(vr.subarray(ur,ur+hr)),ur+=hr,Et.putImageData(lr,0,jr),jr+=rt;Rr<Lt&&(hr=St*Pt*4,Fr.set(vr.subarray(ur,ur+hr)),Et.putImageData(lr,0,jr))}else if(xt.kind===a.ImageKind.RGB_24BPP)for(xr=rt,hr=St*xr,Rr=0;Rr<Lt;Rr++){for(Rr>=Nt&&(xr=Pt,hr=St*xr),wr=0,jr=hr;jr--;)Fr[wr++]=vr[ur++],Fr[wr++]=vr[ur++],Fr[wr++]=vr[ur++],Fr[wr++]=255;Et.putImageData(lr,0,Rr*rt)}else throw new Error(`bad image kind: ${xt.kind}`)}function pt(Et,xt){if(xt.bitmap){Et.drawImage(xt.bitmap,0,0);return}const mt=xt.height,St=xt.width,Pt=mt%rt,Nt=(mt-Pt)/rt,Lt=Pt===0?Nt:Nt+1,lr=Et.createImageData(St,rt);let ur=0;const wr=xt.data,vr=lr.data;for(let Fr=0;Fr<Lt;Fr++){const Rr=Fr<Nt?rt:Pt;({srcPos:ur}=(0,d.convertBlackAndWhiteToRGBA)({src:wr,srcPos:ur,dest:vr,width:St,height:Rr,nonBlackColor:0})),Et.putImageData(lr,0,Fr*rt)}}function dt(Et,xt){const mt=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const St of mt)Et[St]!==void 0&&(xt[St]=Et[St]);Et.setLineDash!==void 0&&(xt.setLineDash(Et.getLineDash()),xt.lineDashOffset=Et.lineDashOffset)}function wt(Et){if(Et.strokeStyle=Et.fillStyle="#000000",Et.fillRule="nonzero",Et.globalAlpha=1,Et.lineWidth=1,Et.lineCap="butt",Et.lineJoin="miter",Et.miterLimit=10,Et.globalCompositeOperation="source-over",Et.font="10px sans-serif",Et.setLineDash!==void 0&&(Et.setLineDash([]),Et.lineDashOffset=0),!a.isNodeJS){const{filter:xt}=Et;xt!=="none"&&xt!==""&&(Et.filter="none")}}function lt(Et,xt,mt,St){const Pt=Et.length;for(let Nt=3;Nt<Pt;Nt+=4){const Lt=Et[Nt];if(Lt===0)Et[Nt-3]=xt,Et[Nt-2]=mt,Et[Nt-1]=St;else if(Lt<255){const lr=255-Lt;Et[Nt-3]=Et[Nt-3]*Lt+xt*lr>>8,Et[Nt-2]=Et[Nt-2]*Lt+mt*lr>>8,Et[Nt-1]=Et[Nt-1]*Lt+St*lr>>8}}}function gt(Et,xt,mt){const St=Et.length,Pt=1/255;for(let Nt=3;Nt<St;Nt+=4){const Lt=mt?mt[Et[Nt]]:Et[Nt];xt[Nt]=xt[Nt]*Lt*Pt|0}}function vt(Et,xt,mt){const St=Et.length;for(let Pt=3;Pt<St;Pt+=4){const Nt=Et[Pt-3]*77+Et[Pt-2]*152+Et[Pt-1]*28;xt[Pt]=mt?xt[Pt]*mt[Nt>>8]>>8:xt[Pt]*Nt>>16}}function At(Et,xt,mt,St,Pt,Nt,Lt,lr,ur,wr,vr){const Fr=!!Nt,Rr=Fr?Nt[0]:0,jr=Fr?Nt[1]:0,xr=Fr?Nt[2]:0,hr=Pt==="Luminosity"?vt:gt,sr=Math.min(St,Math.ceil(1048576/mt));for(let _r=0;_r<St;_r+=sr){const Ar=Math.min(sr,St-_r),Mr=Et.getImageData(lr-wr,_r+(ur-vr),mt,Ar),Ur=xt.getImageData(lr,_r+ur,mt,Ar);Fr&&lt(Mr.data,Rr,jr,xr),hr(Mr.data,Ur.data,Lt),xt.putImageData(Ur,lr,_r+ur)}}function yt(Et,xt,mt,St){const Pt=St[0],Nt=St[1],Lt=St[2]-Pt,lr=St[3]-Nt;Lt===0||lr===0||(At(xt.context,mt,Lt,lr,xt.subtype,xt.backdrop,xt.transferMap,Pt,Nt,xt.offsetX,xt.offsetY),Et.save(),Et.globalAlpha=1,Et.globalCompositeOperation="source-over",Et.setTransform(1,0,0,1,0,0),Et.drawImage(mt.canvas,0,0),Et.restore())}function bt(Et,xt){const mt=a.Util.singularValueDecompose2dScale(Et);mt[0]=Math.fround(mt[0]),mt[1]=Math.fround(mt[1]);const St=Math.fround((globalThis.devicePixelRatio||1)*o.PixelsPerInch.PDF_TO_CSS_UNITS);return xt!==void 0?xt:mt[0]<=St||mt[1]<=St}const Tt=["butt","round","square"],er=["miter","round","bevel"],zt={},ar={},fr=class fr{constructor(xt,mt,St,Pt,Nt,{optionalContentConfig:Lt,markedContentStack:lr=null},ur,wr){Sr(this,Yt);this.ctx=xt,this.current=new st(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=mt,this.objs=St,this.canvasFactory=Pt,this.filterFactory=Nt,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=lr||[],this.optionalContentConfig=Lt,this.cachedCanvases=new et(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ur,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=wr,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(xt,mt=null){return typeof xt=="string"?xt.startsWith("g_")?this.commonObjs.get(xt):this.objs.get(xt):mt}beginDrawing({transform:xt,viewport:mt,transparency:St=!1,background:Pt=null}){const Nt=this.ctx.canvas.width,Lt=this.ctx.canvas.height,lr=this.ctx.fillStyle;if(this.ctx.fillStyle=Pt||"#ffffff",this.ctx.fillRect(0,0,Nt,Lt),this.ctx.fillStyle=lr,St){const ur=this.cachedCanvases.getCanvas("transparent",Nt,Lt);this.compositeCtx=this.ctx,this.transparentCanvas=ur.canvas,this.ctx=ur.context,this.ctx.save(),this.ctx.transform(...(0,o.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),wt(this.ctx),xt&&(this.ctx.transform(...xt),this.outputScaleX=xt[0],this.outputScaleY=xt[0]),this.ctx.transform(...mt.transform),this.viewportScale=mt.scale,this.baseTransform=(0,o.getCurrentTransform)(this.ctx)}executeOperatorList(xt,mt,St,Pt){const Nt=xt.argsArray,Lt=xt.fnArray;let lr=mt||0;const ur=Nt.length;if(ur===lr)return lr;const wr=ur-lr>tt&&typeof St=="function",vr=wr?Date.now()+b:0;let Fr=0;const Rr=this.commonObjs,jr=this.objs;let xr;for(;;){if(Pt!==void 0&&lr===Pt.nextBreakPoint)return Pt.breakIt(lr,St),lr;if(xr=Lt[lr],xr!==a.OPS.dependency)this[xr].apply(this,Nt[lr]);else for(const hr of Nt[lr]){const jt=hr.startsWith("g_")?Rr:jr;if(!jt.has(hr))return jt.get(hr,St),lr}if(lr++,lr===ur)return lr;if(wr&&++Fr>tt){if(Date.now()>vr)return St(),lr;Fr=0}}}endDrawing(){mr(this,Yt,Xs).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const xt of this._cachedBitmapsMap.values()){for(const mt of xt.values())typeof HTMLCanvasElement<"u"&&mt instanceof HTMLCanvasElement&&(mt.width=mt.height=0);xt.clear()}this._cachedBitmapsMap.clear(),mr(this,Yt,Gs).call(this)}_scaleImage(xt,mt){const St=xt.width,Pt=xt.height;let Nt=Math.max(Math.hypot(mt[0],mt[1]),1),Lt=Math.max(Math.hypot(mt[2],mt[3]),1),lr=St,ur=Pt,wr="prescale1",vr,Fr;for(;Nt>2&&lr>1||Lt>2&&ur>1;){let Rr=lr,jr=ur;Nt>2&&lr>1&&(Rr=lr>=16384?Math.floor(lr/2)-1||1:Math.ceil(lr/2),Nt/=lr/Rr),Lt>2&&ur>1&&(jr=ur>=16384?Math.floor(ur/2)-1||1:Math.ceil(ur)/2,Lt/=ur/jr),vr=this.cachedCanvases.getCanvas(wr,Rr,jr),Fr=vr.context,Fr.clearRect(0,0,Rr,jr),Fr.drawImage(xt,0,0,lr,ur,0,0,Rr,jr),xt=vr.canvas,lr=Rr,ur=jr,wr=wr==="prescale1"?"prescale2":"prescale1"}return{img:xt,paintWidth:lr,paintHeight:ur}}_createMaskCanvas(xt){const mt=this.ctx,{width:St,height:Pt}=xt,Nt=this.current.fillColor,Lt=this.current.patternFill,lr=(0,o.getCurrentTransform)(mt);let ur,wr,vr,Fr;if((xt.bitmap||xt.data)&&xt.count>1){const pr=xt.bitmap||xt.data.buffer;wr=JSON.stringify(Lt?lr:[lr.slice(0,4),Nt]),ur=this._cachedBitmapsMap.get(pr),ur||(ur=new Map,this._cachedBitmapsMap.set(pr,ur));const Wr=ur.get(wr);if(Wr&&!Lt){const zr=Math.round(Math.min(lr[0],lr[2])+lr[4]),en=Math.round(Math.min(lr[1],lr[3])+lr[5]);return{canvas:Wr,offsetX:zr,offsetY:en}}vr=Wr}vr||(Fr=this.cachedCanvases.getCanvas("maskCanvas",St,Pt),pt(Fr.context,xt));let Rr=a.Util.transform(lr,[1/St,0,0,-1/Pt,0,0]);Rr=a.Util.transform(Rr,[1,0,0,1,0,-Pt]);const jr=a.Util.applyTransform([0,0],Rr),xr=a.Util.applyTransform([St,Pt],Rr),hr=a.Util.normalizeRect([jr[0],jr[1],xr[0],xr[1]]),jt=Math.round(hr[2]-hr[0])||1,sr=Math.round(hr[3]-hr[1])||1,_r=this.cachedCanvases.getCanvas("fillCanvas",jt,sr),Ar=_r.context,Mr=Math.min(jr[0],xr[0]),Ur=Math.min(jr[1],xr[1]);Ar.translate(-Mr,-Ur),Ar.transform(...Rr),vr||(vr=this._scaleImage(Fr.canvas,(0,o.getCurrentTransformInverse)(Ar)),vr=vr.img,ur&&Lt&&ur.set(wr,vr)),Ar.imageSmoothingEnabled=bt((0,o.getCurrentTransform)(Ar),xt.interpolate),nt(Ar,vr,0,0,vr.width,vr.height,0,0,St,Pt),Ar.globalCompositeOperation="source-in";const Er=a.Util.transform((0,o.getCurrentTransformInverse)(Ar),[1,0,0,1,-Mr,-Ur]);return Ar.fillStyle=Lt?Nt.getPattern(mt,this,Er,c.PathType.FILL):Nt,Ar.fillRect(0,0,St,Pt),ur&&!Lt&&(this.cachedCanvases.delete("fillCanvas"),ur.set(wr,_r.canvas)),{canvas:_r.canvas,offsetX:Math.round(Mr),offsetY:Math.round(Ur)}}setLineWidth(xt){xt!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=xt,this.ctx.lineWidth=xt}setLineCap(xt){this.ctx.lineCap=Tt[xt]}setLineJoin(xt){this.ctx.lineJoin=er[xt]}setMiterLimit(xt){this.ctx.miterLimit=xt}setDash(xt,mt){const St=this.ctx;St.setLineDash!==void 0&&(St.setLineDash(xt),St.lineDashOffset=mt)}setRenderingIntent(xt){}setFlatness(xt){}setGState(xt){for(const[mt,St]of xt)switch(mt){case"LW":this.setLineWidth(St);break;case"LC":this.setLineCap(St);break;case"LJ":this.setLineJoin(St);break;case"ML":this.setMiterLimit(St);break;case"D":this.setDash(St[0],St[1]);break;case"RI":this.setRenderingIntent(St);break;case"FL":this.setFlatness(St);break;case"Font":this.setFont(St[0],St[1]);break;case"CA":this.current.strokeAlpha=St;break;case"ca":this.current.fillAlpha=St,this.ctx.globalAlpha=St;break;case"BM":this.ctx.globalCompositeOperation=St;break;case"SMask":this.current.activeSMask=St?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(St);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const xt=this.inSMaskMode;this.current.activeSMask&&!xt?this.beginSMaskMode():!this.current.activeSMask&&xt&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const xt=this.ctx.canvas.width,mt=this.ctx.canvas.height,St="smaskGroupAt"+this.groupLevel,Pt=this.cachedCanvases.getCanvas(St,xt,mt);this.suspendedCtx=this.ctx,this.ctx=Pt.context;const Nt=this.ctx;Nt.setTransform(...(0,o.getCurrentTransform)(this.suspendedCtx)),dt(this.suspendedCtx,Nt),it(Nt,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),dt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(xt){if(!this.current.activeSMask)return;xt?(xt[0]=Math.floor(xt[0]),xt[1]=Math.floor(xt[1]),xt[2]=Math.ceil(xt[2]),xt[3]=Math.ceil(xt[3])):xt=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const mt=this.current.activeSMask,St=this.suspendedCtx;yt(St,mt,this.ctx,xt),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(dt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const xt=this.current;this.stateStack.push(xt),this.current=xt.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),dt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(xt,mt,St,Pt,Nt,Lt){this.ctx.transform(xt,mt,St,Pt,Nt,Lt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(xt,mt,St){const Pt=this.ctx,Nt=this.current;let Lt=Nt.x,lr=Nt.y,ur,wr;const vr=(0,o.getCurrentTransform)(Pt),Fr=vr[0]===0&&vr[3]===0||vr[1]===0&&vr[2]===0,Rr=Fr?St.slice(0):null;for(let jr=0,xr=0,hr=xt.length;jr<hr;jr++)switch(xt[jr]|0){case a.OPS.rectangle:Lt=mt[xr++],lr=mt[xr++];const jt=mt[xr++],sr=mt[xr++],_r=Lt+jt,Ar=lr+sr;Pt.moveTo(Lt,lr),jt===0||sr===0?Pt.lineTo(_r,Ar):(Pt.lineTo(_r,lr),Pt.lineTo(_r,Ar),Pt.lineTo(Lt,Ar)),Fr||Nt.updateRectMinMax(vr,[Lt,lr,_r,Ar]),Pt.closePath();break;case a.OPS.moveTo:Lt=mt[xr++],lr=mt[xr++],Pt.moveTo(Lt,lr),Fr||Nt.updatePathMinMax(vr,Lt,lr);break;case a.OPS.lineTo:Lt=mt[xr++],lr=mt[xr++],Pt.lineTo(Lt,lr),Fr||Nt.updatePathMinMax(vr,Lt,lr);break;case a.OPS.curveTo:ur=Lt,wr=lr,Lt=mt[xr+4],lr=mt[xr+5],Pt.bezierCurveTo(mt[xr],mt[xr+1],mt[xr+2],mt[xr+3],Lt,lr),Nt.updateCurvePathMinMax(vr,ur,wr,mt[xr],mt[xr+1],mt[xr+2],mt[xr+3],Lt,lr,Rr),xr+=6;break;case a.OPS.curveTo2:ur=Lt,wr=lr,Pt.bezierCurveTo(Lt,lr,mt[xr],mt[xr+1],mt[xr+2],mt[xr+3]),Nt.updateCurvePathMinMax(vr,ur,wr,Lt,lr,mt[xr],mt[xr+1],mt[xr+2],mt[xr+3],Rr),Lt=mt[xr+2],lr=mt[xr+3],xr+=4;break;case a.OPS.curveTo3:ur=Lt,wr=lr,Lt=mt[xr+2],lr=mt[xr+3],Pt.bezierCurveTo(mt[xr],mt[xr+1],Lt,lr,Lt,lr),Nt.updateCurvePathMinMax(vr,ur,wr,mt[xr],mt[xr+1],Lt,lr,Lt,lr,Rr),xr+=4;break;case a.OPS.closePath:Pt.closePath();break}Fr&&Nt.updateScalingPathMinMax(vr,Rr),Nt.setCurrentPoint(Lt,lr)}closePath(){this.ctx.closePath()}stroke(xt=!0){const mt=this.ctx,St=this.current.strokeColor;mt.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof St=="object"&&(St!=null&&St.getPattern)?(mt.save(),mt.strokeStyle=St.getPattern(mt,this,(0,o.getCurrentTransformInverse)(mt),c.PathType.STROKE),this.rescaleAndStroke(!1),mt.restore()):this.rescaleAndStroke(!0)),xt&&this.consumePath(this.current.getClippedPathBoundingBox()),mt.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(xt=!0){const mt=this.ctx,St=this.current.fillColor,Pt=this.current.patternFill;let Nt=!1;Pt&&(mt.save(),mt.fillStyle=St.getPattern(mt,this,(0,o.getCurrentTransformInverse)(mt),c.PathType.FILL),Nt=!0);const Lt=this.current.getClippedPathBoundingBox();this.contentVisible&&Lt!==null&&(this.pendingEOFill?(mt.fill("evenodd"),this.pendingEOFill=!1):mt.fill()),Nt&&mt.restore(),xt&&this.consumePath(Lt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=zt}eoClip(){this.pendingClip=ar}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const xt=this.pendingTextPaths,mt=this.ctx;if(xt===void 0){mt.beginPath();return}mt.save(),mt.beginPath();for(const St of xt)mt.setTransform(...St.transform),mt.translate(St.x,St.y),St.addToPath(mt,St.fontSize);mt.restore(),mt.clip(),mt.beginPath(),delete this.pendingTextPaths}setCharSpacing(xt){this.current.charSpacing=xt}setWordSpacing(xt){this.current.wordSpacing=xt}setHScale(xt){this.current.textHScale=xt/100}setLeading(xt){this.current.leading=-xt}setFont(xt,mt){var vr;const St=this.commonObjs.get(xt),Pt=this.current;if(!St)throw new Error(`Can't find font for ${xt}`);if(Pt.fontMatrix=St.fontMatrix||a.FONT_IDENTITY_MATRIX,(Pt.fontMatrix[0]===0||Pt.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+xt),mt<0?(mt=-mt,Pt.fontDirection=-1):Pt.fontDirection=1,this.current.font=St,this.current.fontSize=mt,St.isType3Font)return;const Nt=St.loadedName||"sans-serif",Lt=((vr=St.systemFontInfo)==null?void 0:vr.css)||`"${Nt}", ${St.fallbackName}`;let lr="normal";St.black?lr="900":St.bold&&(lr="bold");const ur=St.italic?"italic":"normal";let wr=mt;mt<h?wr=h:mt>g&&(wr=g),this.current.fontSizeScale=mt/wr,this.ctx.font=`${ur} ${lr} ${wr}px ${Lt}`}setTextRenderingMode(xt){this.current.textRenderingMode=xt}setTextRise(xt){this.current.textRise=xt}moveText(xt,mt){this.current.x=this.current.lineX+=xt,this.current.y=this.current.lineY+=mt}setLeadingMoveText(xt,mt){this.setLeading(-mt),this.moveText(xt,mt)}setTextMatrix(xt,mt,St,Pt,Nt,Lt){this.current.textMatrix=[xt,mt,St,Pt,Nt,Lt],this.current.textMatrixScale=Math.hypot(xt,mt),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(xt,mt,St,Pt){const Nt=this.ctx,Lt=this.current,lr=Lt.font,ur=Lt.textRenderingMode,wr=Lt.fontSize/Lt.fontSizeScale,vr=ur&a.TextRenderingMode.FILL_STROKE_MASK,Fr=!!(ur&a.TextRenderingMode.ADD_TO_PATH_FLAG),Rr=Lt.patternFill&&!lr.missingFile;let jr;(lr.disableFontFace||Fr||Rr)&&(jr=lr.getPathGenerator(this.commonObjs,xt)),lr.disableFontFace||Rr?(Nt.save(),Nt.translate(mt,St),Nt.beginPath(),jr(Nt,wr),Pt&&Nt.setTransform(...Pt),(vr===a.TextRenderingMode.FILL||vr===a.TextRenderingMode.FILL_STROKE)&&Nt.fill(),(vr===a.TextRenderingMode.STROKE||vr===a.TextRenderingMode.FILL_STROKE)&&Nt.stroke(),Nt.restore()):((vr===a.TextRenderingMode.FILL||vr===a.TextRenderingMode.FILL_STROKE)&&Nt.fillText(xt,mt,St),(vr===a.TextRenderingMode.STROKE||vr===a.TextRenderingMode.FILL_STROKE)&&Nt.strokeText(xt,mt,St)),Fr&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,o.getCurrentTransform)(Nt),x:mt,y:St,fontSize:wr,addToPath:jr})}get isFontSubpixelAAEnabled(){const{context:xt}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);xt.scale(1.5,1),xt.fillText("I",0,10);const mt=xt.getImageData(0,0,10,10).data;let St=!1;for(let Pt=3;Pt<mt.length;Pt+=4)if(mt[Pt]>0&&mt[Pt]<255){St=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",St)}showText(xt){const mt=this.current,St=mt.font;if(St.isType3Font)return this.showType3Text(xt);const Pt=mt.fontSize;if(Pt===0)return;const Nt=this.ctx,Lt=mt.fontSizeScale,lr=mt.charSpacing,ur=mt.wordSpacing,wr=mt.fontDirection,vr=mt.textHScale*wr,Fr=xt.length,Rr=St.vertical,jr=Rr?1:-1,xr=St.defaultVMetrics,hr=Pt*mt.fontMatrix[0],jt=mt.textRenderingMode===a.TextRenderingMode.FILL&&!St.disableFontFace&&!mt.patternFill;Nt.save(),Nt.transform(...mt.textMatrix),Nt.translate(mt.x,mt.y+mt.textRise),wr>0?Nt.scale(vr,-1):Nt.scale(vr,1);let sr;if(mt.patternFill){Nt.save();const Er=mt.fillColor.getPattern(Nt,this,(0,o.getCurrentTransformInverse)(Nt),c.PathType.FILL);sr=(0,o.getCurrentTransform)(Nt),Nt.restore(),Nt.fillStyle=Er}let _r=mt.lineWidth;const Ar=mt.textMatrixScale;if(Ar===0||_r===0){const Er=mt.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(Er===a.TextRenderingMode.STROKE||Er===a.TextRenderingMode.FILL_STROKE)&&(_r=this.getSinglePixelWidth())}else _r/=Ar;if(Lt!==1&&(Nt.scale(Lt,Lt),_r/=Lt),Nt.lineWidth=_r,St.isInvalidPDFjsFont){const Er=[];let pr=0;for(const Wr of xt)Er.push(Wr.unicode),pr+=Wr.width;Nt.fillText(Er.join(""),0,0),mt.x+=pr*hr*vr,Nt.restore(),this.compose();return}let Mr=0,Ur;for(Ur=0;Ur<Fr;++Ur){const Er=xt[Ur];if(typeof Er=="number"){Mr+=jr*Er*Pt/1e3;continue}let pr=!1;const Wr=(Er.isSpace?ur:0)+lr,zr=Er.fontChar,en=Er.accent;let sn,dn,Kr=Er.width;if(Rr){const fn=Er.vmetric||xr,hn=-(Er.vmetric?fn[1]:Kr*.5)*hr,Br=fn[2]*hr;Kr=fn?-fn[0]:Kr,sn=hn/Lt,dn=(Mr+Br)/Lt}else sn=Mr/Lt,dn=0;if(St.remeasure&&Kr>0){const fn=Nt.measureText(zr).width*1e3/Pt*Lt;if(Kr<fn&&this.isFontSubpixelAAEnabled){const hn=Kr/fn;pr=!0,Nt.save(),Nt.scale(hn,1),sn/=hn}else Kr!==fn&&(sn+=(Kr-fn)/2e3*Pt/Lt)}if(this.contentVisible&&(Er.isInFont||St.missingFile)){if(jt&&!en)Nt.fillText(zr,sn,dn);else if(this.paintChar(zr,sn,dn,sr),en){const fn=sn+Pt*en.offset.x/Lt,hn=dn-Pt*en.offset.y/Lt;this.paintChar(en.fontChar,fn,hn,sr)}}const tn=Rr?Kr*hr-Wr*wr:Kr*hr+Wr*wr;Mr+=tn,pr&&Nt.restore()}Rr?mt.y-=Mr:mt.x+=Mr*vr,Nt.restore(),this.compose()}showType3Text(xt){const mt=this.ctx,St=this.current,Pt=St.font,Nt=St.fontSize,Lt=St.fontDirection,lr=Pt.vertical?1:-1,ur=St.charSpacing,wr=St.wordSpacing,vr=St.textHScale*Lt,Fr=St.fontMatrix||a.FONT_IDENTITY_MATRIX,Rr=xt.length,jr=St.textRenderingMode===a.TextRenderingMode.INVISIBLE;let xr,hr,jt,sr;if(!(jr||Nt===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,mt.save(),mt.transform(...St.textMatrix),mt.translate(St.x,St.y),mt.scale(vr,Lt),xr=0;xr<Rr;++xr){if(hr=xt[xr],typeof hr=="number"){sr=lr*hr*Nt/1e3,this.ctx.translate(sr,0),St.x+=sr*vr;continue}const _r=(hr.isSpace?wr:0)+ur,Ar=Pt.charProcOperatorList[hr.operatorListId];if(!Ar){(0,a.warn)(`Type3 character "${hr.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=hr,this.save(),mt.scale(Nt,Nt),mt.transform(...Fr),this.executeOperatorList(Ar),this.restore()),jt=a.Util.applyTransform([hr.width,0],Fr)[0]*Nt+_r,mt.translate(jt,0),St.x+=jt*vr}mt.restore(),this.processingType3=null}}setCharWidth(xt,mt){}setCharWidthAndBounds(xt,mt,St,Pt,Nt,Lt){this.ctx.rect(St,Pt,Nt-St,Lt-Pt),this.ctx.clip(),this.endPath()}getColorN_Pattern(xt){let mt;if(xt[0]==="TilingPattern"){const St=xt[1],Pt=this.baseTransform||(0,o.getCurrentTransform)(this.ctx),Nt={createCanvasGraphics:Lt=>new fr(Lt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};mt=new c.TilingPattern(xt,St,this.ctx,Nt,Pt)}else mt=this._getPattern(xt[1],xt[2]);return mt}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(xt,mt,St){const Pt=a.Util.makeHexColor(xt,mt,St);this.ctx.strokeStyle=Pt,this.current.strokeColor=Pt}setFillRGBColor(xt,mt,St){const Pt=a.Util.makeHexColor(xt,mt,St);this.ctx.fillStyle=Pt,this.current.fillColor=Pt,this.current.patternFill=!1}_getPattern(xt,mt=null){let St;return this.cachedPatterns.has(xt)?St=this.cachedPatterns.get(xt):(St=(0,c.getShadingPattern)(this.getObject(xt)),this.cachedPatterns.set(xt,St)),mt&&(St.matrix=mt),St}shadingFill(xt){if(!this.contentVisible)return;const mt=this.ctx;this.save();const St=this._getPattern(xt);mt.fillStyle=St.getPattern(mt,this,(0,o.getCurrentTransformInverse)(mt),c.PathType.SHADING);const Pt=(0,o.getCurrentTransformInverse)(mt);if(Pt){const{width:Nt,height:Lt}=mt.canvas,[lr,ur,wr,vr]=a.Util.getAxialAlignedBoundingBox([0,0,Nt,Lt],Pt);this.ctx.fillRect(lr,ur,wr-lr,vr-ur)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(xt,mt){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(xt)&&xt.length===6&&this.transform(...xt),this.baseTransform=(0,o.getCurrentTransform)(this.ctx),mt)){const St=mt[2]-mt[0],Pt=mt[3]-mt[1];this.ctx.rect(mt[0],mt[1],St,Pt),this.current.updateRectMinMax((0,o.getCurrentTransform)(this.ctx),mt),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(xt){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const mt=this.ctx;xt.isolated||(0,a.info)("TODO: Support non-isolated groups."),xt.knockout&&(0,a.warn)("Knockout groups not supported.");const St=(0,o.getCurrentTransform)(mt);if(xt.matrix&&mt.transform(...xt.matrix),!xt.bbox)throw new Error("Bounding box is required.");let Pt=a.Util.getAxialAlignedBoundingBox(xt.bbox,(0,o.getCurrentTransform)(mt));const Nt=[0,0,mt.canvas.width,mt.canvas.height];Pt=a.Util.intersect(Pt,Nt)||[0,0,0,0];const Lt=Math.floor(Pt[0]),lr=Math.floor(Pt[1]);let ur=Math.max(Math.ceil(Pt[2])-Lt,1),wr=Math.max(Math.ceil(Pt[3])-lr,1),vr=1,Fr=1;ur>_&&(vr=ur/_,ur=_),wr>_&&(Fr=wr/_,wr=_),this.current.startNewPathAndClipBox([0,0,ur,wr]);let Rr="groupAt"+this.groupLevel;xt.smask&&(Rr+="_smask_"+this.smaskCounter++%2);const jr=this.cachedCanvases.getCanvas(Rr,ur,wr),xr=jr.context;xr.scale(1/vr,1/Fr),xr.translate(-Lt,-lr),xr.transform(...St),xt.smask?this.smaskStack.push({canvas:jr.canvas,context:xr,offsetX:Lt,offsetY:lr,scaleX:vr,scaleY:Fr,subtype:xt.smask.subtype,backdrop:xt.smask.backdrop,transferMap:xt.smask.transferMap||null,startTransformInverse:null}):(mt.setTransform(1,0,0,1,0,0),mt.translate(Lt,lr),mt.scale(vr,Fr),mt.save()),dt(mt,xr),this.ctx=xr,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(mt),this.groupLevel++}endGroup(xt){if(!this.contentVisible)return;this.groupLevel--;const mt=this.ctx,St=this.groupStack.pop();if(this.ctx=St,this.ctx.imageSmoothingEnabled=!1,xt.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Pt=(0,o.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Pt);const Nt=a.Util.getAxialAlignedBoundingBox([0,0,mt.canvas.width,mt.canvas.height],Pt);this.ctx.drawImage(mt.canvas,0,0),this.ctx.restore(),this.compose(Nt)}}beginAnnotation(xt,mt,St,Pt,Nt){if(mr(this,Yt,Xs).call(this),wt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(mt)&&mt.length===4){const Lt=mt[2]-mt[0],lr=mt[3]-mt[1];if(Nt&&this.annotationCanvasMap){St=St.slice(),St[4]-=mt[0],St[5]-=mt[1],mt=mt.slice(),mt[0]=mt[1]=0,mt[2]=Lt,mt[3]=lr;const[ur,wr]=a.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(this.ctx)),{viewportScale:vr}=this,Fr=Math.ceil(Lt*this.outputScaleX*vr),Rr=Math.ceil(lr*this.outputScaleY*vr);this.annotationCanvas=this.canvasFactory.create(Fr,Rr);const{canvas:jr,context:xr}=this.annotationCanvas;this.annotationCanvasMap.set(xt,jr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=xr,this.ctx.save(),this.ctx.setTransform(ur,0,0,-wr,0,lr*wr),wt(this.ctx)}else wt(this.ctx),this.ctx.rect(mt[0],mt[1],Lt,lr),this.ctx.clip(),this.endPath()}this.current=new st(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...St),this.transform(...Pt)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),mr(this,Yt,Gs).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(xt){if(!this.contentVisible)return;const mt=xt.count;xt=this.getObject(xt.data,xt),xt.count=mt;const St=this.ctx,Pt=this.processingType3;if(Pt&&(Pt.compiled===void 0&&(Pt.compiled=at(xt)),Pt.compiled)){Pt.compiled(St);return}const Nt=this._createMaskCanvas(xt),Lt=Nt.canvas;St.save(),St.setTransform(1,0,0,1,0,0),St.drawImage(Lt,Nt.offsetX,Nt.offsetY),St.restore(),this.compose()}paintImageMaskXObjectRepeat(xt,mt,St=0,Pt=0,Nt,Lt){if(!this.contentVisible)return;xt=this.getObject(xt.data,xt);const lr=this.ctx;lr.save();const ur=(0,o.getCurrentTransform)(lr);lr.transform(mt,St,Pt,Nt,0,0);const wr=this._createMaskCanvas(xt);lr.setTransform(1,0,0,1,wr.offsetX-ur[4],wr.offsetY-ur[5]);for(let vr=0,Fr=Lt.length;vr<Fr;vr+=2){const Rr=a.Util.transform(ur,[mt,St,Pt,Nt,Lt[vr],Lt[vr+1]]),[jr,xr]=a.Util.applyTransform([0,0],Rr);lr.drawImage(wr.canvas,jr,xr)}lr.restore(),this.compose()}paintImageMaskXObjectGroup(xt){if(!this.contentVisible)return;const mt=this.ctx,St=this.current.fillColor,Pt=this.current.patternFill;for(const Nt of xt){const{data:Lt,width:lr,height:ur,transform:wr}=Nt,vr=this.cachedCanvases.getCanvas("maskCanvas",lr,ur),Fr=vr.context;Fr.save();const Rr=this.getObject(Lt,Nt);pt(Fr,Rr),Fr.globalCompositeOperation="source-in",Fr.fillStyle=Pt?St.getPattern(Fr,this,(0,o.getCurrentTransformInverse)(mt),c.PathType.FILL):St,Fr.fillRect(0,0,lr,ur),Fr.restore(),mt.save(),mt.transform(...wr),mt.scale(1,-1),nt(mt,vr.canvas,0,0,lr,ur,0,-1,1,1),mt.restore()}this.compose()}paintImageXObject(xt){if(!this.contentVisible)return;const mt=this.getObject(xt);if(!mt){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(mt)}paintImageXObjectRepeat(xt,mt,St,Pt){if(!this.contentVisible)return;const Nt=this.getObject(xt);if(!Nt){(0,a.warn)("Dependent image isn't ready yet");return}const Lt=Nt.width,lr=Nt.height,ur=[];for(let wr=0,vr=Pt.length;wr<vr;wr+=2)ur.push({transform:[mt,0,0,St,Pt[wr],Pt[wr+1]],x:0,y:0,w:Lt,h:lr});this.paintInlineImageXObjectGroup(Nt,ur)}applyTransferMapsToCanvas(xt){return this.current.transferMaps!=="none"&&(xt.filter=this.current.transferMaps,xt.drawImage(xt.canvas,0,0),xt.filter="none"),xt.canvas}applyTransferMapsToBitmap(xt){if(this.current.transferMaps==="none")return xt.bitmap;const{bitmap:mt,width:St,height:Pt}=xt,Nt=this.cachedCanvases.getCanvas("inlineImage",St,Pt),Lt=Nt.context;return Lt.filter=this.current.transferMaps,Lt.drawImage(mt,0,0),Lt.filter="none",Nt.canvas}paintInlineImageXObject(xt){if(!this.contentVisible)return;const mt=xt.width,St=xt.height,Pt=this.ctx;if(this.save(),!a.isNodeJS){const{filter:lr}=Pt;lr!=="none"&&lr!==""&&(Pt.filter="none")}Pt.scale(1/mt,-1/St);let Nt;if(xt.bitmap)Nt=this.applyTransferMapsToBitmap(xt);else if(typeof HTMLElement=="function"&&xt instanceof HTMLElement||!xt.data)Nt=xt;else{const ur=this.cachedCanvases.getCanvas("inlineImage",mt,St).context;ot(ur,xt),Nt=this.applyTransferMapsToCanvas(ur)}const Lt=this._scaleImage(Nt,(0,o.getCurrentTransformInverse)(Pt));Pt.imageSmoothingEnabled=bt((0,o.getCurrentTransform)(Pt),xt.interpolate),nt(Pt,Lt.img,0,0,Lt.paintWidth,Lt.paintHeight,0,-St,mt,St),this.compose(),this.restore()}paintInlineImageXObjectGroup(xt,mt){if(!this.contentVisible)return;const St=this.ctx;let Pt;if(xt.bitmap)Pt=xt.bitmap;else{const Nt=xt.width,Lt=xt.height,ur=this.cachedCanvases.getCanvas("inlineImage",Nt,Lt).context;ot(ur,xt),Pt=this.applyTransferMapsToCanvas(ur)}for(const Nt of mt)St.save(),St.transform(...Nt.transform),St.scale(1,-1),nt(St,Pt,Nt.x,Nt.y,Nt.w,Nt.h,0,-1,1,1),St.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(xt){}markPointProps(xt,mt){}beginMarkedContent(xt){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(xt,mt){xt==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(mt)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(xt){const mt=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(xt);const St=this.ctx;this.pendingClip&&(mt||(this.pendingClip===ar?St.clip("evenodd"):St.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),St.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const xt=(0,o.getCurrentTransform)(this.ctx);if(xt[1]===0&&xt[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(xt[0]),Math.abs(xt[3]));else{const mt=Math.abs(xt[0]*xt[3]-xt[2]*xt[1]),St=Math.hypot(xt[0],xt[2]),Pt=Math.hypot(xt[1],xt[3]);this._cachedGetSinglePixelWidth=Math.max(St,Pt)/mt}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:xt}=this.current,{a:mt,b:St,c:Pt,d:Nt}=this.ctx.getTransform();let Lt,lr;if(St===0&&Pt===0){const ur=Math.abs(mt),wr=Math.abs(Nt);if(ur===wr)if(xt===0)Lt=lr=1/ur;else{const vr=ur*xt;Lt=lr=vr<1?1/vr:1}else if(xt===0)Lt=1/ur,lr=1/wr;else{const vr=ur*xt,Fr=wr*xt;Lt=vr<1?1/vr:1,lr=Fr<1?1/Fr:1}}else{const ur=Math.abs(mt*Nt-St*Pt),wr=Math.hypot(mt,St),vr=Math.hypot(Pt,Nt);if(xt===0)Lt=vr/ur,lr=wr/ur;else{const Fr=xt*ur;Lt=vr>Fr?vr/Fr:1,lr=wr>Fr?wr/Fr:1}}this._cachedScaleForStroking[0]=Lt,this._cachedScaleForStroking[1]=lr}return this._cachedScaleForStroking}rescaleAndStroke(xt){const{ctx:mt}=this,{lineWidth:St}=this.current,[Pt,Nt]=this.getScaleForStroking();if(mt.lineWidth=St||1,Pt===1&&Nt===1){mt.stroke();return}const Lt=mt.getLineDash();if(xt&&mt.save(),mt.scale(Pt,Nt),Lt.length>0){const lr=Math.max(Pt,Nt);mt.setLineDash(Lt.map(ur=>ur/lr)),mt.lineDashOffset/=lr}mt.stroke(),xt&&mt.restore()}isContentVisible(){for(let xt=this.markedContentStack.length-1;xt>=0;xt--)if(!this.markedContentStack[xt].visible)return!1;return!0}};Yt=new WeakSet,Xs=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Gs=function(){if(this.pageColors){const xt=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(xt!=="none"){const mt=this.ctx.filter;this.ctx.filter=xt,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=mt}}};let Jt=fr;i.CanvasGraphics=Jt;for(const Et in a.OPS)Jt.prototype[Et]!==void 0&&(Jt.prototype[a.OPS[Et]]=Jt.prototype[Et])},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=rt;var a=s(1),o=s(6);const c={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=c;function d(at,st){if(!st)return;const ot=st[2]-st[0],pt=st[3]-st[1],dt=new Path2D;dt.rect(st[0],st[1],ot,pt),at.clip(dt)}class h{constructor(){this.constructor===h&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class g extends h{constructor(st){super(),this._type=st[1],this._bbox=st[2],this._colorStops=st[3],this._p0=st[4],this._p1=st[5],this._r0=st[6],this._r1=st[7],this.matrix=null}_createGradient(st){let ot;this._type==="axial"?ot=st.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(ot=st.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const pt of this._colorStops)ot.addColorStop(pt[0],pt[1]);return ot}getPattern(st,ot,pt,dt){let wt;if(dt===c.STROKE||dt===c.FILL){const lt=ot.current.getClippedPathBoundingBox(dt,(0,o.getCurrentTransform)(st))||[0,0,0,0],gt=Math.ceil(lt[2]-lt[0])||1,vt=Math.ceil(lt[3]-lt[1])||1,At=ot.cachedCanvases.getCanvas("pattern",gt,vt,!0),yt=At.context;yt.clearRect(0,0,yt.canvas.width,yt.canvas.height),yt.beginPath(),yt.rect(0,0,yt.canvas.width,yt.canvas.height),yt.translate(-lt[0],-lt[1]),pt=a.Util.transform(pt,[1,0,0,1,lt[0],lt[1]]),yt.transform(...ot.baseTransform),this.matrix&&yt.transform(...this.matrix),d(yt,this._bbox),yt.fillStyle=this._createGradient(yt),yt.fill(),wt=st.createPattern(At.canvas,"no-repeat");const bt=new DOMMatrix(pt);wt.setTransform(bt)}else d(st,this._bbox),wt=this._createGradient(st);return wt}}function _(at,st,ot,pt,dt,wt,lt,gt){const vt=st.coords,At=st.colors,yt=at.data,bt=at.width*4;let Tt;vt[ot+1]>vt[pt+1]&&(Tt=ot,ot=pt,pt=Tt,Tt=wt,wt=lt,lt=Tt),vt[pt+1]>vt[dt+1]&&(Tt=pt,pt=dt,dt=Tt,Tt=lt,lt=gt,gt=Tt),vt[ot+1]>vt[pt+1]&&(Tt=ot,ot=pt,pt=Tt,Tt=wt,wt=lt,lt=Tt);const er=(vt[ot]+st.offsetX)*st.scaleX,zt=(vt[ot+1]+st.offsetY)*st.scaleY,ar=(vt[pt]+st.offsetX)*st.scaleX,Jt=(vt[pt+1]+st.offsetY)*st.scaleY,Yt=(vt[dt]+st.offsetX)*st.scaleX,kt=(vt[dt+1]+st.offsetY)*st.scaleY;if(zt>=kt)return;const ir=At[wt],fr=At[wt+1],Et=At[wt+2],xt=At[lt],mt=At[lt+1],St=At[lt+2],Pt=At[gt],Nt=At[gt+1],Lt=At[gt+2],lr=Math.round(zt),ur=Math.round(kt);let wr,vr,Fr,Rr,jr,xr,hr,jt;for(let sr=lr;sr<=ur;sr++){if(sr<Jt){const Er=sr<zt?0:(zt-sr)/(zt-Jt);wr=er-(er-ar)*Er,vr=ir-(ir-xt)*Er,Fr=fr-(fr-mt)*Er,Rr=Et-(Et-St)*Er}else{let Er;sr>kt?Er=1:Jt===kt?Er=0:Er=(Jt-sr)/(Jt-kt),wr=ar-(ar-Yt)*Er,vr=xt-(xt-Pt)*Er,Fr=mt-(mt-Nt)*Er,Rr=St-(St-Lt)*Er}let _r;sr<zt?_r=0:sr>kt?_r=1:_r=(zt-sr)/(zt-kt),jr=er-(er-Yt)*_r,xr=ir-(ir-Pt)*_r,hr=fr-(fr-Nt)*_r,jt=Et-(Et-Lt)*_r;const Ar=Math.round(Math.min(wr,jr)),Mr=Math.round(Math.max(wr,jr));let Ur=bt*sr+Ar*4;for(let Er=Ar;Er<=Mr;Er++)_r=(wr-Er)/(wr-jr),_r<0?_r=0:_r>1&&(_r=1),yt[Ur++]=vr-(vr-xr)*_r|0,yt[Ur++]=Fr-(Fr-hr)*_r|0,yt[Ur++]=Rr-(Rr-jt)*_r|0,yt[Ur++]=255}}function b(at,st,ot){const pt=st.coords,dt=st.colors;let wt,lt;switch(st.type){case"lattice":const gt=st.verticesPerRow,vt=Math.floor(pt.length/gt)-1,At=gt-1;for(wt=0;wt<vt;wt++){let yt=wt*gt;for(let bt=0;bt<At;bt++,yt++)_(at,ot,pt[yt],pt[yt+1],pt[yt+gt],dt[yt],dt[yt+1],dt[yt+gt]),_(at,ot,pt[yt+gt+1],pt[yt+1],pt[yt+gt],dt[yt+gt+1],dt[yt+1],dt[yt+gt])}break;case"triangles":for(wt=0,lt=pt.length;wt<lt;wt+=3)_(at,ot,pt[wt],pt[wt+1],pt[wt+2],dt[wt],dt[wt+1],dt[wt+2]);break;default:throw new Error("illegal figure")}}class tt extends h{constructor(st){super(),this._coords=st[2],this._colors=st[3],this._figures=st[4],this._bounds=st[5],this._bbox=st[7],this._background=st[8],this.matrix=null}_createMeshCanvas(st,ot,pt){const gt=Math.floor(this._bounds[0]),vt=Math.floor(this._bounds[1]),At=Math.ceil(this._bounds[2])-gt,yt=Math.ceil(this._bounds[3])-vt,bt=Math.min(Math.ceil(Math.abs(At*st[0]*1.1)),3e3),Tt=Math.min(Math.ceil(Math.abs(yt*st[1]*1.1)),3e3),er=At/bt,zt=yt/Tt,ar={coords:this._coords,colors:this._colors,offsetX:-gt,offsetY:-vt,scaleX:1/er,scaleY:1/zt},Jt=bt+2*2,Yt=Tt+2*2,kt=pt.getCanvas("mesh",Jt,Yt,!1),ir=kt.context,fr=ir.createImageData(bt,Tt);if(ot){const xt=fr.data;for(let mt=0,St=xt.length;mt<St;mt+=4)xt[mt]=ot[0],xt[mt+1]=ot[1],xt[mt+2]=ot[2],xt[mt+3]=255}for(const xt of this._figures)b(fr,xt,ar);return ir.putImageData(fr,2,2),{canvas:kt.canvas,offsetX:gt-2*er,offsetY:vt-2*zt,scaleX:er,scaleY:zt}}getPattern(st,ot,pt,dt){d(st,this._bbox);let wt;if(dt===c.SHADING)wt=a.Util.singularValueDecompose2dScale((0,o.getCurrentTransform)(st));else if(wt=a.Util.singularValueDecompose2dScale(ot.baseTransform),this.matrix){const gt=a.Util.singularValueDecompose2dScale(this.matrix);wt=[wt[0]*gt[0],wt[1]*gt[1]]}const lt=this._createMeshCanvas(wt,dt===c.SHADING?null:this._background,ot.cachedCanvases);return dt!==c.SHADING&&(st.setTransform(...ot.baseTransform),this.matrix&&st.transform(...this.matrix)),st.translate(lt.offsetX,lt.offsetY),st.scale(lt.scaleX,lt.scaleY),st.createPattern(lt.canvas,"no-repeat")}}class _e extends h{getPattern(){return"hotpink"}}function rt(at){switch(at[0]){case"RadialAxial":return new g(at);case"Mesh":return new tt(at);case"Dummy":return new _e}throw new Error(`Unknown IR type: ${at[0]}`)}const it={COLORED:1,UNCOLORED:2},nt=class nt{constructor(st,ot,pt,dt,wt){this.operatorList=st[2],this.matrix=st[3]||[1,0,0,1,0,0],this.bbox=st[4],this.xstep=st[5],this.ystep=st[6],this.paintType=st[7],this.tilingType=st[8],this.color=ot,this.ctx=pt,this.canvasGraphicsFactory=dt,this.baseTransform=wt}createPatternCanvas(st){const ot=this.operatorList,pt=this.bbox,dt=this.xstep,wt=this.ystep,lt=this.paintType,gt=this.tilingType,vt=this.color,At=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+gt);const yt=pt[0],bt=pt[1],Tt=pt[2],er=pt[3],zt=a.Util.singularValueDecompose2dScale(this.matrix),ar=a.Util.singularValueDecompose2dScale(this.baseTransform),Jt=[zt[0]*ar[0],zt[1]*ar[1]],Yt=this.getSizeAndScale(dt,this.ctx.canvas.width,Jt[0]),kt=this.getSizeAndScale(wt,this.ctx.canvas.height,Jt[1]),ir=st.cachedCanvases.getCanvas("pattern",Yt.size,kt.size,!0),fr=ir.context,Et=At.createCanvasGraphics(fr);Et.groupLevel=st.groupLevel,this.setFillAndStrokeStyleToContext(Et,lt,vt);let xt=yt,mt=bt,St=Tt,Pt=er;return yt<0&&(xt=0,St+=Math.abs(yt)),bt<0&&(mt=0,Pt+=Math.abs(bt)),fr.translate(-(Yt.scale*xt),-(kt.scale*mt)),Et.transform(Yt.scale,0,0,kt.scale,0,0),fr.save(),this.clipBbox(Et,xt,mt,St,Pt),Et.baseTransform=(0,o.getCurrentTransform)(Et.ctx),Et.executeOperatorList(ot),Et.endDrawing(),{canvas:ir.canvas,scaleX:Yt.scale,scaleY:kt.scale,offsetX:xt,offsetY:mt}}getSizeAndScale(st,ot,pt){st=Math.abs(st);const dt=Math.max(nt.MAX_PATTERN_SIZE,ot);let wt=Math.ceil(st*pt);return wt>=dt?wt=dt:pt=wt/st,{scale:pt,size:wt}}clipBbox(st,ot,pt,dt,wt){const lt=dt-ot,gt=wt-pt;st.ctx.rect(ot,pt,lt,gt),st.current.updateRectMinMax((0,o.getCurrentTransform)(st.ctx),[ot,pt,dt,wt]),st.clip(),st.endPath()}setFillAndStrokeStyleToContext(st,ot,pt){const dt=st.ctx,wt=st.current;switch(ot){case it.COLORED:const lt=this.ctx;dt.fillStyle=lt.fillStyle,dt.strokeStyle=lt.strokeStyle,wt.fillColor=lt.fillStyle,wt.strokeColor=lt.strokeStyle;break;case it.UNCOLORED:const gt=a.Util.makeHexColor(pt[0],pt[1],pt[2]);dt.fillStyle=gt,dt.strokeStyle=gt,wt.fillColor=gt,wt.strokeColor=gt;break;default:throw new a.FormatError(`Unsupported paint type: ${ot}`)}}getPattern(st,ot,pt,dt){let wt=pt;dt!==c.SHADING&&(wt=a.Util.transform(wt,ot.baseTransform),this.matrix&&(wt=a.Util.transform(wt,this.matrix)));const lt=this.createPatternCanvas(ot);let gt=new DOMMatrix(wt);gt=gt.translate(lt.offsetX,lt.offsetY),gt=gt.scale(1/lt.scaleX,1/lt.scaleY);const vt=st.createPattern(lt.canvas,"repeat");return vt.setTransform(gt),vt}};mn(nt,"MAX_PATTERN_SIZE",3e3);let et=nt;i.TilingPattern=et},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=c,i.convertToRGBA=o,i.grayToRGBA=h;var a=s(1);function o(g){switch(g.kind){case a.ImageKind.GRAYSCALE_1BPP:return c(g);case a.ImageKind.RGB_24BPP:return d(g)}return null}function c({src:g,srcPos:_=0,dest:b,width:tt,height:_e,nonBlackColor:rt=4294967295,inverseDecode:it=!1}){const et=a.FeatureTest.isLittleEndian?4278190080:255,[nt,at]=it?[rt,et]:[et,rt],st=tt>>3,ot=tt&7,pt=g.length;b=new Uint32Array(b.buffer);let dt=0;for(let wt=0;wt<_e;wt++){for(const gt=_+st;_<gt;_++){const vt=_<pt?g[_]:255;b[dt++]=vt&128?at:nt,b[dt++]=vt&64?at:nt,b[dt++]=vt&32?at:nt,b[dt++]=vt&16?at:nt,b[dt++]=vt&8?at:nt,b[dt++]=vt&4?at:nt,b[dt++]=vt&2?at:nt,b[dt++]=vt&1?at:nt}if(ot===0)continue;const lt=_<pt?g[_++]:255;for(let gt=0;gt<ot;gt++)b[dt++]=lt&1<<7-gt?at:nt}return{srcPos:_,destPos:dt}}function d({src:g,srcPos:_=0,dest:b,destPos:tt=0,width:_e,height:rt}){let it=0;const et=g.length>>2,nt=new Uint32Array(g.buffer,_,et);if(a.FeatureTest.isLittleEndian){for(;it<et-2;it+=3,tt+=4){const at=nt[it],st=nt[it+1],ot=nt[it+2];b[tt]=at|4278190080,b[tt+1]=at>>>24|st<<8|4278190080,b[tt+2]=st>>>16|ot<<16|4278190080,b[tt+3]=ot>>>8|4278190080}for(let at=it*4,st=g.length;at<st;at+=3)b[tt++]=g[at]|g[at+1]<<8|g[at+2]<<16|4278190080}else{for(;it<et-2;it+=3,tt+=4){const at=nt[it],st=nt[it+1],ot=nt[it+2];b[tt]=at|255,b[tt+1]=at<<24|st>>>8|255,b[tt+2]=st<<16|ot>>>16|255,b[tt+3]=ot<<8|255}for(let at=it*4,st=g.length;at<st;at+=3)b[tt++]=g[at]<<24|g[at+1]<<16|g[at+2]<<8|255}return{srcPos:_,destPos:tt}}function h(g,_){if(a.FeatureTest.isLittleEndian)for(let b=0,tt=g.length;b<tt;b++)_[b]=g[b]*65793|4278190080;else for(let b=0,tt=g.length;b<tt;b++)_[b]=g[b]*16843008|255}},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const s=Object.create(null);i.GlobalWorkerOptions=s,s.workerPort=null,s.workerSrc=""},(e,i,s)=>{var g,Ao,To,ws;Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var a=s(1);const o={UNKNOWN:0,DATA:1,ERROR:2},c={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function d(_e){switch(_e instanceof Error||typeof _e=="object"&&_e!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_e.name){case"AbortException":return new a.AbortException(_e.message);case"MissingPDFException":return new a.MissingPDFException(_e.message);case"PasswordException":return new a.PasswordException(_e.message,_e.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(_e.message,_e.status);case"UnknownErrorException":return new a.UnknownErrorException(_e.message,_e.details);default:return new a.UnknownErrorException(_e.message,_e.toString())}}class h{constructor(rt,it,et){Sr(this,g);this.sourceName=rt,this.targetName=it,this.comObj=et,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=nt=>{const at=nt.data;if(at.targetName!==this.sourceName)return;if(at.stream){mr(this,g,To).call(this,at);return}if(at.callback){const ot=at.callbackId,pt=this.callbackCapabilities[ot];if(!pt)throw new Error(`Cannot resolve callback ${ot}`);if(delete this.callbackCapabilities[ot],at.callback===o.DATA)pt.resolve(at.data);else if(at.callback===o.ERROR)pt.reject(d(at.reason));else throw new Error("Unexpected callback case");return}const st=this.actionHandler[at.action];if(!st)throw new Error(`Unknown action from worker: ${at.action}`);if(at.callbackId){const ot=this.sourceName,pt=at.sourceName;new Promise(function(dt){dt(st(at.data))}).then(function(dt){et.postMessage({sourceName:ot,targetName:pt,callback:o.DATA,callbackId:at.callbackId,data:dt})},function(dt){et.postMessage({sourceName:ot,targetName:pt,callback:o.ERROR,callbackId:at.callbackId,reason:d(dt)})});return}if(at.streamId){mr(this,g,Ao).call(this,at);return}st(at.data)},et.addEventListener("message",this._onComObjOnMessage)}on(rt,it){const et=this.actionHandler;if(et[rt])throw new Error(`There is already an actionName called "${rt}"`);et[rt]=it}send(rt,it,et){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:rt,data:it},et)}sendWithPromise(rt,it,et){const nt=this.callbackId++,at=new a.PromiseCapability;this.callbackCapabilities[nt]=at;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:rt,callbackId:nt,data:it},et)}catch(st){at.reject(st)}return at.promise}sendWithStream(rt,it,et,nt){const at=this.streamId++,st=this.sourceName,ot=this.targetName,pt=this.comObj;return new ReadableStream({start:dt=>{const wt=new a.PromiseCapability;return this.streamControllers[at]={controller:dt,startCall:wt,pullCall:null,cancelCall:null,isClosed:!1},pt.postMessage({sourceName:st,targetName:ot,action:rt,streamId:at,data:it,desiredSize:dt.desiredSize},nt),wt.promise},pull:dt=>{const wt=new a.PromiseCapability;return this.streamControllers[at].pullCall=wt,pt.postMessage({sourceName:st,targetName:ot,stream:c.PULL,streamId:at,desiredSize:dt.desiredSize}),wt.promise},cancel:dt=>{(0,a.assert)(dt instanceof Error,"cancel must have a valid reason");const wt=new a.PromiseCapability;return this.streamControllers[at].cancelCall=wt,this.streamControllers[at].isClosed=!0,pt.postMessage({sourceName:st,targetName:ot,stream:c.CANCEL,streamId:at,reason:d(dt)}),wt.promise}},et)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}g=new WeakSet,Ao=function(rt){const it=rt.streamId,et=this.sourceName,nt=rt.sourceName,at=this.comObj,st=this,ot=this.actionHandler[rt.action],pt={enqueue(dt,wt=1,lt){if(this.isCancelled)return;const gt=this.desiredSize;this.desiredSize-=wt,gt>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),at.postMessage({sourceName:et,targetName:nt,stream:c.ENQUEUE,streamId:it,chunk:dt},lt)},close(){this.isCancelled||(this.isCancelled=!0,at.postMessage({sourceName:et,targetName:nt,stream:c.CLOSE,streamId:it}),delete st.streamSinks[it])},error(dt){(0,a.assert)(dt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,at.postMessage({sourceName:et,targetName:nt,stream:c.ERROR,streamId:it,reason:d(dt)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:rt.desiredSize,ready:null};pt.sinkCapability.resolve(),pt.ready=pt.sinkCapability.promise,this.streamSinks[it]=pt,new Promise(function(dt){dt(ot(rt.data,pt))}).then(function(){at.postMessage({sourceName:et,targetName:nt,stream:c.START_COMPLETE,streamId:it,success:!0})},function(dt){at.postMessage({sourceName:et,targetName:nt,stream:c.START_COMPLETE,streamId:it,reason:d(dt)})})},To=function(rt){const it=rt.streamId,et=this.sourceName,nt=rt.sourceName,at=this.comObj,st=this.streamControllers[it],ot=this.streamSinks[it];switch(rt.stream){case c.START_COMPLETE:rt.success?st.startCall.resolve():st.startCall.reject(d(rt.reason));break;case c.PULL_COMPLETE:rt.success?st.pullCall.resolve():st.pullCall.reject(d(rt.reason));break;case c.PULL:if(!ot){at.postMessage({sourceName:et,targetName:nt,stream:c.PULL_COMPLETE,streamId:it,success:!0});break}ot.desiredSize<=0&&rt.desiredSize>0&&ot.sinkCapability.resolve(),ot.desiredSize=rt.desiredSize,new Promise(function(pt){var dt;pt((dt=ot.onPull)==null?void 0:dt.call(ot))}).then(function(){at.postMessage({sourceName:et,targetName:nt,stream:c.PULL_COMPLETE,streamId:it,success:!0})},function(pt){at.postMessage({sourceName:et,targetName:nt,stream:c.PULL_COMPLETE,streamId:it,reason:d(pt)})});break;case c.ENQUEUE:if((0,a.assert)(st,"enqueue should have stream controller"),st.isClosed)break;st.controller.enqueue(rt.chunk);break;case c.CLOSE:if((0,a.assert)(st,"close should have stream controller"),st.isClosed)break;st.isClosed=!0,st.controller.close(),mr(this,g,ws).call(this,st,it);break;case c.ERROR:(0,a.assert)(st,"error should have stream controller"),st.controller.error(d(rt.reason)),mr(this,g,ws).call(this,st,it);break;case c.CANCEL_COMPLETE:rt.success?st.cancelCall.resolve():st.cancelCall.reject(d(rt.reason)),mr(this,g,ws).call(this,st,it);break;case c.CANCEL:if(!ot)break;new Promise(function(pt){var dt;pt((dt=ot.onCancel)==null?void 0:dt.call(ot,d(rt.reason)))}).then(function(){at.postMessage({sourceName:et,targetName:nt,stream:c.CANCEL_COMPLETE,streamId:it,success:!0})},function(pt){at.postMessage({sourceName:et,targetName:nt,stream:c.CANCEL_COMPLETE,streamId:it,reason:d(pt)})}),ot.sinkCapability.reject(d(rt.reason)),ot.isCancelled=!0,delete this.streamSinks[it];break;default:throw new Error("Unexpected stream case")}},ws=async function(rt,it){var et,nt,at;await Promise.allSettled([(et=rt.startCall)==null?void 0:et.promise,(nt=rt.pullCall)==null?void 0:nt.promise,(at=rt.cancelCall)==null?void 0:at.promise]),delete this.streamControllers[it]},i.MessageHandler=h},(e,i,s)=>{var c,d;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var a=s(1);class o{constructor({parsedData:g,rawData:_}){Sr(this,c);Sr(this,d);yr(this,c,g),yr(this,d,_)}getRaw(){return ht(this,d)}get(g){return ht(this,c).get(g)??null}getAll(){return(0,a.objectFromMap)(ht(this,c))}has(g){return ht(this,c).has(g)}}c=new WeakMap,d=new WeakMap,i.Metadata=o},(e,i,s)=>{var g,_,b,tt,_e,rt,Ks;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var a=s(1),o=s(8);const c=Symbol("INTERNAL");class d{constructor(nt,at){Sr(this,g,!0);this.name=nt,this.intent=at}get visible(){return ht(this,g)}_setVisible(nt,at){nt!==c&&(0,a.unreachable)("Internal method `_setVisible` called."),yr(this,g,at)}}g=new WeakMap;class h{constructor(nt){Sr(this,rt);Sr(this,_,null);Sr(this,b,new Map);Sr(this,tt,null);Sr(this,_e,null);if(this.name=null,this.creator=null,nt!==null){this.name=nt.name,this.creator=nt.creator,yr(this,_e,nt.order);for(const at of nt.groups)ht(this,b).set(at.id,new d(at.name,at.intent));if(nt.baseState==="OFF")for(const at of ht(this,b).values())at._setVisible(c,!1);for(const at of nt.on)ht(this,b).get(at)._setVisible(c,!0);for(const at of nt.off)ht(this,b).get(at)._setVisible(c,!1);yr(this,tt,this.getHash())}}isVisible(nt){if(ht(this,b).size===0)return!0;if(!nt)return(0,a.warn)("Optional content group not defined."),!0;if(nt.type==="OCG")return ht(this,b).has(nt.id)?ht(this,b).get(nt.id).visible:((0,a.warn)(`Optional content group not found: ${nt.id}`),!0);if(nt.type==="OCMD"){if(nt.expression)return mr(this,rt,Ks).call(this,nt.expression);if(!nt.policy||nt.policy==="AnyOn"){for(const at of nt.ids){if(!ht(this,b).has(at))return(0,a.warn)(`Optional content group not found: ${at}`),!0;if(ht(this,b).get(at).visible)return!0}return!1}else if(nt.policy==="AllOn"){for(const at of nt.ids){if(!ht(this,b).has(at))return(0,a.warn)(`Optional content group not found: ${at}`),!0;if(!ht(this,b).get(at).visible)return!1}return!0}else if(nt.policy==="AnyOff"){for(const at of nt.ids){if(!ht(this,b).has(at))return(0,a.warn)(`Optional content group not found: ${at}`),!0;if(!ht(this,b).get(at).visible)return!0}return!1}else if(nt.policy==="AllOff"){for(const at of nt.ids){if(!ht(this,b).has(at))return(0,a.warn)(`Optional content group not found: ${at}`),!0;if(ht(this,b).get(at).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${nt.policy}.`),!0}return(0,a.warn)(`Unknown group type ${nt.type}.`),!0}setVisibility(nt,at=!0){if(!ht(this,b).has(nt)){(0,a.warn)(`Optional content group not found: ${nt}`);return}ht(this,b).get(nt)._setVisible(c,!!at),yr(this,_,null)}get hasInitialVisibility(){return ht(this,tt)===null||this.getHash()===ht(this,tt)}getOrder(){return ht(this,b).size?ht(this,_e)?ht(this,_e).slice():[...ht(this,b).keys()]:null}getGroups(){return ht(this,b).size>0?(0,a.objectFromMap)(ht(this,b)):null}getGroup(nt){return ht(this,b).get(nt)||null}getHash(){if(ht(this,_)!==null)return ht(this,_);const nt=new o.MurmurHash3_64;for(const[at,st]of ht(this,b))nt.update(`${at}:${st.visible}`);return yr(this,_,nt.hexdigest())}}_=new WeakMap,b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakSet,Ks=function(nt){const at=nt.length;if(at<2)return!0;const st=nt[0];for(let ot=1;ot<at;ot++){const pt=nt[ot];let dt;if(Array.isArray(pt))dt=mr(this,rt,Ks).call(this,pt);else if(ht(this,b).has(pt))dt=ht(this,b).get(pt).visible;else return(0,a.warn)(`Optional content group not found: ${pt}`),!0;switch(st){case"And":if(!dt)return!1;break;case"Or":if(dt)return!0;break;case"Not":return!dt;default:return!0}}return st==="And"},i.OptionalContentConfig=h},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var a=s(1),o=s(6);class c{constructor({length:_,initialData:b,progressiveDone:tt=!1,contentDispositionFilename:_e=null,disableRange:rt=!1,disableStream:it=!1},et){if((0,a.assert)(et,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=tt,this._contentDispositionFilename=_e,(b==null?void 0:b.length)>0){const nt=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;this._queuedChunks.push(nt)}this._pdfDataRangeTransport=et,this._isStreamingSupported=!it,this._isRangeSupported=!rt,this._contentLength=_,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((nt,at)=>{this._onReceiveData({begin:nt,chunk:at})}),this._pdfDataRangeTransport.addProgressListener((nt,at)=>{this._onProgress({loaded:nt,total:at})}),this._pdfDataRangeTransport.addProgressiveReadListener(nt=>{this._onReceiveData({chunk:nt})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:_,chunk:b}){const tt=b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength?b.buffer:new Uint8Array(b).buffer;if(_===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(tt):this._queuedChunks.push(tt);else{const _e=this._rangeReaders.some(function(rt){return rt._begin!==_?!1:(rt._enqueue(tt),!0)});(0,a.assert)(_e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}_onProgress(_){var b,tt,_e,rt;_.total===void 0?(tt=(b=this._rangeReaders[0])==null?void 0:b.onProgress)==null||tt.call(b,{loaded:_.loaded}):(rt=(_e=this._fullRequestReader)==null?void 0:_e.onProgress)==null||rt.call(_e,{loaded:_.loaded,total:_.total})}_onProgressiveDone(){var _;(_=this._fullRequestReader)==null||_.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const b=this._rangeReaders.indexOf(_);b>=0&&this._rangeReaders.splice(b,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new d(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,b){if(b<=this._progressiveDataLength)return null;const tt=new h(this,_,b);return this._pdfDataRangeTransport.requestDataRange(_,b),this._rangeReaders.push(tt),tt}cancelAllRequests(_){var b;(b=this._fullRequestReader)==null||b.cancel(_);for(const tt of this._rangeReaders.slice(0))tt.cancel(_);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=c;class d{constructor(_,b,tt=!1,_e=null){this._stream=_,this._done=tt||!1,this._filename=(0,o.isPdfFile)(_e)?_e:null,this._queuedChunks=b||[],this._loaded=0;for(const rt of this._queuedChunks)this._loaded+=rt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=new a.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class h{constructor(_,b,tt){this._stream=_,this._begin=b,this._end=tt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(this._requests.length===0)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const tt of this._requests)tt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const _=new a.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var a=s(1),o=s(20);function c(tt,_e,rt){return{method:"GET",headers:tt,signal:rt.signal,mode:"cors",credentials:_e?"include":"same-origin",redirect:"follow"}}function d(tt){const _e=new Headers;for(const rt in tt){const it=tt[rt];it!==void 0&&_e.append(rt,it)}return _e}function h(tt){return tt instanceof Uint8Array?tt.buffer:tt instanceof ArrayBuffer?tt:((0,a.warn)(`getArrayBuffer - unexpected data format: ${tt}`),new Uint8Array(tt).buffer)}class g{constructor(_e){this.source=_e,this.isHttp=/^https?:/i.test(_e.url),this.httpHeaders=this.isHttp&&_e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _e;return((_e=this._fullRequestReader)==null?void 0:_e._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new _(this),this._fullRequestReader}getRangeReader(_e,rt){if(rt<=this._progressiveDataLength)return null;const it=new b(this,_e,rt);return this._rangeRequestReaders.push(it),it}cancelAllRequests(_e){var rt;(rt=this._fullRequestReader)==null||rt.cancel(_e);for(const it of this._rangeRequestReaders.slice(0))it.cancel(_e)}}i.PDFFetchStream=g;class _{constructor(_e){this._stream=_e,this._reader=null,this._loaded=0,this._filename=null;const rt=_e.source;this._withCredentials=rt.withCredentials||!1,this._contentLength=rt.length,this._headersCapability=new a.PromiseCapability,this._disableRange=rt.disableRange||!1,this._rangeChunkSize=rt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!rt.disableStream,this._isRangeSupported=!rt.disableRange,this._headers=d(this._stream.httpHeaders);const it=rt.url;fetch(it,c(this._headers,this._withCredentials,this._abortController)).then(et=>{if(!(0,o.validateResponseStatus)(et.status))throw(0,o.createResponseStatusError)(et.status,it);this._reader=et.body.getReader(),this._headersCapability.resolve();const nt=ot=>et.headers.get(ot),{allowRangeRequests:at,suggestedLength:st}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:nt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=at,this._contentLength=st||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(nt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var it;await this._headersCapability.promise;const{value:_e,done:rt}=await this._reader.read();return rt?{value:_e,done:rt}:(this._loaded+=_e.byteLength,(it=this.onProgress)==null||it.call(this,{loaded:this._loaded,total:this._contentLength}),{value:h(_e),done:!1})}cancel(_e){var rt;(rt=this._reader)==null||rt.cancel(_e),this._abortController.abort()}}class b{constructor(_e,rt,it){this._stream=_e,this._reader=null,this._loaded=0;const et=_e.source;this._withCredentials=et.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!et.disableStream,this._abortController=new AbortController,this._headers=d(this._stream.httpHeaders),this._headers.append("Range",`bytes=${rt}-${it-1}`);const nt=et.url;fetch(nt,c(this._headers,this._withCredentials,this._abortController)).then(at=>{if(!(0,o.validateResponseStatus)(at.status))throw(0,o.createResponseStatusError)(at.status,nt);this._readCapability.resolve(),this._reader=at.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var it;await this._readCapability.promise;const{value:_e,done:rt}=await this._reader.read();return rt?{value:_e,done:rt}:(this._loaded+=_e.byteLength,(it=this.onProgress)==null||it.call(this,{loaded:this._loaded}),{value:h(_e),done:!1})}cancel(_e){var rt;(rt=this._reader)==null||rt.cancel(_e),this._abortController.abort()}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=g,i.extractFilenameFromHeader=h,i.validateRangeRequestCapabilities=d,i.validateResponseStatus=_;var a=s(1),o=s(21),c=s(6);function d({getResponseHeader:b,isHttp:tt,rangeChunkSize:_e,disableRange:rt}){const it={allowRangeRequests:!1,suggestedLength:void 0},et=parseInt(b("Content-Length"),10);return!Number.isInteger(et)||(it.suggestedLength=et,et<=2*_e)||rt||!tt||b("Accept-Ranges")!=="bytes"||(b("Content-Encoding")||"identity")!=="identity"||(it.allowRangeRequests=!0),it}function h(b){const tt=b("Content-Disposition");if(tt){let _e=(0,o.getFilenameFromContentDispositionHeader)(tt);if(_e.includes("%"))try{_e=decodeURIComponent(_e)}catch{}if((0,c.isPdfFile)(_e))return _e}return null}function g(b,tt){return b===404||b===0&&tt.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+tt+'".'):new a.UnexpectedResponseException(`Unexpected server response (${b}) while retrieving PDF "${tt}".`,b)}function _(b){return b===200||b===206}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=o;var a=s(1);function o(c){let d=!0,h=g("filename\\*","i").exec(c);if(h){h=h[1];let et=_e(h);return et=unescape(et),et=rt(et),et=it(et),b(et)}if(h=tt(c),h){const et=it(h);return b(et)}if(h=g("filename","i").exec(c),h){h=h[1];let et=_e(h);return et=it(et),b(et)}function g(et,nt){return new RegExp("(?:^|;)\\s*"+et+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',nt)}function _(et,nt){if(et){if(!/^[\x00-\xFF]+$/.test(nt))return nt;try{const at=new TextDecoder(et,{fatal:!0}),st=(0,a.stringToBytes)(nt);nt=at.decode(st),d=!1}catch{}}return nt}function b(et){return d&&/[\x80-\xff]/.test(et)&&(et=_("utf-8",et),d&&(et=_("iso-8859-1",et))),et}function tt(et){const nt=[];let at;const st=g("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(at=st.exec(et))!==null;){let[,pt,dt,wt]=at;if(pt=parseInt(pt,10),pt in nt){if(pt===0)break;continue}nt[pt]=[dt,wt]}const ot=[];for(let pt=0;pt<nt.length&&pt in nt;++pt){let[dt,wt]=nt[pt];wt=_e(wt),dt&&(wt=unescape(wt),pt===0&&(wt=rt(wt))),ot.push(wt)}return ot.join("")}function _e(et){if(et.startsWith('"')){const nt=et.slice(1).split('\\"');for(let at=0;at<nt.length;++at){const st=nt[at].indexOf('"');st!==-1&&(nt[at]=nt[at].slice(0,st),nt.length=at+1),nt[at]=nt[at].replaceAll(/\\(.)/g,"$1")}et=nt.join('"')}return et}function rt(et){const nt=et.indexOf("'");if(nt===-1)return et;const at=et.slice(0,nt),ot=et.slice(nt+1).replace(/^[^']*'/,"");return _(at,ot)}function it(et){return!et.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(et)?et:et.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(nt,at,st,ot){if(st==="q"||st==="Q")return ot=ot.replaceAll("_"," "),ot=ot.replaceAll(/=([0-9a-fA-F]{2})/g,function(pt,dt){return String.fromCharCode(parseInt(dt,16))}),_(at,ot);try{ot=atob(ot)}catch{}return _(at,ot)})}return""}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var a=s(1),o=s(20);const c=200,d=206;function h(_e){const rt=_e.response;return typeof rt!="string"?rt:(0,a.stringToBytes)(rt).buffer}class g{constructor(rt,it={}){this.url=rt,this.isHttp=/^https?:/i.test(rt),this.httpHeaders=this.isHttp&&it.httpHeaders||Object.create(null),this.withCredentials=it.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(rt,it,et){const nt={begin:rt,end:it};for(const at in et)nt[at]=et[at];return this.request(nt)}requestFull(rt){return this.request(rt)}request(rt){const it=new XMLHttpRequest,et=this.currXhrId++,nt=this.pendingRequests[et]={xhr:it};it.open("GET",this.url),it.withCredentials=this.withCredentials;for(const at in this.httpHeaders){const st=this.httpHeaders[at];st!==void 0&&it.setRequestHeader(at,st)}return this.isHttp&&"begin"in rt&&"end"in rt?(it.setRequestHeader("Range",`bytes=${rt.begin}-${rt.end-1}`),nt.expectedStatus=d):nt.expectedStatus=c,it.responseType="arraybuffer",rt.onError&&(it.onerror=function(at){rt.onError(it.status)}),it.onreadystatechange=this.onStateChange.bind(this,et),it.onprogress=this.onProgress.bind(this,et),nt.onHeadersReceived=rt.onHeadersReceived,nt.onDone=rt.onDone,nt.onError=rt.onError,nt.onProgress=rt.onProgress,it.send(null),et}onProgress(rt,it){var nt;const et=this.pendingRequests[rt];et&&((nt=et.onProgress)==null||nt.call(et,it))}onStateChange(rt,it){var pt,dt,wt;const et=this.pendingRequests[rt];if(!et)return;const nt=et.xhr;if(nt.readyState>=2&&et.onHeadersReceived&&(et.onHeadersReceived(),delete et.onHeadersReceived),nt.readyState!==4||!(rt in this.pendingRequests))return;if(delete this.pendingRequests[rt],nt.status===0&&this.isHttp){(pt=et.onError)==null||pt.call(et,nt.status);return}const at=nt.status||c;if(!(at===c&&et.expectedStatus===d)&&at!==et.expectedStatus){(dt=et.onError)==null||dt.call(et,nt.status);return}const ot=h(nt);if(at===d){const lt=nt.getResponseHeader("Content-Range"),gt=/bytes (\d+)-(\d+)\/(\d+)/.exec(lt);et.onDone({begin:parseInt(gt[1],10),chunk:ot})}else ot?et.onDone({begin:0,chunk:ot}):(wt=et.onError)==null||wt.call(et,nt.status)}getRequestXhr(rt){return this.pendingRequests[rt].xhr}isPendingRequest(rt){return rt in this.pendingRequests}abortRequest(rt){const it=this.pendingRequests[rt].xhr;delete this.pendingRequests[rt],it.abort()}}class _{constructor(rt){this._source=rt,this._manager=new g(rt.url,{httpHeaders:rt.httpHeaders,withCredentials:rt.withCredentials}),this._rangeChunkSize=rt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(rt){const it=this._rangeRequestReaders.indexOf(rt);it>=0&&this._rangeRequestReaders.splice(it,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new b(this._manager,this._source),this._fullRequestReader}getRangeReader(rt,it){const et=new tt(this._manager,rt,it);return et.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(et),et}cancelAllRequests(rt){var it;(it=this._fullRequestReader)==null||it.cancel(rt);for(const et of this._rangeRequestReaders.slice(0))et.cancel(rt)}}i.PDFNetworkStream=_;class b{constructor(rt,it){this._manager=rt;const et={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=it.url,this._fullRequestId=rt.requestFull(et),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=it.disableRange||!1,this._contentLength=it.length,this._rangeChunkSize=it.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const rt=this._fullRequestId,it=this._manager.getRequestXhr(rt),et=st=>it.getResponseHeader(st),{allowRangeRequests:nt,suggestedLength:at}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:et,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});nt&&(this._isRangeSupported=!0),this._contentLength=at||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(et),this._isRangeSupported&&this._manager.abortRequest(rt),this._headersReceivedCapability.resolve()}_onDone(rt){if(rt&&(this._requests.length>0?this._requests.shift().resolve({value:rt.chunk,done:!1}):this._cachedChunks.push(rt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(rt){this._storedError=(0,o.createResponseStatusError)(rt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const it of this._requests)it.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(rt){var it;(it=this.onProgress)==null||it.call(this,{loaded:rt.loaded,total:rt.lengthComputable?rt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const rt=new a.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0,this._headersReceivedCapability.reject(rt);for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class tt{constructor(rt,it,et){this._manager=rt;const nt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=rt.url,this._requestId=rt.requestRange(it,et,nt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var rt;(rt=this.onClosed)==null||rt.call(this,this)}_onDone(rt){const it=rt.chunk;this._requests.length>0?this._requests.shift().resolve({value:it,done:!1}):this._queuedChunk=it,this._done=!0;for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(rt){this._storedError=(0,o.createResponseStatusError)(rt,this._url);for(const it of this._requests)it.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(rt){var it;this.isStreamingSupported||(it=this.onProgress)==null||it.call(this,{loaded:rt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const it=this._queuedChunk;return this._queuedChunk=null,{value:it,done:!1}}if(this._done)return{value:void 0,done:!0};const rt=new a.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0;for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var a=s(1),o=s(20);const c=/^file:\/\/\/[a-zA-Z]:\//;function d(et){const nt=require$$5,at=nt.parse(et);return at.protocol==="file:"||at.host?at:/^[a-z]:[/\\]/i.test(et)?nt.parse(`file:///${et}`):(at.host||(at.protocol="file:"),at)}class h{constructor(nt){this.source=nt,this.url=d(nt.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&nt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var nt;return((nt=this._fullRequestReader)==null?void 0:nt._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new rt(this):new tt(this),this._fullRequestReader}getRangeReader(nt,at){if(at<=this._progressiveDataLength)return null;const st=this.isFsUrl?new it(this,nt,at):new _e(this,nt,at);return this._rangeRequestReaders.push(st),st}cancelAllRequests(nt){var at;(at=this._fullRequestReader)==null||at.cancel(nt);for(const st of this._rangeRequestReaders.slice(0))st.cancel(nt)}}i.PDFNodeStream=h;class g{constructor(nt){this._url=nt.url,this._done=!1,this._storedError=null,this.onProgress=null;const at=nt.source;this._contentLength=at.length,this._loaded=0,this._filename=null,this._disableRange=at.disableRange||!1,this._rangeChunkSize=at.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!at.disableStream,this._isRangeSupported=!at.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const nt=this._readableStream.read();return nt===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=nt.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(nt).buffer,done:!1})}cancel(nt){if(!this._readableStream){this._error(nt);return}this._readableStream.destroy(nt)}_error(nt){this._storedError=nt,this._readCapability.resolve()}_setReadableStream(nt){this._readableStream=nt,nt.on("readable",()=>{this._readCapability.resolve()}),nt.on("end",()=>{nt.destroy(),this._done=!0,this._readCapability.resolve()}),nt.on("error",at=>{this._error(at)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _{constructor(nt){this._url=nt.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const at=nt.source;this._isStreamingSupported=!at.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const nt=this._readableStream.read();return nt===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=nt.length,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded}),{value:new Uint8Array(nt).buffer,done:!1})}cancel(nt){if(!this._readableStream){this._error(nt);return}this._readableStream.destroy(nt)}_error(nt){this._storedError=nt,this._readCapability.resolve()}_setReadableStream(nt){this._readableStream=nt,nt.on("readable",()=>{this._readCapability.resolve()}),nt.on("end",()=>{nt.destroy(),this._done=!0,this._readCapability.resolve()}),nt.on("error",at=>{this._error(at)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function b(et,nt){return{protocol:et.protocol,auth:et.auth,host:et.hostname,port:et.port,path:et.path,method:"GET",headers:nt}}class tt extends g{constructor(nt){super(nt);const at=st=>{if(st.statusCode===404){const wt=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=wt,this._headersCapability.reject(wt);return}this._headersCapability.resolve(),this._setReadableStream(st);const ot=wt=>this._readableStream.headers[wt.toLowerCase()],{allowRangeRequests:pt,suggestedLength:dt}=(0,o.validateRangeRequestCapabilities)({getResponseHeader:ot,isHttp:nt.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=pt,this._contentLength=dt||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(ot)};if(this._request=null,this._url.protocol==="http:"){const st=require$$5;this._request=st.request(b(this._url,nt.httpHeaders),at)}else{const st=require$$5;this._request=st.request(b(this._url,nt.httpHeaders),at)}this._request.on("error",st=>{this._storedError=st,this._headersCapability.reject(st)}),this._request.end()}}class _e extends _{constructor(nt,at,st){super(nt),this._httpHeaders={};for(const pt in nt.httpHeaders){const dt=nt.httpHeaders[pt];dt!==void 0&&(this._httpHeaders[pt]=dt)}this._httpHeaders.Range=`bytes=${at}-${st-1}`;const ot=pt=>{if(pt.statusCode===404){const dt=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=dt;return}this._setReadableStream(pt)};if(this._request=null,this._url.protocol==="http:"){const pt=require$$5;this._request=pt.request(b(this._url,this._httpHeaders),ot)}else{const pt=require$$5;this._request=pt.request(b(this._url,this._httpHeaders),ot)}this._request.on("error",pt=>{this._storedError=pt}),this._request.end()}}class rt extends g{constructor(nt){super(nt);let at=decodeURIComponent(this._url.path);c.test(this._url.href)&&(at=at.replace(/^\//,""));const st=require$$5;st.lstat(at,(ot,pt)=>{if(ot){ot.code==="ENOENT"&&(ot=new a.MissingPDFException(`Missing PDF "${at}".`)),this._storedError=ot,this._headersCapability.reject(ot);return}this._contentLength=pt.size,this._setReadableStream(st.createReadStream(at)),this._headersCapability.resolve()})}}class it extends _{constructor(nt,at,st){super(nt);let ot=decodeURIComponent(this._url.path);c.test(this._url.href)&&(ot=ot.replace(/^\//,""));const pt=require$$5;this._setReadableStream(pt.createReadStream(ot,{start:at,end:st-1}))}}},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var a=s(6),o=s(1);const c={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",g=["butt","round","square"],_=["miter","round","bevel"],b=function(pt,dt="",wt=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!wt)return URL.createObjectURL(new Blob([pt],{type:dt}));const lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let gt=`data:${dt};base64,`;for(let vt=0,At=pt.length;vt<At;vt+=3){const yt=pt[vt]&255,bt=pt[vt+1]&255,Tt=pt[vt+2]&255,er=yt>>2,zt=(yt&3)<<4|bt>>4,ar=vt+1<At?(bt&15)<<2|Tt>>6:64,Jt=vt+2<At?Tt&63:64;gt+=lt[er]+lt[zt]+lt[ar]+lt[Jt]}return gt},tt=function(){const pt=new Uint8Array([137,80,78,71,13,10,26,10]),dt=12,wt=new Int32Array(256);for(let Tt=0;Tt<256;Tt++){let er=Tt;for(let zt=0;zt<8;zt++)er=er&1?3988292384^er>>1&2147483647:er>>1&2147483647;wt[Tt]=er}function lt(Tt,er,zt){let ar=-1;for(let Jt=er;Jt<zt;Jt++){const Yt=(ar^Tt[Jt])&255,kt=wt[Yt];ar=ar>>>8^kt}return ar^-1}function gt(Tt,er,zt,ar){let Jt=ar;const Yt=er.length;zt[Jt]=Yt>>24&255,zt[Jt+1]=Yt>>16&255,zt[Jt+2]=Yt>>8&255,zt[Jt+3]=Yt&255,Jt+=4,zt[Jt]=Tt.charCodeAt(0)&255,zt[Jt+1]=Tt.charCodeAt(1)&255,zt[Jt+2]=Tt.charCodeAt(2)&255,zt[Jt+3]=Tt.charCodeAt(3)&255,Jt+=4,zt.set(er,Jt),Jt+=er.length;const kt=lt(zt,ar+4,Jt);zt[Jt]=kt>>24&255,zt[Jt+1]=kt>>16&255,zt[Jt+2]=kt>>8&255,zt[Jt+3]=kt&255}function vt(Tt,er,zt){let ar=1,Jt=0;for(let Yt=er;Yt<zt;++Yt)ar=(ar+(Tt[Yt]&255))%65521,Jt=(Jt+ar)%65521;return Jt<<16|ar}function At(Tt){if(!o.isNodeJS)return yt(Tt);try{const er=parseInt(process.versions.node)>=8?Tt:Buffer.from(Tt),zt=require$$5.deflateSync(er,{level:9});return zt instanceof Uint8Array?zt:new Uint8Array(zt)}catch(er){(0,o.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+er)}return yt(Tt)}function yt(Tt){let er=Tt.length;const zt=65535,ar=Math.ceil(er/zt),Jt=new Uint8Array(2+er+ar*5+4);let Yt=0;Jt[Yt++]=120,Jt[Yt++]=156;let kt=0;for(;er>zt;)Jt[Yt++]=0,Jt[Yt++]=255,Jt[Yt++]=255,Jt[Yt++]=0,Jt[Yt++]=0,Jt.set(Tt.subarray(kt,kt+zt),Yt),Yt+=zt,kt+=zt,er-=zt;Jt[Yt++]=1,Jt[Yt++]=er&255,Jt[Yt++]=er>>8&255,Jt[Yt++]=~er&65535&255,Jt[Yt++]=(~er&65535)>>8&255,Jt.set(Tt.subarray(kt),Yt),Yt+=Tt.length-kt;const ir=vt(Tt,0,Tt.length);return Jt[Yt++]=ir>>24&255,Jt[Yt++]=ir>>16&255,Jt[Yt++]=ir>>8&255,Jt[Yt++]=ir&255,Jt}function bt(Tt,er,zt,ar){const Jt=Tt.width,Yt=Tt.height;let kt,ir,fr;const Et=Tt.data;switch(er){case o.ImageKind.GRAYSCALE_1BPP:ir=0,kt=1,fr=Jt+7>>3;break;case o.ImageKind.RGB_24BPP:ir=2,kt=8,fr=Jt*3;break;case o.ImageKind.RGBA_32BPP:ir=6,kt=8,fr=Jt*4;break;default:throw new Error("invalid format")}const xt=new Uint8Array((1+fr)*Yt);let mt=0,St=0;for(let wr=0;wr<Yt;++wr)xt[mt++]=0,xt.set(Et.subarray(St,St+fr),mt),St+=fr,mt+=fr;if(er===o.ImageKind.GRAYSCALE_1BPP&&ar){mt=0;for(let wr=0;wr<Yt;wr++){mt++;for(let vr=0;vr<fr;vr++)xt[mt++]^=255}}const Pt=new Uint8Array([Jt>>24&255,Jt>>16&255,Jt>>8&255,Jt&255,Yt>>24&255,Yt>>16&255,Yt>>8&255,Yt&255,kt,ir,0,0,0]),Nt=At(xt),Lt=pt.length+dt*3+Pt.length+Nt.length,lr=new Uint8Array(Lt);let ur=0;return lr.set(pt,ur),ur+=pt.length,gt("IHDR",Pt,lr,ur),ur+=dt+Pt.length,gt("IDATA",Nt,lr,ur),ur+=dt+Nt.length,gt("IEND",new Uint8Array(0),lr,ur),b(lr,"image/png",zt)}return function(er,zt,ar){const Jt=er.kind===void 0?o.ImageKind.GRAYSCALE_1BPP:er.kind;return bt(er,Jt,zt,ar)}}();class _e{constructor(){this.fontSizeScale=1,this.fontWeight=c.fontWeight,this.fontSize=0,this.textMatrix=o.IDENTITY_MATRIX,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=o.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=c.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(dt,wt){this.x=dt,this.y=wt}}function rt(pt){let dt=[];const wt=[];for(const lt of pt){if(lt.fn==="save"){dt.push({fnId:92,fn:"group",items:[]}),wt.push(dt),dt=dt.at(-1).items;continue}lt.fn==="restore"?dt=wt.pop():dt.push(lt)}return dt}function it(pt){if(Number.isInteger(pt))return pt.toString();const dt=pt.toFixed(10);let wt=dt.length-1;if(dt[wt]!=="0")return dt;do wt--;while(dt[wt]==="0");return dt.substring(0,dt[wt]==="."?wt:wt+1)}function et(pt){if(pt[4]===0&&pt[5]===0){if(pt[1]===0&&pt[2]===0)return pt[0]===1&&pt[3]===1?"":`scale(${it(pt[0])} ${it(pt[3])})`;if(pt[0]===pt[3]&&pt[1]===-pt[2]){const dt=Math.acos(pt[0])*180/Math.PI;return`rotate(${it(dt)})`}}else if(pt[0]===1&&pt[1]===0&&pt[2]===0&&pt[3]===1)return`translate(${it(pt[4])} ${it(pt[5])})`;return`matrix(${it(pt[0])} ${it(pt[1])} ${it(pt[2])} ${it(pt[3])} ${it(pt[4])} ${it(pt[5])})`}let nt=0,at=0,st=0;class ot{constructor(dt,wt,lt=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new _e,this.transformMatrix=o.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=dt,this.objs=wt,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!lt,this._operatorIdMapping=[];for(const gt in o.OPS)this._operatorIdMapping[o.OPS[gt]]=gt}getObject(dt,wt=null){return typeof dt=="string"?dt.startsWith("g_")?this.commonObjs.get(dt):this.objs.get(dt):wt}save(){this.transformStack.push(this.transformMatrix);const dt=this.current;this.extraStack.push(dt),this.current=dt.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(dt){this.save(),this.executeOpTree(dt),this.restore()}loadDependencies(dt){const wt=dt.fnArray,lt=dt.argsArray;for(let gt=0,vt=wt.length;gt<vt;gt++)if(wt[gt]===o.OPS.dependency)for(const At of lt[gt]){const yt=At.startsWith("g_")?this.commonObjs:this.objs,bt=new Promise(Tt=>{yt.get(At,Tt)});this.current.dependencies.push(bt)}return Promise.all(this.current.dependencies)}transform(dt,wt,lt,gt,vt,At){const yt=[dt,wt,lt,gt,vt,At];this.transformMatrix=o.Util.transform(this.transformMatrix,yt),this.tgrp=null}getSVG(dt,wt){this.viewport=wt;const lt=this._initialize(wt);return this.loadDependencies(dt).then(()=>(this.transformMatrix=o.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(dt)),lt))}convertOpList(dt){const wt=this._operatorIdMapping,lt=dt.argsArray,gt=dt.fnArray,vt=[];for(let At=0,yt=gt.length;At<yt;At++){const bt=gt[At];vt.push({fnId:bt,fn:wt[bt],args:lt[At]})}return rt(vt)}executeOpTree(dt){for(const wt of dt){const lt=wt.fn,gt=wt.fnId,vt=wt.args;switch(gt|0){case o.OPS.beginText:this.beginText();break;case o.OPS.dependency:break;case o.OPS.setLeading:this.setLeading(vt);break;case o.OPS.setLeadingMoveText:this.setLeadingMoveText(vt[0],vt[1]);break;case o.OPS.setFont:this.setFont(vt);break;case o.OPS.showText:this.showText(vt[0]);break;case o.OPS.showSpacedText:this.showText(vt[0]);break;case o.OPS.endText:this.endText();break;case o.OPS.moveText:this.moveText(vt[0],vt[1]);break;case o.OPS.setCharSpacing:this.setCharSpacing(vt[0]);break;case o.OPS.setWordSpacing:this.setWordSpacing(vt[0]);break;case o.OPS.setHScale:this.setHScale(vt[0]);break;case o.OPS.setTextMatrix:this.setTextMatrix(vt[0],vt[1],vt[2],vt[3],vt[4],vt[5]);break;case o.OPS.setTextRise:this.setTextRise(vt[0]);break;case o.OPS.setTextRenderingMode:this.setTextRenderingMode(vt[0]);break;case o.OPS.setLineWidth:this.setLineWidth(vt[0]);break;case o.OPS.setLineJoin:this.setLineJoin(vt[0]);break;case o.OPS.setLineCap:this.setLineCap(vt[0]);break;case o.OPS.setMiterLimit:this.setMiterLimit(vt[0]);break;case o.OPS.setFillRGBColor:this.setFillRGBColor(vt[0],vt[1],vt[2]);break;case o.OPS.setStrokeRGBColor:this.setStrokeRGBColor(vt[0],vt[1],vt[2]);break;case o.OPS.setStrokeColorN:this.setStrokeColorN(vt);break;case o.OPS.setFillColorN:this.setFillColorN(vt);break;case o.OPS.shadingFill:this.shadingFill(vt[0]);break;case o.OPS.setDash:this.setDash(vt[0],vt[1]);break;case o.OPS.setRenderingIntent:this.setRenderingIntent(vt[0]);break;case o.OPS.setFlatness:this.setFlatness(vt[0]);break;case o.OPS.setGState:this.setGState(vt[0]);break;case o.OPS.fill:this.fill();break;case o.OPS.eoFill:this.eoFill();break;case o.OPS.stroke:this.stroke();break;case o.OPS.fillStroke:this.fillStroke();break;case o.OPS.eoFillStroke:this.eoFillStroke();break;case o.OPS.clip:this.clip("nonzero");break;case o.OPS.eoClip:this.clip("evenodd");break;case o.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.OPS.paintImageXObject:this.paintImageXObject(vt[0]);break;case o.OPS.paintInlineImageXObject:this.paintInlineImageXObject(vt[0]);break;case o.OPS.paintImageMaskXObject:this.paintImageMaskXObject(vt[0]);break;case o.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(vt[0],vt[1]);break;case o.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.OPS.closePath:this.closePath();break;case o.OPS.closeStroke:this.closeStroke();break;case o.OPS.closeFillStroke:this.closeFillStroke();break;case o.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case o.OPS.nextLine:this.nextLine();break;case o.OPS.transform:this.transform(vt[0],vt[1],vt[2],vt[3],vt[4],vt[5]);break;case o.OPS.constructPath:this.constructPath(vt[0],vt[1]);break;case o.OPS.endPath:this.endPath();break;case 92:this.group(wt.items);break;default:(0,o.warn)(`Unimplemented operator ${lt}`);break}}}setWordSpacing(dt){this.current.wordSpacing=dt}setCharSpacing(dt){this.current.charSpacing=dt}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(dt,wt,lt,gt,vt,At){const yt=this.current;yt.textMatrix=yt.lineMatrix=[dt,wt,lt,gt,vt,At],yt.textMatrixScale=Math.hypot(dt,wt),yt.x=yt.lineX=0,yt.y=yt.lineY=0,yt.xcoords=[],yt.ycoords=[],yt.tspan=this.svgFactory.createElement("svg:tspan"),yt.tspan.setAttributeNS(null,"font-family",yt.fontFamily),yt.tspan.setAttributeNS(null,"font-size",`${it(yt.fontSize)}px`),yt.tspan.setAttributeNS(null,"y",it(-yt.y)),yt.txtElement=this.svgFactory.createElement("svg:text"),yt.txtElement.append(yt.tspan)}beginText(){const dt=this.current;dt.x=dt.lineX=0,dt.y=dt.lineY=0,dt.textMatrix=o.IDENTITY_MATRIX,dt.lineMatrix=o.IDENTITY_MATRIX,dt.textMatrixScale=1,dt.tspan=this.svgFactory.createElement("svg:tspan"),dt.txtElement=this.svgFactory.createElement("svg:text"),dt.txtgrp=this.svgFactory.createElement("svg:g"),dt.xcoords=[],dt.ycoords=[]}moveText(dt,wt){const lt=this.current;lt.x=lt.lineX+=dt,lt.y=lt.lineY+=wt,lt.xcoords=[],lt.ycoords=[],lt.tspan=this.svgFactory.createElement("svg:tspan"),lt.tspan.setAttributeNS(null,"font-family",lt.fontFamily),lt.tspan.setAttributeNS(null,"font-size",`${it(lt.fontSize)}px`),lt.tspan.setAttributeNS(null,"y",it(-lt.y))}showText(dt){const wt=this.current,lt=wt.font,gt=wt.fontSize;if(gt===0)return;const vt=wt.fontSizeScale,At=wt.charSpacing,yt=wt.wordSpacing,bt=wt.fontDirection,Tt=wt.textHScale*bt,er=lt.vertical,zt=er?1:-1,ar=lt.defaultVMetrics,Jt=gt*wt.fontMatrix[0];let Yt=0;for(const fr of dt){if(fr===null){Yt+=bt*yt;continue}else if(typeof fr=="number"){Yt+=zt*fr*gt/1e3;continue}const Et=(fr.isSpace?yt:0)+At,xt=fr.fontChar;let mt,St,Pt=fr.width;if(er){let Lt;const lr=fr.vmetric||ar;Lt=fr.vmetric?lr[1]:Pt*.5,Lt=-Lt*Jt;const ur=lr[2]*Jt;Pt=lr?-lr[0]:Pt,mt=Lt/vt,St=(Yt+ur)/vt}else mt=Yt/vt,St=0;(fr.isInFont||lt.missingFile)&&(wt.xcoords.push(wt.x+mt),er&&wt.ycoords.push(-wt.y+St),wt.tspan.textContent+=xt);const Nt=er?Pt*Jt-Et*bt:Pt*Jt+Et*bt;Yt+=Nt}wt.tspan.setAttributeNS(null,"x",wt.xcoords.map(it).join(" ")),er?wt.tspan.setAttributeNS(null,"y",wt.ycoords.map(it).join(" ")):wt.tspan.setAttributeNS(null,"y",it(-wt.y)),er?wt.y-=Yt:wt.x+=Yt*Tt,wt.tspan.setAttributeNS(null,"font-family",wt.fontFamily),wt.tspan.setAttributeNS(null,"font-size",`${it(wt.fontSize)}px`),wt.fontStyle!==c.fontStyle&&wt.tspan.setAttributeNS(null,"font-style",wt.fontStyle),wt.fontWeight!==c.fontWeight&&wt.tspan.setAttributeNS(null,"font-weight",wt.fontWeight);const kt=wt.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;if(kt===o.TextRenderingMode.FILL||kt===o.TextRenderingMode.FILL_STROKE?(wt.fillColor!==c.fillColor&&wt.tspan.setAttributeNS(null,"fill",wt.fillColor),wt.fillAlpha<1&&wt.tspan.setAttributeNS(null,"fill-opacity",wt.fillAlpha)):wt.textRenderingMode===o.TextRenderingMode.ADD_TO_PATH?wt.tspan.setAttributeNS(null,"fill","transparent"):wt.tspan.setAttributeNS(null,"fill","none"),kt===o.TextRenderingMode.STROKE||kt===o.TextRenderingMode.FILL_STROKE){const fr=1/(wt.textMatrixScale||1);this._setStrokeAttributes(wt.tspan,fr)}let ir=wt.textMatrix;wt.textRise!==0&&(ir=ir.slice(),ir[5]+=wt.textRise),wt.txtElement.setAttributeNS(null,"transform",`${et(ir)} scale(${it(Tt)}, -1)`),wt.txtElement.setAttributeNS(d,"xml:space","preserve"),wt.txtElement.append(wt.tspan),wt.txtgrp.append(wt.txtElement),this._ensureTransformGroup().append(wt.txtElement)}setLeadingMoveText(dt,wt){this.setLeading(-wt),this.moveText(dt,wt)}addFontStyle(dt){if(!dt.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const wt=b(dt.data,dt.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${dt.loadedName}"; src: url(${wt}); }
`}setFont(dt){const wt=this.current,lt=this.commonObjs.get(dt[0]);let gt=dt[1];wt.font=lt,this.embedFonts&&!lt.missingFile&&!this.embeddedFonts[lt.loadedName]&&(this.addFontStyle(lt),this.embeddedFonts[lt.loadedName]=lt),wt.fontMatrix=lt.fontMatrix||o.FONT_IDENTITY_MATRIX;let vt="normal";lt.black?vt="900":lt.bold&&(vt="bold");const At=lt.italic?"italic":"normal";gt<0?(gt=-gt,wt.fontDirection=-1):wt.fontDirection=1,wt.fontSize=gt,wt.fontFamily=lt.loadedName,wt.fontWeight=vt,wt.fontStyle=At,wt.tspan=this.svgFactory.createElement("svg:tspan"),wt.tspan.setAttributeNS(null,"y",it(-wt.y)),wt.xcoords=[],wt.ycoords=[]}endText(){var wt;const dt=this.current;dt.textRenderingMode&o.TextRenderingMode.ADD_TO_PATH_FLAG&&((wt=dt.txtElement)!=null&&wt.hasChildNodes())&&(dt.element=dt.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(dt){dt>0&&(this.current.lineWidth=dt)}setLineCap(dt){this.current.lineCap=g[dt]}setLineJoin(dt){this.current.lineJoin=_[dt]}setMiterLimit(dt){this.current.miterLimit=dt}setStrokeAlpha(dt){this.current.strokeAlpha=dt}setStrokeRGBColor(dt,wt,lt){this.current.strokeColor=o.Util.makeHexColor(dt,wt,lt)}setFillAlpha(dt){this.current.fillAlpha=dt}setFillRGBColor(dt,wt,lt){this.current.fillColor=o.Util.makeHexColor(dt,wt,lt),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(dt){this.current.strokeColor=this._makeColorN_Pattern(dt)}setFillColorN(dt){this.current.fillColor=this._makeColorN_Pattern(dt)}shadingFill(dt){const{width:wt,height:lt}=this.viewport,gt=o.Util.inverseTransform(this.transformMatrix),[vt,At,yt,bt]=o.Util.getAxialAlignedBoundingBox([0,0,wt,lt],gt),Tt=this.svgFactory.createElement("svg:rect");Tt.setAttributeNS(null,"x",vt),Tt.setAttributeNS(null,"y",At),Tt.setAttributeNS(null,"width",yt-vt),Tt.setAttributeNS(null,"height",bt-At),Tt.setAttributeNS(null,"fill",this._makeShadingPattern(dt)),this.current.fillAlpha<1&&Tt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Tt)}_makeColorN_Pattern(dt){return dt[0]==="TilingPattern"?this._makeTilingPattern(dt):this._makeShadingPattern(dt)}_makeTilingPattern(dt){const wt=dt[1],lt=dt[2],gt=dt[3]||o.IDENTITY_MATRIX,[vt,At,yt,bt]=dt[4],Tt=dt[5],er=dt[6],zt=dt[7],ar=`shading${st++}`,[Jt,Yt,kt,ir]=o.Util.normalizeRect([...o.Util.applyTransform([vt,At],gt),...o.Util.applyTransform([yt,bt],gt)]),[fr,Et]=o.Util.singularValueDecompose2dScale(gt),xt=Tt*fr,mt=er*Et,St=this.svgFactory.createElement("svg:pattern");St.setAttributeNS(null,"id",ar),St.setAttributeNS(null,"patternUnits","userSpaceOnUse"),St.setAttributeNS(null,"width",xt),St.setAttributeNS(null,"height",mt),St.setAttributeNS(null,"x",`${Jt}`),St.setAttributeNS(null,"y",`${Yt}`);const Pt=this.svg,Nt=this.transformMatrix,Lt=this.current.fillColor,lr=this.current.strokeColor,ur=this.svgFactory.create(kt-Jt,ir-Yt);if(this.svg=ur,this.transformMatrix=gt,zt===2){const wr=o.Util.makeHexColor(...wt);this.current.fillColor=wr,this.current.strokeColor=wr}return this.executeOpTree(this.convertOpList(lt)),this.svg=Pt,this.transformMatrix=Nt,this.current.fillColor=Lt,this.current.strokeColor=lr,St.append(ur.childNodes[0]),this.defs.append(St),`url(#${ar})`}_makeShadingPattern(dt){switch(typeof dt=="string"&&(dt=this.objs.get(dt)),dt[0]){case"RadialAxial":const wt=`shading${st++}`,lt=dt[3];let gt;switch(dt[1]){case"axial":const vt=dt[4],At=dt[5];gt=this.svgFactory.createElement("svg:linearGradient"),gt.setAttributeNS(null,"id",wt),gt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gt.setAttributeNS(null,"x1",vt[0]),gt.setAttributeNS(null,"y1",vt[1]),gt.setAttributeNS(null,"x2",At[0]),gt.setAttributeNS(null,"y2",At[1]);break;case"radial":const yt=dt[4],bt=dt[5],Tt=dt[6],er=dt[7];gt=this.svgFactory.createElement("svg:radialGradient"),gt.setAttributeNS(null,"id",wt),gt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gt.setAttributeNS(null,"cx",bt[0]),gt.setAttributeNS(null,"cy",bt[1]),gt.setAttributeNS(null,"r",er),gt.setAttributeNS(null,"fx",yt[0]),gt.setAttributeNS(null,"fy",yt[1]),gt.setAttributeNS(null,"fr",Tt);break;default:throw new Error(`Unknown RadialAxial type: ${dt[1]}`)}for(const vt of lt){const At=this.svgFactory.createElement("svg:stop");At.setAttributeNS(null,"offset",vt[0]),At.setAttributeNS(null,"stop-color",vt[1]),gt.append(At)}return this.defs.append(gt),`url(#${wt})`;case"Mesh":return(0,o.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${dt[0]}`)}}setDash(dt,wt){this.current.dashArray=dt,this.current.dashPhase=wt}constructPath(dt,wt){const lt=this.current;let gt=lt.x,vt=lt.y,At=[],yt=0;for(const bt of dt)switch(bt|0){case o.OPS.rectangle:gt=wt[yt++],vt=wt[yt++];const Tt=wt[yt++],er=wt[yt++],zt=gt+Tt,ar=vt+er;At.push("M",it(gt),it(vt),"L",it(zt),it(vt),"L",it(zt),it(ar),"L",it(gt),it(ar),"Z");break;case o.OPS.moveTo:gt=wt[yt++],vt=wt[yt++],At.push("M",it(gt),it(vt));break;case o.OPS.lineTo:gt=wt[yt++],vt=wt[yt++],At.push("L",it(gt),it(vt));break;case o.OPS.curveTo:gt=wt[yt+4],vt=wt[yt+5],At.push("C",it(wt[yt]),it(wt[yt+1]),it(wt[yt+2]),it(wt[yt+3]),it(gt),it(vt)),yt+=6;break;case o.OPS.curveTo2:At.push("C",it(gt),it(vt),it(wt[yt]),it(wt[yt+1]),it(wt[yt+2]),it(wt[yt+3])),gt=wt[yt+2],vt=wt[yt+3],yt+=4;break;case o.OPS.curveTo3:gt=wt[yt+2],vt=wt[yt+3],At.push("C",it(wt[yt]),it(wt[yt+1]),it(gt),it(vt),it(gt),it(vt)),yt+=4;break;case o.OPS.closePath:At.push("Z");break}At=At.join(" "),lt.path&&dt.length>0&&dt[0]!==o.OPS.rectangle&&dt[0]!==o.OPS.moveTo?At=lt.path.getAttributeNS(null,"d")+At:(lt.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(lt.path)),lt.path.setAttributeNS(null,"d",At),lt.path.setAttributeNS(null,"fill","none"),lt.element=lt.path,lt.setCurrentPoint(gt,vt)}endPath(){const dt=this.current;if(dt.path=null,!this.pendingClip)return;if(!dt.element){this.pendingClip=null;return}const wt=`clippath${nt++}`,lt=this.svgFactory.createElement("svg:clipPath");lt.setAttributeNS(null,"id",wt),lt.setAttributeNS(null,"transform",et(this.transformMatrix));const gt=dt.element.cloneNode(!0);if(this.pendingClip==="evenodd"?gt.setAttributeNS(null,"clip-rule","evenodd"):gt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,lt.append(gt),this.defs.append(lt),dt.activeClipUrl){dt.clipGroup=null;for(const vt of this.extraStack)vt.clipGroup=null;lt.setAttributeNS(null,"clip-path",dt.activeClipUrl)}dt.activeClipUrl=`url(#${wt})`,this.tgrp=null}clip(dt){this.pendingClip=dt}closePath(){const dt=this.current;if(dt.path){const wt=`${dt.path.getAttributeNS(null,"d")}Z`;dt.path.setAttributeNS(null,"d",wt)}}setLeading(dt){this.current.leading=-dt}setTextRise(dt){this.current.textRise=dt}setTextRenderingMode(dt){this.current.textRenderingMode=dt}setHScale(dt){this.current.textHScale=dt/100}setRenderingIntent(dt){}setFlatness(dt){}setGState(dt){for(const[wt,lt]of dt)switch(wt){case"LW":this.setLineWidth(lt);break;case"LC":this.setLineCap(lt);break;case"LJ":this.setLineJoin(lt);break;case"ML":this.setMiterLimit(lt);break;case"D":this.setDash(lt[0],lt[1]);break;case"RI":this.setRenderingIntent(lt);break;case"FL":this.setFlatness(lt);break;case"Font":this.setFont(lt);break;case"CA":this.setStrokeAlpha(lt);break;case"ca":this.setFillAlpha(lt);break;default:(0,o.warn)(`Unimplemented graphic state operator ${wt}`);break}}fill(){const dt=this.current;dt.element&&(dt.element.setAttributeNS(null,"fill",dt.fillColor),dt.element.setAttributeNS(null,"fill-opacity",dt.fillAlpha),this.endPath())}stroke(){const dt=this.current;dt.element&&(this._setStrokeAttributes(dt.element),dt.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(dt,wt=1){const lt=this.current;let gt=lt.dashArray;wt!==1&&gt.length>0&&(gt=gt.map(function(vt){return wt*vt})),dt.setAttributeNS(null,"stroke",lt.strokeColor),dt.setAttributeNS(null,"stroke-opacity",lt.strokeAlpha),dt.setAttributeNS(null,"stroke-miterlimit",it(lt.miterLimit)),dt.setAttributeNS(null,"stroke-linecap",lt.lineCap),dt.setAttributeNS(null,"stroke-linejoin",lt.lineJoin),dt.setAttributeNS(null,"stroke-width",it(wt*lt.lineWidth)+"px"),dt.setAttributeNS(null,"stroke-dasharray",gt.map(it).join(" ")),dt.setAttributeNS(null,"stroke-dashoffset",it(wt*lt.dashPhase)+"px")}eoFill(){var dt;(dt=this.current.element)==null||dt.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var dt;(dt=this.current.element)==null||dt.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const dt=this.svgFactory.createElement("svg:rect");dt.setAttributeNS(null,"x","0"),dt.setAttributeNS(null,"y","0"),dt.setAttributeNS(null,"width","1px"),dt.setAttributeNS(null,"height","1px"),dt.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(dt)}paintImageXObject(dt){const wt=this.getObject(dt);if(!wt){(0,o.warn)(`Dependent image with object ID ${dt} is not ready yet`);return}this.paintInlineImageXObject(wt)}paintInlineImageXObject(dt,wt){const lt=dt.width,gt=dt.height,vt=tt(dt,this.forceDataSchema,!!wt),At=this.svgFactory.createElement("svg:rect");At.setAttributeNS(null,"x","0"),At.setAttributeNS(null,"y","0"),At.setAttributeNS(null,"width",it(lt)),At.setAttributeNS(null,"height",it(gt)),this.current.element=At,this.clip("nonzero");const yt=this.svgFactory.createElement("svg:image");yt.setAttributeNS(h,"xlink:href",vt),yt.setAttributeNS(null,"x","0"),yt.setAttributeNS(null,"y",it(-gt)),yt.setAttributeNS(null,"width",it(lt)+"px"),yt.setAttributeNS(null,"height",it(gt)+"px"),yt.setAttributeNS(null,"transform",`scale(${it(1/lt)} ${it(-1/gt)})`),wt?wt.append(yt):this._ensureTransformGroup().append(yt)}paintImageMaskXObject(dt){const wt=this.getObject(dt.data,dt);if(wt.bitmap){(0,o.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const lt=this.current,gt=wt.width,vt=wt.height,At=lt.fillColor;lt.maskId=`mask${at++}`;const yt=this.svgFactory.createElement("svg:mask");yt.setAttributeNS(null,"id",lt.maskId);const bt=this.svgFactory.createElement("svg:rect");bt.setAttributeNS(null,"x","0"),bt.setAttributeNS(null,"y","0"),bt.setAttributeNS(null,"width",it(gt)),bt.setAttributeNS(null,"height",it(vt)),bt.setAttributeNS(null,"fill",At),bt.setAttributeNS(null,"mask",`url(#${lt.maskId})`),this.defs.append(yt),this._ensureTransformGroup().append(bt),this.paintInlineImageXObject(wt,yt)}paintFormXObjectBegin(dt,wt){if(Array.isArray(dt)&&dt.length===6&&this.transform(dt[0],dt[1],dt[2],dt[3],dt[4],dt[5]),wt){const lt=wt[2]-wt[0],gt=wt[3]-wt[1],vt=this.svgFactory.createElement("svg:rect");vt.setAttributeNS(null,"x",wt[0]),vt.setAttributeNS(null,"y",wt[1]),vt.setAttributeNS(null,"width",it(lt)),vt.setAttributeNS(null,"height",it(gt)),this.current.element=vt,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(dt){const wt=this.svgFactory.create(dt.width,dt.height),lt=this.svgFactory.createElement("svg:defs");wt.append(lt),this.defs=lt;const gt=this.svgFactory.createElement("svg:g");return gt.setAttributeNS(null,"transform",et(dt.transform)),wt.append(gt),this.svg=gt,wt}_ensureClipGroup(){if(!this.current.clipGroup){const dt=this.svgFactory.createElement("svg:g");dt.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(dt),this.current.clipGroup=dt}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",et(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}i.SVGGraphics=ot},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class s{static textContent(o){const c=[],d={items:c,styles:Object.create(null)};function h(g){var tt;if(!g)return;let _=null;const b=g.name;if(b==="#text")_=g.value;else if(s.shouldBuildText(b))(tt=g==null?void 0:g.attributes)!=null&&tt.textContent?_=g.attributes.textContent:g.value&&(_=g.value);else return;if(_!==null&&c.push({str:_}),!!g.children)for(const _e of g.children)h(_e)}return h(o),d}static shouldBuildText(o){return!(o==="textarea"||o==="input"||o==="option"||o==="select")}}i.XfaText=s},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=et,i.updateTextLayer=nt;var a=s(1),o=s(6);const c=1e5,d=30,h=.8,g=new Map;function _(at,st){let ot;if(st&&a.FeatureTest.isOffscreenCanvasSupported)ot=new OffscreenCanvas(at,at).getContext("2d",{alpha:!1});else{const pt=document.createElement("canvas");pt.width=pt.height=at,ot=pt.getContext("2d",{alpha:!1})}return ot}function b(at,st){const ot=g.get(at);if(ot)return ot;const pt=_(d,st);pt.font=`${d}px ${at}`;const dt=pt.measureText("");let wt=dt.fontBoundingBoxAscent,lt=Math.abs(dt.fontBoundingBoxDescent);if(wt){const vt=wt/(wt+lt);return g.set(at,vt),pt.canvas.width=pt.canvas.height=0,vt}pt.strokeStyle="red",pt.clearRect(0,0,d,d),pt.strokeText("g",0,0);let gt=pt.getImageData(0,0,d,d).data;lt=0;for(let vt=gt.length-1-3;vt>=0;vt-=4)if(gt[vt]>0){lt=Math.ceil(vt/4/d);break}pt.clearRect(0,0,d,d),pt.strokeText("A",0,d),gt=pt.getImageData(0,0,d,d).data,wt=0;for(let vt=0,At=gt.length;vt<At;vt+=4)if(gt[vt]>0){wt=d-Math.floor(vt/4/d);break}if(pt.canvas.width=pt.canvas.height=0,wt){const vt=wt/(wt+lt);return g.set(at,vt),vt}return g.set(at,h),h}function tt(at,st,ot){const pt=document.createElement("span"),dt={angle:0,canvasWidth:0,hasText:st.str!=="",hasEOL:st.hasEOL,fontSize:0};at._textDivs.push(pt);const wt=a.Util.transform(at._transform,st.transform);let lt=Math.atan2(wt[1],wt[0]);const gt=ot[st.fontName];gt.vertical&&(lt+=Math.PI/2);const vt=Math.hypot(wt[2],wt[3]),At=vt*b(gt.fontFamily,at._isOffscreenCanvasSupported);let yt,bt;lt===0?(yt=wt[4],bt=wt[5]-At):(yt=wt[4]+At*Math.sin(lt),bt=wt[5]-At*Math.cos(lt));const Tt="calc(var(--scale-factor)*",er=pt.style;at._container===at._rootContainer?(er.left=`${(100*yt/at._pageWidth).toFixed(2)}%`,er.top=`${(100*bt/at._pageHeight).toFixed(2)}%`):(er.left=`${Tt}${yt.toFixed(2)}px)`,er.top=`${Tt}${bt.toFixed(2)}px)`),er.fontSize=`${Tt}${vt.toFixed(2)}px)`,er.fontFamily=gt.fontFamily,dt.fontSize=vt,pt.setAttribute("role","presentation"),pt.textContent=st.str,pt.dir=st.dir,at._fontInspectorEnabled&&(pt.dataset.fontName=st.fontName),lt!==0&&(dt.angle=lt*(180/Math.PI));let zt=!1;if(st.str.length>1)zt=!0;else if(st.str!==" "&&st.transform[0]!==st.transform[3]){const ar=Math.abs(st.transform[0]),Jt=Math.abs(st.transform[3]);ar!==Jt&&Math.max(ar,Jt)/Math.min(ar,Jt)>1.5&&(zt=!0)}zt&&(dt.canvasWidth=gt.vertical?st.height:st.width),at._textDivProperties.set(pt,dt),at._isReadableStream&&at._layoutText(pt)}function _e(at){const{div:st,scale:ot,properties:pt,ctx:dt,prevFontSize:wt,prevFontFamily:lt}=at,{style:gt}=st;let vt="";if(pt.canvasWidth!==0&&pt.hasText){const{fontFamily:At}=gt,{canvasWidth:yt,fontSize:bt}=pt;(wt!==bt||lt!==At)&&(dt.font=`${bt*ot}px ${At}`,at.prevFontSize=bt,at.prevFontFamily=At);const{width:Tt}=dt.measureText(st.textContent);Tt>0&&(vt=`scaleX(${yt*ot/Tt})`)}pt.angle!==0&&(vt=`rotate(${pt.angle}deg) ${vt}`),vt.length>0&&(gt.transform=vt)}function rt(at){if(at._canceled)return;const st=at._textDivs,ot=at._capability;if(st.length>c){ot.resolve();return}if(!at._isReadableStream)for(const dt of st)at._layoutText(dt);ot.resolve()}class it{constructor({textContentSource:st,container:ot,viewport:pt,textDivs:dt,textDivProperties:wt,textContentItemsStr:lt,isOffscreenCanvasSupported:gt}){var Tt;this._textContentSource=st,this._isReadableStream=st instanceof ReadableStream,this._container=this._rootContainer=ot,this._textDivs=dt||[],this._textContentItemsStr=lt||[],this._isOffscreenCanvasSupported=gt,this._fontInspectorEnabled=!!((Tt=globalThis.FontInspector)!=null&&Tt.enabled),this._reader=null,this._textDivProperties=wt||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:pt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:_(0,gt)};const{pageWidth:vt,pageHeight:At,pageX:yt,pageY:bt}=pt.rawDims;this._transform=[1,0,0,-1,-yt,bt+At],this._pageWidth=vt,this._pageHeight=At,(0,o.setLayerDimensions)(ot,pt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(st,ot){for(const pt of st){if(pt.str===void 0){if(pt.type==="beginMarkedContentProps"||pt.type==="beginMarkedContent"){const dt=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),pt.id!==null&&this._container.setAttribute("id",`${pt.id}`),dt.append(this._container)}else pt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(pt.str),tt(this,pt,ot)}}_layoutText(st){const ot=this._layoutTextParams.properties=this._textDivProperties.get(st);if(this._layoutTextParams.div=st,_e(this._layoutTextParams),ot.hasText&&this._container.append(st),ot.hasEOL){const pt=document.createElement("br");pt.setAttribute("role","presentation"),this._container.append(pt)}}_render(){const st=new a.PromiseCapability;let ot=Object.create(null);if(this._isReadableStream){const pt=()=>{this._reader.read().then(({value:dt,done:wt})=>{if(wt){st.resolve();return}Object.assign(ot,dt.styles),this._processItems(dt.items,ot),pt()},st.reject)};this._reader=this._textContentSource.getReader(),pt()}else if(this._textContentSource){const{items:pt,styles:dt}=this._textContentSource;this._processItems(pt,dt),st.resolve()}else throw new Error('No "textContentSource" parameter specified.');st.promise.then(()=>{ot=null,rt(this)},this._capability.reject)}}i.TextLayerRenderTask=it;function et(at){!at.textContentSource&&(at.textContent||at.textContentStream)&&((0,o.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),at.textContentSource=at.textContent||at.textContentStream);const{container:st,viewport:ot}=at,pt=getComputedStyle(st),dt=pt.getPropertyValue("visibility"),wt=parseFloat(pt.getPropertyValue("--scale-factor"));dt==="visible"&&(!wt||Math.abs(wt-ot.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const lt=new it(at);return lt._render(),lt}function nt({container:at,viewport:st,textDivs:ot,textDivProperties:pt,isOffscreenCanvasSupported:dt,mustRotate:wt=!0,mustRescale:lt=!0}){if(wt&&(0,o.setLayerDimensions)(at,{rotation:st.rotation}),lt){const gt=_(0,dt),At={prevFontSize:null,prevFontFamily:null,div:null,scale:st.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:gt};for(const yt of ot)At.properties=pt.get(yt),At.div=yt,_e(At)}}},(e,i,s)=>{var b,tt,_e,rt,it,et,nt,at,st,ot,pt,Ys,Es,qs,Qs;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var a=s(1),o=s(4),c=s(28),d=s(33),h=s(6),g=s(34);const vt=class vt{constructor({uiManager:yt,pageIndex:bt,div:Tt,accessibilityManager:er,annotationLayer:zt,viewport:ar,l10n:Jt}){Sr(this,pt);Sr(this,b);Sr(this,tt,!1);Sr(this,_e,null);Sr(this,rt,this.pointerup.bind(this));Sr(this,it,this.pointerdown.bind(this));Sr(this,et,new Map);Sr(this,nt,!1);Sr(this,at,!1);Sr(this,st,!1);Sr(this,ot);const Yt=[c.FreeTextEditor,d.InkEditor,g.StampEditor];if(!vt._initialized){vt._initialized=!0;for(const kt of Yt)kt.initialize(Jt)}yt.registerEditorTypes(Yt),yr(this,ot,yt),this.pageIndex=bt,this.div=Tt,yr(this,b,er),yr(this,_e,zt),this.viewport=ar,ht(this,ot).addLayer(this)}get isEmpty(){return ht(this,et).size===0}updateToolbar(yt){ht(this,ot).updateToolbar(yt)}updateMode(yt=ht(this,ot).getMode()){mr(this,pt,Qs).call(this),yt===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),yt!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",yt===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",yt===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",yt===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(yt){if(!yt&&ht(this,ot).getMode()!==a.AnnotationEditorType.INK)return;if(!yt){for(const Tt of ht(this,et).values())if(Tt.isEmpty()){Tt.setInBackground();return}}mr(this,pt,Es).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(yt){ht(this,ot).setEditingState(yt)}addCommands(yt){ht(this,ot).addCommands(yt)}enable(){this.div.style.pointerEvents="auto";const yt=new Set;for(const Tt of ht(this,et).values())Tt.enableEditing(),Tt.annotationElementId&&yt.add(Tt.annotationElementId);if(!ht(this,_e))return;const bt=ht(this,_e).getEditableAnnotations();for(const Tt of bt){if(Tt.hide(),ht(this,ot).isDeletedAnnotationElement(Tt.data.id)||yt.has(Tt.data.id))continue;const er=this.deserialize(Tt);er&&(this.addOrRebuild(er),er.enableEditing())}}disable(){var bt;yr(this,st,!0),this.div.style.pointerEvents="none";const yt=new Set;for(const Tt of ht(this,et).values()){if(Tt.disableEditing(),!Tt.annotationElementId||Tt.serialize()!==null){yt.add(Tt.annotationElementId);continue}(bt=this.getEditableAnnotation(Tt.annotationElementId))==null||bt.show(),Tt.remove()}if(ht(this,_e)){const Tt=ht(this,_e).getEditableAnnotations();for(const er of Tt){const{id:zt}=er.data;yt.has(zt)||ht(this,ot).isDeletedAnnotationElement(zt)||er.show()}}mr(this,pt,Qs).call(this),this.isEmpty&&(this.div.hidden=!0),yr(this,st,!1)}getEditableAnnotation(yt){var bt;return((bt=ht(this,_e))==null?void 0:bt.getEditableAnnotation(yt))||null}setActiveEditor(yt){ht(this,ot).getActive()!==yt&&ht(this,ot).setActiveEditor(yt)}enableClick(){this.div.addEventListener("pointerdown",ht(this,it)),this.div.addEventListener("pointerup",ht(this,rt))}disableClick(){this.div.removeEventListener("pointerdown",ht(this,it)),this.div.removeEventListener("pointerup",ht(this,rt))}attach(yt){ht(this,et).set(yt.id,yt);const{annotationElementId:bt}=yt;bt&&ht(this,ot).isDeletedAnnotationElement(bt)&&ht(this,ot).removeDeletedAnnotationElement(yt)}detach(yt){var bt;ht(this,et).delete(yt.id),(bt=ht(this,b))==null||bt.removePointerInTextLayer(yt.contentDiv),!ht(this,st)&&yt.annotationElementId&&ht(this,ot).addDeletedAnnotationElement(yt)}remove(yt){this.detach(yt),ht(this,ot).removeEditor(yt),yt.div.contains(document.activeElement)&&setTimeout(()=>{ht(this,ot).focusMainContainer()},0),yt.div.remove(),yt.isAttachedToDOM=!1,ht(this,at)||this.addInkEditorIfNeeded(!1)}changeParent(yt){var bt;yt.parent!==this&&(yt.annotationElementId&&(ht(this,ot).addDeletedAnnotationElement(yt.annotationElementId),o.AnnotationEditor.deleteAnnotationElement(yt),yt.annotationElementId=null),this.attach(yt),(bt=yt.parent)==null||bt.detach(yt),yt.setParent(this),yt.div&&yt.isAttachedToDOM&&(yt.div.remove(),this.div.append(yt.div)))}add(yt){if(this.changeParent(yt),ht(this,ot).addEditor(yt),this.attach(yt),!yt.isAttachedToDOM){const bt=yt.render();this.div.append(bt),yt.isAttachedToDOM=!0}yt.fixAndSetPosition(),yt.onceAdded(),ht(this,ot).addToAnnotationStorage(yt)}moveEditorInDOM(yt){var Tt;if(!yt.isAttachedToDOM)return;const{activeElement:bt}=document;yt.div.contains(bt)&&(yt._focusEventsAllowed=!1,setTimeout(()=>{yt.div.contains(document.activeElement)?yt._focusEventsAllowed=!0:(yt.div.addEventListener("focusin",()=>{yt._focusEventsAllowed=!0},{once:!0}),bt.focus())},0)),yt._structTreeParentId=(Tt=ht(this,b))==null?void 0:Tt.moveElementInDOM(this.div,yt.div,yt.contentDiv,!0)}addOrRebuild(yt){yt.needsToBeRebuilt()?yt.rebuild():this.add(yt)}addUndoableEditor(yt){const bt=()=>yt._uiManager.rebuild(yt),Tt=()=>{yt.remove()};this.addCommands({cmd:bt,undo:Tt,mustExec:!1})}getNextId(){return ht(this,ot).getId()}pasteEditor(yt,bt){ht(this,ot).updateToolbar(yt),ht(this,ot).updateMode(yt);const{offsetX:Tt,offsetY:er}=mr(this,pt,qs).call(this),zt=this.getNextId(),ar=mr(this,pt,Ys).call(this,{parent:this,id:zt,x:Tt,y:er,uiManager:ht(this,ot),isCentered:!0,...bt});ar&&this.add(ar)}deserialize(yt){switch(yt.annotationType??yt.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return c.FreeTextEditor.deserialize(yt,this,ht(this,ot));case a.AnnotationEditorType.INK:return d.InkEditor.deserialize(yt,this,ht(this,ot));case a.AnnotationEditorType.STAMP:return g.StampEditor.deserialize(yt,this,ht(this,ot))}return null}addNewEditor(){mr(this,pt,Es).call(this,mr(this,pt,qs).call(this),!0)}setSelected(yt){ht(this,ot).setSelected(yt)}toggleSelected(yt){ht(this,ot).toggleSelected(yt)}isSelected(yt){return ht(this,ot).isSelected(yt)}unselect(yt){ht(this,ot).unselect(yt)}pointerup(yt){const{isMac:bt}=a.FeatureTest.platform;if(!(yt.button!==0||yt.ctrlKey&&bt)&&yt.target===this.div&&ht(this,nt)){if(yr(this,nt,!1),!ht(this,tt)){yr(this,tt,!0);return}if(ht(this,ot).getMode()===a.AnnotationEditorType.STAMP){ht(this,ot).unselectAll();return}mr(this,pt,Es).call(this,yt,!1)}}pointerdown(yt){if(ht(this,nt)){yr(this,nt,!1);return}const{isMac:bt}=a.FeatureTest.platform;if(yt.button!==0||yt.ctrlKey&&bt||yt.target!==this.div)return;yr(this,nt,!0);const Tt=ht(this,ot).getActive();yr(this,tt,!Tt||Tt.isEmpty())}findNewParent(yt,bt,Tt){const er=ht(this,ot).findParent(bt,Tt);return er===null||er===this?!1:(er.changeParent(yt),!0)}destroy(){var yt,bt;((yt=ht(this,ot).getActive())==null?void 0:yt.parent)===this&&(ht(this,ot).commitOrRemove(),ht(this,ot).setActiveEditor(null));for(const Tt of ht(this,et).values())(bt=ht(this,b))==null||bt.removePointerInTextLayer(Tt.contentDiv),Tt.setParent(null),Tt.isAttachedToDOM=!1,Tt.div.remove();this.div=null,ht(this,et).clear(),ht(this,ot).removeLayer(this)}render({viewport:yt}){this.viewport=yt,(0,h.setLayerDimensions)(this.div,yt);for(const bt of ht(this,ot).getEditors(this.pageIndex))this.add(bt);this.updateMode()}update({viewport:yt}){ht(this,ot).commitOrRemove(),this.viewport=yt,(0,h.setLayerDimensions)(this.div,{rotation:yt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:yt,pageHeight:bt}=this.viewport.rawDims;return[yt,bt]}};b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,ot=new WeakMap,pt=new WeakSet,Ys=function(yt){switch(ht(this,ot).getMode()){case a.AnnotationEditorType.FREETEXT:return new c.FreeTextEditor(yt);case a.AnnotationEditorType.INK:return new d.InkEditor(yt);case a.AnnotationEditorType.STAMP:return new g.StampEditor(yt)}return null},Es=function(yt,bt){const Tt=this.getNextId(),er=mr(this,pt,Ys).call(this,{parent:this,id:Tt,x:yt.offsetX,y:yt.offsetY,uiManager:ht(this,ot),isCentered:bt});return er&&this.add(er),er},qs=function(){const{x:yt,y:bt,width:Tt,height:er}=this.div.getBoundingClientRect(),zt=Math.max(0,yt),ar=Math.max(0,bt),Jt=Math.min(window.innerWidth,yt+Tt),Yt=Math.min(window.innerHeight,bt+er),kt=(zt+Jt)/2-yt,ir=(ar+Yt)/2-bt,[fr,Et]=this.viewport.rotation%180===0?[kt,ir]:[ir,kt];return{offsetX:fr,offsetY:Et}},Qs=function(){yr(this,at,!0);for(const yt of ht(this,et).values())yt.isEmpty()&&yt.remove();yr(this,at,!1)},mn(vt,"_initialized",!1);let _=vt;i.AnnotationEditorLayer=_},(e,i,s)=>{var g,_,b,tt,_e,rt,it,et,nt,at,Co,Ro,Po,ds,Js,ko,Zs;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var a=s(1),o=s(5),c=s(4),d=s(29);const vt=class vt extends c.AnnotationEditor{constructor(bt){super({...bt,name:"freeTextEditor"});Sr(this,at);Sr(this,g,this.editorDivBlur.bind(this));Sr(this,_,this.editorDivFocus.bind(this));Sr(this,b,this.editorDivInput.bind(this));Sr(this,tt,this.editorDivKeydown.bind(this));Sr(this,_e);Sr(this,rt,"");Sr(this,it,`${this.id}-editor`);Sr(this,et);Sr(this,nt,null);yr(this,_e,bt.color||vt._defaultColor||c.AnnotationEditor._defaultLineColor),yr(this,et,bt.fontSize||vt._defaultFontSize)}static get _keyboardManager(){const bt=vt.prototype,Tt=ar=>ar.isEmpty(),er=o.AnnotationEditorUIManager.TRANSLATE_SMALL,zt=o.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new o.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],bt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],bt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],bt._translateEmpty,{args:[-er,0],checker:Tt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],bt._translateEmpty,{args:[-zt,0],checker:Tt}],[["ArrowRight","mac+ArrowRight"],bt._translateEmpty,{args:[er,0],checker:Tt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],bt._translateEmpty,{args:[zt,0],checker:Tt}],[["ArrowUp","mac+ArrowUp"],bt._translateEmpty,{args:[0,-er],checker:Tt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],bt._translateEmpty,{args:[0,-zt],checker:Tt}],[["ArrowDown","mac+ArrowDown"],bt._translateEmpty,{args:[0,er],checker:Tt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],bt._translateEmpty,{args:[0,zt],checker:Tt}]]))}static initialize(bt){c.AnnotationEditor.initialize(bt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Tt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Tt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(bt,Tt){switch(bt){case a.AnnotationEditorParamsType.FREETEXT_SIZE:vt._defaultFontSize=Tt;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:vt._defaultColor=Tt;break}}updateParams(bt,Tt){switch(bt){case a.AnnotationEditorParamsType.FREETEXT_SIZE:mr(this,at,Co).call(this,Tt);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:mr(this,at,Ro).call(this,Tt);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,vt._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,vt._defaultColor||c.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,ht(this,et)],[a.AnnotationEditorParamsType.FREETEXT_COLOR,ht(this,_e)]]}_translateEmpty(bt,Tt){this._uiManager.translateSelectedEditors(bt,Tt,!0)}getInitialTranslation(){const bt=this.parentScale;return[-vt._internalPadding*bt,-(vt._internalPadding+ht(this,et))*bt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",ht(this,tt)),this.editorDiv.addEventListener("focus",ht(this,_)),this.editorDiv.addEventListener("blur",ht(this,g)),this.editorDiv.addEventListener("input",ht(this,b)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",ht(this,it)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",ht(this,tt)),this.editorDiv.removeEventListener("focus",ht(this,_)),this.editorDiv.removeEventListener("blur",ht(this,g)),this.editorDiv.removeEventListener("input",ht(this,b)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(bt){this._focusEventsAllowed&&(super.focusin(bt),bt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var bt;if(this.width){mr(this,at,Zs).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(bt=this._initialOptions)!=null&&bt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const bt=ht(this,rt),Tt=yr(this,rt,mr(this,at,Po).call(this).trimEnd());if(bt===Tt)return;const er=zt=>{if(yr(this,rt,zt),!zt){this.remove();return}mr(this,at,Js).call(this),this._uiManager.rebuild(this),mr(this,at,ds).call(this)};this.addCommands({cmd:()=>{er(Tt)},undo:()=>{er(bt)},mustExec:!1}),mr(this,at,ds).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(bt){this.enterInEditMode()}keydown(bt){bt.target===this.div&&bt.key==="Enter"&&(this.enterInEditMode(),bt.preventDefault())}editorDivKeydown(bt){vt._keyboardManager.exec(this,bt)}editorDivFocus(bt){this.isEditing=!0}editorDivBlur(bt){this.isEditing=!1}editorDivInput(bt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let bt,Tt;this.width&&(bt=this.x,Tt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",ht(this,it)),this.enableEditing(),c.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(zt=>{var ar;return(ar=this.editorDiv)==null?void 0:ar.setAttribute("aria-label",zt)}),c.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(zt=>{var ar;return(ar=this.editorDiv)==null?void 0:ar.setAttribute("default-content",zt)}),this.editorDiv.contentEditable=!0;const{style:er}=this.editorDiv;if(er.fontSize=`calc(${ht(this,et)}px * var(--scale-factor))`,er.color=ht(this,_e),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,o.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[zt,ar]=this.parentDimensions;if(this.annotationElementId){const{position:Jt}=ht(this,nt);let[Yt,kt]=this.getInitialTranslation();[Yt,kt]=this.pageTranslationToScreen(Yt,kt);const[ir,fr]=this.pageDimensions,[Et,xt]=this.pageTranslation;let mt,St;switch(this.rotation){case 0:mt=bt+(Jt[0]-Et)/ir,St=Tt+this.height-(Jt[1]-xt)/fr;break;case 90:mt=bt+(Jt[0]-Et)/ir,St=Tt-(Jt[1]-xt)/fr,[Yt,kt]=[kt,-Yt];break;case 180:mt=bt-this.width+(Jt[0]-Et)/ir,St=Tt-(Jt[1]-xt)/fr,[Yt,kt]=[-Yt,-kt];break;case 270:mt=bt+(Jt[0]-Et-this.height*fr)/ir,St=Tt+(Jt[1]-xt-this.width*ir)/fr,[Yt,kt]=[-kt,Yt];break}this.setAt(mt*zt,St*ar,Yt,kt)}else this.setAt(bt*zt,Tt*ar,this.width*zt,this.height*ar);mr(this,at,Js).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(bt,Tt,er){let zt=null;if(bt instanceof d.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Jt,fontColor:Yt},rect:kt,rotation:ir,id:fr},textContent:Et,textPosition:xt,parent:{page:{pageNumber:mt}}}=bt;if(!Et||Et.length===0)return null;zt=bt={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(Yt),fontSize:Jt,value:Et.join(`
`),position:xt,pageIndex:mt-1,rect:kt,rotation:ir,id:fr,deleted:!1}}const ar=super.deserialize(bt,Tt,er);return yr(ar,et,bt.fontSize),yr(ar,_e,a.Util.makeHexColor(...bt.color)),yr(ar,rt,bt.value),ar.annotationElementId=bt.id||null,yr(ar,nt,zt),ar}serialize(bt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Tt=vt._internalPadding*this.parentScale,er=this.getRect(Tt,Tt),zt=c.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:ht(this,_e)),ar={annotationType:a.AnnotationEditorType.FREETEXT,color:zt,fontSize:ht(this,et),value:ht(this,rt),pageIndex:this.pageIndex,rect:er,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return bt?ar:this.annotationElementId&&!mr(this,at,ko).call(this,ar)?null:(ar.id=this.annotationElementId,ar)}};g=new WeakMap,_=new WeakMap,b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakSet,Co=function(bt){const Tt=zt=>{this.editorDiv.style.fontSize=`calc(${zt}px * var(--scale-factor))`,this.translate(0,-(zt-ht(this,et))*this.parentScale),yr(this,et,zt),mr(this,at,ds).call(this)},er=ht(this,et);this.addCommands({cmd:()=>{Tt(bt)},undo:()=>{Tt(er)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ro=function(bt){const Tt=ht(this,_e);this.addCommands({cmd:()=>{yr(this,_e,this.editorDiv.style.color=bt)},undo:()=>{yr(this,_e,this.editorDiv.style.color=Tt)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Po=function(){const bt=this.editorDiv.getElementsByTagName("div");if(bt.length===0)return this.editorDiv.innerText;const Tt=[];for(const er of bt)Tt.push(er.innerText.replace(/\r\n?|\n/,""));return Tt.join(`
`)},ds=function(){const[bt,Tt]=this.parentDimensions;let er;if(this.isAttachedToDOM)er=this.div.getBoundingClientRect();else{const{currentLayer:zt,div:ar}=this,Jt=ar.style.display;ar.style.display="hidden",zt.div.append(this.div),er=ar.getBoundingClientRect(),ar.remove(),ar.style.display=Jt}this.rotation%180===this.parentRotation%180?(this.width=er.width/bt,this.height=er.height/Tt):(this.width=er.height/bt,this.height=er.width/Tt),this.fixAndSetPosition()},Js=function(){if(this.editorDiv.replaceChildren(),!!ht(this,rt))for(const bt of ht(this,rt).split(`
`)){const Tt=document.createElement("div");Tt.append(bt?document.createTextNode(bt):document.createElement("br")),this.editorDiv.append(Tt)}},ko=function(bt){const{value:Tt,fontSize:er,color:zt,rect:ar,pageIndex:Jt}=ht(this,nt);return bt.value!==Tt||bt.fontSize!==er||bt.rect.some((Yt,kt)=>Math.abs(Yt-ar[kt])>=1)||bt.color.some((Yt,kt)=>Yt!==zt[kt])||bt.pageIndex!==Jt},Zs=function(bt=!1){if(!this.annotationElementId)return;if(mr(this,at,ds).call(this),!bt&&(this.width===0||this.height===0)){setTimeout(()=>mr(this,at,Zs).call(this,!0),0);return}const Tt=vt._internalPadding*this.parentScale;ht(this,nt).rect=this.getRect(Tt,Tt)},mn(vt,"_freeTextDefaultContent",""),mn(vt,"_internalPadding",0),mn(vt,"_defaultColor",null),mn(vt,"_defaultFontSize",10),mn(vt,"_type","freetext");let h=vt;i.FreeTextEditor=h},(e,i,s)=>{var St,Nt,Un,Fo,ur,wr,vr,Fr,Rr,jr,xr,hr,jt,sr,_r,Ar,Mr,Ur,Er,pr,Wr,zr,Oo,Ss,na,ga,tn,fn,hn,Br,br,Cr,Hr,xa,rn,dr,Nr,Xr,No,_a;Object.defineProperty(i,"__esModule",{value:!0}),i.StampAnnotationElement=i.InkAnnotationElement=i.FreeTextAnnotationElement=i.AnnotationLayer=void 0;var a=s(1),o=s(6),c=s(3),d=s(30),h=s(31),g=s(32);const _=1e3,b=9,tt=new WeakSet;function _e(Qr){return{width:Qr[2]-Qr[0],height:Qr[3]-Qr[1]}}class rt{static create(cr){switch(cr.data.annotationType){case a.AnnotationType.LINK:return new et(cr);case a.AnnotationType.TEXT:return new nt(cr);case a.AnnotationType.WIDGET:switch(cr.data.fieldType){case"Tx":return new st(cr);case"Btn":return cr.data.radioButton?new dt(cr):cr.data.checkBox?new pt(cr):new wt(cr);case"Ch":return new lt(cr);case"Sig":return new ot(cr)}return new at(cr);case a.AnnotationType.POPUP:return new gt(cr);case a.AnnotationType.FREETEXT:return new At(cr);case a.AnnotationType.LINE:return new yt(cr);case a.AnnotationType.SQUARE:return new bt(cr);case a.AnnotationType.CIRCLE:return new Tt(cr);case a.AnnotationType.POLYLINE:return new er(cr);case a.AnnotationType.CARET:return new ar(cr);case a.AnnotationType.INK:return new Jt(cr);case a.AnnotationType.POLYGON:return new zt(cr);case a.AnnotationType.HIGHLIGHT:return new Yt(cr);case a.AnnotationType.UNDERLINE:return new kt(cr);case a.AnnotationType.SQUIGGLY:return new ir(cr);case a.AnnotationType.STRIKEOUT:return new fr(cr);case a.AnnotationType.STAMP:return new Et(cr);case a.AnnotationType.FILEATTACHMENT:return new xt(cr);default:return new it(cr)}}}const Pt=class Pt{constructor(cr,{isRenderable:rr=!1,ignoreBorder:gr=!1,createQuadrilaterals:Or=!1}={}){Sr(this,St,!1);this.isRenderable=rr,this.data=cr.data,this.layer=cr.layer,this.linkService=cr.linkService,this.downloadManager=cr.downloadManager,this.imageResourcesPath=cr.imageResourcesPath,this.renderForms=cr.renderForms,this.svgFactory=cr.svgFactory,this.annotationStorage=cr.annotationStorage,this.enableScripting=cr.enableScripting,this.hasJSActions=cr.hasJSActions,this._fieldObjects=cr.fieldObjects,this.parent=cr.parent,rr&&(this.container=this._createContainer(gr)),Or&&this._createQuadrilaterals()}static _hasPopupData({titleObj:cr,contentsObj:rr,richText:gr}){return!!(cr!=null&&cr.str||rr!=null&&rr.str||gr!=null&&gr.str)}get hasPopupData(){return Pt._hasPopupData(this.data)}_createContainer(cr){const{data:rr,parent:{page:gr,viewport:Or}}=this,Ir=document.createElement("section");Ir.setAttribute("data-annotation-id",rr.id),this instanceof at||(Ir.tabIndex=_),Ir.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Ir.setAttribute("aria-haspopup","dialog"),rr.noRotate&&Ir.classList.add("norotate");const{pageWidth:$r,pageHeight:Vr,pageX:nn,pageY:Zr}=Or.rawDims;if(!rr.rect||this instanceof gt){const{rotation:tr}=rr;return!rr.hasOwnCanvas&&tr!==0&&this.setRotation(tr,Ir),Ir}const{width:Rt,height:nr}=_e(rr.rect),Mt=a.Util.normalizeRect([rr.rect[0],gr.view[3]-rr.rect[1]+gr.view[1],rr.rect[2],gr.view[3]-rr.rect[3]+gr.view[1]]);if(!cr&&rr.borderStyle.width>0){Ir.style.borderWidth=`${rr.borderStyle.width}px`;const tr=rr.borderStyle.horizontalCornerRadius,or=rr.borderStyle.verticalCornerRadius;if(tr>0||or>0){const Lr=`calc(${tr}px * var(--scale-factor)) / calc(${or}px * var(--scale-factor))`;Ir.style.borderRadius=Lr}else if(this instanceof dt){const Lr=`calc(${Rt}px * var(--scale-factor)) / calc(${nr}px * var(--scale-factor))`;Ir.style.borderRadius=Lr}switch(rr.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:Ir.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:Ir.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:Ir.style.borderBottomStyle="solid";break}const Tr=rr.borderColor||null;Tr?(yr(this,St,!0),Ir.style.borderColor=a.Util.makeHexColor(Tr[0]|0,Tr[1]|0,Tr[2]|0)):Ir.style.borderWidth=0}Ir.style.left=`${100*(Mt[0]-nn)/$r}%`,Ir.style.top=`${100*(Mt[1]-Zr)/Vr}%`;const{rotation:Bt}=rr;return rr.hasOwnCanvas||Bt===0?(Ir.style.width=`${100*Rt/$r}%`,Ir.style.height=`${100*nr/Vr}%`):this.setRotation(Bt,Ir),Ir}setRotation(cr,rr=this.container){if(!this.data.rect)return;const{pageWidth:gr,pageHeight:Or}=this.parent.viewport.rawDims,{width:Ir,height:$r}=_e(this.data.rect);let Vr,nn;cr%180===0?(Vr=100*Ir/gr,nn=100*$r/Or):(Vr=100*$r/gr,nn=100*Ir/Or),rr.style.width=`${Vr}%`,rr.style.height=`${nn}%`,rr.setAttribute("data-main-rotation",(360-cr)%360)}get _commonActions(){const cr=(rr,gr,Or)=>{const Ir=Or.detail[rr],$r=Ir[0],Vr=Ir.slice(1);Or.target.style[gr]=d.ColorConverters[`${$r}_HTML`](Vr),this.annotationStorage.setValue(this.data.id,{[gr]:d.ColorConverters[`${$r}_rgb`](Vr)})};return(0,a.shadow)(this,"_commonActions",{display:rr=>{const{display:gr}=rr.detail,Or=gr%2===1;this.container.style.visibility=Or?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Or,noPrint:gr===1||gr===2})},print:rr=>{this.annotationStorage.setValue(this.data.id,{noPrint:!rr.detail.print})},hidden:rr=>{const{hidden:gr}=rr.detail;this.container.style.visibility=gr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:gr,noView:gr})},focus:rr=>{setTimeout(()=>rr.target.focus({preventScroll:!1}),0)},userName:rr=>{rr.target.title=rr.detail.userName},readonly:rr=>{rr.target.disabled=rr.detail.readonly},required:rr=>{this._setRequired(rr.target,rr.detail.required)},bgColor:rr=>{cr("bgColor","backgroundColor",rr)},fillColor:rr=>{cr("fillColor","backgroundColor",rr)},fgColor:rr=>{cr("fgColor","color",rr)},textColor:rr=>{cr("textColor","color",rr)},borderColor:rr=>{cr("borderColor","borderColor",rr)},strokeColor:rr=>{cr("strokeColor","borderColor",rr)},rotation:rr=>{const gr=rr.detail.rotation;this.setRotation(gr),this.annotationStorage.setValue(this.data.id,{rotation:gr})}})}_dispatchEventFromSandbox(cr,rr){const gr=this._commonActions;for(const Or of Object.keys(rr.detail)){const Ir=cr[Or]||gr[Or];Ir==null||Ir(rr)}}_setDefaultPropertiesFromJS(cr){if(!this.enableScripting)return;const rr=this.annotationStorage.getRawValue(this.data.id);if(!rr)return;const gr=this._commonActions;for(const[Or,Ir]of Object.entries(rr)){const $r=gr[Or];if($r){const Vr={detail:{[Or]:Ir},target:cr};$r(Vr),delete rr[Or]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:cr}=this.data;if(!cr)return;const[rr,gr,Or,Ir]=this.data.rect;if(cr.length===1){const[,{x:or,y:Tr},{x:Lr,y:kr}]=cr[0];if(Or===or&&Ir===Tr&&rr===Lr&&gr===kr)return}const{style:$r}=this.container;let Vr;if(ht(this,St)){const{borderColor:or,borderWidth:Tr}=$r;$r.borderWidth=0,Vr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${or}" stroke-width="${Tr}">`],this.container.classList.add("hasBorder")}const nn=Or-rr,Zr=Ir-gr,{svgFactory:Rt}=this,nr=Rt.createElement("svg");nr.classList.add("quadrilateralsContainer"),nr.setAttribute("width",0),nr.setAttribute("height",0);const Mt=Rt.createElement("defs");nr.append(Mt);const Bt=Rt.createElement("clipPath"),tr=`clippath_${this.data.id}`;Bt.setAttribute("id",tr),Bt.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Bt);for(const[,{x:or,y:Tr},{x:Lr,y:kr}]of cr){const Pr=Rt.createElement("rect"),Dr=(Lr-rr)/nn,Gr=(Ir-Tr)/Zr,Yr=(or-Lr)/nn,un=(Tr-kr)/Zr;Pr.setAttribute("x",Dr),Pr.setAttribute("y",Gr),Pr.setAttribute("width",Yr),Pr.setAttribute("height",un),Bt.append(Pr),Vr==null||Vr.push(`<rect vector-effect="non-scaling-stroke" x="${Dr}" y="${Gr}" width="${Yr}" height="${un}"/>`)}ht(this,St)&&(Vr.push("</g></svg>')"),$r.backgroundImage=Vr.join("")),this.container.append(nr),this.container.style.clipPath=`url(#${tr})`}_createPopup(){const{container:cr,data:rr}=this;cr.setAttribute("aria-haspopup","dialog");const gr=new gt({data:{color:rr.color,titleObj:rr.titleObj,modificationDate:rr.modificationDate,contentsObj:rr.contentsObj,richText:rr.richText,parentRect:rr.rect,borderStyle:0,id:`popup_${rr.id}`,rotation:rr.rotation},parent:this.parent,elements:[this]});this.parent.div.append(gr.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(cr,rr=null){const gr=[];if(this._fieldObjects){const Or=this._fieldObjects[cr];if(Or)for(const{page:Ir,id:$r,exportValues:Vr}of Or){if(Ir===-1||$r===rr)continue;const nn=typeof Vr=="string"?Vr:null,Zr=document.querySelector(`[data-element-id="${$r}"]`);if(Zr&&!tt.has(Zr)){(0,a.warn)(`_getElementsByName - element not allowed: ${$r}`);continue}gr.push({id:$r,exportValue:nn,domElement:Zr})}return gr}for(const Or of document.getElementsByName(cr)){const{exportValue:Ir}=Or,$r=Or.getAttribute("data-element-id");$r!==rr&&tt.has(Or)&&gr.push({id:$r,exportValue:Ir,domElement:Or})}return gr}show(){var cr;this.container&&(this.container.hidden=!1),(cr=this.popup)==null||cr.maybeShow()}hide(){var cr;this.container&&(this.container.hidden=!0),(cr=this.popup)==null||cr.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const cr=this.getElementsToTriggerPopup();if(Array.isArray(cr))for(const rr of cr)rr.classList.add("highlightArea");else cr.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:cr,data:{id:rr}}=this;this.container.addEventListener("dblclick",()=>{var gr;(gr=this.linkService.eventBus)==null||gr.dispatch("switchannotationeditormode",{source:this,mode:cr,editId:rr})})}};St=new WeakMap;let it=Pt;class et extends it{constructor(rr,gr=null){super(rr,{isRenderable:!0,ignoreBorder:!!(gr!=null&&gr.ignoreBorder),createQuadrilaterals:!0});Sr(this,Nt);this.isTooltipOnly=rr.data.isTooltipOnly}render(){const{data:rr,linkService:gr}=this,Or=document.createElement("a");Or.setAttribute("data-element-id",rr.id);let Ir=!1;return rr.url?(gr.addLinkAttributes(Or,rr.url,rr.newWindow),Ir=!0):rr.action?(this._bindNamedAction(Or,rr.action),Ir=!0):rr.attachment?(this._bindAttachment(Or,rr.attachment),Ir=!0):rr.setOCGState?(mr(this,Nt,Fo).call(this,Or,rr.setOCGState),Ir=!0):rr.dest?(this._bindLink(Or,rr.dest),Ir=!0):(rr.actions&&(rr.actions.Action||rr.actions["Mouse Up"]||rr.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Or,rr),Ir=!0),rr.resetForm?(this._bindResetFormAction(Or,rr.resetForm),Ir=!0):this.isTooltipOnly&&!Ir&&(this._bindLink(Or,""),Ir=!0)),this.container.classList.add("linkAnnotation"),Ir&&this.container.append(Or),this.container}_bindLink(rr,gr){rr.href=this.linkService.getDestinationHash(gr),rr.onclick=()=>(gr&&this.linkService.goToDestination(gr),!1),(gr||gr==="")&&mr(this,Nt,Un).call(this)}_bindNamedAction(rr,gr){rr.href=this.linkService.getAnchorUrl(""),rr.onclick=()=>(this.linkService.executeNamedAction(gr),!1),mr(this,Nt,Un).call(this)}_bindAttachment(rr,gr){rr.href=this.linkService.getAnchorUrl(""),rr.onclick=()=>{var Or;return(Or=this.downloadManager)==null||Or.openOrDownloadData(this.container,gr.content,gr.filename),!1},mr(this,Nt,Un).call(this)}_bindJSAction(rr,gr){rr.href=this.linkService.getAnchorUrl("");const Or=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Ir of Object.keys(gr.actions)){const $r=Or.get(Ir);$r&&(rr[$r]=()=>{var Vr;return(Vr=this.linkService.eventBus)==null||Vr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:gr.id,name:Ir}}),!1})}rr.onclick||(rr.onclick=()=>!1),mr(this,Nt,Un).call(this)}_bindResetFormAction(rr,gr){const Or=rr.onclick;if(Or||(rr.href=this.linkService.getAnchorUrl("")),mr(this,Nt,Un).call(this),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Or||(rr.onclick=()=>!1);return}rr.onclick=()=>{var nr;Or==null||Or();const{fields:Ir,refs:$r,include:Vr}=gr,nn=[];if(Ir.length!==0||$r.length!==0){const Mt=new Set($r);for(const Bt of Ir){const tr=this._fieldObjects[Bt]||[];for(const{id:or}of tr)Mt.add(or)}for(const Bt of Object.values(this._fieldObjects))for(const tr of Bt)Mt.has(tr.id)===Vr&&nn.push(tr)}else for(const Mt of Object.values(this._fieldObjects))nn.push(...Mt);const Zr=this.annotationStorage,Rt=[];for(const Mt of nn){const{id:Bt}=Mt;switch(Rt.push(Bt),Mt.type){case"text":{const or=Mt.defaultValue||"";Zr.setValue(Bt,{value:or});break}case"checkbox":case"radiobutton":{const or=Mt.defaultValue===Mt.exportValues;Zr.setValue(Bt,{value:or});break}case"combobox":case"listbox":{const or=Mt.defaultValue||"";Zr.setValue(Bt,{value:or});break}default:continue}const tr=document.querySelector(`[data-element-id="${Bt}"]`);if(tr){if(!tt.has(tr)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${Bt}`);continue}}else continue;tr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((nr=this.linkService.eventBus)==null||nr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}Nt=new WeakSet,Un=function(){this.container.setAttribute("data-internal-link","")},Fo=function(rr,gr){rr.href=this.linkService.getAnchorUrl(""),rr.onclick=()=>(this.linkService.executeSetOCGState(gr),!1),mr(this,Nt,Un).call(this)};class nt extends it{constructor(cr){super(cr,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const cr=document.createElement("img");return cr.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",cr.alt="[{{type}} Annotation]",cr.dataset.l10nId="text_annotation_type",cr.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(cr),this.container}}class at extends it{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(cr){var rr;this.data.hasOwnCanvas&&(((rr=cr.previousSibling)==null?void 0:rr.nodeName)==="CANVAS"&&(cr.previousSibling.hidden=!0),cr.hidden=!1)}_getKeyModifier(cr){const{isWin:rr,isMac:gr}=a.FeatureTest.platform;return rr&&cr.ctrlKey||gr&&cr.metaKey}_setEventListener(cr,rr,gr,Or,Ir){gr.includes("mouse")?cr.addEventListener(gr,$r=>{var Vr;(Vr=this.linkService.eventBus)==null||Vr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Or,value:Ir($r),shift:$r.shiftKey,modifier:this._getKeyModifier($r)}})}):cr.addEventListener(gr,$r=>{var Vr;if(gr==="blur"){if(!rr.focused||!$r.relatedTarget)return;rr.focused=!1}else if(gr==="focus"){if(rr.focused)return;rr.focused=!0}Ir&&((Vr=this.linkService.eventBus)==null||Vr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Or,value:Ir($r)}}))})}_setEventListeners(cr,rr,gr,Or){var Ir,$r,Vr;for(const[nn,Zr]of gr)(Zr==="Action"||(Ir=this.data.actions)!=null&&Ir[Zr])&&((Zr==="Focus"||Zr==="Blur")&&(rr||(rr={focused:!1})),this._setEventListener(cr,rr,nn,Zr,Or),Zr==="Focus"&&!(($r=this.data.actions)!=null&&$r.Blur)?this._setEventListener(cr,rr,"blur","Blur",null):Zr==="Blur"&&!((Vr=this.data.actions)!=null&&Vr.Focus)&&this._setEventListener(cr,rr,"focus","Focus",null))}_setBackgroundColor(cr){const rr=this.data.backgroundColor||null;cr.style.backgroundColor=rr===null?"transparent":a.Util.makeHexColor(rr[0],rr[1],rr[2])}_setTextStyle(cr){const rr=["left","center","right"],{fontColor:gr}=this.data.defaultAppearanceData,Or=this.data.defaultAppearanceData.fontSize||b,Ir=cr.style;let $r;const Vr=2,nn=Zr=>Math.round(10*Zr)/10;if(this.data.multiLine){const Zr=Math.abs(this.data.rect[3]-this.data.rect[1]-Vr),Rt=Math.round(Zr/(a.LINE_FACTOR*Or))||1,nr=Zr/Rt;$r=Math.min(Or,nn(nr/a.LINE_FACTOR))}else{const Zr=Math.abs(this.data.rect[3]-this.data.rect[1]-Vr);$r=Math.min(Or,nn(Zr/a.LINE_FACTOR))}Ir.fontSize=`calc(${$r}px * var(--scale-factor))`,Ir.color=a.Util.makeHexColor(gr[0],gr[1],gr[2]),this.data.textAlignment!==null&&(Ir.textAlign=rr[this.data.textAlignment])}_setRequired(cr,rr){rr?cr.setAttribute("required",!0):cr.removeAttribute("required"),cr.setAttribute("aria-required",rr)}}class st extends at{constructor(cr){const rr=cr.renderForms||!cr.data.hasAppearance&&!!cr.data.fieldValue;super(cr,{isRenderable:rr})}setPropertyOnSiblings(cr,rr,gr,Or){const Ir=this.annotationStorage;for(const $r of this._getElementsByName(cr.name,cr.id))$r.domElement&&($r.domElement[rr]=gr),Ir.setValue($r.id,{[Or]:gr})}render(){var Or,Ir;const cr=this.annotationStorage,rr=this.data.id;this.container.classList.add("textWidgetAnnotation");let gr=null;if(this.renderForms){const $r=cr.getValue(rr,{value:this.data.fieldValue});let Vr=$r.value||"";const nn=cr.getValue(rr,{charLimit:this.data.maxLen}).charLimit;nn&&Vr.length>nn&&(Vr=Vr.slice(0,nn));let Zr=$r.formattedValue||((Or=this.data.textContent)==null?void 0:Or.join(`
`))||null;Zr&&this.data.comb&&(Zr=Zr.replaceAll(/\s+/g,""));const Rt={userValue:Vr,formattedValue:Zr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(gr=document.createElement("textarea"),gr.textContent=Zr??Vr,this.data.doNotScroll&&(gr.style.overflowY="hidden")):(gr=document.createElement("input"),gr.type="text",gr.setAttribute("value",Zr??Vr),this.data.doNotScroll&&(gr.style.overflowX="hidden")),this.data.hasOwnCanvas&&(gr.hidden=!0),tt.add(gr),gr.setAttribute("data-element-id",rr),gr.disabled=this.data.readOnly,gr.name=this.data.fieldName,gr.tabIndex=_,this._setRequired(gr,this.data.required),nn&&(gr.maxLength=nn),gr.addEventListener("input",Mt=>{cr.setValue(rr,{value:Mt.target.value}),this.setPropertyOnSiblings(gr,"value",Mt.target.value,"value"),Rt.formattedValue=null}),gr.addEventListener("resetform",Mt=>{const Bt=this.data.defaultFieldValue??"";gr.value=Rt.userValue=Bt,Rt.formattedValue=null});let nr=Mt=>{const{formattedValue:Bt}=Rt;Bt!=null&&(Mt.target.value=Bt),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){gr.addEventListener("focus",Bt=>{if(Rt.focused)return;const{target:tr}=Bt;Rt.userValue&&(tr.value=Rt.userValue),Rt.lastCommittedValue=tr.value,Rt.commitKey=1,Rt.focused=!0}),gr.addEventListener("updatefromsandbox",Bt=>{this.showElementAndHideCanvas(Bt.target);const tr={value(or){Rt.userValue=or.detail.value??"",cr.setValue(rr,{value:Rt.userValue.toString()}),or.target.value=Rt.userValue},formattedValue(or){const{formattedValue:Tr}=or.detail;Rt.formattedValue=Tr,Tr!=null&&or.target!==document.activeElement&&(or.target.value=Tr),cr.setValue(rr,{formattedValue:Tr})},selRange(or){or.target.setSelectionRange(...or.detail.selRange)},charLimit:or=>{var Pr;const{charLimit:Tr}=or.detail,{target:Lr}=or;if(Tr===0){Lr.removeAttribute("maxLength");return}Lr.setAttribute("maxLength",Tr);let kr=Rt.userValue;!kr||kr.length<=Tr||(kr=kr.slice(0,Tr),Lr.value=Rt.userValue=kr,cr.setValue(rr,{value:kr}),(Pr=this.linkService.eventBus)==null||Pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rr,name:"Keystroke",value:kr,willCommit:!0,commitKey:1,selStart:Lr.selectionStart,selEnd:Lr.selectionEnd}}))}};this._dispatchEventFromSandbox(tr,Bt)}),gr.addEventListener("keydown",Bt=>{var Tr;Rt.commitKey=1;let tr=-1;if(Bt.key==="Escape"?tr=0:Bt.key==="Enter"&&!this.data.multiLine?tr=2:Bt.key==="Tab"&&(Rt.commitKey=3),tr===-1)return;const{value:or}=Bt.target;Rt.lastCommittedValue!==or&&(Rt.lastCommittedValue=or,Rt.userValue=or,(Tr=this.linkService.eventBus)==null||Tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rr,name:"Keystroke",value:or,willCommit:!0,commitKey:tr,selStart:Bt.target.selectionStart,selEnd:Bt.target.selectionEnd}}))});const Mt=nr;nr=null,gr.addEventListener("blur",Bt=>{var or;if(!Rt.focused||!Bt.relatedTarget)return;Rt.focused=!1;const{value:tr}=Bt.target;Rt.userValue=tr,Rt.lastCommittedValue!==tr&&((or=this.linkService.eventBus)==null||or.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rr,name:"Keystroke",value:tr,willCommit:!0,commitKey:Rt.commitKey,selStart:Bt.target.selectionStart,selEnd:Bt.target.selectionEnd}})),Mt(Bt)}),(Ir=this.data.actions)!=null&&Ir.Keystroke&&gr.addEventListener("beforeinput",Bt=>{var Gr;Rt.lastCommittedValue=null;const{data:tr,target:or}=Bt,{value:Tr,selectionStart:Lr,selectionEnd:kr}=or;let Pr=Lr,Dr=kr;switch(Bt.inputType){case"deleteWordBackward":{const Yr=Tr.substring(0,Lr).match(/\w*[^\w]*$/);Yr&&(Pr-=Yr[0].length);break}case"deleteWordForward":{const Yr=Tr.substring(Lr).match(/^[^\w]*\w*/);Yr&&(Dr+=Yr[0].length);break}case"deleteContentBackward":Lr===kr&&(Pr-=1);break;case"deleteContentForward":Lr===kr&&(Dr+=1);break}Bt.preventDefault(),(Gr=this.linkService.eventBus)==null||Gr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rr,name:"Keystroke",value:Tr,change:tr||"",willCommit:!1,selStart:Pr,selEnd:Dr}})}),this._setEventListeners(gr,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Bt=>Bt.target.value)}if(nr&&gr.addEventListener("blur",nr),this.data.comb){const Bt=(this.data.rect[2]-this.data.rect[0])/nn;gr.classList.add("comb"),gr.style.letterSpacing=`calc(${Bt}px * var(--scale-factor) - 1ch)`}}else gr=document.createElement("div"),gr.textContent=this.data.fieldValue,gr.style.verticalAlign="middle",gr.style.display="table-cell";return this._setTextStyle(gr),this._setBackgroundColor(gr),this._setDefaultPropertiesFromJS(gr),this.container.append(gr),this.container}}class ot extends at{constructor(cr){super(cr,{isRenderable:!!cr.data.hasOwnCanvas})}}class pt extends at{constructor(cr){super(cr,{isRenderable:cr.renderForms})}render(){const cr=this.annotationStorage,rr=this.data,gr=rr.id;let Or=cr.getValue(gr,{value:rr.exportValue===rr.fieldValue}).value;typeof Or=="string"&&(Or=Or!=="Off",cr.setValue(gr,{value:Or})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Ir=document.createElement("input");return tt.add(Ir),Ir.setAttribute("data-element-id",gr),Ir.disabled=rr.readOnly,this._setRequired(Ir,this.data.required),Ir.type="checkbox",Ir.name=rr.fieldName,Or&&Ir.setAttribute("checked",!0),Ir.setAttribute("exportValue",rr.exportValue),Ir.tabIndex=_,Ir.addEventListener("change",$r=>{const{name:Vr,checked:nn}=$r.target;for(const Zr of this._getElementsByName(Vr,gr)){const Rt=nn&&Zr.exportValue===rr.exportValue;Zr.domElement&&(Zr.domElement.checked=Rt),cr.setValue(Zr.id,{value:Rt})}cr.setValue(gr,{value:nn})}),Ir.addEventListener("resetform",$r=>{const Vr=rr.defaultFieldValue||"Off";$r.target.checked=Vr===rr.exportValue}),this.enableScripting&&this.hasJSActions&&(Ir.addEventListener("updatefromsandbox",$r=>{const Vr={value(nn){nn.target.checked=nn.detail.value!=="Off",cr.setValue(gr,{value:nn.target.checked})}};this._dispatchEventFromSandbox(Vr,$r)}),this._setEventListeners(Ir,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$r=>$r.target.checked)),this._setBackgroundColor(Ir),this._setDefaultPropertiesFromJS(Ir),this.container.append(Ir),this.container}}class dt extends at{constructor(cr){super(cr,{isRenderable:cr.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const cr=this.annotationStorage,rr=this.data,gr=rr.id;let Or=cr.getValue(gr,{value:rr.fieldValue===rr.buttonValue}).value;typeof Or=="string"&&(Or=Or!==rr.buttonValue,cr.setValue(gr,{value:Or}));const Ir=document.createElement("input");if(tt.add(Ir),Ir.setAttribute("data-element-id",gr),Ir.disabled=rr.readOnly,this._setRequired(Ir,this.data.required),Ir.type="radio",Ir.name=rr.fieldName,Or&&Ir.setAttribute("checked",!0),Ir.tabIndex=_,Ir.addEventListener("change",$r=>{const{name:Vr,checked:nn}=$r.target;for(const Zr of this._getElementsByName(Vr,gr))cr.setValue(Zr.id,{value:!1});cr.setValue(gr,{value:nn})}),Ir.addEventListener("resetform",$r=>{const Vr=rr.defaultFieldValue;$r.target.checked=Vr!=null&&Vr===rr.buttonValue}),this.enableScripting&&this.hasJSActions){const $r=rr.buttonValue;Ir.addEventListener("updatefromsandbox",Vr=>{const nn={value:Zr=>{const Rt=$r===Zr.detail.value;for(const nr of this._getElementsByName(Zr.target.name)){const Mt=Rt&&nr.id===gr;nr.domElement&&(nr.domElement.checked=Mt),cr.setValue(nr.id,{value:Mt})}}};this._dispatchEventFromSandbox(nn,Vr)}),this._setEventListeners(Ir,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Vr=>Vr.target.checked)}return this._setBackgroundColor(Ir),this._setDefaultPropertiesFromJS(Ir),this.container.append(Ir),this.container}}class wt extends et{constructor(cr){super(cr,{ignoreBorder:cr.data.hasAppearance})}render(){const cr=super.render();cr.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(cr.title=this.data.alternativeText);const rr=cr.lastChild;return this.enableScripting&&this.hasJSActions&&rr&&(this._setDefaultPropertiesFromJS(rr),rr.addEventListener("updatefromsandbox",gr=>{this._dispatchEventFromSandbox({},gr)})),cr}}class lt extends at{constructor(cr){super(cr,{isRenderable:cr.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const cr=this.annotationStorage,rr=this.data.id,gr=cr.getValue(rr,{value:this.data.fieldValue}),Or=document.createElement("select");tt.add(Or),Or.setAttribute("data-element-id",rr),Or.disabled=this.data.readOnly,this._setRequired(Or,this.data.required),Or.name=this.data.fieldName,Or.tabIndex=_;let Ir=this.data.combo&&this.data.options.length>0;this.data.combo||(Or.size=this.data.options.length,this.data.multiSelect&&(Or.multiple=!0)),Or.addEventListener("resetform",Rt=>{const nr=this.data.defaultFieldValue;for(const Mt of Or.options)Mt.selected=Mt.value===nr});for(const Rt of this.data.options){const nr=document.createElement("option");nr.textContent=Rt.displayValue,nr.value=Rt.exportValue,gr.value.includes(Rt.exportValue)&&(nr.setAttribute("selected",!0),Ir=!1),Or.append(nr)}let $r=null;if(Ir){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),Or.prepend(Rt),$r=()=>{Rt.remove(),Or.removeEventListener("input",$r),$r=null},Or.addEventListener("input",$r)}const Vr=Rt=>{const nr=Rt?"value":"textContent",{options:Mt,multiple:Bt}=Or;return Bt?Array.prototype.filter.call(Mt,tr=>tr.selected).map(tr=>tr[nr]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][nr]};let nn=Vr(!1);const Zr=Rt=>{const nr=Rt.target.options;return Array.prototype.map.call(nr,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(Or.addEventListener("updatefromsandbox",Rt=>{const nr={value(Mt){$r==null||$r();const Bt=Mt.detail.value,tr=new Set(Array.isArray(Bt)?Bt:[Bt]);for(const or of Or.options)or.selected=tr.has(or.value);cr.setValue(rr,{value:Vr(!0)}),nn=Vr(!1)},multipleSelection(Mt){Or.multiple=!0},remove(Mt){const Bt=Or.options,tr=Mt.detail.remove;Bt[tr].selected=!1,Or.remove(tr),Bt.length>0&&Array.prototype.findIndex.call(Bt,Tr=>Tr.selected)===-1&&(Bt[0].selected=!0),cr.setValue(rr,{value:Vr(!0),items:Zr(Mt)}),nn=Vr(!1)},clear(Mt){for(;Or.length!==0;)Or.remove(0);cr.setValue(rr,{value:null,items:[]}),nn=Vr(!1)},insert(Mt){const{index:Bt,displayValue:tr,exportValue:or}=Mt.detail.insert,Tr=Or.children[Bt],Lr=document.createElement("option");Lr.textContent=tr,Lr.value=or,Tr?Tr.before(Lr):Or.append(Lr),cr.setValue(rr,{value:Vr(!0),items:Zr(Mt)}),nn=Vr(!1)},items(Mt){const{items:Bt}=Mt.detail;for(;Or.length!==0;)Or.remove(0);for(const tr of Bt){const{displayValue:or,exportValue:Tr}=tr,Lr=document.createElement("option");Lr.textContent=or,Lr.value=Tr,Or.append(Lr)}Or.options.length>0&&(Or.options[0].selected=!0),cr.setValue(rr,{value:Vr(!0),items:Zr(Mt)}),nn=Vr(!1)},indices(Mt){const Bt=new Set(Mt.detail.indices);for(const tr of Mt.target.options)tr.selected=Bt.has(tr.index);cr.setValue(rr,{value:Vr(!0)}),nn=Vr(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(nr,Rt)}),Or.addEventListener("input",Rt=>{var Mt;const nr=Vr(!0);cr.setValue(rr,{value:nr}),Rt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rr,name:"Keystroke",value:nn,changeEx:nr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Or,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):Or.addEventListener("input",function(Rt){cr.setValue(rr,{value:Vr(!0)})}),this.data.combo&&this._setTextStyle(Or),this._setBackgroundColor(Or),this._setDefaultPropertiesFromJS(Or),this.container.append(Or),this.container}}class gt extends it{constructor(cr){const{data:rr,elements:gr}=cr;super(cr,{isRenderable:it._hasPopupData(rr)}),this.elements=gr}render(){this.container.classList.add("popupAnnotation");const cr=new vt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),rr=[];for(const gr of this.elements)gr.popup=cr,rr.push(gr.data.id),gr.addHighlightArea();return this.container.setAttribute("aria-controls",rr.map(gr=>`${a.AnnotationPrefix}${gr}`).join(",")),this.container}}class vt{constructor({container:cr,color:rr,elements:gr,titleObj:Or,modificationDate:Ir,contentsObj:$r,richText:Vr,parent:nn,rect:Zr,parentRect:Rt,open:nr}){Sr(this,zr);Sr(this,ur,null);Sr(this,wr,mr(this,zr,Oo).bind(this));Sr(this,vr,mr(this,zr,ga).bind(this));Sr(this,Fr,mr(this,zr,na).bind(this));Sr(this,Rr,mr(this,zr,Ss).bind(this));Sr(this,jr,null);Sr(this,xr,null);Sr(this,hr,null);Sr(this,jt,null);Sr(this,sr,null);Sr(this,_r,null);Sr(this,Ar,!1);Sr(this,Mr,null);Sr(this,Ur,null);Sr(this,Er,null);Sr(this,pr,null);Sr(this,Wr,!1);var Bt;yr(this,xr,cr),yr(this,pr,Or),yr(this,hr,$r),yr(this,Er,Vr),yr(this,sr,nn),yr(this,jr,rr),yr(this,Ur,Zr),yr(this,_r,Rt),yr(this,jt,gr);const Mt=o.PDFDateString.toDateObject(Ir);Mt&&yr(this,ur,nn.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=gr.flatMap(tr=>tr.getElementsToTriggerPopup());for(const tr of this.trigger)tr.addEventListener("click",ht(this,Rr)),tr.addEventListener("mouseenter",ht(this,Fr)),tr.addEventListener("mouseleave",ht(this,vr)),tr.classList.add("popupTriggerArea");for(const tr of gr)(Bt=tr.container)==null||Bt.addEventListener("keydown",ht(this,wr));ht(this,xr).hidden=!0,nr&&mr(this,zr,Ss).call(this)}render(){if(ht(this,Mr))return;const{page:{view:cr},viewport:{rawDims:{pageWidth:rr,pageHeight:gr,pageX:Or,pageY:Ir}}}=ht(this,sr),$r=yr(this,Mr,document.createElement("div"));if($r.className="popup",ht(this,jr)){const Pr=$r.style.outlineColor=a.Util.makeHexColor(...ht(this,jr));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?$r.style.backgroundColor=`color-mix(in srgb, ${Pr} 30%, white)`:$r.style.backgroundColor=a.Util.makeHexColor(...ht(this,jr).map(Gr=>Math.floor(.7*(255-Gr)+Gr)))}const Vr=document.createElement("span");Vr.className="header";const nn=document.createElement("h1");if(Vr.append(nn),{dir:nn.dir,str:nn.textContent}=ht(this,pr),$r.append(Vr),ht(this,ur)){const Pr=document.createElement("span");Pr.classList.add("popupDate"),ht(this,ur).then(Dr=>{Pr.textContent=Dr}),Vr.append(Pr)}const Zr=ht(this,hr),Rt=ht(this,Er);if(Rt!=null&&Rt.str&&(!(Zr!=null&&Zr.str)||Zr.str===Rt.str))g.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:$r}),$r.lastChild.classList.add("richText","popupContent");else{const Pr=this._formatContents(Zr);$r.append(Pr)}let nr=!!ht(this,_r),Mt=nr?ht(this,_r):ht(this,Ur);for(const Pr of ht(this,jt))if(!Mt||a.Util.intersect(Pr.data.rect,Mt)!==null){Mt=Pr.data.rect,nr=!0;break}const Bt=a.Util.normalizeRect([Mt[0],cr[3]-Mt[1]+cr[1],Mt[2],cr[3]-Mt[3]+cr[1]]),or=nr?Mt[2]-Mt[0]+5:0,Tr=Bt[0]+or,Lr=Bt[1],{style:kr}=ht(this,xr);kr.left=`${100*(Tr-Or)/rr}%`,kr.top=`${100*(Lr-Ir)/gr}%`,ht(this,xr).append($r)}_formatContents({str:cr,dir:rr}){const gr=document.createElement("p");gr.classList.add("popupContent"),gr.dir=rr;const Or=cr.split(/(?:\r\n?|\n)/);for(let Ir=0,$r=Or.length;Ir<$r;++Ir){const Vr=Or[Ir];gr.append(document.createTextNode(Vr)),Ir<$r-1&&gr.append(document.createElement("br"))}return gr}forceHide(){yr(this,Wr,this.isVisible),ht(this,Wr)&&(ht(this,xr).hidden=!0)}maybeShow(){ht(this,Wr)&&(yr(this,Wr,!1),ht(this,xr).hidden=!1)}get isVisible(){return ht(this,xr).hidden===!1}}ur=new WeakMap,wr=new WeakMap,vr=new WeakMap,Fr=new WeakMap,Rr=new WeakMap,jr=new WeakMap,xr=new WeakMap,hr=new WeakMap,jt=new WeakMap,sr=new WeakMap,_r=new WeakMap,Ar=new WeakMap,Mr=new WeakMap,Ur=new WeakMap,Er=new WeakMap,pr=new WeakMap,Wr=new WeakMap,zr=new WeakSet,Oo=function(cr){cr.altKey||cr.shiftKey||cr.ctrlKey||cr.metaKey||(cr.key==="Enter"||cr.key==="Escape"&&ht(this,Ar))&&mr(this,zr,Ss).call(this)},Ss=function(){yr(this,Ar,!ht(this,Ar)),ht(this,Ar)?(mr(this,zr,na).call(this),ht(this,xr).addEventListener("click",ht(this,Rr)),ht(this,xr).addEventListener("keydown",ht(this,wr))):(mr(this,zr,ga).call(this),ht(this,xr).removeEventListener("click",ht(this,Rr)),ht(this,xr).removeEventListener("keydown",ht(this,wr)))},na=function(){ht(this,Mr)||this.render(),this.isVisible?ht(this,Ar)&&ht(this,xr).classList.add("focused"):(ht(this,xr).hidden=!1,ht(this,xr).style.zIndex=parseInt(ht(this,xr).style.zIndex)+1e3)},ga=function(){ht(this,xr).classList.remove("focused"),!(ht(this,Ar)||!this.isVisible)&&(ht(this,xr).hidden=!0,ht(this,xr).style.zIndex=parseInt(ht(this,xr).style.zIndex)-1e3)};class At extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0}),this.textContent=cr.data.textContent,this.textPosition=cr.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const cr=document.createElement("div");cr.classList.add("annotationTextContent"),cr.setAttribute("role","comment");for(const rr of this.textContent){const gr=document.createElement("span");gr.textContent=rr,cr.append(gr)}this.container.append(cr)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}i.FreeTextAnnotationElement=At;class yt extends it{constructor(rr){super(rr,{isRenderable:!0,ignoreBorder:!0});Sr(this,tn,null)}render(){this.container.classList.add("lineAnnotation");const rr=this.data,{width:gr,height:Or}=_e(rr.rect),Ir=this.svgFactory.create(gr,Or,!0),$r=yr(this,tn,this.svgFactory.createElement("svg:line"));return $r.setAttribute("x1",rr.rect[2]-rr.lineCoordinates[0]),$r.setAttribute("y1",rr.rect[3]-rr.lineCoordinates[1]),$r.setAttribute("x2",rr.rect[2]-rr.lineCoordinates[2]),$r.setAttribute("y2",rr.rect[3]-rr.lineCoordinates[3]),$r.setAttribute("stroke-width",rr.borderStyle.width||1),$r.setAttribute("stroke","transparent"),$r.setAttribute("fill","transparent"),Ir.append($r),this.container.append(Ir),!rr.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ht(this,tn)}addHighlightArea(){this.container.classList.add("highlightArea")}}tn=new WeakMap;class bt extends it{constructor(rr){super(rr,{isRenderable:!0,ignoreBorder:!0});Sr(this,fn,null)}render(){this.container.classList.add("squareAnnotation");const rr=this.data,{width:gr,height:Or}=_e(rr.rect),Ir=this.svgFactory.create(gr,Or,!0),$r=rr.borderStyle.width,Vr=yr(this,fn,this.svgFactory.createElement("svg:rect"));return Vr.setAttribute("x",$r/2),Vr.setAttribute("y",$r/2),Vr.setAttribute("width",gr-$r),Vr.setAttribute("height",Or-$r),Vr.setAttribute("stroke-width",$r||1),Vr.setAttribute("stroke","transparent"),Vr.setAttribute("fill","transparent"),Ir.append(Vr),this.container.append(Ir),!rr.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ht(this,fn)}addHighlightArea(){this.container.classList.add("highlightArea")}}fn=new WeakMap;class Tt extends it{constructor(rr){super(rr,{isRenderable:!0,ignoreBorder:!0});Sr(this,hn,null)}render(){this.container.classList.add("circleAnnotation");const rr=this.data,{width:gr,height:Or}=_e(rr.rect),Ir=this.svgFactory.create(gr,Or,!0),$r=rr.borderStyle.width,Vr=yr(this,hn,this.svgFactory.createElement("svg:ellipse"));return Vr.setAttribute("cx",gr/2),Vr.setAttribute("cy",Or/2),Vr.setAttribute("rx",gr/2-$r/2),Vr.setAttribute("ry",Or/2-$r/2),Vr.setAttribute("stroke-width",$r||1),Vr.setAttribute("stroke","transparent"),Vr.setAttribute("fill","transparent"),Ir.append(Vr),this.container.append(Ir),!rr.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ht(this,hn)}addHighlightArea(){this.container.classList.add("highlightArea")}}hn=new WeakMap;class er extends it{constructor(rr){super(rr,{isRenderable:!0,ignoreBorder:!0});Sr(this,Br,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const rr=this.data,{width:gr,height:Or}=_e(rr.rect),Ir=this.svgFactory.create(gr,Or,!0);let $r=[];for(const nn of rr.vertices){const Zr=nn.x-rr.rect[0],Rt=rr.rect[3]-nn.y;$r.push(Zr+","+Rt)}$r=$r.join(" ");const Vr=yr(this,Br,this.svgFactory.createElement(this.svgElementName));return Vr.setAttribute("points",$r),Vr.setAttribute("stroke-width",rr.borderStyle.width||1),Vr.setAttribute("stroke","transparent"),Vr.setAttribute("fill","transparent"),Ir.append(Vr),this.container.append(Ir),!rr.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ht(this,Br)}addHighlightArea(){this.container.classList.add("highlightArea")}}Br=new WeakMap;class zt extends er{constructor(cr){super(cr),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ar extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Jt extends it{constructor(rr){super(rr,{isRenderable:!0,ignoreBorder:!0});Sr(this,br,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const rr=this.data,{width:gr,height:Or}=_e(rr.rect),Ir=this.svgFactory.create(gr,Or,!0);for(const $r of rr.inkLists){let Vr=[];for(const Zr of $r){const Rt=Zr.x-rr.rect[0],nr=rr.rect[3]-Zr.y;Vr.push(`${Rt},${nr}`)}Vr=Vr.join(" ");const nn=this.svgFactory.createElement(this.svgElementName);ht(this,br).push(nn),nn.setAttribute("points",Vr),nn.setAttribute("stroke-width",rr.borderStyle.width||1),nn.setAttribute("stroke","transparent"),nn.setAttribute("fill","transparent"),!rr.popupRef&&this.hasPopupData&&this._createPopup(),Ir.append(nn)}return this.container.append(Ir),this.container}getElementsToTriggerPopup(){return ht(this,br)}addHighlightArea(){this.container.classList.add("highlightArea")}}br=new WeakMap,i.InkAnnotationElement=Jt;class Yt extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class kt extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ir extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class fr extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Et extends it{constructor(cr){super(cr,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}i.StampAnnotationElement=Et;class xt extends it{constructor(rr){var Ir;super(rr,{isRenderable:!0});Sr(this,Hr);Sr(this,Cr,null);const{filename:gr,content:Or}=this.data.file;this.filename=(0,o.getFilenameFromUrl)(gr,!0),this.content=Or,(Ir=this.linkService.eventBus)==null||Ir.dispatch("fileattachmentannotation",{source:this,filename:gr,content:Or})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:rr,data:gr}=this;let Or;gr.hasAppearance||gr.fillAlpha===0?Or=document.createElement("div"):(Or=document.createElement("img"),Or.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(gr.name)?"paperclip":"pushpin"}.svg`,gr.fillAlpha&&gr.fillAlpha<1&&(Or.style=`filter: opacity(${Math.round(gr.fillAlpha*100)}%);`)),Or.addEventListener("dblclick",mr(this,Hr,xa).bind(this)),yr(this,Cr,Or);const{isMac:Ir}=a.FeatureTest.platform;return rr.addEventListener("keydown",$r=>{$r.key==="Enter"&&(Ir?$r.metaKey:$r.ctrlKey)&&mr(this,Hr,xa).call(this)}),!gr.popupRef&&this.hasPopupData?this._createPopup():Or.classList.add("popupTriggerArea"),rr.append(Or),rr}getElementsToTriggerPopup(){return ht(this,Cr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cr=new WeakMap,Hr=new WeakSet,xa=function(){var rr;(rr=this.downloadManager)==null||rr.openOrDownloadData(this.container,this.content,this.filename)};class mt{constructor({div:cr,accessibilityManager:rr,annotationCanvasMap:gr,l10n:Or,page:Ir,viewport:$r}){Sr(this,Xr);Sr(this,rn,null);Sr(this,dr,null);Sr(this,Nr,new Map);this.div=cr,yr(this,rn,rr),yr(this,dr,gr),this.l10n=Or,this.page=Ir,this.viewport=$r,this.zIndex=0,this.l10n||(this.l10n=h.NullL10n)}async render(cr){const{annotations:rr}=cr,gr=this.div;(0,o.setLayerDimensions)(gr,this.viewport);const Or=new Map,Ir={data:null,layer:gr,linkService:cr.linkService,downloadManager:cr.downloadManager,imageResourcesPath:cr.imageResourcesPath||"",renderForms:cr.renderForms!==!1,svgFactory:new o.DOMSVGFactory,annotationStorage:cr.annotationStorage||new c.AnnotationStorage,enableScripting:cr.enableScripting===!0,hasJSActions:cr.hasJSActions,fieldObjects:cr.fieldObjects,parent:this,elements:null};for(const $r of rr){if($r.noHTML)continue;const Vr=$r.annotationType===a.AnnotationType.POPUP;if(Vr){const Rt=Or.get($r.id);if(!Rt)continue;Ir.elements=Rt}else{const{width:Rt,height:nr}=_e($r.rect);if(Rt<=0||nr<=0)continue}Ir.data=$r;const nn=rt.create(Ir);if(!nn.isRenderable)continue;if(!Vr&&$r.popupRef){const Rt=Or.get($r.popupRef);Rt?Rt.push(nn):Or.set($r.popupRef,[nn])}nn.annotationEditorType>0&&ht(this,Nr).set(nn.data.id,nn);const Zr=nn.render();$r.hidden&&(Zr.style.visibility="hidden"),mr(this,Xr,No).call(this,Zr,$r.id)}mr(this,Xr,_a).call(this),await this.l10n.translate(gr)}update({viewport:cr}){const rr=this.div;this.viewport=cr,(0,o.setLayerDimensions)(rr,{rotation:cr.rotation}),mr(this,Xr,_a).call(this),rr.hidden=!1}getEditableAnnotations(){return Array.from(ht(this,Nr).values())}getEditableAnnotation(cr){return ht(this,Nr).get(cr)}}rn=new WeakMap,dr=new WeakMap,Nr=new WeakMap,Xr=new WeakSet,No=function(cr,rr){var Or;const gr=cr.firstChild||cr;gr.id=`${a.AnnotationPrefix}${rr}`,this.div.append(cr),(Or=ht(this,rn))==null||Or.moveElementInDOM(this.div,cr,gr,!1)},_a=function(){if(!ht(this,dr))return;const cr=this.div;for(const[rr,gr]of ht(this,dr)){const Or=cr.querySelector(`[data-annotation-id="${rr}"]`);if(!Or)continue;const{firstChild:Ir}=Or;Ir?Ir.nodeName==="CANVAS"?Ir.replaceWith(gr):Ir.before(gr):Or.append(gr)}ht(this,dr).clear()},i.AnnotationLayer=mt},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function s(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}function a(c){return Math.max(0,Math.min(255,255*c))}class o{static CMYK_G([d,h,g,_]){return["G",1-Math.min(1,.3*d+.59*g+.11*h+_)]}static G_CMYK([d]){return["CMYK",0,0,0,1-d]}static G_RGB([d]){return["RGB",d,d,d]}static G_rgb([d]){return d=a(d),[d,d,d]}static G_HTML([d]){const h=s(d);return`#${h}${h}${h}`}static RGB_G([d,h,g]){return["G",.3*d+.59*h+.11*g]}static RGB_rgb(d){return d.map(a)}static RGB_HTML(d){return`#${d.map(s).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([d,h,g,_]){return["RGB",1-Math.min(1,d+_),1-Math.min(1,g+_),1-Math.min(1,h+_)]}static CMYK_rgb([d,h,g,_]){return[a(1-Math.min(1,d+_)),a(1-Math.min(1,g+_)),a(1-Math.min(1,h+_))]}static CMYK_HTML(d){const h=this.CMYK_RGB(d).slice(1);return this.RGB_HTML(h)}static RGB_CMYK([d,h,g]){const _=1-d,b=1-h,tt=1-g,_e=Math.min(_,b,tt);return["CMYK",_,b,tt,_e]}}i.ColorConverters=o},(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NullL10n=void 0,i.getL10nFallback=a;const s={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};s.print_progress_percent="{{progress}}%";function a(d,h){switch(d){case"find_match_count":d=`find_match_count[${h.total===1?"one":"other"}]`;break;case"find_match_count_limit":d=`find_match_count_limit[${h.limit===1?"one":"other"}]`;break}return s[d]||""}function o(d,h){return h?d.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(g,_)=>_ in h?h[_]:"{{"+_+"}}"):d}const c={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(d,h=null,g=a(d,h)){return o(g,h)},async translate(d){}};i.NullL10n=c},(e,i,s)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var a=s(25);class o{static setupStorage(d,h,g,_,b){const tt=_.getValue(h,{value:null});switch(g.name){case"textarea":if(tt.value!==null&&(d.textContent=tt.value),b==="print")break;d.addEventListener("input",_e=>{_.setValue(h,{value:_e.target.value})});break;case"input":if(g.attributes.type==="radio"||g.attributes.type==="checkbox"){if(tt.value===g.attributes.xfaOn?d.setAttribute("checked",!0):tt.value===g.attributes.xfaOff&&d.removeAttribute("checked"),b==="print")break;d.addEventListener("change",_e=>{_.setValue(h,{value:_e.target.checked?_e.target.getAttribute("xfaOn"):_e.target.getAttribute("xfaOff")})})}else{if(tt.value!==null&&d.setAttribute("value",tt.value),b==="print")break;d.addEventListener("input",_e=>{_.setValue(h,{value:_e.target.value})})}break;case"select":if(tt.value!==null){d.setAttribute("value",tt.value);for(const _e of g.children)_e.attributes.value===tt.value?_e.attributes.selected=!0:_e.attributes.hasOwnProperty("selected")&&delete _e.attributes.selected}d.addEventListener("input",_e=>{const rt=_e.target.options,it=rt.selectedIndex===-1?"":rt[rt.selectedIndex].value;_.setValue(h,{value:it})});break}}static setAttributes({html:d,element:h,storage:g=null,intent:_,linkService:b}){const{attributes:tt}=h,_e=d instanceof HTMLAnchorElement;tt.type==="radio"&&(tt.name=`${tt.name}-${_}`);for(const[rt,it]of Object.entries(tt))if(it!=null)switch(rt){case"class":it.length&&d.setAttribute(rt,it.join(" "));break;case"dataId":break;case"id":d.setAttribute("data-element-id",it);break;case"style":Object.assign(d.style,it);break;case"textContent":d.textContent=it;break;default:(!_e||rt!=="href"&&rt!=="newWindow")&&d.setAttribute(rt,it)}_e&&b.addLinkAttributes(d,tt.href,tt.newWindow),g&&tt.dataId&&this.setupStorage(d,tt.dataId,h,g)}static render(d){var et;const h=d.annotationStorage,g=d.linkService,_=d.xfaHtml,b=d.intent||"display",tt=document.createElement(_.name);_.attributes&&this.setAttributes({html:tt,element:_,intent:b,linkService:g});const _e=[[_,-1,tt]],rt=d.div;if(rt.append(tt),d.viewport){const nt=`matrix(${d.viewport.transform.join(",")})`;rt.style.transform=nt}b!=="richText"&&rt.setAttribute("class","xfaLayer xfaFont");const it=[];for(;_e.length>0;){const[nt,at,st]=_e.at(-1);if(at+1===nt.children.length){_e.pop();continue}const ot=nt.children[++_e.at(-1)[1]];if(ot===null)continue;const{name:pt}=ot;if(pt==="#text"){const wt=document.createTextNode(ot.value);it.push(wt),st.append(wt);continue}const dt=(et=ot==null?void 0:ot.attributes)!=null&&et.xmlns?document.createElementNS(ot.attributes.xmlns,pt):document.createElement(pt);if(st.append(dt),ot.attributes&&this.setAttributes({html:dt,element:ot,storage:h,intent:b,linkService:g}),ot.children&&ot.children.length>0)_e.push([ot,-1,dt]);else if(ot.value){const wt=document.createTextNode(ot.value);a.XfaText.shouldBuildText(pt)&&it.push(wt),dt.append(wt)}}for(const nt of rt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))nt.setAttribute("readOnly",!0);return{textDivs:it}}static update(d){const h=`matrix(${d.viewport.transform.join(",")})`;d.div.style.transform=h,d.div.hidden=!1}}i.XfaLayer=o},(e,i,s)=>{var _,b,tt,_e,rt,it,et,nt,at,st,ot,pt,dt,wt,lt,Io,Mo,Do,Lo,ba,jo,$a,Bo,Uo,$o,zo,Ho,Fn,eo,bs,As,Kn,to,Ts,Nt,Wo,ro,Vo,Xo,no,Cs,Yn;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0;var a=s(1),o=s(4),c=s(29),d=s(6),h=s(5);const jr=class jr extends o.AnnotationEditor{constructor(jt){super({...jt,name:"inkEditor"});Sr(this,lt);Sr(this,_,0);Sr(this,b,0);Sr(this,tt,this.canvasPointermove.bind(this));Sr(this,_e,this.canvasPointerleave.bind(this));Sr(this,rt,this.canvasPointerup.bind(this));Sr(this,it,this.canvasPointerdown.bind(this));Sr(this,et,new Path2D);Sr(this,nt,!1);Sr(this,at,!1);Sr(this,st,!1);Sr(this,ot,null);Sr(this,pt,0);Sr(this,dt,0);Sr(this,wt,null);this.color=jt.color||null,this.thickness=jt.thickness||null,this.opacity=jt.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(jt){o.AnnotationEditor.initialize(jt,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(jt,sr){switch(jt){case a.AnnotationEditorParamsType.INK_THICKNESS:jr._defaultThickness=sr;break;case a.AnnotationEditorParamsType.INK_COLOR:jr._defaultColor=sr;break;case a.AnnotationEditorParamsType.INK_OPACITY:jr._defaultOpacity=sr/100;break}}updateParams(jt,sr){switch(jt){case a.AnnotationEditorParamsType.INK_THICKNESS:mr(this,lt,Io).call(this,sr);break;case a.AnnotationEditorParamsType.INK_COLOR:mr(this,lt,Mo).call(this,sr);break;case a.AnnotationEditorParamsType.INK_OPACITY:mr(this,lt,Do).call(this,sr);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,jr._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,jr._defaultColor||o.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(jr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||jr._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||jr._defaultColor||o.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??jr._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(mr(this,lt,bs).call(this),mr(this,lt,As).call(this)),this.isAttachedToDOM||(this.parent.add(this),mr(this,lt,Kn).call(this)),mr(this,lt,Yn).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,ht(this,ot).disconnect(),yr(this,ot,null),super.remove())}setParent(jt){!this.parent&&jt?this._uiManager.removeShouldRescale(this):this.parent&&jt===null&&this._uiManager.addShouldRescale(this),super.setParent(jt)}onScaleChanging(){const[jt,sr]=this.parentDimensions,_r=this.width*jt,Ar=this.height*sr;this.setDimensions(_r,Ar)}enableEditMode(){ht(this,nt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",ht(this,it)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",ht(this,it)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){ht(this,nt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),yr(this,nt,!0),this.div.classList.add("disabled"),mr(this,lt,Yn).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(jt){this._focusEventsAllowed&&(super.focusin(jt),this.enableEditMode())}canvasPointerdown(jt){jt.button!==0||!this.isInEditMode()||ht(this,nt)||(this.setInForeground(),jt.preventDefault(),jt.type!=="mouse"&&this.div.focus(),mr(this,lt,jo).call(this,jt.offsetX,jt.offsetY))}canvasPointermove(jt){jt.preventDefault(),mr(this,lt,$a).call(this,jt.offsetX,jt.offsetY)}canvasPointerup(jt){jt.preventDefault(),mr(this,lt,eo).call(this,jt)}canvasPointerleave(jt){mr(this,lt,eo).call(this,jt)}get isResizable(){return!this.isEmpty()&&ht(this,nt)}render(){if(this.div)return this.div;let jt,sr;this.width&&(jt=this.x,sr=this.y),super.render(),o.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Er=>{var pr;return(pr=this.div)==null?void 0:pr.setAttribute("aria-label",Er)});const[_r,Ar,Mr,Ur]=mr(this,lt,Lo).call(this);if(this.setAt(_r,Ar,0,0),this.setDims(Mr,Ur),mr(this,lt,bs).call(this),this.width){const[Er,pr]=this.parentDimensions;this.setAspectRatio(this.width*Er,this.height*pr),this.setAt(jt*Er,sr*pr,this.width*Er,this.height*pr),yr(this,st,!0),mr(this,lt,Kn).call(this),this.setDims(this.width*Er,this.height*pr),mr(this,lt,Fn).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return mr(this,lt,As).call(this),this.div}setDimensions(jt,sr){const _r=Math.round(jt),Ar=Math.round(sr);if(ht(this,pt)===_r&&ht(this,dt)===Ar)return;yr(this,pt,_r),yr(this,dt,Ar),this.canvas.style.visibility="hidden";const[Mr,Ur]=this.parentDimensions;this.width=jt/Mr,this.height=sr/Ur,this.fixAndSetPosition(),ht(this,nt)&&mr(this,lt,to).call(this,jt,sr),mr(this,lt,Kn).call(this),mr(this,lt,Fn).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(jt,sr,_r){var tn,fn,hn;if(jt instanceof c.InkAnnotationElement)return null;const Ar=super.deserialize(jt,sr,_r);Ar.thickness=jt.thickness,Ar.color=a.Util.makeHexColor(...jt.color),Ar.opacity=jt.opacity;const[Mr,Ur]=Ar.pageDimensions,Er=Ar.width*Mr,pr=Ar.height*Ur,Wr=Ar.parentScale,zr=jt.thickness/2;yr(Ar,nt,!0),yr(Ar,pt,Math.round(Er)),yr(Ar,dt,Math.round(pr));const{paths:en,rect:sn,rotation:dn}=jt;for(let{bezier:Br}of en){Br=mr(tn=jr,Nt,Vo).call(tn,Br,sn,dn);const br=[];Ar.paths.push(br);let Cr=Wr*(Br[0]-zr),Hr=Wr*(Br[1]-zr);for(let rn=2,dr=Br.length;rn<dr;rn+=6){const Nr=Wr*(Br[rn]-zr),Xr=Wr*(Br[rn+1]-zr),Jr=Wr*(Br[rn+2]-zr),on=Wr*(Br[rn+3]-zr),Qr=Wr*(Br[rn+4]-zr),cr=Wr*(Br[rn+5]-zr);br.push([[Cr,Hr],[Nr,Xr],[Jr,on],[Qr,cr]]),Cr=Qr,Hr=cr}const an=mr(this,Nt,Wo).call(this,br);Ar.bezierPath2D.push(an)}const Kr=mr(fn=Ar,lt,no).call(fn);return yr(Ar,b,Math.max(o.AnnotationEditor.MIN_SIZE,Kr[2]-Kr[0])),yr(Ar,_,Math.max(o.AnnotationEditor.MIN_SIZE,Kr[3]-Kr[1])),mr(hn=Ar,lt,to).call(hn,Er,pr),Ar}serialize(){if(this.isEmpty())return null;const jt=this.getRect(0,0),sr=o.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:sr,thickness:this.thickness,opacity:this.opacity,paths:mr(this,lt,Xo).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,jt),pageIndex:this.pageIndex,rect:jt,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};_=new WeakMap,b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakMap,ot=new WeakMap,pt=new WeakMap,dt=new WeakMap,wt=new WeakMap,lt=new WeakSet,Io=function(jt){const sr=this.thickness;this.addCommands({cmd:()=>{this.thickness=jt,mr(this,lt,Yn).call(this)},undo:()=>{this.thickness=sr,mr(this,lt,Yn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Mo=function(jt){const sr=this.color;this.addCommands({cmd:()=>{this.color=jt,mr(this,lt,Fn).call(this)},undo:()=>{this.color=sr,mr(this,lt,Fn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Do=function(jt){jt/=100;const sr=this.opacity;this.addCommands({cmd:()=>{this.opacity=jt,mr(this,lt,Fn).call(this)},undo:()=>{this.opacity=sr,mr(this,lt,Fn).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Lo=function(){const{parentRotation:jt,parentDimensions:[sr,_r]}=this;switch(jt){case 90:return[0,_r,_r,sr];case 180:return[sr,_r,sr,_r];case 270:return[sr,0,_r,sr];default:return[0,0,sr,_r]}},ba=function(){const{ctx:jt,color:sr,opacity:_r,thickness:Ar,parentScale:Mr,scaleFactor:Ur}=this;jt.lineWidth=Ar*Mr/Ur,jt.lineCap="round",jt.lineJoin="round",jt.miterLimit=10,jt.strokeStyle=`${sr}${(0,h.opacityToHex)(_r)}`},jo=function(jt,sr){this.canvas.addEventListener("contextmenu",d.noContextMenu),this.canvas.addEventListener("pointerleave",ht(this,_e)),this.canvas.addEventListener("pointermove",ht(this,tt)),this.canvas.addEventListener("pointerup",ht(this,rt)),this.canvas.removeEventListener("pointerdown",ht(this,it)),this.isEditing=!0,ht(this,st)||(yr(this,st,!0),mr(this,lt,Kn).call(this),this.thickness||(this.thickness=jr._defaultThickness),this.color||(this.color=jr._defaultColor||o.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=jr._defaultOpacity)),this.currentPath.push([jt,sr]),yr(this,at,!1),mr(this,lt,ba).call(this),yr(this,wt,()=>{mr(this,lt,$o).call(this),ht(this,wt)&&window.requestAnimationFrame(ht(this,wt))}),window.requestAnimationFrame(ht(this,wt))},$a=function(jt,sr){const[_r,Ar]=this.currentPath.at(-1);if(this.currentPath.length>1&&jt===_r&&sr===Ar)return;const Mr=this.currentPath;let Ur=ht(this,et);if(Mr.push([jt,sr]),yr(this,at,!0),Mr.length<=2){Ur.moveTo(...Mr[0]),Ur.lineTo(jt,sr);return}Mr.length===3&&(yr(this,et,Ur=new Path2D),Ur.moveTo(...Mr[0])),mr(this,lt,zo).call(this,Ur,...Mr.at(-3),...Mr.at(-2),jt,sr)},Bo=function(){if(this.currentPath.length===0)return;const jt=this.currentPath.at(-1);ht(this,et).lineTo(...jt)},Uo=function(jt,sr){yr(this,wt,null),jt=Math.min(Math.max(jt,0),this.canvas.width),sr=Math.min(Math.max(sr,0),this.canvas.height),mr(this,lt,$a).call(this,jt,sr),mr(this,lt,Bo).call(this);let _r;if(this.currentPath.length!==1)_r=mr(this,lt,Ho).call(this);else{const pr=[jt,sr];_r=[[pr,pr.slice(),pr.slice(),pr]]}const Ar=ht(this,et),Mr=this.currentPath;this.currentPath=[],yr(this,et,new Path2D);const Ur=()=>{this.allRawPaths.push(Mr),this.paths.push(_r),this.bezierPath2D.push(Ar),this.rebuild()},Er=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(mr(this,lt,bs).call(this),mr(this,lt,As).call(this)),mr(this,lt,Yn).call(this))};this.addCommands({cmd:Ur,undo:Er,mustExec:!0})},$o=function(){if(!ht(this,at))return;yr(this,at,!1);const jt=Math.ceil(this.thickness*this.parentScale),sr=this.currentPath.slice(-3),_r=sr.map(Ur=>Ur[0]),Ar=sr.map(Ur=>Ur[1]);Math.min(..._r)-jt,Math.max(..._r)+jt,Math.min(...Ar)-jt,Math.max(...Ar)+jt;const{ctx:Mr}=this;Mr.save(),Mr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ur of this.bezierPath2D)Mr.stroke(Ur);Mr.stroke(ht(this,et)),Mr.restore()},zo=function(jt,sr,_r,Ar,Mr,Ur,Er){const pr=(sr+Ar)/2,Wr=(_r+Mr)/2,zr=(Ar+Ur)/2,en=(Mr+Er)/2;jt.bezierCurveTo(pr+2*(Ar-pr)/3,Wr+2*(Mr-Wr)/3,zr+2*(Ar-zr)/3,en+2*(Mr-en)/3,zr,en)},Ho=function(){const jt=this.currentPath;if(jt.length<=2)return[[jt[0],jt[0],jt.at(-1),jt.at(-1)]];const sr=[];let _r,[Ar,Mr]=jt[0];for(_r=1;_r<jt.length-2;_r++){const[sn,dn]=jt[_r],[Kr,tn]=jt[_r+1],fn=(sn+Kr)/2,hn=(dn+tn)/2,Br=[Ar+2*(sn-Ar)/3,Mr+2*(dn-Mr)/3],br=[fn+2*(sn-fn)/3,hn+2*(dn-hn)/3];sr.push([[Ar,Mr],Br,br,[fn,hn]]),[Ar,Mr]=[fn,hn]}const[Ur,Er]=jt[_r],[pr,Wr]=jt[_r+1],zr=[Ar+2*(Ur-Ar)/3,Mr+2*(Er-Mr)/3],en=[pr+2*(Ur-pr)/3,Wr+2*(Er-Wr)/3];return sr.push([[Ar,Mr],zr,en,[pr,Wr]]),sr},Fn=function(){if(this.isEmpty()){mr(this,lt,Ts).call(this);return}mr(this,lt,ba).call(this);const{canvas:jt,ctx:sr}=this;sr.setTransform(1,0,0,1,0,0),sr.clearRect(0,0,jt.width,jt.height),mr(this,lt,Ts).call(this);for(const _r of this.bezierPath2D)sr.stroke(_r)},eo=function(jt){this.canvas.removeEventListener("pointerleave",ht(this,_e)),this.canvas.removeEventListener("pointermove",ht(this,tt)),this.canvas.removeEventListener("pointerup",ht(this,rt)),this.canvas.addEventListener("pointerdown",ht(this,it)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",d.noContextMenu)},10),mr(this,lt,Uo).call(this,jt.offsetX,jt.offsetY),this.addToAnnotationStorage(),this.setInBackground()},bs=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",o.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(jt=>{var sr;return(sr=this.canvas)==null?void 0:sr.setAttribute("aria-label",jt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},As=function(){yr(this,ot,new ResizeObserver(jt=>{const sr=jt[0].contentRect;sr.width&&sr.height&&this.setDimensions(sr.width,sr.height)})),ht(this,ot).observe(this.div)},Kn=function(){if(!ht(this,st))return;const[jt,sr]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*jt),this.canvas.height=Math.ceil(this.height*sr),mr(this,lt,Ts).call(this)},to=function(jt,sr){const _r=mr(this,lt,Cs).call(this),Ar=(jt-_r)/ht(this,b),Mr=(sr-_r)/ht(this,_);this.scaleFactor=Math.min(Ar,Mr)},Ts=function(){const jt=mr(this,lt,Cs).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+jt,this.translationY*this.scaleFactor+jt)},Nt=new WeakSet,Wo=function(jt){const sr=new Path2D;for(let _r=0,Ar=jt.length;_r<Ar;_r++){const[Mr,Ur,Er,pr]=jt[_r];_r===0&&sr.moveTo(...Mr),sr.bezierCurveTo(Ur[0],Ur[1],Er[0],Er[1],pr[0],pr[1])}return sr},ro=function(jt,sr,_r){const[Ar,Mr,Ur,Er]=sr;switch(_r){case 0:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2)jt[pr]+=Ar,jt[pr+1]=Er-jt[pr+1];break;case 90:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2){const zr=jt[pr];jt[pr]=jt[pr+1]+Ar,jt[pr+1]=zr+Mr}break;case 180:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2)jt[pr]=Ur-jt[pr],jt[pr+1]+=Mr;break;case 270:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2){const zr=jt[pr];jt[pr]=Ur-jt[pr+1],jt[pr+1]=Er-zr}break;default:throw new Error("Invalid rotation")}return jt},Vo=function(jt,sr,_r){const[Ar,Mr,Ur,Er]=sr;switch(_r){case 0:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2)jt[pr]-=Ar,jt[pr+1]=Er-jt[pr+1];break;case 90:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2){const zr=jt[pr];jt[pr]=jt[pr+1]-Mr,jt[pr+1]=zr-Ar}break;case 180:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2)jt[pr]=Ur-jt[pr],jt[pr+1]-=Mr;break;case 270:for(let pr=0,Wr=jt.length;pr<Wr;pr+=2){const zr=jt[pr];jt[pr]=Er-jt[pr+1],jt[pr+1]=Ur-zr}break;default:throw new Error("Invalid rotation")}return jt},Xo=function(jt,sr,_r,Ar){var Wr,zr;const Mr=[],Ur=this.thickness/2,Er=jt*sr+Ur,pr=jt*_r+Ur;for(const en of this.paths){const sn=[],dn=[];for(let Kr=0,tn=en.length;Kr<tn;Kr++){const[fn,hn,Br,br]=en[Kr],Cr=jt*fn[0]+Er,Hr=jt*fn[1]+pr,an=jt*hn[0]+Er,rn=jt*hn[1]+pr,dr=jt*Br[0]+Er,Nr=jt*Br[1]+pr,Xr=jt*br[0]+Er,Jr=jt*br[1]+pr;Kr===0&&(sn.push(Cr,Hr),dn.push(Cr,Hr)),sn.push(an,rn,dr,Nr,Xr,Jr),dn.push(an,rn),Kr===tn-1&&dn.push(Xr,Jr)}Mr.push({bezier:mr(Wr=jr,Nt,ro).call(Wr,sn,Ar,this.rotation),points:mr(zr=jr,Nt,ro).call(zr,dn,Ar,this.rotation)})}return Mr},no=function(){let jt=1/0,sr=-1/0,_r=1/0,Ar=-1/0;for(const Mr of this.paths)for(const[Ur,Er,pr,Wr]of Mr){const zr=a.Util.bezierBoundingBox(...Ur,...Er,...pr,...Wr);jt=Math.min(jt,zr[0]),_r=Math.min(_r,zr[1]),sr=Math.max(sr,zr[2]),Ar=Math.max(Ar,zr[3])}return[jt,_r,sr,Ar]},Cs=function(){return ht(this,nt)?Math.ceil(this.thickness*this.parentScale):0},Yn=function(jt=!1){if(this.isEmpty())return;if(!ht(this,nt)){mr(this,lt,Fn).call(this);return}const sr=mr(this,lt,no).call(this),_r=mr(this,lt,Cs).call(this);yr(this,b,Math.max(o.AnnotationEditor.MIN_SIZE,sr[2]-sr[0])),yr(this,_,Math.max(o.AnnotationEditor.MIN_SIZE,sr[3]-sr[1]));const Ar=Math.ceil(_r+ht(this,b)*this.scaleFactor),Mr=Math.ceil(_r+ht(this,_)*this.scaleFactor),[Ur,Er]=this.parentDimensions;this.width=Ar/Ur,this.height=Mr/Er,this.setAspectRatio(Ar,Mr);const pr=this.translationX,Wr=this.translationY;this.translationX=-sr[0],this.translationY=-sr[1],mr(this,lt,Kn).call(this),mr(this,lt,Fn).call(this),yr(this,pt,Ar),yr(this,dt,Mr),this.setDims(Ar,Mr);const zr=jt?_r/this.scaleFactor/2:0;this.translate(pr-this.translationX-zr,Wr-this.translationY-zr)},Sr(jr,Nt),mn(jr,"_defaultColor",null),mn(jr,"_defaultOpacity",1),mn(jr,"_defaultThickness",1),mn(jr,"_type","ink");let g=jr;i.InkEditor=g},(e,i,s)=>{var g,_,b,tt,_e,rt,it,et,nt,at,st,fs,hs,Rs,io,Go,Ko,so,Ps,Yo;Object.defineProperty(i,"__esModule",{value:!0}),i.StampEditor=void 0;var a=s(1),o=s(4),c=s(6),d=s(29);const bt=class bt extends o.AnnotationEditor{constructor(zt){super({...zt,name:"stampEditor"});Sr(this,st);Sr(this,g,null);Sr(this,_,null);Sr(this,b,null);Sr(this,tt,null);Sr(this,_e,null);Sr(this,rt,null);Sr(this,it,null);Sr(this,et,null);Sr(this,nt,!1);Sr(this,at,!1);yr(this,tt,zt.bitmapUrl),yr(this,_e,zt.bitmapFile)}static initialize(zt){o.AnnotationEditor.initialize(zt)}static get supportedTypes(){const zt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,a.shadow)(this,"supportedTypes",zt.map(ar=>`image/${ar}`))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(zt){return this.supportedTypes.includes(zt)}static paste(zt,ar){ar.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:zt.getAsFile()})}remove(){var zt,ar;ht(this,_)&&(yr(this,g,null),this._uiManager.imageManager.deleteId(ht(this,_)),(zt=ht(this,rt))==null||zt.remove(),yr(this,rt,null),(ar=ht(this,it))==null||ar.disconnect(),yr(this,it,null)),super.remove()}rebuild(){if(!this.parent){ht(this,_)&&mr(this,st,Rs).call(this);return}super.rebuild(),this.div!==null&&(ht(this,_)&&mr(this,st,Rs).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(ht(this,b)||ht(this,g)||ht(this,tt)||ht(this,_e))}get isResizable(){return!0}render(){if(this.div)return this.div;let zt,ar;if(this.width&&(zt=this.x,ar=this.y),super.render(),this.div.hidden=!0,ht(this,g)?mr(this,st,io).call(this):mr(this,st,Rs).call(this),this.width){const[Jt,Yt]=this.parentDimensions;this.setAt(zt*Jt,ar*Yt,this.width*Jt,this.height*Yt)}return this.div}static deserialize(zt,ar,Jt){if(zt instanceof d.StampAnnotationElement)return null;const Yt=super.deserialize(zt,ar,Jt),{rect:kt,bitmapUrl:ir,bitmapId:fr,isSvg:Et,accessibilityData:xt}=zt;fr&&Jt.imageManager.isValidId(fr)?yr(Yt,_,fr):yr(Yt,tt,ir),yr(Yt,nt,Et);const[mt,St]=Yt.pageDimensions;return Yt.width=(kt[2]-kt[0])/mt,Yt.height=(kt[3]-kt[1])/St,xt&&(Yt.altTextData=xt),Yt}serialize(zt=!1,ar=null){if(this.isEmpty())return null;const Jt={annotationType:a.AnnotationEditorType.STAMP,bitmapId:ht(this,_),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:ht(this,nt),structTreeParentId:this._structTreeParentId};if(zt)return Jt.bitmapUrl=mr(this,st,Ps).call(this,!0),Jt.accessibilityData=this.altTextData,Jt;const{decorative:Yt,altText:kt}=this.altTextData;if(!Yt&&kt&&(Jt.accessibilityData={type:"Figure",alt:kt}),ar===null)return Jt;ar.stamps||(ar.stamps=new Map);const ir=ht(this,nt)?(Jt.rect[2]-Jt.rect[0])*(Jt.rect[3]-Jt.rect[1]):null;if(!ar.stamps.has(ht(this,_)))ar.stamps.set(ht(this,_),{area:ir,serialized:Jt}),Jt.bitmap=mr(this,st,Ps).call(this,!1);else if(ht(this,nt)){const fr=ar.stamps.get(ht(this,_));ir>fr.area&&(fr.area=ir,fr.serialized.bitmap.close(),fr.serialized.bitmap=mr(this,st,Ps).call(this,!1))}return Jt}};g=new WeakMap,_=new WeakMap,b=new WeakMap,tt=new WeakMap,_e=new WeakMap,rt=new WeakMap,it=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakMap,st=new WeakSet,fs=function(zt,ar=!1){if(!zt){this.remove();return}yr(this,g,zt.bitmap),ar||(yr(this,_,zt.id),yr(this,nt,zt.isSvg)),mr(this,st,io).call(this)},hs=function(){yr(this,b,null),this._uiManager.enableWaiting(!1),ht(this,rt)&&this.div.focus()},Rs=function(){if(ht(this,_)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(ht(this,_)).then(ar=>mr(this,st,fs).call(this,ar,!0)).finally(()=>mr(this,st,hs).call(this));return}if(ht(this,tt)){const ar=ht(this,tt);yr(this,tt,null),this._uiManager.enableWaiting(!0),yr(this,b,this._uiManager.imageManager.getFromUrl(ar).then(Jt=>mr(this,st,fs).call(this,Jt)).finally(()=>mr(this,st,hs).call(this)));return}if(ht(this,_e)){const ar=ht(this,_e);yr(this,_e,null),this._uiManager.enableWaiting(!0),yr(this,b,this._uiManager.imageManager.getFromFile(ar).then(Jt=>mr(this,st,fs).call(this,Jt)).finally(()=>mr(this,st,hs).call(this)));return}const zt=document.createElement("input");zt.type="file",zt.accept=bt.supportedTypesStr,yr(this,b,new Promise(ar=>{zt.addEventListener("change",async()=>{if(!zt.files||zt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Jt=await this._uiManager.imageManager.getFromFile(zt.files[0]);mr(this,st,fs).call(this,Jt)}ar()}),zt.addEventListener("cancel",()=>{this.remove(),ar()})}).finally(()=>mr(this,st,hs).call(this))),zt.click()},io=function(){const{div:zt}=this;let{width:ar,height:Jt}=ht(this,g);const[Yt,kt]=this.pageDimensions,ir=.75;if(this.width)ar=this.width*Yt,Jt=this.height*kt;else if(ar>ir*Yt||Jt>ir*kt){const mt=Math.min(ir*Yt/ar,ir*kt/Jt);ar*=mt,Jt*=mt}const[fr,Et]=this.parentDimensions;this.setDims(ar*fr/Yt,Jt*Et/kt),this._uiManager.enableWaiting(!1);const xt=yr(this,rt,document.createElement("canvas"));zt.append(xt),zt.hidden=!1,mr(this,st,so).call(this,ar,Jt),mr(this,st,Yo).call(this),ht(this,at)||(this.parent.addUndoableEditor(this),yr(this,at,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Go=function(zt,ar){var ir;const[Jt,Yt]=this.parentDimensions;this.width=zt/Jt,this.height=ar/Yt,this.setDims(zt,ar),(ir=this._initialOptions)!=null&&ir.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,ht(this,et)!==null&&clearTimeout(ht(this,et)),yr(this,et,setTimeout(()=>{yr(this,et,null),mr(this,st,so).call(this,zt,ar)},200))},Ko=function(zt,ar){const{width:Jt,height:Yt}=ht(this,g);let kt=Jt,ir=Yt,fr=ht(this,g);for(;kt>2*zt||ir>2*ar;){const Et=kt,xt=ir;kt>2*zt&&(kt=kt>=16384?Math.floor(kt/2)-1:Math.ceil(kt/2)),ir>2*ar&&(ir=ir>=16384?Math.floor(ir/2)-1:Math.ceil(ir/2));const mt=new OffscreenCanvas(kt,ir);mt.getContext("2d").drawImage(fr,0,0,Et,xt,0,0,kt,ir),fr=mt.transferToImageBitmap()}return fr},so=function(zt,ar){zt=Math.ceil(zt),ar=Math.ceil(ar);const Jt=ht(this,rt);if(!Jt||Jt.width===zt&&Jt.height===ar)return;Jt.width=zt,Jt.height=ar;const Yt=ht(this,nt)?ht(this,g):mr(this,st,Ko).call(this,zt,ar),kt=Jt.getContext("2d");kt.filter=this._uiManager.hcmFilter,kt.drawImage(Yt,0,0,Yt.width,Yt.height,0,0,zt,ar)},Ps=function(zt){if(zt){if(ht(this,nt)){const Yt=this._uiManager.imageManager.getSvgUrl(ht(this,_));if(Yt)return Yt}const ar=document.createElement("canvas");return{width:ar.width,height:ar.height}=ht(this,g),ar.getContext("2d").drawImage(ht(this,g),0,0),ar.toDataURL()}if(ht(this,nt)){const[ar,Jt]=this.pageDimensions,Yt=Math.round(this.width*ar*c.PixelsPerInch.PDF_TO_CSS_UNITS),kt=Math.round(this.height*Jt*c.PixelsPerInch.PDF_TO_CSS_UNITS),ir=new OffscreenCanvas(Yt,kt);return ir.getContext("2d").drawImage(ht(this,g),0,0,ht(this,g).width,ht(this,g).height,0,0,Yt,kt),ir.transferToImageBitmap()}return structuredClone(ht(this,g))},Yo=function(){yr(this,it,new ResizeObserver(zt=>{const ar=zt[0].contentRect;ar.width&&ar.height&&mr(this,st,Go).call(this,ar.width,ar.height)})),ht(this,it).observe(this.div)},mn(bt,"_type","stamp");let h=bt;i.StampEditor=h}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var i=__webpack_module_cache__[e];if(i!==void 0)return i.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return c.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return d.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return h.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return a.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return g.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return i.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return s.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return a.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return o.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return o.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.version}});var i=__w_pdfjs_require__(1),s=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),o=__w_pdfjs_require__(26),c=__w_pdfjs_require__(27),d=__w_pdfjs_require__(5),h=__w_pdfjs_require__(29),g=__w_pdfjs_require__(14),_=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;typeof window<"u"&&(pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",console.log("PDF.js worker configurado para verso 3.11.174 - API version:",pdfExports.version));class PDFExtractor{static generateId(){return Math.random().toString(36).substr(2,9)}static parseValue(i){const s=i.replace(/\./g,"").replace(",",".").replace(/[^\d.-]/g,"");return parseFloat(s)||0}static extractEmployeeData(i){var pt,dt,wt,lt,gt,vt;function s(At,yt){const bt=At[yt].replace(/^[^:]+:/,"").trim();if(bt&&/^[\d.,-]+$/.test(bt))return bt;if(yt+1<At.length){const Tt=At[yt+1].trim();if(/^[\d.,-]+$/.test(Tt))return Tt}return""}const a=[];let o=null;const c=[],d=[];let h=!1,g=0,_=0,b=0,tt=0,_e=0,rt=0,it=0;const et=[],nt=[];let at=[];function st(){if(o&&o.matricula&&o.name){const At={id:o.id||"",name:o.name,matricula:o.matricula,funcao:o.funcao||"",secao:o.secao||"",filial:o.filial||"",admissao:o.admissao||"",demissao:o.demissao||"",salarioBase:o.salarioBase||0,eventos:nt.slice(),proventos:[],descontos:[],bases:{inss:g,irrf:_,fgts:b},valores:{bruto:tt,totalDescontos:0,liquido:_e,fgtsAcumulado:rt,irrfDescontado:it},eventosBrutos:et.slice()};console.log("[PUSH][Employee]",At),console.log("[DEBUG][Employee Final]",JSON.stringify(At,null,2)),a.push(At)}nt.length=0,c.length=0,d.length=0,g=0,_=0,b=0,tt=0,_e=0,rt=0,it=0,et.length=0,o=null}let ot=!1;for(let At=0;At<i.length;At++){const yt=i[At].trim();if(yt.includes("0096")&&console.log("[DEBUG][Linha com 0096]",At,JSON.stringify(yt)),console.log(`[DEBUG][Linha ${At}][Contedo]`,JSON.stringify(yt)),/^\d{6}$/.test(yt)&&console.log("[DEBUG][Nova matrcula detectada]",yt,"| Linha:",At),yt.toLowerCase()==="descontos"&&((pt=i[At+1])==null?void 0:pt.trim().toLowerCase())==="proventos"&&((dt=i[At+2])==null?void 0:dt.trim().toLowerCase())==="ref."&&((wt=i[At+3])==null?void 0:wt.trim().toLowerCase())==="descrio"&&((lt=i[At+4])==null?void 0:lt.trim().toLowerCase())==="evento"){console.log("[DEBUG][Cabealho de eventos detectado nas linhas]",At,At+1,At+2,At+3,At+4);let Tt=At+5;for(;Tt+3<i.length;){const er=i[Tt].trim(),zt=((gt=i[Tt+1])==null?void 0:gt.trim())||"";let ar="",Jt=Tt+2;for(;Jt<i.length&&!/^\d{4}$/.test(i[Jt].trim());)ar+=(ar?" ":"")+i[Jt].trim(),Jt++;const Yt=((vt=i[Jt])==null?void 0:vt.trim())||"",kt=/^-?[\d.,]+$/.test(er),ir=/^\d{4}$/.test(Yt);if(kt&&ir){const fr=this.parseValue(er),Et={codigo:Yt,tipo:ar,valor:fr,ref:zt};nt.push(Et),et.push(`${Yt} | ${ar} | ${zt} | ${er}`),console.log("[EVENTO][EventoUnico]",Et),Tt=Jt+1}else break}At=Tt-1;continue}if(/^\d{6}$/.test(yt)){let Tt=function(Et){return Et.normalize("NFD").replace(/[^\w\s]/g,"").replace(/[-]/g," ").replace(/\s+/g," ").trim().toUpperCase()};st();const er=At>0?i[At-1].trim():"",zt=At+1<i.length?i[At+1].trim():"";let ar="",Jt="",Yt=0,kt="",ir="";for(let Et=At+1;Et<Math.min(At+10,i.length);Et++){const xt=i[Et].trim(),mt=xt.match(/^FILIAL\s*:\s*(.+)$/i);mt&&(ir=mt[1].trim(),console.log("[DEBUG][FILIAL extrada pelo padro FILIAL:]",ir,"| Linha:",xt))}const fr=["UNICEUMA ANIL","UNICEUMA RENASCENCA","UNICEUMA TURU","UNICEUMA COHAMA","UNICEUMA IMPERATRIZ","UNICEUMA DEODORO","UNICEUMA BACABAL"];if(!ir)for(let Et=At-1;Et>=Math.max(0,At-5);Et--){const xt=i[Et].trim(),mt=Tt(xt);if(fr.map(Tt).includes(mt)){ir=xt,console.log("[DEBUG][FILIAL extrada por lista fixa]",ir,"| Linha:",xt);break}}o={id:this.generateId(),name:er,matricula:yt,funcao:zt,secao:kt,filial:ir,admissao:ar,demissao:Jt,salarioBase:Yt},at.length>0&&(nt.push(...at),at=[]);continue}if(!o)continue;if(/^SALRIO:/i.test(yt)){const Tt=s(i,At);o.salarioBase=this.parseValue(Tt),console.log("[VALOR][Salrio Base]",o.salarioBase)}if(/^Totais:/i.test(yt)){const Tt=s(i,At);tt=this.parseValue(Tt),console.log("[VALOR][Bruto]",tt)}if(/^Lquido:/i.test(yt)){const Tt=s(i,At);_e=this.parseValue(Tt),console.log("[VALOR][Lquido]",_e)}if(/^BASE INSS/i.test(yt)){const Tt=s(i,At);g=this.parseValue(Tt),console.log("[VALOR][BASE INSS]",g)}if(/^BASE IRRF/i.test(yt)){const Tt=s(i,At);_=this.parseValue(Tt),console.log("[VALOR][BASE IRRF]",_)}if(/^IRRF DESC/i.test(yt)){const Tt=s(i,At);it=this.parseValue(Tt),console.log("[VALOR][IRRF DESC]",it)}if(/^BASE FGTS/i.test(yt)){const Tt=s(i,At);b=this.parseValue(Tt),console.log("[VALOR][BASE FGTS]",b)}if(/^FGTS DEP\./i.test(yt)){const Tt=s(i,At);rt=this.parseValue(Tt),console.log("[VALOR][FGTS DEP.]",rt)}if((yt.toLowerCase().includes("evento")||yt.toLowerCase().includes("proventos")||yt.toLowerCase().includes("descontos"))&&console.log("[DEBUG][Possvel Cabealho Evento]",yt),/^evento\s+descri[c][a]o\s+ref\.?\s+proventos\s+descontos$/i.test(yt.replace(/\s+/g," ").trim())){h=!0,console.log("[DEBUG][Cabealho de eventos linha nica detectado (flexvel)]",yt,"| Linha:",At);continue}if(h&&/^BASE INSS|^Totais:|^Lquido:|^BASE IRRF|^BASE FGTS|^IRRF DESC|^FGTS DEP\./i.test(yt)){h=!1;continue}if(h){const Tt=yt.match(/^([0-9]{4})\s+(.+?)\s+([\d.,-]+)\s+([\d.,-]+|-)\s+([\d.,-]+|-)$/);if(Tt){const[er,zt,ar,Jt,Yt,kt]=Tt;Yt&&Yt!=="-"&&Yt!==""&&(c.push({codigo:zt,descricao:ar,ref:Jt,valor:this.parseValue(Yt),tipo:"provento"}),console.log("[EVENTO][Provento][Linha nica]",{codigo:zt,descricao:ar,ref:Jt,valor:this.parseValue(Yt)})),kt&&kt!=="-"&&kt!==""&&(d.push({codigo:zt,descricao:ar,ref:Jt,valor:this.parseValue(kt),tipo:"desconto"}),console.log("[EVENTO][Desconto][Linha nica]",{codigo:zt,descricao:ar,ref:Jt,valor:this.parseValue(kt)})),et.push(`${zt} | ${ar} | ${Jt} | ${Yt} | ${kt}`)}else console.log("[DEBUG][Linha no reconhecida como evento]",yt,"| Linha:",At)}if(/^BASE INSS|^BASE IRRF|^BASE FGTS|^IRRF DESC|^Totais:|^Lquido:/i.test(yt)&&(ot=!0),ot){const Tt=yt.match(/^(\d{4})\s+(.+?)\s+([\d.,-]+)\s+([\d.,-]+|-)\s+([\d.,-]+|-)$|^(\d{4})\s+(.+?)\s+([\d.,-]+)\s+-\s+([\d.,-]+)$/);if(Tt){const er=Tt[1]||Tt[6],zt=Tt[2]||Tt[7],ar=Tt[3]||Tt[8]||"",Jt=Tt[4]||"-",Yt=Tt[5]||Tt[9]||"-";if(er==="0096"&&console.log("[DEBUG][Evento 0096 capturado]",{codigo:er,descricao:zt,ref:ar,provento:Jt,desconto:Yt}),er&&zt&&(Jt!=="-"||Yt!=="-")){Jt!=="-"&&Jt!==""&&(nt.push({codigo:er,tipo:zt,valor:this.parseValue(Jt),ref:ar}),et.push(`${er} | ${zt} | ${ar} | ${Jt}`)),Yt!=="-"&&Yt!==""&&(nt.push({codigo:er,tipo:zt,valor:this.parseValue(Yt),ref:ar}),et.push(`${er} | ${zt} | ${ar} | ${Yt}`));continue}}!/^\s*$/.test(yt)&&!Tt&&(ot=!1)}const bt=yt.match(/^(\d{4})\s+(.+?)\s+([\d.,-]+)\s+([\d.,-]+|-)\s+([\d.,-]+|-)$|^(\d{4})\s+(.+?)\s+([\d.,-]+)\s+-\s+([\d.,-]+)$/);if(console.log(`[DEBUG][Linha ${At}][Regex evento isolado]`,!!bt,bt),bt){const Tt=bt[1]||bt[6],er=bt[2]||bt[7],zt=bt[3]||bt[8]||"",ar=bt[4]||"-",Jt=bt[5]||bt[9]||"-";if(console.log(`[DEBUG][Linha ${At}][Evento isolado extrado]`,{codigo:Tt,descricao:er,ref:zt,provento:ar,desconto:Jt}),Tt==="0096"&&console.log("[DEBUG][Evento 0096 capturado]",{codigo:Tt,descricao:er,ref:zt,provento:ar,desconto:Jt}),console.log(`[DEBUG][Linha ${At}][Eventos antes]`,JSON.stringify(nt)),Tt&&er&&(ar!=="-"||Jt!=="-")){ar!=="-"&&ar!==""&&(nt.push({codigo:Tt,tipo:er,valor:this.parseValue(ar),ref:zt}),et.push(`${Tt} | ${er} | ${zt} | ${ar}`)),Jt!=="-"&&Jt!==""&&(nt.push({codigo:Tt,tipo:er,valor:this.parseValue(Jt),ref:zt}),et.push(`${Tt} | ${er} | ${zt} | ${Jt}`)),console.log(`[DEBUG][Linha ${At}][Eventos depois]`,JSON.stringify(nt));continue}}}return st(),a}static finalizeEmployee(i){const s=i;return!s.valores.bruto&&s.proventos&&(s.valores.bruto=s.proventos.reduce((a,o)=>a+o.valor,0)),!s.valores.totalDescontos&&s.descontos&&(s.valores.totalDescontos=s.descontos.reduce((a,o)=>a+o.valor,0)),s.valores.liquido||(s.valores.liquido=s.valores.bruto-s.valores.totalDescontos),s}static async extractFromFile(i){try{if(!pdfExports.GlobalWorkerOptions.workerSrc)throw new Error("Worker do PDF.js no configurado");console.log("Processando arquivo:",i.name,"Tamanho:",i.size);const s=await i.arrayBuffer(),a=await pdfExports.getDocument(s).promise,o=[];for(let d=1;d<=a.numPages;d++)try{const _=(await(await a.getPage(d)).getTextContent()).items.filter(b=>"str"in b).map(b=>b.str).filter(b=>b.trim().length>0);console.log(`Pgina ${d}: ${_.length} linhas de texto extradas`),o.push(..._)}catch(h){console.warn(`Erro ao processar pgina ${d}:`,h)}console.log("[DEBUG][PDF] Total de linhas extradas:",o.length);const c=this.extractEmployeeData(o);return console.log(`Total de colaboradores extrados do arquivo ${i.name}: ${c.length}`),c}catch(s){throw console.error("Erro detalhado ao processar PDF:",s),s instanceof Error?s.message.includes("worker")?new Error(`Erro no worker do PDF.js para arquivo ${i.name}. Tente recarregar a pgina.`):s.message.includes("Invalid PDF")?new Error(`Arquivo ${i.name} no  um PDF vlido ou est corrompido.`):new Error(`Erro ao processar arquivo ${i.name}: ${s.message}`):new Error(`Erro desconhecido ao processar arquivo ${i.name}`)}}static async extractFromFiles(i,s){const a=Date.now(),o={totalFiles:i.length,totalEmployees:0,successfulExtractions:0,errors:[],processingTime:0},c=[];for(let d=0;d<i.length;d++){const h=i[d];try{const g=await this.extractFromFile(h);c.push(...g),o.successfulExtractions++,o.totalEmployees+=g.length;const _=(d+1)/i.length*100;s==null||s(_)}catch(g){const _=g instanceof Error?g.message:`Erro ao processar ${h.name}`;o.errors.push(_),console.error("Erro no arquivo:",h.name,g)}}return o.processingTime=Date.now()-a,{employees:c,stats:o,success:o.errors.length===0}}static processarProventosDescontos(i,s){var a,o;if(!(!i||!s))for(const c of i){const d=c.match(/^(\d{4})\s+(.+?)\s+([\d.,-]+)\s+([\d.,-]+|-)\s+([\d.,-]+|-)$/);if(d){const h=d[1],g=d[2].trim();d[3];const _=d[4],b=d[5];_&&_!=="-"&&parseFloat(_.replace(",","."))>0&&((a=s.proventos)==null||a.push({tipo:g,valor:this.parseValue(_),codigo:h})),b&&b!=="-"&&parseFloat(b.replace(",","."))>0&&((o=s.descontos)==null||o.push({tipo:g,valor:this.parseValue(b),codigo:h}))}}}}const STORAGE_KEY="folha:employees",EmployeeContext=reactExports.createContext(void 0),EmployeeProvider=({children:e})=>{const[i,s]=reactExports.useState([]),[a,o]=reactExports.useState(!1);reactExports.useEffect(()=>{const d=localStorage.getItem(STORAGE_KEY);if(d)try{s(JSON.parse(d))}catch(h){console.error("Erro ao carregar dados do localStorage:",h),localStorage.removeItem(STORAGE_KEY)}o(!0)},[]),reactExports.useEffect(()=>{a&&i.length>0&&localStorage.setItem(STORAGE_KEY,JSON.stringify(i))},[i,a]);const c=d=>{s(d),d.length>0?localStorage.setItem(STORAGE_KEY,JSON.stringify(d)):localStorage.removeItem(STORAGE_KEY)};return jsxRuntimeExports.jsx(EmployeeContext.Provider,{value:{employees:i,setEmployees:c},children:e})};function useEmployees(){const e=reactExports.useContext(EmployeeContext);if(!e)throw new Error("useEmployees deve ser usado dentro de EmployeeProvider");return e}const IndexContent=()=>{const{employees:e,setEmployees:i}=useEmployees(),[s,a]=reactExports.useState(null),[o,c]=reactExports.useState(!1),[d,h]=reactExports.useState(0),g=async b=>{c(!0),h(0),i([]),a(null);try{toast({title:"Processando arquivos",description:"Iniciando extrao de dados das folhas analticas..."});const tt=await PDFExtractor.extractFromFiles(b,_e=>{h(_e)});a(tt),i(tt.employees),console.log("[DEBUG][Employees extrados]",JSON.stringify(tt.employees,null,2)),tt.success?toast({title:"Processamento concludo",description:`${tt.employees.length} colaboradores extrados com sucesso!`}):toast({title:"Processamento concludo com avisos",description:`${tt.employees.length} colaboradores extrados. Verifique os erros relatados.`,variant:"destructive"})}catch(tt){toast({title:"Erro no processamento",description:tt instanceof Error?tt.message:"Erro desconhecido",variant:"destructive"})}finally{c(!1),h(0)}},_=()=>{window.confirm("Tem certeza que deseja iniciar um novo processamento? Todos os dados atuais sero perdidos.")&&(i([]),a(null),c(!1),h(0),localStorage.removeItem("folha:employees"))};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-secondary",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-primary text-primary-foreground shadow-lg-custom",children:jsxRuntimeExports.jsx("div",{className:"container mx-auto px-4 py-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-primary-foreground/20 rounded-lg flex items-center justify-center",children:jsxRuntimeExports.jsx(FileSpreadsheet,{className:"w-6 h-6"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold",children:"Extrator de Folhas Analticas"}),jsxRuntimeExports.jsx("p",{className:"text-primary-foreground/80",children:"Processamento inteligente de PDFs para Excel"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:e.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Link,{to:"/totais",children:jsxRuntimeExports.jsx(Button,{variant:"secondary",className:"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground border-0",children:"Totais por Evento"})}),jsxRuntimeExports.jsxs(Button,{onClick:_,variant:"secondary",className:"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground border-0",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-4 h-4 mr-2"}),"Novo Processamento"]})]})})]})})}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[e.length===0&&jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto",children:[jsxRuntimeExports.jsxs(Card,{className:"shadow-lg-custom",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"text-center",children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center justify-center space-x-2 text-2xl",children:[jsxRuntimeExports.jsx(Upload,{className:"w-6 h-6 text-primary"}),jsxRuntimeExports.jsx("span",{children:"Processamento de Folhas Analticas"})]}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mt-2",children:"Carregue arquivos PDF de folhas analticas para extrair dados estruturados de colaboradores"})]}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx(PDFUploader,{onFilesSelected:g,isProcessing:o,processingProgress:d})})]}),jsxRuntimeExports.jsx(Card,{className:"mt-6 border-primary/20 bg-primary/5",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg mb-4 text-primary",children:"Como usar esta ferramenta:"}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-muted-foreground",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Upload:"})," Selecione um ou mltiplos arquivos PDF"]}),jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Processamento:"})," A extrao  feita automaticamente"]}),jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Visualizao:"})," Dados organizados em tabela navegvel"]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Filtros:"})," Busque por nome, funo ou filial"]}),jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Exportao:"})," Baixe os dados em Excel (.xlsx)"]}),jsxRuntimeExports.jsxs("p",{children:[" ",jsxRuntimeExports.jsx("strong",{children:"Validao:"})," Relatrio de erros e estatsticas"]})]})]})]})})]}),s&&jsxRuntimeExports.jsx("div",{className:"max-w-6xl mx-auto",children:jsxRuntimeExports.jsx(ProcessingResults,{stats:s.stats})}),e.length>0&&jsxRuntimeExports.jsx("div",{className:"max-w-6xl mx-auto",children:jsxRuntimeExports.jsx(EmployeeTable,{employees:e})})]})]})},Index=()=>jsxRuntimeExports.jsx(EmployeeProvider,{children:jsxRuntimeExports.jsx(IndexContent,{})}),NotFound=()=>{const e=useLocation();return reactExports.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),jsxRuntimeExports.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};var POPOVER_NAME="Popover",[createPopoverContext,createPopoverScope]=createContextScope$2(POPOVER_NAME,[createPopperScope]),usePopperScope=createPopperScope(),[PopoverProvider,usePopoverContext]=createPopoverContext(POPOVER_NAME),Popover$1=e=>{const{__scopePopover:i,children:s,open:a,defaultOpen:o,onOpenChange:c,modal:d=!1}=e,h=usePopperScope(i),g=reactExports.useRef(null),[_,b]=reactExports.useState(!1),[tt=!1,_e]=useControllableState({prop:a,defaultProp:o,onChange:c});return jsxRuntimeExports.jsx(Root2$2,{...h,children:jsxRuntimeExports.jsx(PopoverProvider,{scope:i,contentId:useId(),triggerRef:g,open:tt,onOpenChange:_e,onOpenToggle:reactExports.useCallback(()=>_e(rt=>!rt),[_e]),hasCustomAnchor:_,onCustomAnchorAdd:reactExports.useCallback(()=>b(!0),[]),onCustomAnchorRemove:reactExports.useCallback(()=>b(!1),[]),modal:d,children:s})})};Popover$1.displayName=POPOVER_NAME;var ANCHOR_NAME="PopoverAnchor",PopoverAnchor=reactExports.forwardRef((e,i)=>{const{__scopePopover:s,...a}=e,o=usePopoverContext(ANCHOR_NAME,s),c=usePopperScope(s),{onCustomAnchorAdd:d,onCustomAnchorRemove:h}=o;return reactExports.useEffect(()=>(d(),()=>h()),[d,h]),jsxRuntimeExports.jsx(Anchor,{...c,...a,ref:i})});PopoverAnchor.displayName=ANCHOR_NAME;var TRIGGER_NAME="PopoverTrigger",PopoverTrigger$1=reactExports.forwardRef((e,i)=>{const{__scopePopover:s,...a}=e,o=usePopoverContext(TRIGGER_NAME,s),c=usePopperScope(s),d=useComposedRefs(i,o.triggerRef),h=jsxRuntimeExports.jsx(Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":getState$1(o.open),...a,ref:d,onClick:composeEventHandlers$1(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?h:jsxRuntimeExports.jsx(Anchor,{asChild:!0,...c,children:h})});PopoverTrigger$1.displayName=TRIGGER_NAME;var PORTAL_NAME="PopoverPortal",[PortalProvider,usePortalContext]=createPopoverContext(PORTAL_NAME,{forceMount:void 0}),PopoverPortal=e=>{const{__scopePopover:i,forceMount:s,children:a,container:o}=e,c=usePopoverContext(PORTAL_NAME,i);return jsxRuntimeExports.jsx(PortalProvider,{scope:i,forceMount:s,children:jsxRuntimeExports.jsx(Presence,{present:s||c.open,children:jsxRuntimeExports.jsx(Portal$2,{asChild:!0,container:o,children:a})})})};PopoverPortal.displayName=PORTAL_NAME;var CONTENT_NAME="PopoverContent",PopoverContent$1=reactExports.forwardRef((e,i)=>{const s=usePortalContext(CONTENT_NAME,e.__scopePopover),{forceMount:a=s.forceMount,...o}=e,c=usePopoverContext(CONTENT_NAME,e.__scopePopover);return jsxRuntimeExports.jsx(Presence,{present:a||c.open,children:c.modal?jsxRuntimeExports.jsx(PopoverContentModal,{...o,ref:i}):jsxRuntimeExports.jsx(PopoverContentNonModal,{...o,ref:i})})});PopoverContent$1.displayName=CONTENT_NAME;var PopoverContentModal=reactExports.forwardRef((e,i)=>{const s=usePopoverContext(CONTENT_NAME,e.__scopePopover),a=reactExports.useRef(null),o=useComposedRefs(i,a),c=reactExports.useRef(!1);return reactExports.useEffect(()=>{const d=a.current;if(d)return hideOthers(d)},[]),jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot,allowPinchZoom:!0,children:jsxRuntimeExports.jsx(PopoverContentImpl,{...e,ref:o,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:composeEventHandlers$1(e.onCloseAutoFocus,d=>{var h;d.preventDefault(),c.current||(h=s.triggerRef.current)==null||h.focus()}),onPointerDownOutside:composeEventHandlers$1(e.onPointerDownOutside,d=>{const h=d.detail.originalEvent,g=h.button===0&&h.ctrlKey===!0,_=h.button===2||g;c.current=_},{checkForDefaultPrevented:!1}),onFocusOutside:composeEventHandlers$1(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),PopoverContentNonModal=reactExports.forwardRef((e,i)=>{const s=usePopoverContext(CONTENT_NAME,e.__scopePopover),a=reactExports.useRef(!1),o=reactExports.useRef(!1);return jsxRuntimeExports.jsx(PopoverContentImpl,{...e,ref:i,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d,h;(d=e.onCloseAutoFocus)==null||d.call(e,c),c.defaultPrevented||(a.current||(h=s.triggerRef.current)==null||h.focus(),c.preventDefault()),a.current=!1,o.current=!1},onInteractOutside:c=>{var g,_;(g=e.onInteractOutside)==null||g.call(e,c),c.defaultPrevented||(a.current=!0,c.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const d=c.target;((_=s.triggerRef.current)==null?void 0:_.contains(d))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&o.current&&c.preventDefault()}})}),PopoverContentImpl=reactExports.forwardRef((e,i)=>{const{__scopePopover:s,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEscapeKeyDown:h,onPointerDownOutside:g,onFocusOutside:_,onInteractOutside:b,...tt}=e,_e=usePopoverContext(CONTENT_NAME,s),rt=usePopperScope(s);return useFocusGuards(),jsxRuntimeExports.jsx(FocusScope,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:o,onUnmountAutoFocus:c,children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:b,onEscapeKeyDown:h,onPointerDownOutside:g,onFocusOutside:_,onDismiss:()=>_e.onOpenChange(!1),children:jsxRuntimeExports.jsx(Content,{"data-state":getState$1(_e.open),role:"dialog",id:_e.contentId,...rt,...tt,ref:i,style:{...tt.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),CLOSE_NAME="PopoverClose",PopoverClose=reactExports.forwardRef((e,i)=>{const{__scopePopover:s,...a}=e,o=usePopoverContext(CLOSE_NAME,s);return jsxRuntimeExports.jsx(Primitive.button,{type:"button",...a,ref:i,onClick:composeEventHandlers$1(e.onClick,()=>o.onOpenChange(!1))})});PopoverClose.displayName=CLOSE_NAME;var ARROW_NAME="PopoverArrow",PopoverArrow=reactExports.forwardRef((e,i)=>{const{__scopePopover:s,...a}=e,o=usePopperScope(s);return jsxRuntimeExports.jsx(Arrow,{...o,...a,ref:i})});PopoverArrow.displayName=ARROW_NAME;function getState$1(e){return e?"open":"closed"}var Root2=Popover$1,Trigger=PopoverTrigger$1,Portal=PopoverPortal,Content2=PopoverContent$1;const Popover=Root2,PopoverTrigger=Trigger,PopoverContent=reactExports.forwardRef(({className:e,align:i="center",sideOffset:s=4,...a},o)=>jsxRuntimeExports.jsx(Portal,{children:jsxRuntimeExports.jsx(Content2,{ref:o,align:i,sideOffset:s,className:cn("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));PopoverContent.displayName=Content2.displayName;var CHECKBOX_NAME="Checkbox",[createCheckboxContext,createCheckboxScope]=createContextScope$2(CHECKBOX_NAME),[CheckboxProvider,useCheckboxContext]=createCheckboxContext(CHECKBOX_NAME),Checkbox$1=reactExports.forwardRef((e,i)=>{const{__scopeCheckbox:s,name:a,checked:o,defaultChecked:c,required:d,disabled:h,value:g="on",onCheckedChange:_,form:b,...tt}=e,[_e,rt]=reactExports.useState(null),it=useComposedRefs(i,pt=>rt(pt)),et=reactExports.useRef(!1),nt=_e?b||!!_e.closest("form"):!0,[at=!1,st]=useControllableState({prop:o,defaultProp:c,onChange:_}),ot=reactExports.useRef(at);return reactExports.useEffect(()=>{const pt=_e==null?void 0:_e.form;if(pt){const dt=()=>st(ot.current);return pt.addEventListener("reset",dt),()=>pt.removeEventListener("reset",dt)}},[_e,st]),jsxRuntimeExports.jsxs(CheckboxProvider,{scope:s,state:at,disabled:h,children:[jsxRuntimeExports.jsx(Primitive.button,{type:"button",role:"checkbox","aria-checked":isIndeterminate(at)?"mixed":at,"aria-required":d,"data-state":getState(at),"data-disabled":h?"":void 0,disabled:h,value:g,...tt,ref:it,onKeyDown:composeEventHandlers$1(e.onKeyDown,pt=>{pt.key==="Enter"&&pt.preventDefault()}),onClick:composeEventHandlers$1(e.onClick,pt=>{st(dt=>isIndeterminate(dt)?!0:!dt),nt&&(et.current=pt.isPropagationStopped(),et.current||pt.stopPropagation())})}),nt&&jsxRuntimeExports.jsx(BubbleInput,{control:_e,bubbles:!et.current,name:a,value:g,checked:at,required:d,disabled:h,form:b,style:{transform:"translateX(-100%)"},defaultChecked:isIndeterminate(c)?!1:c})]})});Checkbox$1.displayName=CHECKBOX_NAME;var INDICATOR_NAME="CheckboxIndicator",CheckboxIndicator=reactExports.forwardRef((e,i)=>{const{__scopeCheckbox:s,forceMount:a,...o}=e,c=useCheckboxContext(INDICATOR_NAME,s);return jsxRuntimeExports.jsx(Presence,{present:a||isIndeterminate(c.state)||c.state===!0,children:jsxRuntimeExports.jsx(Primitive.span,{"data-state":getState(c.state),"data-disabled":c.disabled?"":void 0,...o,ref:i,style:{pointerEvents:"none",...e.style}})})});CheckboxIndicator.displayName=INDICATOR_NAME;var BubbleInput=e=>{const{control:i,checked:s,bubbles:a=!0,defaultChecked:o,...c}=e,d=reactExports.useRef(null),h=usePrevious(s),g=useSize(i);reactExports.useEffect(()=>{const b=d.current,tt=window.HTMLInputElement.prototype,rt=Object.getOwnPropertyDescriptor(tt,"checked").set;if(h!==s&&rt){const it=new Event("click",{bubbles:a});b.indeterminate=isIndeterminate(s),rt.call(b,isIndeterminate(s)?!1:s),b.dispatchEvent(it)}},[h,s,a]);const _=reactExports.useRef(isIndeterminate(s)?!1:s);return jsxRuntimeExports.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o??_.current,...c,tabIndex:-1,ref:d,style:{...e.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function isIndeterminate(e){return e==="indeterminate"}function getState(e){return isIndeterminate(e)?"indeterminate":e?"checked":"unchecked"}var Root=Checkbox$1,Indicator=CheckboxIndicator;const Checkbox=reactExports.forwardRef(({className:e,...i},s)=>jsxRuntimeExports.jsx(Root,{ref:s,className:cn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...i,children:jsxRuntimeExports.jsx(Indicator,{className:cn("flex items-center justify-center text-current"),children:jsxRuntimeExports.jsx(Check,{className:"h-4 w-4"})})}));Checkbox.displayName=Root.displayName;const MultiSelect=({options:e,value:i,onChange:s,placeholder:a,disabled:o})=>{const[c,d]=reactExports.useState(!1),[h,g]=reactExports.useState(i),_=()=>{s(h),d(!1)},b=tt=>{g(_e=>_e.includes(tt)?_e.filter(rt=>rt!==tt):[..._e,tt])};return React.useEffect(()=>{c||g(i)},[c,i]),jsxRuntimeExports.jsxs(Popover,{open:c,onOpenChange:d,children:[jsxRuntimeExports.jsx(PopoverTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Button,{variant:"outline",className:"w-64 justify-between",disabled:o,children:jsxRuntimeExports.jsx("span",{className:"truncate",children:i.length===0?a||"Selecione...":e.filter(tt=>i.includes(tt.value)).map(tt=>tt.label).join(", ")})})}),jsxRuntimeExports.jsxs(PopoverContent,{className:"w-64 p-2 space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:e.map(tt=>jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 cursor-pointer px-2 py-1 rounded hover:bg-muted",children:[jsxRuntimeExports.jsx(Checkbox,{checked:h.includes(tt.value),onCheckedChange:()=>b(tt.value)}),jsxRuntimeExports.jsx("span",{className:"truncate",children:tt.label})]},tt.value))}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[jsxRuntimeExports.jsx(Button,{size:"sm",variant:"ghost",onClick:()=>d(!1),children:"Cancelar"}),jsxRuntimeExports.jsx(Button,{size:"sm",onClick:_,children:"Confirmar"})]})]})]})};function TotalsPage(){const{employees:e}=useEmployees();console.log("[DEBUG][TotalsPage][employees]",e);const i=useNavigate(),s=reactExports.useMemo(()=>{const rt=new Set;return e.forEach(it=>{it.filial&&rt.add(it.filial)}),Array.from(rt)},[e]),a=reactExports.useMemo(()=>{const rt=new Map;return e.forEach(it=>{var et;(et=it.eventos)==null||et.forEach(nt=>{nt.codigo&&nt.tipo&&rt.set(nt.codigo,nt.tipo)})}),Array.from(rt.entries()).map(([it,et])=>({codigo:it,tipo:et}))},[e]),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState([]),[g,_]=reactExports.useState(!1),b=e&&e.length>0;reactExports.useMemo(()=>!o.length||!d.length?0:e.filter(rt=>o.includes(rt.filial)).flatMap(rt=>rt.eventos||[]).filter(rt=>d.includes(rt.codigo)).reduce((rt,it)=>rt+(it.valor||0),0),[e,o,d]);const tt=reactExports.useMemo(()=>!o.length||!d.length?[]:e.filter(rt=>o.includes(rt.filial)).flatMap(rt=>(rt.eventos||[]).filter(it=>d.includes(it.codigo)).map(it=>({colaborador:rt.name,matricula:rt.matricula,valor:it.valor,evento:it.tipo,codigo:it.codigo,filial:rt.filial}))),[e,o,d]),_e=()=>{const rt=o.flatMap(ot=>d.map(pt=>{var lt;const dt=((lt=a.find(gt=>gt.codigo===pt))==null?void 0:lt.tipo)||"",wt=e.filter(gt=>gt.filial===ot).flatMap(gt=>gt.eventos||[]).filter(gt=>gt.codigo===pt).reduce((gt,vt)=>gt+(vt.valor||0),0);return{Filial:ot,Evento:pt+" - "+dt,Total:wt}})),it=tt.map(ot=>({Filial:ot.filial,Evento:ot.codigo,Descricao:ot.evento,Colaborador:ot.colaborador,Matricula:ot.matricula,Valor:ot.valor})),et=utils.book_new(),nt=utils.json_to_sheet(rt);if(utils.book_append_sheet(et,nt,"Resumo"),it.length>0){const ot=utils.json_to_sheet(it);utils.book_append_sheet(et,ot,"Detalhes")}const st=`totais_evento_${new Date().toISOString().slice(0,10)}.xlsx`;writeFileSync(et,st)};return jsxRuntimeExports.jsx("div",{className:"max-w-3xl mx-auto py-8 space-y-6",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Totalizao por Evento e Filial"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[!b&&jsxRuntimeExports.jsxs("div",{className:"text-center py-8 text-muted-foreground space-y-4",children:[jsxRuntimeExports.jsx("p",{children:"Nenhum dado disponvel. Faa o processamento de um arquivo primeiro."}),jsxRuntimeExports.jsx(Button,{onClick:()=>i("/"),children:"Ir para Processamento"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[jsxRuntimeExports.jsx(MultiSelect,{options:s.map(rt=>({value:rt,label:rt})),value:o,onChange:c,placeholder:"Selecione a(s) Filial(is)",disabled:!b}),jsxRuntimeExports.jsx(MultiSelect,{options:a.map(rt=>({value:rt.codigo,label:rt.codigo+" - "+rt.tipo})),value:d,onChange:h,placeholder:"Selecione o(s) Evento(s)",disabled:!b})]}),b&&jsxRuntimeExports.jsxs("div",{className:"mt-6 flex items-center gap-4",children:[jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableHead,{children:"Filial"}),jsxRuntimeExports.jsx(TableHead,{children:"Evento"}),jsxRuntimeExports.jsx(TableHead,{children:"Total"})]})}),jsxRuntimeExports.jsx(TableBody,{children:o.length>0&&d.length>0&&o.flatMap(rt=>d.map(it=>{var at;const et=((at=a.find(st=>st.codigo===it))==null?void 0:at.tipo)||"",nt=e.filter(st=>st.filial===rt).flatMap(st=>st.eventos||[]).filter(st=>st.codigo===it).reduce((st,ot)=>st+(ot.valor||0),0);return jsxRuntimeExports.jsxs(TableRow,{className:"cursor-pointer hover:bg-muted/40",onClick:()=>_(st=>!st),children:[jsxRuntimeExports.jsx(TableCell,{children:rt}),jsxRuntimeExports.jsxs(TableCell,{children:[it," - ",et]}),jsxRuntimeExports.jsx(TableCell,{children:jsxRuntimeExports.jsx("b",{children:nt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})})]},rt+"-"+it)}))})]}),jsxRuntimeExports.jsx(Button,{onClick:_e,disabled:!o.length||!d.length,children:"Exportar Excel"})]}),b&&g&&tt.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-4",children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableHead,{children:"Colaborador"}),jsxRuntimeExports.jsx(TableHead,{children:"Matrcula"}),jsxRuntimeExports.jsx(TableHead,{children:"Descrio"}),jsxRuntimeExports.jsx(TableHead,{children:"Valor"})]})}),jsxRuntimeExports.jsx(TableBody,{children:tt.map((rt,it)=>jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{children:rt.colaborador}),jsxRuntimeExports.jsx(TableCell,{children:rt.matricula}),jsxRuntimeExports.jsx(TableCell,{children:rt.evento}),jsxRuntimeExports.jsx(TableCell,{children:rt.valor.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]},rt.matricula+"-"+rt.codigo+"-"+it))})]})})]})]})})}const queryClient=new QueryClient,App=()=>jsxRuntimeExports.jsx(ErrorBoundary,{children:jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsxs(TooltipProvider,{children:[jsxRuntimeExports.jsx(Toaster$1,{}),jsxRuntimeExports.jsx(Toaster,{}),jsxRuntimeExports.jsx(EmployeeProvider,{children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/folha-data-explorer",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Index,{})}),jsxRuntimeExports.jsx(Route,{path:"/totais",element:jsxRuntimeExports.jsx(TotalsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})})]})})})]})})});createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(App,{}));
